function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,i=!0,o=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){o=!0,c=e},f:function(){try{i||null==n.return||n.return()}finally{if(o)throw c}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=_superPropBase(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,a=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;n=Reflect.construct(a,arguments,r)}else n=a.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"0bMg":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"validation",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.map((function(t){return e.get(t)})).every((function(e){return e&&""===e.value||!e}))?{noOneSet:!0}:null}}}]),e}()},"EGJ/":function(e,t,n){"use strict";n.r(t),n.d(t,"UsersModule",(function(){return Fa}));var a=n("ofXK"),r=n("PCNd"),c=n("tyNb"),i=n("OwvW"),o=n("mrSG"),s=n("3Pt+"),l=n("+0xr"),u=n("R+Vs"),b=n("F48D"),m=n("Izkr"),d=n("mV3u"),f=n("fXoL"),p=n("jhN1"),h=n("sYmb"),g=n("dNgK"),v=n("0IaG"),w=n("mksl"),S=n("Wp6s"),_=n("7EHt"),G=n("bSwM"),y=n("kmnG"),Y=n("qFsG"),Z=n("IZUe"),C=n("bTqV"),k=["groupForm"],P=["groupEditDialog"];function I(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Permissions")))}function T(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",f.nc(2,1,n.display_name)," ")}}function x(e,t){if(1&e){var n=f.ac();f.Zb(0,"mat-header-cell",17),f.hc("click",(function(){f.Ic(n);var e=f.lc().$implicit;return f.lc(2).selectGroup(e)})),f.Zb(1,"div",18),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()}if(2&e){var a=f.lc().$implicit;f.Gb(2),f.Uc(" ",f.nc(3,1,a.name)," ")}}function M(e,t){if(1&e){var n=f.ac();f.Zb(0,"mat-checkbox",21),f.hc("change",(function(){f.Ic(n);var e=f.lc().$implicit,t=f.lc().$implicit;return f.lc(2).togglePerm(t,e.value)})),f.Yb()}if(2&e){var a=f.lc().$implicit,r=f.lc().$implicit;f.tc("checked",r.hasPermission(a.value))}}function O(e,t){1&e&&f.Ub(0,"mat-checkbox",22),2&e&&f.tc("checked",!0)("disabled",!0)}function D(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Zb(1,"div",18),f.Qc(2,M,1,1,"mat-checkbox",19),f.Qc(3,O,1,2,"mat-checkbox",20),f.Yb(),f.Yb()),2&e){var n=f.lc().$implicit;f.Gb(2),f.tc("ngIf",2!==n.id),f.Gb(1),f.tc("ngIf",2===n.id)}}function E(e,t){if(1&e&&(f.Zb(0,"div"),f.Xb(1,15),f.Qc(2,x,4,3,"mat-header-cell",16),f.Qc(3,D,4,2,"mat-cell",11),f.Wb(),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("matColumnDef",n.name)}}function U(e,t){1&e&&f.Ub(0,"mat-header-row")}function Q(e,t){1&e&&f.Ub(0,"mat-row")}function R(e,t){if(1&e&&(f.Zb(0,"mat-accordion"),f.Zb(1,"mat-expansion-panel",6),f.Zb(2,"mat-expansion-panel-header"),f.Zb(3,"mat-panel-title"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb(),f.Zb(6,"div",7),f.Zb(7,"table",8),f.Xb(8,9),f.Qc(9,I,3,3,"mat-header-cell",10),f.Qc(10,T,3,3,"mat-cell",11),f.Wb(),f.Qc(11,E,4,1,"div",12),f.Qc(12,U,1,0,"mat-header-row",13),f.Qc(13,Q,1,0,"mat-row",14),f.Yb(),f.Yb(),f.Yb(),f.Yb()),2&e){var n=t.$implicit,a=f.lc();f.Gb(1),f.tc("expanded",!0),f.Gb(3),f.Uc(" ",f.nc(5,7,n.name)," "),f.Gb(3),f.tc("dataSource",a.getTableDataSource(n.permissions)),f.Gb(4),f.tc("ngForOf",a.groups)("ngForTrackBy",a.trackByIndex),f.Gb(1),f.tc("matHeaderRowDef",a.headerRowDef),f.Gb(1),f.tc("matRowDefColumns",a.headerRowDef)}}function F(e,t){1&e&&(f.Zb(0,"mat-error"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Required")))}function A(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",32),f.hc("click",(function(){return f.Ic(n),f.lc(2).deleteSelectedGroup()})),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()}if(2&e){var a=f.lc(2);f.tc("disabled",!a.canDeleteGroup(a.selectedGroup)),f.Gb(2),f.Tc(f.nc(3,2,"Delete"))}}function N(e,t){if(1&e){var n=f.ac();f.Zb(0,"h1",23),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb(),f.Zb(4,"div",24),f.Zb(5,"form",25),f.hc("keydown",(function(e){return f.Ic(n),f.lc().keyDownFunction(e)})),f.Zb(6,"mat-form-field"),f.Ub(7,"input",26),f.mc(8,"translate"),f.Qc(9,F,3,3,"mat-error",27),f.Yb(),f.Yb(),f.Yb(),f.Zb(10,"div",28),f.Zb(11,"button",29),f.hc("click",(function(){f.Ic(n);var e=f.lc();return e.saveGroup(e.groupForm.value)})),f.Zb(12,"span"),f.Sc(13),f.mc(14,"translate"),f.Yb(),f.Yb(),f.Zb(15,"button",30),f.hc("click",(function(){return f.Ic(n),f.lc().cancelEditing()})),f.Zb(16,"span"),f.Sc(17),f.mc(18,"translate"),f.Yb(),f.Yb(),f.Qc(19,A,4,4,"button",31),f.Yb()}if(2&e){var a=f.lc();f.Gb(2),f.Tc(f.nc(3,8,"New group name")),f.Gb(3),f.tc("formGroup",a.groupForm),f.Gb(2),f.uc("placeholder",f.nc(8,10,"New group name")),f.Gb(2),f.tc("ngIf",!a.groupForm.valid),f.Gb(2),f.tc("disabled",!a.groupForm.valid),f.Gb(2),f.Tc(f.nc(14,12,"Save")),f.Gb(4),f.Tc(f.nc(18,14,"Cancel")),f.Gb(2),f.tc("ngIf",a.selectedGroup)}}var V,L=((V=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i,o,s){var l;return _classCallCheck(this,n),(l=t.call(this,e,a,r)).translate=a,l.dialog=c,l.repo=i,l.promptService=o,l.fb=s,l.headerRowDef=[],l.newGroup=!1,l.editGroup=!1,l}return _createClass(n,[{key:"setEditMode",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.editGroup=e,this.newGroup=n,this.groupForm=this.fb.group({name:[this.selectedGroup?this.selectedGroup.name:"",s.G.required]}),this.dialogRef=this.dialog.open(this.groupEditDialog,m.a),this.dialogRef.keydownEvents().subscribe((function(e){"Enter"===e.key&&e.shiftKey&&t.groupForm.valid&&t.saveGroup(t.groupForm.value)}))}},{key:"saveGroup",value:function(e){var t=this;this.editGroup&&this.newGroup?this.repo.create(e).then((function(){return t.cancelEditing()}),this.raiseError):this.editGroup&&!this.newGroup&&this.repo.update(e,this.selectedGroup).then((function(){return t.cancelEditing()}),this.raiseError)}},{key:"selectGroup",value:function(e){this.selectedGroup=e,this.setEditMode(!0,!1)}},{key:"deleteSelectedGroup",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to delete this group?"),n=this.translate.instant(this.selectedGroup.name),e.next=3,this.promptService.open(t,n);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.repo.delete(this.selectedGroup).then((function(){return a.cancelEditing()}),this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"cancelEditing",value:function(){this.dialogRef.close(),this.newGroup=!1,this.editGroup=!1,this.selectedGroup=null}},{key:"canDeleteGroup",value:function(e){return 1!==e.id&&2!==e.id}},{key:"togglePerm",value:function(e,t){this.repo.togglePerm(e,t)}},{key:"updateRowDef",value:function(){var e=this;this.headerRowDef=["perm"],this.groups.forEach((function(t){e.headerRowDef.push(""+t.name)}))}},{key:"trackGroupArray",value:function(e){return e.id}},{key:"getTableDataSource",value:function(e){var t=new l.o;return t.data=e,t}},{key:"isProtected",value:function(e){return 1===e.id||2===e.id}},{key:"keyDownFunction",value:function(e){"Escape"===e.key&&(this.newGroup=!1)}},{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"setTitle",this).call(this,"Groups"),this.repo.getViewModelListObservable().subscribe((function(t){t&&(e.groups=t,e.updateRowDef())}))}},{key:"appPermissions",get:function(){return this.repo.appPermissions}}]),n}(d.a)).\u0275fac=function(e){return new(e||V)(f.Tb(p.d),f.Tb(h.k),f.Tb(g.a),f.Tb(v.b),f.Tb(u.a),f.Tb(b.a),f.Tb(s.f))},V.\u0275cmp=f.Nb({type:V,selectors:[["os-group-list"]],viewQuery:function(e,t){var n;1&e&&(f.Oc(k,!0),f.Oc(P,!0)),2&e&&(f.Dc(n=f.ic())&&(t.groupForm=n.first),f.Dc(n=f.ic())&&(t.groupEditDialog=n.first))},features:[f.Db],decls:13,vars:9,consts:[[3,"hasMainButton","nav","mainEvent"],[1,"title-slot"],[1,"spacer-bottom-60"],[1,"hint-text"],[4,"ngFor","ngForOf"],["groupEditDialog",""],[1,"mat-elevation-z0",3,"expanded"],[1,"scrollable-perm-matrix"],["mat-table","",3,"dataSource"],["matColumnDef","perm","sticky",""],[4,"matHeaderCellDef"],[4,"matCellDef"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["class","group-head-table-cell",3,"click",4,"matHeaderCellDef"],[1,"group-head-table-cell",3,"click"],[1,"inner-table"],[3,"checked","change",4,"ngIf"],[3,"checked","disabled",4,"ngIf"],[3,"checked","change"],[3,"checked","disabled"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],[1,"edit-form",3,"formGroup","keydown"],["type","text","matInput","","osAutofocus","","required","","formControlName","name",3,"placeholder"],[4,"ngIf"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","click"],["type","button","mat-button","",3,"click"],["type","button","mat-button","","color","warn",3,"disabled","click",4,"ngIf"],["type","button","mat-button","","color","warn",3,"disabled","click"]],template:function(e,t){1&e&&(f.Zb(0,"os-head-bar",0),f.hc("mainEvent",(function(){return t.setEditMode(!t.editGroup)})),f.Zb(1,"div",1),f.Zb(2,"h2"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Zb(5,"mat-card",2),f.Zb(6,"div",3),f.Zb(7,"span"),f.Sc(8),f.mc(9,"translate"),f.Yb(),f.Yb(),f.Qc(10,R,14,9,"mat-accordion",4),f.Yb(),f.Qc(11,N,20,16,"ng-template",null,5,f.Rc)),2&e&&(f.tc("hasMainButton",!0)("nav",!1),f.Gb(3),f.Tc(f.nc(4,5,"Groups")),f.Gb(5),f.Tc(f.nc(9,7,"All your changes are saved immediately.")),f.Gb(2),f.tc("ngForOf",t.appPermissions))},directives:[w.a,S.a,a.s,_.a,_.c,_.g,_.h,l.n,l.c,l.i,l.b,l.k,l.m,l.h,l.a,a.t,G.a,l.j,l.l,v.i,v.f,s.I,s.t,s.k,y.c,Y.b,s.c,Z.a,s.D,s.s,s.i,v.c,C.b,y.b],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{min-width:80px}table[_ngcontent-%COMP%]   .mat-column-perm[_ngcontent-%COMP%]{min-width:130px}table[_ngcontent-%COMP%]   .inner-table[_ngcontent-%COMP%]{width:100%;text-align:center}table[_ngcontent-%COMP%]   .group-head-table-cell[_ngcontent-%COMP%]{cursor:pointer}.hint-text[_ngcontent-%COMP%]{padding-top:1em;padding-left:25px}.new-group-forrm[_ngcontent-%COMP%]{text-align:center;padding-top:10px;background-color:#fff}.new-group-forrm[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px}.scrollable-perm-matrix[_ngcontent-%COMP%]{overflow:auto}"]}),V),j=n("ZDbo"),B=n("NFeN"),W=n("Qu3c");function $(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.Tc(f.nc(3,1,"You are not supposed to be here...")))}function H(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h1"),f.Zb(2,"span"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Sc(5),f.Yb(),f.Zb(6,"mat-icon"),f.Sc(7,"warning"),f.Yb(),f.Sc(8," \xa0"),f.Zb(9,"span"),f.Sc(10),f.mc(11,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.Gb(3),f.Tc(f.nc(4,3,"Change password for")),f.Gb(2),f.Uc(" ",n.user.full_name," "),f.Gb(5),f.Tc(f.nc(11,5,"You override the personally set password!"))}}function q(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Sc(4),f.Ub(5,"br"),f.Zb(6,"span"),f.Sc(7),f.mc(8,"translate"),f.Yb(),f.Sc(9),f.Yb()),2&e){var n=f.lc(2);f.Gb(2),f.Tc(f.nc(3,4,"Initial password")),f.Gb(2),f.Uc(": ",n.user.default_password,""),f.Gb(3),f.Tc(f.nc(8,6,"Username")),f.Gb(2),f.Uc(": ",n.user.username," ")}}function X(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Qc(1,H,12,7,"div",3),f.Ub(2,"br"),f.Zb(3,"form",4),f.hc("keydown",(function(e){return f.Ic(n),f.lc().onKeyDown(e)})),f.Zb(4,"mat-form-field"),f.Ub(5,"input",5),f.mc(6,"translate"),f.Zb(7,"mat-icon",6),f.hc("click",(function(){f.Ic(n);var e=f.lc();return e.hidePassword=!e.hidePassword})),f.mc(8,"translate"),f.mc(9,"translate"),f.Sc(10),f.Yb(),f.Zb(11,"mat-icon",7),f.hc("click",(function(){return f.Ic(n),f.lc().generatePassword()})),f.mc(12,"translate"),f.Sc(13," settings "),f.Yb(),f.Yb(),f.Yb(),f.Ub(14,"br"),f.Qc(15,q,10,8,"div",3),f.Yb()}if(2&e){var a=f.lc();f.Gb(1),f.tc("ngIf",a.user),f.Gb(2),f.tc("formGroup",a.adminPasswordForm),f.Gb(2),f.uc("placeholder",f.nc(6,8,"New password")),f.tc("type",a.hidePassword?"password":"text"),f.Gb(2),f.uc("matTooltip",a.hidePassword?f.nc(8,10,"Show password"):f.nc(9,12,"Hide password")),f.Gb(3),f.Uc(" ",a.hidePassword?"visibility":"visibility_off"," "),f.Gb(1),f.uc("matTooltip",f.nc(12,14,"Generate password")),f.Gb(4),f.tc("ngIf",a.user)}}function z(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Zb(1,"form",4),f.hc("keydown",(function(e){return f.Ic(n),f.lc().onKeyDown(e)})),f.Zb(2,"mat-form-field"),f.Ub(3,"input",8),f.mc(4,"translate"),f.Zb(5,"mat-icon",9),f.hc("click",(function(){f.Ic(n);var e=f.lc();return e.hideOldPassword=!e.hideOldPassword})),f.Sc(6),f.Yb(),f.Yb(),f.Ub(7,"br"),f.Zb(8,"mat-form-field"),f.Ub(9,"input",10),f.mc(10,"translate"),f.Zb(11,"mat-icon",9),f.hc("click",(function(){f.Ic(n);var e=f.lc();return e.hidePassword=!e.hidePassword})),f.Sc(12),f.Yb(),f.Yb(),f.Ub(13,"br"),f.Zb(14,"mat-form-field"),f.Ub(15,"input",11),f.mc(16,"translate"),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=f.lc();f.Gb(1),f.tc("formGroup",a.userPasswordForm),f.Gb(2),f.uc("placeholder",f.nc(4,9,"Old password")),f.tc("type",a.hideOldPassword?"password":"text"),f.Gb(3),f.Uc(" ",a.hideOldPassword?"visibility":"visibility_off"," "),f.Gb(3),f.uc("placeholder",f.nc(10,11,"New password")),f.tc("type",a.hidePassword?"password":"text"),f.Gb(3),f.Uc(" ",a.hidePassword?"visibility":"visibility_off"," "),f.Gb(3),f.uc("placeholder",f.nc(16,13,"Confirm new password")),f.tc("type",a.hidePassword?"password":"text")}}var K,J=((K=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i,o,s,l){var u;return _classCallCheck(this,n),(u=t.call(this,e,a,r)).translate=a,u.route=c,u.router=i,u.repo=o,u.operator=s,u.formBuilder=l,u.hidePassword=!0,u.hideOldPassword=!0,u}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"setTitle",this).call(this,this.translate.instant("Change password")),this.route.params.subscribe((function(t){t.id&&(e.urlUserId=+t.id,e.repo.getViewModelObservable(e.urlUserId).subscribe((function(){e.updateUser()}))),e.updateUser()})),this.operator.getUserObservable().subscribe((function(){e.updateUser()})),this.adminPasswordForm=this.formBuilder.group({newPassword:["",s.G.required]}),this.userPasswordForm=this.formBuilder.group({newPassword1:["",s.G.required],newPassword2:["",s.G.required],oldPassword:["",s.G.required]})}},{key:"updateUser",value:function(){this.ownPage=!this.urlUserId||this.operator.user.id===this.urlUserId,this.user=this.ownPage?this.operator.viewUser:this.repo.getViewModel(this.urlUserId),this.canManage=this.operator.hasPerms(i.b.usersCanManage)}},{key:"goBack",value:function(){this.router.navigate(this.ownPage?["./"]:["./users/"+this.user.id])}},{key:"save",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.canManage||this.ownPage){e.next=10;break}if(this.adminPasswordForm.valid){e.next=4;break}return e.abrupt("return");case 4:return t=this.adminPasswordForm.value.newPassword,e.next=7,this.repo.resetPassword(this.user,t);case 7:this.router.navigate(["./users/"+this.user.id]),e.next=21;break;case 10:if(!this.ownPage){e.next=21;break}if(this.userPasswordForm.valid){e.next=13;break}return e.abrupt("return");case 13:if(n=this.userPasswordForm.value.oldPassword,(a=this.userPasswordForm.value.newPassword1)===this.userPasswordForm.value.newPassword2){e.next=18;break}this.raiseError(this.translate.instant("Error: The new passwords do not match.")),e.next=21;break;case 18:return e.next=20,this.repo.setNewPassword(n,a);case 20:this.router.navigate(["./"]);case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(0),this.raiseError(e.t0);case 26:case"end":return e.stop()}}),e,this,[[0,23]])})))}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&e.shiftKey&&this.save()}},{key:"generatePassword",value:function(){var e=this.repo.getRandomPassword();this.adminPasswordForm.patchValue({newPassword:e}),this.userPasswordForm.patchValue({newPassword1:e,newPassword2:e}),this.hidePassword=!1}}]),n}(d.a)).\u0275fac=function(e){return new(e||K)(f.Tb(p.d),f.Tb(h.k),f.Tb(g.a),f.Tb(c.a),f.Tb(c.f),f.Tb(j.a),f.Tb(i.a),f.Tb(s.f))},K.\u0275cmp=f.Nb({type:K,selectors:[["os-password"]],features:[f.Db],decls:10,vars:9,consts:[[3,"hasMainButton","nav","editMode","mainEvent","saveEvent"],[1,"title-slot"],[1,"os-card"],[4,"ngIf"],[3,"formGroup","keydown"],["matInput","","formControlName","newPassword","required","",3,"type","placeholder"],["matSuffix","","mat-icon-button","",1,"pointer",3,"matTooltip","click"],["matSuffix","","mat-icon-button","",1,"pointer","spacer-left-10",3,"matTooltip","click"],["matInput","","formControlName","oldPassword","required","",3,"type","placeholder"],["mat-button","","matSuffix","","mat-icon-button","",3,"click"],["matInput","","formControlName","newPassword1","required","",3,"type","placeholder"],["matInput","","formControlName","newPassword2","required","",3,"type","placeholder"]],template:function(e,t){1&e&&(f.Zb(0,"os-head-bar",0),f.hc("mainEvent",(function(){return t.goBack()}))("saveEvent",(function(){return t.save()})),f.Sc(1,"a "),f.Zb(2,"div",1),f.Zb(3,"h2"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Zb(6,"mat-card",2),f.Qc(7,$,4,3,"div",3),f.Qc(8,X,16,16,"div",3),f.Qc(9,z,17,15,"div",3),f.Yb()),2&e&&(f.tc("hasMainButton",!0)("nav",!1)("editMode",!0),f.Gb(4),f.Tc(f.nc(5,7,"Change password")),f.Gb(3),f.tc("ngIf",!t.canManage&&!t.ownPage),f.Gb(1),f.tc("ngIf",t.canManage&&!t.ownPage),f.Gb(1),f.tc("ngIf",t.ownPage))},directives:[w.a,S.a,a.t,s.I,s.t,s.k,y.c,Y.b,s.c,s.s,s.i,s.D,B.a,y.j,W.c],pipes:[h.j],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}.pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),K),ee=n("+KbT");function te(e,t){if(1&e&&(f.Zb(0,"mat-card",8),f.Zb(1,"span"),f.Sc(2),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Sc(6,": "),f.Zb(7,"span"),f.Sc(8),f.mc(9,"translate"),f.mc(10,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.tc("ngClass",n.lastChangedUser.is_present?"success":"warning"),f.Gb(2),f.Uc("",n.lastChangedUser.full_name,"\xa0"),f.Gb(2),f.Tc(f.nc(5,4,"is now")),f.Gb(4),f.Uc("\xa0",n.lastChangedUser.is_present?f.nc(9,6,"present"):f.nc(10,8,"absent"),"")}}function ne(e,t){if(1&e&&(f.Zb(0,"mat-card",9),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=f.lc(2);f.Gb(1),f.Tc(f.nc(2,1,n.errorMsg))}}function ae(e,t){if(1&e){var n=f.ac();f.Zb(0,"mat-card"),f.Zb(1,"p"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"mat-form-field",3),f.Zb(5,"input",4),f.hc("keyup",(function(e){return f.Ic(n),f.lc().onKeyUp(e)})),f.mc(6,"translate"),f.Yb(),f.Yb(),f.Zb(7,"button",5),f.hc("click",(function(){return f.Ic(n),f.lc().changePresence()})),f.Sc(8),f.mc(9,"translate"),f.Yb(),f.Qc(10,te,11,10,"mat-card",6),f.Qc(11,ne,3,3,"mat-card",7),f.Yb()}if(2&e){var a=f.lc();f.Gb(2),f.Tc(f.nc(3,7,"Check in or check out participants based on their participant numbers:")),f.Gb(2),f.tc("formGroup",a.userForm),f.Gb(1),f.uc("placeholder",f.nc(6,9,"Enter participant number")),f.tc("formControl",a.userForm.get("number")),f.Gb(3),f.Tc(f.nc(9,11,"Change presence")),f.Gb(2),f.tc("ngIf",a.lastChangedUser),f.Gb(1),f.tc("ngIf",a.errorMsg)}}var re,ce,ie,oe=((re=function(){function e(t,n,a,r,c){var i=this;_classCallCheck(this,e),this.userRepo=t,this.formBuilder=n,this.operator=a,this.translate=r,this._userSubscription=null,c.get("users_enable_presence_view").subscribe((function(e){return i._enabledInConfig=e}))}return _createClass(e,[{key:"ngOnInit",value:function(){this.userForm=this.formBuilder.group({number:""})}},{key:"changePresence",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.userForm.get("number").value,n=this.userRepo.getUsersByNumber(t),this.userForm.reset(),1!==n.length){e.next=8;break}return e.next=5,this.userRepo.update({is_present:!n[0].is_present},n[0]);case 5:this.subscribeUser(n[0].id),e.next=9;break;case 8:n.length?n.length>1&&(this.clearSubscription(),this.errorMsg=this.translate.instant("Participant number is not unique")):(this.clearSubscription(),this.errorMsg=this.translate.instant("Participant cannot be found"));case 9:case"end":return e.stop()}}),e,this)})))}},{key:"subscribeUser",value:function(e){var t=this;this.clearSubscription(),this.errorMsg=null,this._userSubscription=this.userRepo.getViewModelObservable(e).subscribe((function(e){return t.lastChangedUser=e}))}},{key:"clearSubscription",value:function(){this._userSubscription&&this._userSubscription.unsubscribe(),this.lastChangedUser=null}},{key:"onKeyUp",value:function(e){"Enter"===e.key&&this.changePresence()}},{key:"permission",get:function(){return this.operator.hasPerms(i.b.usersCanManage)&&this._enabledInConfig}}]),e}()).\u0275fac=function(e){return new(e||re)(f.Tb(j.a),f.Tb(s.f),f.Tb(i.a),f.Tb(h.k),f.Tb(ee.a))},re.\u0275cmp=f.Nb({type:re,selectors:[["os-presence-detail"]],decls:6,vars:6,consts:[[3,"hasMainButton","nav"],[1,"title-slot"],[4,"ngIf"],[3,"formGroup"],["osAutofocus","","matInput","",3,"formControl","placeholder","keyup"],["mat-button","",3,"click"],[3,"ngClass",4,"ngIf"],["class","error",4,"ngIf"],[3,"ngClass"],[1,"error"]],template:function(e,t){1&e&&(f.Zb(0,"os-head-bar",0),f.Zb(1,"div",1),f.Zb(2,"h2"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Qc(5,ae,12,13,"mat-card",2)),2&e&&(f.tc("hasMainButton",!1)("nav",!1),f.Gb(3),f.Tc(f.nc(4,4,"Presence")),f.Gb(2),f.tc("ngIf",t.permission))},directives:[w.a,a.t,S.a,y.c,s.t,s.k,Y.b,s.c,Z.a,s.s,s.h,C.b,a.q],pipes:[h.j],encapsulation:2}),re),se=n("2Vo4"),le=n("rUOn"),ue=n("XXEH"),be=n("0bMg"),me=n("lq69"),de=n("a9GI"),fe=((ie=function(){function e(t,n){_classCallCheck(this,e),this.translate=t,this.configService=n}return _createClass(e,[{key:"userAccessToDocDef",value:function(e){var t=[{text:e.short_name,style:"userDataTitle"}];return e.structure_level&&t.push({text:e.structure_level,style:"userDataHeading"}),[t,this.createAccessDataContent(e),this.createWelcomeText()]}},{key:"createUserListDocDef",value:function(e){return[{text:this.translate.instant("List of participants"),style:"title"},this.createUserList(e)]}},{key:"createAccessDataContent",value:function(e){return{columns:[this.createWifiAccessContent(),this.createUserAccessContent(e)],margin:[0,20]}}},{key:"createWifiAccessContent",value:function(){var e=[{text:this.translate.instant("WLAN access data"),style:"userDataHeading"},{text:this.translate.instant("WLAN name (SSID)")+":",style:"userDataTopic"},{text:this.configService.instant("users_pdf_wlan_ssid")||"-",style:"userDataValue"},{text:this.translate.instant("WLAN password")+":",style:"userDataTopic"},{text:this.configService.instant("users_pdf_wlan_password")||"-",style:"userDataValue"},{text:this.translate.instant("WLAN encryption")+":",style:"userDataTopic"},{text:this.configService.instant("users_pdf_wlan_encryption")||"-",style:"userDataValue"},{text:"\n"}];if(this.configService.instant("users_pdf_wlan_ssid")&&this.configService.instant("users_pdf_wlan_encryption")){var t="WIFI:S:"+this.configService.instant("users_pdf_wlan_ssid")+";T:"+this.configService.instant("users_pdf_wlan_encryption")+";P:"+this.configService.instant("users_pdf_wlan_password")+";;";e.push({qr:t,fit:120,margin:[0,0,0,8]},{text:this.translate.instant("Scan this QR code to connect to WLAN."),style:"small"})}return e}},{key:"createUserAccessContent",value:function(e){var t=[{text:this.translate.instant("OpenSlides access data"),style:"userDataHeading"},{text:this.translate.instant("Username")+":",style:"userDataTopic"},{text:e.username,style:"userDataValue"},{text:this.translate.instant("Initial password")+":",style:"userDataTopic"},{text:e.default_password,style:"userDataValue"},{text:"URL:",style:"userDataTopic"},{text:this.configService.instant("users_pdf_url")||"-",link:this.configService.instant("users_pdf_url"),style:"userDataValue"},{text:"\n"}];return this.configService.instant("users_pdf_url")&&t.push({qr:this.configService.instant("users_pdf_url"),fit:120,margin:[0,0,0,8]},{text:this.translate.instant("Scan this QR code to open URL."),style:"small"}),t}},{key:"createWelcomeText",value:function(){var e=this.configService.instant("users_pdf_welcometitle"),t=this.configService.instant("users_pdf_welcometext");return[{text:this.translate.instant(e),style:"userDataHeading"},{text:this.translate.instant(t),style:"userDataTopic"}]}},{key:"createUserList",value:function(e){return{table:{widths:["auto","*","auto"],headerRows:1,body:[[{text:"#",style:"tableHeader"},{text:this.translate.instant("Name"),style:"tableHeader"},{text:this.translate.instant("Groups"),style:"tableHeader"}]].concat(this.getListUsers(e))},layout:"switchColorTableLayout"}}},{key:"getListUsers",value:function(e){var t=this,n=[],a=1;return e.forEach((function(e){var r=e.groups.map((function(e){return t.translate.instant(e.name)}));n.push([{text:""+a},{text:e.full_name},{text:r.join(", ")}]),a+=1})),n}}]),e}()).\u0275fac=function(e){return new(e||ie)(f.dc(h.k),f.dc(ee.a))},ie.\u0275prov=f.Pb({token:ie,factory:ie.\u0275fac,providedIn:"root"}),ie),pe=((ce=function(){function e(t,n,a){_classCallCheck(this,e),this.translate=t,this.userPdfService=n,this.pdfDocumentService=a}return _createClass(e,[{key:"exportSingleUserAccessPDF",value:function(e){var t=this.userPdfService.userAccessToDocDef(e),n="".concat(this.translate.instant("Access-data")," ").concat(e.short_name);this.pdfDocumentService.download(t,n,{title:n})}},{key:"exportMultipleUserAccessPDF",value:function(e){var t=this,n=[];e.forEach((function(e){n.push(t.userPdfService.userAccessToDocDef(e)),n.push({text:"",pageBreak:"after"})}));var a=this.translate.instant("Access-data");this.pdfDocumentService.download(n,a,{title:a})}},{key:"exportUserList",value:function(e){var t=this.translate.instant("List of participants"),n={title:t};this.pdfDocumentService.download(this.userPdfService.createUserListDocDef(e),t,n)}}]),e}()).\u0275fac=function(e){return new(e||ce)(f.dc(h.k),f.dc(fe),f.dc(de.b))},ce.\u0275prov=f.Pb({token:ce,factory:ce.\u0275fac,providedIn:"root"}),ce),he=n("STbY"),ge=n("f0Cb"),ve=n("oqD5"),we=n("d3UM"),Se=n("FKr1"),_e=n("fB2i"),Ge=n("3Xi6"),ye=n("7jBc");function Ye(e,t){1&e&&(f.Zb(0,"span"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"New participant")))}function Ze(e,t){if(1&e&&(f.Zb(0,"span"),f.Sc(1),f.Yb()),2&e){var n=f.lc();f.Gb(1),f.Tc(n.user.full_name)}}function Ce(e,t){if(1&e&&(f.Zb(0,"button",11),f.Zb(1,"mat-icon"),f.Sc(2,"more_vert"),f.Yb(),f.Yb()),2&e){f.lc();var n=f.Ec(8);f.tc("matMenuTriggerFor",n)}}function ke(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",12),f.hc("click",(function(){return f.Ic(n),f.lc().changePassword()})),f.Zb(1,"mat-icon"),f.Sc(2,"security"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Change password")))}function Pe(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",12),f.hc("click",(function(){return f.Ic(n),f.lc().sendInvitationEmail()})),f.Zb(1,"mat-icon"),f.Sc(2,"mail"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Send invitation email")))}function Ie(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",12),f.hc("click",(function(){return f.Ic(n),f.lc().onDownloadPdf()})),f.Zb(1,"mat-icon"),f.Sc(2,"picture_as_pdf"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"PDF")))}function Te(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Ub(1,"mat-divider"),f.Zb(2,"button",13),f.hc("click",(function(){return f.Ic(n),f.lc().deleteUserButton()})),f.Zb(3,"mat-icon"),f.Sc(4,"delete"),f.Yb(),f.Zb(5,"span"),f.Sc(6),f.mc(7,"translate"),f.Yb(),f.Yb(),f.Yb()}2&e&&(f.Gb(6),f.Tc(f.nc(7,1,"Delete")))}function xe(e,t){1&e&&f.Vb(0)}function Me(e,t){if(1&e&&(f.Zb(0,"mat-card",14),f.Qc(1,xe,1,0,"ng-container",15),f.Yb()),2&e){var n=f.lc(),a=f.Ec(16),r=f.Ec(18);f.tc("ngClass",n.editUser?"os-form-card":"os-card"),f.Gb(1),f.tc("ngIf",n.editUser)("ngIfThen",a)("ngIfElse",r)}}function Oe(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-form-field",25),f.Ub(2,"input",26),f.mc(3,"translate"),f.Yb(),f.Zb(4,"mat-form-field",27),f.Ub(5,"input",28),f.mc(6,"translate"),f.Yb(),f.Zb(7,"mat-form-field",29),f.Ub(8,"input",30),f.mc(9,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.uc("placeholder",f.nc(3,3,"Title")),f.Gb(3),f.uc("placeholder",f.nc(6,5,"Given name")),f.Gb(3),f.uc("placeholder",f.nc(9,7,"Surname")))}function De(e,t){1&e&&(f.Zb(0,"mat-error"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Uc(" ",f.nc(2,1,"Please enter a valid email address")," "))}function Ee(e,t){if(1&e&&(f.Zb(0,"mat-option",37),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n),f.Gb(1),f.Tc(f.nc(2,2,n))}}function Ue(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-form-field",31),f.Ub(2,"input",32),f.mc(3,"translate"),f.Qc(4,De,3,3,"mat-error",2),f.Yb(),f.Zb(5,"mat-form-field",33),f.Zb(6,"mat-select",34),f.mc(7,"translate"),f.Zb(8,"mat-option",35),f.Sc(9,"-"),f.Yb(),f.Qc(10,Ee,3,4,"mat-option",36),f.Yb(),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.Gb(2),f.uc("placeholder",f.nc(3,4,"Email")),f.Gb(2),f.tc("ngIf",n.personalInfoForm.get("email").hasError("email")),f.Gb(2),f.uc("placeholder",f.nc(7,6,"Gender")),f.Gb(4),f.tc("ngForOf",n.genderList)}}function Qe(e,t){1&e&&(f.Zb(0,"mat-form-field",38),f.Ub(1,"input",39),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.uc("placeholder",f.nc(2,1,"Vote weight")))}function Re(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Zb(1,"mat-form-field"),f.Ub(2,"input",40),f.mc(3,"translate"),f.Zb(4,"mat-hint",41),f.Sc(5,"Generate"),f.Yb(),f.Zb(6,"button",42),f.hc("click",(function(){return f.Ic(n),f.lc(2).generatePassword()})),f.Zb(7,"mat-icon"),f.Sc(8,"sync_problem"),f.Yb(),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=f.lc(2);f.Gb(2),f.uc("placeholder",f.nc(3,2,"Initial password")),f.Gb(4),f.tc("disabled",!a.newUser)}}function Fe(e,t){if(1&e&&(f.Zb(0,"div",43),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Ub(4,"editor",44),f.Yb()),2&e){var n=f.lc(2);f.Gb(2),f.Tc(f.nc(3,2,"About me")),f.Gb(2),f.tc("init",n.tinyMceSettings)}}function Ae(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-form-field"),f.Ub(2,"input",45),f.mc(3,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.uc("placeholder",f.nc(3,1,"Username")))}function Ne(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-form-field"),f.Ub(2,"input",46),f.mc(3,"translate"),f.Zb(4,"mat-hint"),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.uc("placeholder",f.nc(3,2,"Comment")),f.Gb(3),f.Tc(f.nc(6,4,"Only for internal notes.")))}function Ve(e,t){1&e&&(f.Zb(0,"mat-checkbox",51),f.mc(1,"translate"),f.Zb(2,"span"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb()),2&e&&(f.uc("matTooltip",f.nc(1,2,"Designates whether this user should be treated as active. Unselect this instead of deleting the account.")),f.Gb(3),f.Tc(f.nc(4,4,"Is active")))}function Le(e,t){1&e&&(f.Zb(0,"div",47),f.Zb(1,"mat-checkbox",48),f.mc(2,"translate"),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb(),f.Qc(6,Ve,5,6,"mat-checkbox",49),f.Zb(7,"mat-checkbox",50),f.mc(8,"translate"),f.Zb(9,"span"),f.Sc(10),f.mc(11,"translate"),f.Yb(),f.Yb(),f.Yb()),2&e&&(f.Gb(1),f.uc("matTooltip",f.nc(2,5,"Designates whether this user is in the room.")),f.Gb(3),f.Tc(f.nc(5,7,"Is present")),f.Gb(2),f.tc("osPerms","users.can_see_extra_data"),f.Gb(1),f.uc("matTooltip",f.nc(8,9,"Designates whether this user should be treated as a committee.")),f.Gb(3),f.Tc(f.nc(11,11,"Is a committee")))}var je=function(e,t){return{form37:e,form70:t}},Be=function(e,t,n){return{distance:e,form37:t,form25:n}};function We(e,t){if(1&e){var n=f.ac();f.Zb(0,"form",16),f.hc("keydown",(function(e){return f.Ic(n),f.lc().onKeyDown(e)})),f.Qc(1,Oe,10,9,"div",2),f.Qc(2,Ue,11,8,"div",2),f.Zb(3,"div"),f.Zb(4,"mat-form-field",17),f.Ub(5,"input",18),f.mc(6,"translate"),f.Yb(),f.Zb(7,"mat-form-field",19),f.Ub(8,"input",20),f.mc(9,"translate"),f.Yb(),f.Qc(10,Qe,3,3,"mat-form-field",21),f.Yb(),f.Zb(11,"div"),f.Zb(12,"mat-form-field"),f.Ub(13,"os-search-value-selector",22),f.mc(14,"translate"),f.Yb(),f.Yb(),f.Qc(15,Re,9,4,"div",2),f.Qc(16,Fe,5,4,"div",23),f.Qc(17,Ae,4,3,"div",2),f.Qc(18,Ne,7,6,"div",2),f.Qc(19,Le,12,13,"div",24),f.Yb()}if(2&e){var a=f.lc();f.tc("formGroup",a.personalInfoForm),f.Gb(1),f.tc("ngIf",a.isAllowed("seeName")),f.Gb(1),f.tc("ngIf",a.isAllowed("seePersonal")),f.Gb(2),f.tc("ngClass",f.Ac(22,je,a.showVoteWeight,!a.showVoteWeight)),f.Gb(1),f.uc("placeholder",f.nc(6,16,"Structure level")),f.Gb(2),f.tc("ngClass",f.Bc(25,Be,a.showVoteWeight,a.showVoteWeight,!a.showVoteWeight)),f.Gb(1),f.uc("placeholder",f.nc(9,18,"Participant number")),f.Gb(2),f.tc("ngIf",a.showVoteWeight),f.Gb(3),f.uc("placeholder",f.nc(14,20,"Groups")),f.tc("multiple",!0)("inputListValues",a.groups),f.Gb(2),f.tc("ngIf",a.isAllowed("manage")),f.Gb(1),f.tc("ngIf",a.isAllowed("seePersonal")),f.Gb(1),f.tc("ngIf",a.isAllowed("seePersonal")),f.Gb(1),f.tc("ngIf",a.isAllowed("seeExtra")),f.Gb(1),f.tc("ngIf",a.isAllowed("seeExtra"))}}function $e(e,t){1&e&&(f.Zb(0,"mat-icon",54),f.mc(1,"translate"),f.Sc(2,"check_box"),f.Yb()),2&e&&f.uc("matTooltip",f.nc(1,1,"Is present"))}function He(e,t){1&e&&(f.Zb(0,"mat-icon",54),f.mc(1,"translate"),f.Sc(2,"account_balance"),f.Yb()),2&e&&f.uc("matTooltip",f.nc(1,1,"Is committee"))}function qe(e,t){1&e&&(f.Zb(0,"mat-icon",54),f.mc(1,"translate"),f.Sc(2,"block"),f.Yb()),2&e&&f.uc("matTooltip",f.nc(1,1,"Inactive"))}function Xe(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span",52),f.Zb(5,"span"),f.Sc(6),f.Yb(),f.Qc(7,$e,3,3,"mat-icon",53),f.Qc(8,He,3,3,"mat-icon",53),f.Qc(9,qe,3,3,"mat-icon",53),f.Yb(),f.Yb()),2&e){var n=f.lc(3);f.Gb(2),f.Tc(f.nc(3,5,"Name")),f.Gb(4),f.Tc(n.user.short_name),f.Gb(1),f.tc("ngIf",n.user.is_present&&n.isAllowed("seeName")),f.Gb(1),f.tc("ngIf",n.user.is_committee&&n.isAllowed("seeName")),f.Gb(1),f.tc("ngIf",!n.user.is_active&&n.isAllowed("seeExtra"))}}function ze(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"Email")),f.Gb(3),f.Tc(n.user.email)}}function Ke(e,t){if(1&e&&(f.Zb(0,"div"),f.Qc(1,ze,6,4,"div",2),f.Yb()),2&e){var n=f.lc(3);f.Gb(1),f.tc("ngIf",n.user.email)}}function Je(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(3);f.Gb(2),f.Tc(f.nc(3,2,"Gender")),f.Gb(3),f.Tc(f.nc(6,4,n.user.gender))}}function et(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(3);f.Gb(2),f.Tc(f.nc(3,2,"Structure level")),f.Gb(3),f.Tc(n.user.structure_level)}}function tt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(3);f.Gb(2),f.Tc(f.nc(3,2,"Participant number")),f.Gb(3),f.Tc(n.user.number)}}function nt(e,t){1&e&&(f.Zb(0,"span"),f.Sc(1,",\xa0"),f.Yb())}function at(e,t){if(1&e&&(f.Zb(0,"span"),f.Sc(1),f.mc(2,"translate"),f.Qc(3,nt,2,0,"span",2),f.Yb()),2&e){var n=t.$implicit,a=t.last;f.Gb(1),f.Uc(" ",f.nc(2,2,n.getTitle()),""),f.Gb(2),f.tc("ngIf",!a)}}function rt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Qc(4,at,4,4,"span",55),f.Yb()),2&e){var n=f.lc(3);f.Gb(2),f.Tc(f.nc(3,2,"Groups")),f.Gb(2),f.tc("ngForOf",n.user.groups)}}function ct(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.Tc(f.nc(3,2,"Groups")),f.Gb(3),f.Tc(f.nc(6,4,"Default group")))}function it(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"Vote weight")),f.Gb(3),f.Tc(n.user.vote_weight)}}function ot(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"Username")),f.Gb(3),f.Tc(n.user.username)}}function st(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"Initial password")),f.Gb(3),f.Tc(n.user.default_password)}}function lt(e,t){if(1&e&&(f.Zb(0,"div"),f.Qc(1,it,6,4,"div",2),f.Qc(2,ot,6,4,"div",2),f.Qc(3,st,6,4,"div",2),f.Yb()),2&e){var n=f.lc(3);f.Gb(1),f.tc("ngIf",n.user.vote_weight&&n.showVoteWeight),f.Gb(1),f.tc("ngIf",n.user.username),f.Gb(1),f.tc("ngIf",n.user.default_password)}}function ut(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Ub(4,"div",56),f.mc(5,"trust"),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"About me")),f.Gb(2),f.tc("innerHTML",f.oc(5,4,n.user.about_me,"html"),f.Jc)}}function bt(e,t){if(1&e&&(f.Zb(0,"div"),f.Qc(1,ut,6,7,"div",2),f.Yb()),2&e){var n=f.lc(3);f.Gb(1),f.tc("ngIf",n.user.about_me)}}function mt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"h4"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(2),f.Tc(f.nc(3,2,"Comment")),f.Gb(3),f.Tc(n.user.comment)}}function dt(e,t){if(1&e&&(f.Zb(0,"div"),f.Qc(1,mt,6,4,"div",2),f.Yb()),2&e){var n=f.lc(3);f.Gb(1),f.tc("ngIf",n.user.comment)}}function ft(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"div"),f.Zb(2,"h4"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Zb(5,"span"),f.Sc(6),f.Yb(),f.Yb(),f.Yb()),2&e){var n=f.lc(3);f.Gb(3),f.Tc(f.nc(4,2,"Last email sent")),f.Gb(3),f.Tc(n.getEmailSentTime())}}function pt(e,t){if(1&e&&(f.Xb(0),f.Qc(1,Xe,10,7,"div",2),f.Qc(2,Ke,2,1,"div",2),f.Qc(3,Je,7,6,"div",2),f.Qc(4,et,6,4,"div",2),f.Qc(5,tt,6,4,"div",2),f.Qc(6,rt,5,4,"div",2),f.Qc(7,ct,7,6,"div",2),f.Qc(8,lt,4,3,"div",2),f.Qc(9,bt,2,1,"div",2),f.Qc(10,dt,2,1,"div",2),f.Qc(11,ft,7,4,"div",2),f.Wb()),2&e){var n=f.lc(2);f.Gb(1),f.tc("ngIf",n.isAllowed("seeName")),f.Gb(1),f.tc("ngIf",n.isAllowed("seePersonal")),f.Gb(1),f.tc("ngIf",n.user.gender),f.Gb(1),f.tc("ngIf",n.user.structure_level),f.Gb(1),f.tc("ngIf",n.user.number),f.Gb(1),f.tc("ngIf",n.user.groups&&n.user.groups.length>0),f.Gb(1),f.tc("ngIf",!n.user.groups||0===n.user.groups.length),f.Gb(1),f.tc("ngIf",n.isAllowed("manage")),f.Gb(1),f.tc("ngIf",n.isAllowed("seeName")),f.Gb(1),f.tc("ngIf",n.isAllowed("seeExtra")),f.Gb(1),f.tc("ngIf",n.isAllowed("seePersonal")&&n.user.isLastEmailSend)}}function ht(e,t){if(1&e&&f.Qc(0,pt,12,11,"ng-container",2),2&e){var n=f.lc();f.tc("ngIf",n.user)}}var gt,vt,wt=((gt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i,o,s,l,u,b,m,d,f,p){var h;return _classCallCheck(this,n),(h=t.call(this,e,a,r)).translate=a,h.formBuilder=c,h.route=i,h.router=o,h.repo=s,h.operator=l,h.promptService=u,h.pdfService=b,h.groupRepo=m,h.constantsService=d,h.pollService=f,h.ownPage=!1,h.editUser=!1,h.newUser=!1,h.canManage=!1,h.groups=new se.a([]),h.genderList=ue.c,h.userBackends=null,h.createForm(),h.constantsService.get("UserBackends").subscribe((function(e){return h.userBackends=e})),p.get("users_activate_vote_weight").subscribe((function(e){return h.isVoteWeightActive=e})),h.groupRepo.getViewModelListObservableWithoutDefaultGroup().subscribe(h.groups),h}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;this.route.snapshot.url[0]&&"new"===this.route.snapshot.url[0].path?(_get(_getPrototypeOf(n.prototype),"setTitle",this).call(this,"New participant"),this.newUser=!0,this.setEditMode(!0)):this.route.params.subscribe((function(t){e.subscriptions.push(e.repo.getViewModelObservable(+t.id).subscribe((function(t){if(t&&!e.editUser){var a=t.getTitle();_get(_getPrototypeOf(n.prototype),"setTitle",e).call(e,a),e.user=t}}))),e.subscriptions.push(e.operator.getUserObservable().subscribe((function(){e.ownPage=e.operator.user&&e.operator.user.id===+t.id})))}))}},{key:"createForm",value:function(){this.personalInfoForm=this.formBuilder.group({username:[""],title:[""],first_name:[""],last_name:[""],gender:[""],structure_level:[""],number:[""],vote_weight:[],about_me:[""],groups_id:[""],is_present:[!0],is_committee:[!1],email:["",s.G.email],last_email_send:[""],comment:[""],is_active:[!0],default_password:[""]},{validators:be.a.validation("username","first_name","last_name")})}},{key:"isAllowed",value:function(e){switch(e){case"delete":return this.operator.hasPerms(i.b.usersCanManage)&&!this.ownPage;case"manage":return this.operator.hasPerms(i.b.usersCanManage);case"seeName":return this.operator.hasPerms(i.b.usersCanSeeName,i.b.usersCanManage)||this.ownPage;case"seeOtherUsers":return this.operator.hasPerms(i.b.usersCanSeeName,i.b.usersCanManage);case"seeExtra":return this.operator.hasPerms(i.b.usersCanSeeExtraData,i.b.usersCanManage);case"seePersonal":return this.operator.hasPerms(i.b.usersCanSeeExtraData,i.b.usersCanManage)||this.ownPage;case"changePersonal":return this.operator.hasPerms(i.b.usersCanManage)||this.ownPage;case"changePassword":return this.ownPage&&this.operator.hasPerms(i.b.usersCanChangePassword)||this.operator.hasPerms(i.b.usersCanManage);default:return!1}}},{key:"patchFormValues",value:function(){var e=this,t={};Object.keys(this.personalInfoForm.controls).forEach((function(n){t[n]=e.user[n]})),this.personalInfoForm.patchValue(t)}},{key:"updateFormControlsAccesibility",value:function(){var e=this,t=Object.keys(this.personalInfoForm.controls);t.forEach((function(t){e.personalInfoForm.get(t).enable()})),this.isAllowed("manage")||t.forEach((function(t){["username","email","about_me"].includes(t)||e.personalInfoForm.get(t).disable()})),!this.newUser&&this.user.auth_type&&this.userBackends&&this.userBackends[this.user.auth_type]&&this.userBackends[this.user.auth_type].disallowedUpdateKeys.forEach((function(t){e.personalInfoForm.get(t).disable()}))}},{key:"generatePassword",value:function(){this.personalInfoForm.patchValue({default_password:this.repo.getRandomPassword()})}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&e.shiftKey&&this.saveUser()}},{key:"saveUser",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.personalInfoForm.invalid){e.next=6;break}if(t="",this.personalInfoForm.errors)t="At least one of username, first name or last name has to be set.";else for(n in this.personalInfoForm.controls)this.personalInfoForm.get(n).errors&&(t=n+" is incorrect.");this.raiseError(this.translate.instant(t)),e.next=21;break;case 6:if(e.prev=6,!this.newUser){e.next=13;break}return e.next=10,this.repo.create(this.personalInfoForm.value);case 10:this.router.navigate(["./users/"]),e.next=16;break;case 13:return e.next=15,this.repo.update(this.personalInfoForm.value,this.user);case 15:this.setEditMode(!1);case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),this.raiseError(e.t0);case 21:case"end":return e.stop()}}),e,this,[[6,18]])})))}},{key:"setEditMode",value:function(e){this.editUser=e,this.updateFormControlsAccesibility(),!this.newUser&&e&&this.patchFormValues(),this.newUser&&!e&&this.router.navigate(["./users/"])}},{key:"deleteUserButton",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to delete this participant?"),n=this.user.full_name,e.next=3,this.promptService.open(t,n);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.repo.delete(this.user).then((function(){return a.router.navigate(["./users/"])}),this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"changePassword",value:function(){this.router.navigate(["./users/password/"+this.user.id])}},{key:"onDownloadPdf",value:function(){this.pdfService.exportSingleUserAccessPDF(this.user)}},{key:"sendInvitationEmail",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Sending an invitation email"),n=this.translate.instant("Are you sure you want to send an invitation email to the user?"),e.next=3,this.promptService.open(t,n);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.repo.bulkSendInvitationEmail([this.user]).then(this.raiseError,this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getEmailSentTime",value:function(){return this.user.isLastEmailSend?this.repo.lastSentEmailTimeString(this.user):this.translate.instant("No email sent")}},{key:"showVoteWeight",get:function(){return this.pollService.isElectronicVotingEnabled&&this.isVoteWeightActive}}]),n}(d.a)).\u0275fac=function(e){return new(e||gt)(f.Tb(p.d),f.Tb(h.k),f.Tb(g.a),f.Tb(s.f),f.Tb(c.a),f.Tb(c.f),f.Tb(j.a),f.Tb(i.a),f.Tb(b.a),f.Tb(pe),f.Tb(u.a),f.Tb(le.a),f.Tb(me.a),f.Tb(ee.a))},gt.\u0275cmp=f.Nb({type:gt,selectors:[["os-user-detail"]],features:[f.Db],decls:19,vars:13,consts:[["mainButtonIcon","edit",3,"hasMainButton","nav","goBack","editMode","isSaveButtonEnabled","mainEvent","saveEvent"],[1,"title-slot"],[4,"ngIf"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["userExtraMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],[1,"content-container"],["class","spacer-bottom-60",3,"ngClass",4,"ngIf"],["editView",""],["showView",""],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"red-warning-text",3,"click"],[1,"spacer-bottom-60",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],[3,"formGroup","keydown"],[1,"distance",3,"ngClass"],["type","text","matInput","","formControlName","structure_level",3,"placeholder"],[3,"ngClass"],["type","text","matInput","","formControlName","number",3,"placeholder"],["class","form16 force-min-with",4,"ngIf"],["formControlName","groups_id",3,"multiple","placeholder","inputListValues"],["class","spacer-bottom-20",4,"ngIf"],["class","spacer-top-20",4,"ngIf"],[1,"form16","distance","force-min-with"],["type","text","matInput","","osAutofocus","","formControlName","title",3,"placeholder"],[1,"form37","distance","force-min-with"],["type","text","matInput","","formControlName","first_name",3,"placeholder"],[1,"form37","force-min-with"],["type","text","matInput","","formControlName","last_name",3,"placeholder"],[1,"form70","distance"],["type","email","matInput","","autocomplete","off","name","email","formControlName","email",3,"placeholder"],[1,"form25","force-min-with"],["formControlName","gender",3,"placeholder"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"form16","force-min-with"],["type","number","matInput","","formControlName","vote_weight",3,"placeholder"],["matInput","","autocomplete","off","formControlName","default_password",3,"placeholder"],["align","end"],["type","button","mat-button","","matSuffix","","mat-icon-button","",3,"disabled","click"],[1,"spacer-bottom-20"],["formControlName","about_me",3,"init"],["type","text","matInput","","formControlName","username",3,"placeholder"],["matInput","","formControlName","comment",3,"placeholder"],[1,"spacer-top-20"],["formControlName","is_present",3,"matTooltip"],["formControlName","is_active",3,"matTooltip",4,"osPerms"],["formControlName","is_committee",3,"matTooltip"],["formControlName","is_active",3,"matTooltip"],[1,"state-icons"],[3,"matTooltip",4,"ngIf"],[3,"matTooltip"],[4,"ngFor","ngForOf"],[3,"innerHTML"]],template:function(e,t){1&e&&(f.Zb(0,"os-head-bar",0),f.hc("mainEvent",(function(){return t.setEditMode(!t.editUser)}))("saveEvent",(function(){return t.saveUser()})),f.Zb(1,"div",1),f.Zb(2,"h2"),f.Qc(3,Ye,3,3,"span",2),f.Qc(4,Ze,2,1,"span",2),f.Yb(),f.Yb(),f.Zb(5,"div",3),f.Qc(6,Ce,3,1,"button",4),f.Yb(),f.Zb(7,"mat-menu",null,5),f.Qc(9,ke,6,3,"button",6),f.Qc(10,Pe,6,3,"button",6),f.Qc(11,Ie,6,3,"button",6),f.Qc(12,Te,8,3,"div",2),f.Yb(),f.Yb(),f.Zb(13,"div",7),f.Qc(14,Me,2,4,"mat-card",8),f.Yb(),f.Qc(15,We,20,29,"ng-template",null,9,f.Rc),f.Qc(17,ht,1,1,"ng-template",null,10,f.Rc)),2&e&&(f.tc("hasMainButton",t.isAllowed("changePersonal"))("nav",!1)("goBack",!t.isAllowed("seeOtherUsers"))("editMode",t.editUser)("isSaveButtonEnabled",t.personalInfoForm.valid),f.Gb(3),f.tc("ngIf",t.newUser),f.Gb(1),f.tc("ngIf",!t.newUser&&t.user),f.Gb(2),f.tc("ngIf",t.isAllowed("changePersonal")&&t.isAllowed("changePassword")),f.Gb(3),f.tc("ngIf",t.isAllowed("changePassword")),f.Gb(1),f.tc("ngIf",t.isAllowed("manage")&&t.user&&t.user.email),f.Gb(1),f.tc("ngIf",t.isAllowed("manage")),f.Gb(1),f.tc("ngIf",t.isAllowed("delete")),f.Gb(2),f.tc("ngIf",t.isAllowed("seeName")))},directives:[w.a,a.t,he.f,C.b,he.e,B.a,he.c,ge.a,S.a,a.q,s.I,s.t,s.k,y.c,Y.b,s.c,s.s,s.i,ve.a,Z.a,we.a,Se.n,a.s,y.b,s.y,y.f,y.j,_e.a,G.a,W.c,Ge.a],pipes:[h.j,ye.a],styles:["@media screen and (min-width:600px){.form70[_ngcontent-%COMP%]{width:70%}.form37[_ngcontent-%COMP%]{width:37%}.form25[_ngcontent-%COMP%]{width:25%}.form16[_ngcontent-%COMP%]{width:16%}}.force-min-width[_ngcontent-%COMP%]{min-width:110px}.distance[_ngcontent-%COMP%]{padding-right:5%}mat-checkbox[_ngcontent-%COMP%]{margin-right:10px}.state-icons[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.state-icons[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-left:5px}"]}),gt),St=n("1NkQ"),_t=n("gjbj"),Gt=n("E2rH"),yt=n("T9OK"),Yt=function(e){_inherits(n,e);var t=_createSuper(n);function n(){var e;return _classCallCheck(this,n),(e=t.apply(this,arguments)).csvGroups=[],e}return _createClass(n,[{key:"solveGroups",value:function(e){var t=0,n=[];return this.csvGroups.forEach((function(a){if(a.id)n.push(a.id);else if(e.length){var r=e.find((function(e){return e.name===a.name}));r?(a.id=r.id,n.push(r.id)):t+=1}else t+=1})),this.groups_id=n,t}},{key:"isValid",get:function(){return!!(this.first_name||this.last_name||this.username)}}]),n}(ue.b),Zt=n("P6Fj"),Ct=((vt=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i){var o;return _classCallCheck(this,n),(o=t.call(this,r,c,i)).repo=e,o.groupRepo=a,o.headerMap=["title","first_name","last_name","structure_level","number","groups_id","comment","is_active","is_present","is_committee","default_password","email","username","gender","vote_weight"],o.requiredHeaderLength=3,o.errorList={Group:"Group cannot be resolved",Duplicates:"This user already exists",NoName:"Entry has no valid name",DuplicateImport:"Entry cannot be imported twice. This line will be ommitted",ParsingErrors:"Some csv values could not be read correctly.",FailedImport:"Imported user could not be imported.",vote_weight:"The vote weight has too many decimal places (max.: 6)."},o.expectedHeader=o.headerMap,o}return _createClass(n,[{key:"clearData",value:function(){this.newGroups=[]}},{key:"mapData",value:function(e){for(var t=new Yt,n=Math.min(this.expectedHeader.length,e.length),a=!1,r=0;r<n;r++)switch(this.expectedHeader[r]){case"groups_id":t.csvGroups=this.getGroups(e[r]);break;case"is_active":case"is_committee":case"is_present":try{t[this.expectedHeader[r]]=this.toBoolean(e[r])}catch(i){if(i instanceof TypeError){console.log(i),a=!0;continue}}break;case"number":t.number=e[r];break;case"vote_weight":t[this.expectedHeader[r]]=e[r]?e[r]:1;break;default:t[this.expectedHeader[r]]=e[r]}var c=this.userToEntry(t);return a&&this.setError(c,"ParsingErrors"),c}},{key:"doImport",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,r,c,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.createNewGroups();case 2:this.newGroups=e.sent,t=[],n=1,a=_createForOfIteratorHelper(this.entries);try{for(a.s();!(r=a.n()).done;)"new"===(c=r.value).status&&(c.newEntry.solveGroups(this.newGroups)?(this.setError(c,"Group"),this.updatePreview()):(c.importTrackId=n,n+=1,t.push(c)))}catch(s){a.e(s)}finally{a.f()}i=regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.splice(0,100),e.next=3,o.repo.bulkCreate(n);case 3:a=e.sent,n.forEach((function(e){e&&a.importedTrackIds.includes(e.importTrackId)?e.status="done":o.setError(e,a.errors[e.importTrackId]?a.errors[e.importTrackId]:"FailedImport")})),o.updatePreview();case 5:case"end":return e.stop()}}),e)}));case 8:if(!t.length){e.next=12;break}return e.delegateYield(i(),"t0",10);case 10:e.next=8;break;case 12:case"end":return e.stop()}}),e,this)})))}},{key:"getGroups",value:function(e){var t=this,n=[];if(!e)return[];e.trim();var a,r=_createForOfIteratorHelper(e.split(","));try{var c=function(){var e=a.value.trim(),r=t.groupRepo.getViewModelList().filter((function(t){return t.name===e}));r.length||(r=t.groupRepo.getViewModelList().filter((function(n){return t.translate.instant(n.name)===e}))),r.length?1===r.length&&n.push({name:r[0].name,id:r[0].id}):(t.newGroups.find((function(t){return t.name===e}))||t.newGroups.push({name:e}),n.push({name:e}))};for(r.s();!(a=r.n()).done;)c()}catch(i){r.e(i)}finally{r.f()}return n}},{key:"createNewGroups",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a,r,c=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=_createForOfIteratorHelper(this.newGroups);try{for(r=function(){var e=a.value;t.push(c.groupRepo.create(new yt.a({name:e.name})).then((function(t){return{name:e.name,id:t.id}})))},n.s();!(a=n.n()).done;)r()}catch(i){n.e(i)}finally{n.f()}return e.next=5,Promise.all(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"toBoolean",value:function(e){if(e&&"0"!==e&&"false"!==e){if("1"===e||"true"===e)return!0;throw new TypeError("Value cannot be translated into boolean: "+e)}return!1}},{key:"parseTextArea",value:function(e){var t=this,n=[];this.clearData(),this.clearPreview(),e.split("\n").forEach((function(e){if(e.length){var a=e.includes(",")?"lastCommaFirst":"firstSpaceLast",r=new Yt(t.repo.parseUserString(e,a)),c=t.userToEntry(r);n.push(c)}})),this.setParsedEntries(n)}},{key:"userToEntry",value:function(e){var t=this,n={newEntry:e,hasDuplicates:!1,status:"new",errors:[]};return e.isValid?(n.hasDuplicates=this.repo.getViewModelList().some((function(n){return n.full_name===t.repo.getFullName(e)})),n.hasDuplicates&&this.setError(n,"Duplicates")):this.setError(n,"NoName"),n}}]),n}(Gt.a)).\u0275fac=function(e){return new(e||vt)(f.dc(j.a),f.dc(u.a),f.dc(h.k),f.dc(Zt.a),f.dc(g.a))},vt.\u0275prov=f.Pb({token:vt,factory:vt.\u0275fac,providedIn:"root"}),vt),kt=n("wZkO"),Pt=n("ihCf"),It=n("Dh3D");function Tt(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",21),f.hc("click",(function(){return f.Ic(n),f.lc().doImport()})),f.Zb(1,"span",22),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(2),f.Tc(f.nc(3,1,"Import")))}function xt(e,t){1&e&&(f.Zb(0,"span"),f.Sc(1,", "),f.Yb())}function Mt(e,t){if(1&e&&(f.Zb(0,"span"),f.Sc(1),f.mc(2,"translate"),f.Qc(3,xt,2,0,"span",23),f.Yb()),2&e){var n=t.$implicit,a=t.last;f.Gb(1),f.Uc(" ",f.nc(2,2,n),""),f.Gb(2),f.tc("ngIf",!a)}}function Ot(e,t){if(1&e&&(f.Zb(0,"mat-option",24),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n.value),f.Gb(1),f.Uc(" ",f.nc(2,2,n.label)," ")}}function Dt(e,t){if(1&e&&(f.Zb(0,"mat-option",24),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n.value),f.Gb(1),f.Uc(" ",f.nc(2,2,n.label)," ")}}function Et(e,t){if(1&e&&(f.Zb(0,"mat-option",24),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n.value),f.Gb(1),f.Uc(" ",f.nc(2,2,n.label)," ")}}function Ut(e,t){if(1&e&&(f.Zb(0,"div"),f.Sc(1," \xa0 "),f.Zb(2,"mat-icon",53),f.Sc(3,"playlist_add"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Zb(6,"span"),f.Sc(7),f.mc(8,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.Gb(5),f.Uc("\xa0",n.newCount,"\xa0"),f.Gb(2),f.Tc(f.nc(8,2,"Participant(s) will be imported."))}}function Qt(e,t){if(1&e&&(f.Zb(0,"div",54),f.Sc(1," \xa0 "),f.Zb(2,"mat-icon",53),f.Sc(3,"warning"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Zb(6,"span"),f.Sc(7),f.mc(8,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.Gb(5),f.Uc("\xa0",n.nonImportableCount,"\xa0"),f.Gb(2),f.Tc(f.nc(8,2,"entries will be ommitted."))}}function Rt(e,t){if(1&e&&(f.Zb(0,"div",55),f.Sc(1," \xa0 "),f.Zb(2,"mat-icon",53),f.Sc(3,"done"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.Yb(),f.Zb(6,"span"),f.Sc(7),f.mc(8,"translate"),f.Yb(),f.Yb()),2&e){var n=f.lc(2);f.Gb(5),f.Uc("\xa0",n.doneCount,"\xa0"),f.Gb(2),f.Tc(f.nc(8,2,"Participants have been imported."))}}function Ft(e,t){1&e&&(f.Zb(0,"div"),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.Tc(f.nc(3,1,'After verifiy the preview click on "import" please (see top right).')))}function At(e,t){if(1&e){var n=f.ac();f.Zb(0,"mat-select",56),f.hc("valueChange",(function(e){return f.Ic(n),f.lc(2).shown=e}))("selectionChange",(function(){return f.Ic(n),f.lc(2).setFilter()})),f.Zb(1,"mat-option",57),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"mat-option",58),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Zb(7,"mat-option",59),f.Sc(8),f.mc(9,"translate"),f.Yb(),f.Yb()}if(2&e){var a=f.lc(2);f.tc("value",a.shown),f.Gb(2),f.Tc(f.nc(3,4,"Show all")),f.Gb(3),f.Tc(f.nc(6,6,"Show errors only")),f.Gb(3),f.Tc(f.nc(9,8,"Show correct entries only"))}}function Nt(e,t){1&e&&f.Ub(0,"mat-header-cell",60)}function Vt(e,t){if(1&e&&(f.Zb(0,"mat-icon",63),f.mc(1,"translate"),f.Sc(2," warning "),f.Yb()),2&e){var n=f.lc(4);f.uc("matTooltip",f.nc(1,1,n.getVerboseError("ParsingErrors")))}}function Lt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-icon",61),f.mc(2,"translate"),f.Sc(3),f.Yb(),f.Qc(4,Vt,3,3,"mat-icon",62),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.wc("matTooltip","",n.errors.length," ",f.nc(2,4,"errors"),""),f.Gb(2),f.Uc(" ",a.getActionIcon(n)," "),f.Gb(1),f.tc("ngIf",a.hasError(n,"ParsingErrors"))}}function jt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-icon",64),f.mc(2,"translate"),f.Sc(3),f.Yb(),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.uc("matTooltip",f.nc(2,2,"Participant will be imported")),f.Gb(2),f.Uc(" ",a.getActionIcon(n)," ")}}function Bt(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"mat-icon",64),f.mc(2,"translate"),f.Sc(3),f.Yb(),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.uc("matTooltip",f.nc(2,2,"Participant has been imported")),f.Gb(2),f.Uc(" ",a.getActionIcon(n)," ")}}function Wt(e,t){if(1&e&&(f.Zb(0,"mat-cell",60),f.Qc(1,Lt,5,6,"div",23),f.Qc(2,jt,4,4,"div",23),f.Qc(3,Bt,4,4,"div",23),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("ngIf","error"===n.status),f.Gb(1),f.tc("ngIf","new"===n.status),f.Gb(1),f.tc("ngIf","done"===n.status)}}function $t(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Title")))}function Ht(e,t){if(1&e&&(f.Zb(0,"span"),f.Zb(1,"mat-icon",65),f.mc(2,"translate"),f.Sc(3," warning "),f.Yb(),f.Sc(4," \xa0 "),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.uc("matTooltip",f.nc(2,1,a.nameErrors(n)))}}function qt(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Qc(1,Ht,5,3,"span",23),f.Sc(2),f.Yb()),2&e){var n=t.$implicit,a=f.lc(2);f.Gb(1),f.tc("ngIf",a.nameErrors(n)),f.Gb(1),f.Uc(" ",n.newEntry.title," ")}}function Xt(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Given name")))}function zt(e,t){if(1&e&&(f.Zb(0,"span"),f.Zb(1,"mat-icon",65),f.mc(2,"translate"),f.Sc(3," warning "),f.Yb(),f.Sc(4," \xa0 "),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.uc("matTooltip",f.nc(2,1,a.nameErrors(n)))}}function Kt(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Qc(1,zt,5,3,"span",23),f.Sc(2),f.Yb()),2&e){var n=t.$implicit,a=f.lc(2);f.Gb(1),f.tc("ngIf",a.nameErrors(n)),f.Gb(1),f.Uc(" ",n.newEntry.first_name," ")}}function Jt(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Surname")))}function en(e,t){if(1&e&&(f.Zb(0,"span"),f.Zb(1,"mat-icon",65),f.mc(2,"translate"),f.Sc(3," warning "),f.Yb(),f.Sc(4," \xa0 "),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.uc("matTooltip",f.nc(2,1,a.nameErrors(n)))}}function tn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Qc(1,en,5,3,"span",23),f.Sc(2),f.Yb()),2&e){var n=t.$implicit,a=f.lc(2);f.Gb(1),f.tc("ngIf",a.nameErrors(n)),f.Gb(1),f.Uc(" ",n.newEntry.last_name," ")}}function nn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Structure level")))}function an(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.structure_level," ")}}function rn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Participant number")))}function cn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.number," ")}}function on(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Groups")))}function sn(e,t){if(1&e&&(f.Zb(0,"span"),f.Zb(1,"mat-icon",63),f.mc(2,"translate"),f.Sc(3," warning "),f.Yb(),f.Yb()),2&e){var n=f.lc(4);f.Gb(1),f.uc("matTooltip",f.nc(2,1,n.getVerboseError("Groups")))}}function ln(e,t){1&e&&(f.Zb(0,"mat-icon",67),f.Sc(1,"add"),f.Yb())}function un(e,t){if(1&e&&(f.Zb(0,"span"),f.Sc(1),f.Qc(2,ln,2,0,"mat-icon",66),f.Sc(3," \xa0 "),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.name," "),f.Gb(1),f.tc("ngIf",!n.id)}}function bn(e,t){if(1&e&&(f.Zb(0,"div"),f.Qc(1,sn,4,3,"span",23),f.Qc(2,un,4,2,"span",11),f.Yb()),2&e){var n=f.lc().$implicit,a=f.lc(2);f.Gb(1),f.tc("ngIf",a.hasError(n,"Groups")),f.Gb(1),f.tc("ngForOf",n.newEntry.csvGroups)}}function mn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Qc(1,bn,3,2,"div",23),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("ngIf",n.newEntry.csvGroups.length)}}function dn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Comment")))}function fn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.comment," ")}}function pn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Is active")))}function hn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Ub(1,"mat-checkbox",68),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("checked",n.newEntry.is_active)}}function gn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Is present")))}function vn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Ub(1,"mat-checkbox",68),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("checked",n.newEntry.is_present)}}function wn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Is committee")))}function Sn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Ub(1,"mat-checkbox",68),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.tc("checked",n.newEntry.is_committee)}}function _n(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Initial password")))}function Gn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.default_password," ")}}function yn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Email")))}function Yn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.email," ")}}function Zn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Username")))}function Cn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.username," ")}}function kn(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Gender")))}function Pn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.gender," ")}}function In(e,t){1&e&&(f.Zb(0,"mat-header-cell"),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e&&(f.Gb(1),f.Tc(f.nc(2,1,"Vote weight")))}function Tn(e,t){if(1&e&&(f.Zb(0,"mat-cell"),f.Sc(1),f.Yb()),2&e){var n=t.$implicit;f.Gb(1),f.Uc(" ",n.newEntry.vote_weight," ")}}function xn(e,t){1&e&&f.Ub(0,"mat-header-row")}function Mn(e,t){if(1&e&&f.Ub(0,"mat-row",69),2&e){var n=t.$implicit,a=f.lc(2);f.tc("ngClass",a.getStateClass(n))}}function On(e,t){if(1&e&&(f.Zb(0,"mat-card",4),f.Zb(1,"h3"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Zb(4,"div",25),f.Qc(5,Ut,9,4,"div",23),f.Qc(6,Qt,9,4,"div",26),f.Qc(7,Rt,9,4,"div",27),f.Yb(),f.Qc(8,Ft,4,3,"div",23),f.Qc(9,At,10,10,"mat-select",28),f.Zb(10,"div",29),f.Zb(11,"table",30),f.Xb(12,31),f.Qc(13,Nt,1,0,"mat-header-cell",32),f.Qc(14,Wt,4,3,"mat-cell",33),f.Wb(),f.Xb(15,34),f.Qc(16,$t,3,3,"mat-header-cell",35),f.Qc(17,qt,3,2,"mat-cell",36),f.Wb(),f.Xb(18,37),f.Qc(19,Xt,3,3,"mat-header-cell",35),f.Qc(20,Kt,3,2,"mat-cell",36),f.Wb(),f.Xb(21,38),f.Qc(22,Jt,3,3,"mat-header-cell",35),f.Qc(23,tn,3,2,"mat-cell",36),f.Wb(),f.Xb(24,39),f.Qc(25,nn,3,3,"mat-header-cell",35),f.Qc(26,an,2,1,"mat-cell",36),f.Wb(),f.Xb(27,40),f.Qc(28,rn,3,3,"mat-header-cell",35),f.Qc(29,cn,2,1,"mat-cell",36),f.Wb(),f.Xb(30,41),f.Qc(31,on,3,3,"mat-header-cell",35),f.Qc(32,mn,2,1,"mat-cell",36),f.Wb(),f.Xb(33,42),f.Qc(34,dn,3,3,"mat-header-cell",35),f.Qc(35,fn,2,1,"mat-cell",36),f.Wb(),f.Xb(36,43),f.Qc(37,pn,3,3,"mat-header-cell",35),f.Qc(38,hn,2,1,"mat-cell",36),f.Wb(),f.Xb(39,44),f.Qc(40,gn,3,3,"mat-header-cell",35),f.Qc(41,vn,2,1,"mat-cell",36),f.Wb(),f.Xb(42,45),f.Qc(43,wn,3,3,"mat-header-cell",35),f.Qc(44,Sn,2,1,"mat-cell",36),f.Wb(),f.Xb(45,46),f.Qc(46,_n,3,3,"mat-header-cell",35),f.Qc(47,Gn,2,1,"mat-cell",36),f.Wb(),f.Xb(48,47),f.Qc(49,yn,3,3,"mat-header-cell",35),f.Qc(50,Yn,2,1,"mat-cell",36),f.Wb(),f.Xb(51,48),f.Qc(52,Zn,3,3,"mat-header-cell",35),f.Qc(53,Cn,2,1,"mat-cell",36),f.Wb(),f.Xb(54,49),f.Qc(55,kn,3,3,"mat-header-cell",35),f.Qc(56,Pn,2,1,"mat-cell",36),f.Wb(),f.Xb(57,50),f.Qc(58,In,3,3,"mat-header-cell",35),f.Qc(59,Tn,2,1,"mat-cell",36),f.Wb(),f.Qc(60,xn,1,0,"mat-header-row",51),f.Qc(61,Mn,1,1,"mat-row",52),f.Yb(),f.Yb(),f.Yb()),2&e){var n=f.lc();f.Gb(2),f.Tc(f.nc(3,9,"Preview")),f.Gb(3),f.tc("ngIf",n.newCount),f.Gb(1),f.tc("ngIf",n.nonImportableCount),f.Gb(1),f.tc("ngIf",n.doneCount),f.Gb(1),f.tc("ngIf",n.newCount),f.Gb(1),f.tc("ngIf",n.nonImportableCount),f.Gb(2),f.tc("dataSource",n.dataSource),f.Gb(49),f.tc("matHeaderRowDef",n.getColumnDefinition()),f.Gb(1),f.tc("matRowDefColumns",n.getColumnDefinition())}}var Dn,En,Un,Qn=((Dn=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i,o){var s;return _classCallCheck(this,n),(s=t.call(this,o,e,c,a)).translate=c,s.exporter=i,s.headerRow=["Title","Given name","Surname","Structure level","Participant number","Groups","Comment","Is active","Is present","Is a committee","Initial password","Email","Username","Gender","Vote weight"],s.textAreaForm=r.group({inputtext:[""]}),s}return _createClass(n,[{key:"downloadCsvExample",value:function(){this.exporter.dummyCSVExport(this.headerRow,[["Dr.","Max","Mustermann","Berlin",1234567890,"Delegates, Staff","xyz",1,1,,"initialPassword",null,"mmustermann","m",1],[null,"John","Doe","Washington","75/99/8-2","Committees","This is a comment, without doubt",1,1,null,null,"john.doe@email.com","jdoe","diverse",2],[null,"Julia","Bloggs","London",null,null,null,null,null,null,null,null,"jbloggs","f",1.5],[null,null,"Executive Board",null,null,null,null,null,null,1,null,null,"executive",null,2.5]],this.translate.instant("participants-example")+".csv")}},{key:"nameErrors",value:function(e){for(var t=0,n=["NoName","Duplicates","DuplicateImport"];t<n.length;t++){var a=n[t];if(this.importer.hasError(e,a))return this.importer.verbose(a)}return""}},{key:"parseTextArea",value:function(){this.importer.parseTextArea(this.textAreaForm.get("inputtext").value)}},{key:"onTabChange",value:function(){this.importer.clearPreview()}}]),n}(_t.a)).\u0275fac=function(e){return new(e||Dn)(f.Tb(p.d),f.Tb(g.a),f.Tb(s.f),f.Tb(h.k),f.Tb(St.a),f.Tb(Ct))},Dn.\u0275cmp=f.Nb({type:Dn,selectors:[["os-user-import-list"]],features:[f.Db],decls:79,vars:57,consts:[[3,"nav"],[1,"title-slot"],[1,"menu-slot"],["mat-button","",3,"click",4,"ngIf"],[1,"os-form-card","import-table","spacer-bottom-60"],[3,"selectedTabChange"],[3,"label"],[3,"formGroup"],["matInput","","osAutofocus","","formControlName","inputtext","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","10",3,"placeholder"],["mat-button","","color","accent",3,"click"],[1,"code","red-warning-text"],[4,"ngFor","ngForOf"],[1,"wrapper"],[1,"selection",3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",1,"selection",3,"selectionChange"],["value",'"',1,"selection",3,"selectionChange"],["id","user-import-file-input","type","file","accept","text",1,"hidden-input",3,"change"],["fileInput",""],["mat-button","","color","accent","onclick","document.getElementById('user-import-file-input').click()"],["class","os-form-card import-table spacer-bottom-60",4,"ngIf"],["mat-button","",3,"click"],[1,"upper"],[4,"ngIf"],[3,"value"],[1,"summary"],["class","red-warning-text",4,"ngIf"],["class","green-text",4,"ngIf"],["class","filter-imports",3,"value","valueChange","selectionChange",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","status","sticky",""],["class","first-column",4,"matHeaderCellDef"],["class","first-column",4,"matCellDef"],["matColumnDef","title"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","first_name"],["matColumnDef","last_name"],["matColumnDef","structure_level"],["matColumnDef","number"],["matColumnDef","groups_id"],["matColumnDef","comment"],["matColumnDef","is_active"],["matColumnDef","is_present"],["matColumnDef","is_committee"],["matColumnDef","default_password"],["matColumnDef","email"],["matColumnDef","username"],["matColumnDef","gender"],["matColumnDef","vote_weight"],[4,"matHeaderRowDef"],[3,"ngClass",4,"matRowDef","matRowDefColumns"],["inline",""],[1,"red-warning-text"],[1,"green-text"],[1,"filter-imports",3,"value","valueChange","selectionChange"],["value","all"],["value","error"],["value","noerror"],[1,"first-column"],[1,"red-warning-text",3,"matTooltip"],["color","warn",3,"matTooltip",4,"ngIf"],["color","warn",3,"matTooltip"],[3,"matTooltip"],["color","warn","inline","",3,"matTooltip"],["class","newBadge","color","accent","inline","",4,"ngIf"],["color","accent","inline","",1,"newBadge"],["disabled","",3,"checked"],[3,"ngClass"]],template:function(e,t){1&e&&(f.Zb(0,"os-head-bar",0),f.Zb(1,"div",1),f.Zb(2,"h2"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb(),f.Zb(5,"div",2),f.Qc(6,Tt,4,3,"button",3),f.Yb(),f.Yb(),f.Zb(7,"mat-card",4),f.Zb(8,"mat-tab-group",5),f.hc("selectedTabChange",(function(){return t.onTabChange()})),f.Zb(9,"mat-tab",6),f.mc(10,"translate"),f.Ub(11,"br"),f.Zb(12,"div",7),f.Zb(13,"div"),f.Zb(14,"span"),f.Sc(15),f.mc(16,"translate"),f.Yb(),f.Zb(17,"span"),f.Sc(18),f.mc(19,"translate"),f.Yb(),f.Ub(20,"br"),f.Zb(21,"span"),f.Sc(22),f.mc(23,"translate"),f.Yb(),f.Yb(),f.Zb(24,"mat-form-field"),f.Ub(25,"textarea",8),f.mc(26,"translate"),f.Yb(),f.Yb(),f.Zb(27,"div"),f.Zb(28,"button",9),f.hc("click",(function(){return t.parseTextArea()})),f.Zb(29,"span"),f.Sc(30),f.mc(31,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Yb(),f.Zb(32,"mat-tab",6),f.mc(33,"translate"),f.Ub(34,"br"),f.Zb(35,"span"),f.Sc(36),f.mc(37,"translate"),f.Yb(),f.Ub(38,"br"),f.Zb(39,"div",10),f.Qc(40,Mt,4,4,"span",11),f.Yb(),f.Zb(41,"ul"),f.Zb(42,"li"),f.Sc(43),f.mc(44,"translate"),f.Yb(),f.Zb(45,"li"),f.Sc(46),f.mc(47,"translate"),f.Yb(),f.Yb(),f.Zb(48,"button",9),f.hc("click",(function(){return t.downloadCsvExample()})),f.Sc(49),f.mc(50,"translate"),f.Yb(),f.Zb(51,"div",12),f.Zb(52,"mat-form-field"),f.Zb(53,"mat-label"),f.Sc(54),f.mc(55,"translate"),f.Yb(),f.Zb(56,"mat-select",13),f.hc("selectionChange",(function(e){return t.selectEncoding(e)})),f.Qc(57,Ot,3,4,"mat-option",14),f.Yb(),f.Yb(),f.Zb(58,"mat-form-field"),f.Zb(59,"mat-label"),f.Sc(60),f.mc(61,"translate"),f.Yb(),f.Zb(62,"mat-select",15),f.hc("selectionChange",(function(e){return t.selectColSep(e)})),f.Qc(63,Dt,3,4,"mat-option",14),f.Yb(),f.Yb(),f.Zb(64,"mat-form-field"),f.Zb(65,"mat-label"),f.Sc(66),f.mc(67,"translate"),f.Yb(),f.Zb(68,"mat-select",16),f.hc("selectionChange",(function(e){return t.selectTextSep(e)})),f.Qc(69,Et,3,4,"mat-option",14),f.Yb(),f.Yb(),f.Yb(),f.Zb(70,"div"),f.Zb(71,"div"),f.Zb(72,"input",17,18),f.hc("change",(function(e){return t.onSelectFile(e)})),f.Yb(),f.Zb(74,"button",19),f.Zb(75,"span"),f.Sc(76),f.mc(77,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Yb(),f.Yb(),f.Yb(),f.Yb(),f.Qc(78,On,62,11,"mat-card",20)),2&e&&(f.tc("nav",!1),f.Gb(3),f.Tc(f.nc(4,25,"Import participants")),f.Gb(3),f.tc("ngIf",t.hasFile&&t.newCount),f.Gb(3),f.uc("label",f.nc(10,27,"Text import")),f.Gb(3),f.tc("formGroup",t.textAreaForm),f.Gb(3),f.Tc(f.nc(16,29,"Copy and paste your participant names in this textbox.")),f.Gb(3),f.Tc(f.nc(19,31,"Keep each person in a single line.")),f.Gb(4),f.Tc(f.nc(23,33,'Comma separated names will be read as "Surname, given name(s)".')),f.Gb(3),f.uc("placeholder",f.nc(26,35,"Insert participants here")),f.Gb(5),f.Tc(f.nc(31,37,"Preview")),f.Gb(2),f.uc("label",f.nc(33,39,"CSV import")),f.Gb(4),f.Uc(" ",f.nc(37,41,"Required comma or semicolon separated values with these column header names in the first row:")," "),f.Gb(4),f.tc("ngForOf",t.headerRow),f.Gb(3),f.Uc(" ",f.nc(44,43,"One of given name, surname and username has to be filled in. All other fields are optional and may be empty.")," "),f.Gb(3),f.Uc(" ",f.nc(47,45,"Additional columns after the required ones may be present and will not affect the import.")," "),f.Gb(3),f.Uc(" ",f.nc(50,47,"Download CSV example file")," "),f.Gb(5),f.Tc(f.nc(55,49,"Encoding of the file")),f.Gb(2),f.tc("value",t.encodings[0].value),f.Gb(1),f.tc("ngForOf",t.encodings),f.Gb(3),f.Tc(f.nc(61,51,"Column separator")),f.Gb(3),f.tc("ngForOf",t.columnSeparators),f.Gb(3),f.Tc(f.nc(67,53,"Text separator")),f.Gb(3),f.tc("ngForOf",t.textSeparators),f.Gb(7),f.Tc(f.nc(77,55,"Select file")),f.Gb(2),f.tc("ngIf",t.hasFile))},directives:[w.a,a.t,S.a,kt.c,kt.a,s.t,s.k,y.c,Y.b,s.c,Pt.c,Z.a,s.s,s.i,C.b,a.s,y.g,we.a,Se.n,l.n,It.a,l.c,l.i,l.b,l.k,l.m,B.a,l.h,l.a,W.c,G.a,l.j,l.l,a.q],pipes:[h.j],encapsulation:2}),Dn),Rn=n("4u49"),Fn=n("AqIO"),An=n("Jc+d"),Nn=n("wL0i"),Vn=n("D/ll"),Ln=n("+8Rz"),jn=((En=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c){var i;return _classCallCheck(this,n),(i=t.call(this,e,a)).translate=c,i.storageKey="UserList",i.userGroupFilterOptions={property:"groups_id",label:"Groups",options:[]},i.updateFilterForRepo(r,i.userGroupFilterOptions,i.translate.instant("Default"),(function(e){return 1!==e.id})),i}return _createClass(n,[{key:"getFilterDefinitions",value:function(){return[{property:"is_present",label:"Presence",options:[{condition:!0,label:this.translate.instant("Is present")},{condition:!1,label:this.translate.instant("Is not present")}]},{property:"is_active",label:this.translate.instant("Active"),options:[{condition:!0,label:"Is active"},{condition:!1,label:this.translate.instant("Is not active")}]},{property:"is_committee",label:this.translate.instant("Committee"),options:[{condition:!0,label:"Is a committee"},{condition:!1,label:this.translate.instant("Is not a committee")}]},{property:"isLastEmailSend",label:this.translate.instant("Last email send"),options:[{condition:!0,label:this.translate.instant("Got an email")},{condition:!1,label:this.translate.instant("Didn't get an email")}]},{property:"isVoteWeightOne",label:this.translate.instant("Vote weight"),options:[{condition:!1,label:this.translate.instant("Has changed vote weight")},{condition:!0,label:this.translate.instant("Has unchanged vote weight")}]}].concat(this.userGroupFilterOptions)}}]),n}(Ln.a)).\u0275fac=function(e){return new(e||En)(f.dc(Fn.a),f.dc(Vn.a),f.dc(u.a),f.dc(h.k))},En.\u0275prov=f.Pb({token:En,factory:En.\u0275fac,providedIn:"root"}),En),Bn=n("A6Ob"),Wn=((Un=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r){var c;return _classCallCheck(this,n),(c=t.call(this,e,a,r)).storageKey="UserList",c.userSortOptions=[{property:"first_name",label:"Given name"},{property:"last_name",label:"Surname"},{property:"is_present",label:"Presence"},{property:"is_active",label:"Is active"},{property:"is_committee",label:"Is committee"},{property:"number",label:"Participant number"},{property:"structure_level",label:"Structure level"},{property:"vote_weight",label:"Vote weight"},{property:"comment"}],c}return _createClass(n,[{key:"getSortOptions",value:function(){return this.userSortOptions}},{key:"getDefaultDefinition",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{sortProperty:"first_name",sortAscending:!0});case 1:case"end":return e.stop()}}),e)})))}}]),n}(Bn.a)).\u0275fac=function(e){return new(e||Un)(f.dc(h.k),f.dc(Fn.a),f.dc(Vn.a))},Un.\u0275prov=f.Pb({token:Un,factory:Un.\u0275fac,providedIn:"root"}),Un),$n=n("0Obk"),Hn=n("dRZP"),qn=n("vYAO"),Xn=n("Tp2j"),zn=["userInfoDialog"];function Kn(e,t){if(1&e&&f.Ub(0,"a",20),2&e){var n=f.lc().row;f.tc("routerLink",n.id)}}function Jn(e,t){if(1&e&&(f.Zb(0,"div",21),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=f.lc().row;f.Gb(1),f.Vc(" ",f.nc(2,2,"Vote weight"),": ",n.vote_weight," ")}}function ea(e,t){1&e&&(f.Zb(0,"mat-icon",22),f.mc(1,"translate"),f.Sc(2," account_balance "),f.Yb()),2&e&&f.uc("matTooltip",f.nc(1,1,"Is committee"))}function ta(e,t){1&e&&(f.Zb(0,"mat-icon",22),f.mc(1,"translate"),f.Sc(2," block "),f.Yb()),2&e&&f.uc("matTooltip",f.nc(1,1,"Inactive"))}function na(e,t){if(1&e&&(f.Zb(0,"div",14),f.Qc(1,Kn,1,1,"a",15),f.Zb(2,"div",16),f.Zb(3,"div"),f.Zb(4,"div"),f.Sc(5),f.Yb(),f.Qc(6,Jn,3,4,"div",17),f.Yb(),f.Zb(7,"div",18),f.Qc(8,ea,3,3,"mat-icon",19),f.Qc(9,ta,3,3,"mat-icon",19),f.Yb(),f.Yb(),f.Yb()),2&e){var n=t.row,a=f.lc();f.Gb(1),f.tc("ngIf",!a.isMultiSelect),f.Gb(4),f.Tc(n.short_name),f.Gb(1),f.tc("ngIf",a.showVoteWeight),f.Gb(2),f.tc("ngIf",n.is_committee),f.Gb(1),f.tc("ngIf",!n.is_active&&a.operator.hasPerms("users.see_extra"))}}function aa(e,t){1&e&&(f.Zb(0,"span"),f.Sc(1,","),f.Yb())}function ra(e,t){if(1&e&&(f.Zb(0,"span"),f.Sc(1),f.mc(2,"translate"),f.Qc(3,aa,2,0,"span",12),f.Yb()),2&e){var n=t.$implicit,a=t.last;f.Gb(1),f.Uc(" ",f.nc(2,2,n.getTitle()),""),f.Gb(2),f.tc("ngIf",!a)}}function ca(e,t){if(1&e&&(f.Zb(0,"div"),f.Zb(1,"os-icon-container",26),f.Qc(2,ra,4,4,"span",27),f.Yb(),f.Yb()),2&e){var n=f.lc().row;f.Gb(2),f.tc("ngForOf",n.groups)}}function ia(e,t){if(1&e&&(f.Zb(0,"div",28),f.Zb(1,"os-icon-container",29),f.Sc(2),f.Yb(),f.Yb()),2&e){var n=f.lc().row;f.Gb(2),f.Tc(n.structure_level)}}function oa(e,t){if(1&e&&(f.Zb(0,"div",28),f.Zb(1,"os-icon-container",30),f.Sc(2),f.Yb(),f.Yb()),2&e){var n=f.lc().row;f.Gb(2),f.Tc(n.number)}}function sa(e,t){if(1&e){var n=f.ac();f.Zb(0,"div",23),f.hc("click",(function(e){f.Ic(n);var a=t.row;return f.lc().openEditInfo(a,e)})),f.Zb(1,"div",24),f.Qc(2,ca,3,1,"div",12),f.Qc(3,ia,3,1,"div",25),f.Qc(4,oa,3,1,"div",25),f.Yb(),f.Yb()}if(2&e){var a=t.row,r=f.lc();f.tc("ngClass",r.isMultiSelect?"":"clickable"),f.Gb(2),f.tc("ngIf",a.groups&&a.groups.length),f.Gb(1),f.tc("ngIf",a.structure_level),f.Gb(1),f.tc("ngIf",a.number)}}function la(e,t){if(1&e&&(f.Zb(0,"mat-icon",34),f.mc(1,"translate"),f.Sc(2," mail "),f.Yb()),2&e){var n=f.lc().row,a=f.lc();f.wc("matTooltip","",f.nc(1,2,"Email sent")," (",a.getEmailSentTime(n),")")}}function ua(e,t){if(1&e&&(f.Zb(0,"mat-icon",34),f.Sc(1," comment "),f.Yb()),2&e){var n=f.lc().row;f.uc("matTooltip",n.comment)}}function ba(e,t){1&e&&(f.Zb(0,"os-icon-container",35),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(2),f.Tc(f.nc(3,1,"Is SAML user")))}function ma(e,t){if(1&e&&(f.Zb(0,"div",14),f.Zb(1,"div",31),f.Qc(2,la,3,4,"mat-icon",32),f.Qc(3,ua,2,1,"mat-icon",32),f.Qc(4,ba,4,3,"os-icon-container",33),f.Yb(),f.Yb()),2&e){var n=t.row;f.Gb(2),f.tc("ngIf",n.isLastEmailSend),f.Gb(1),f.tc("ngIf",!!n.comment),f.Gb(1),f.tc("ngIf",n.isSamlUser)}}function da(e,t){if(1&e){var n=f.ac();f.Zb(0,"div",14),f.Zb(1,"mat-checkbox",36),f.hc("change",(function(){f.Ic(n);var e=t.row;return f.lc().setPresent(e)})),f.Zb(2,"span"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=t.row,r=f.lc();f.Gb(1),f.tc("checked",a.is_present)("disabled",r.isPresentToggleDisabled(a)),f.Gb(2),f.Tc(f.nc(4,3,"Present"))}}var fa=function(e){return{user:e}};function pa(e,t){if(1&e){var n=f.ac();f.Zb(0,"div",14),f.Zb(1,"button",37),f.hc("click",(function(e){return f.Ic(n),e.stopPropagation()})),f.Zb(2,"mat-icon"),f.Sc(3,"more_vert"),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=t.row,r=f.lc(),c=f.Ec(25);f.Gb(1),f.tc("disabled",r.isMultiSelect)("matMenuTriggerFor",c)("matMenuTriggerData",f.zc(3,fa,a))}}function ha(e,t){if(1&e){var n=f.ac();f.Ub(0,"os-projector-button",38),f.Zb(1,"button",39),f.hc("click",(function(){f.Ic(n);var e=t.user;return f.lc().setPresent(e)})),f.Zb(2,"mat-icon",40),f.Sc(3),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Yb()}if(2&e){var a=t.user;f.tc("object",a)("menuItem",!0),f.Gb(3),f.Uc(" ",a.is_present?"check_box":"check_box_outline_blank"," "),f.Gb(2),f.Tc(f.nc(6,4,"Present"))}}function ga(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",39),f.hc("click",(function(){return f.Ic(n),f.lc(2).toggleMultiSelect()})),f.Zb(1,"mat-icon"),f.Sc(2,"library_add"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Multiselect")))}function va(e,t){1&e&&(f.Zb(0,"button",45),f.Zb(1,"mat-icon"),f.Sc(2,"people"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Groups")))}function wa(e,t){1&e&&(f.Zb(0,"button",47),f.Zb(1,"mat-icon"),f.Sc(2,"transfer_within_a_station"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Presence")))}function Sa(e,t){1&e&&(f.Zb(0,"div"),f.Qc(1,wa,6,3,"button",46),f.Yb()),2&e&&(f.Gb(1),f.tc("osPerms","users.can_manage"))}function _a(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",39),f.hc("click",(function(){return f.Ic(n),f.lc(2).onDownloadAccessPdf()})),f.Zb(1,"mat-icon"),f.Sc(2,"picture_as_pdf"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Access data (PDF)")))}function Ga(e,t){if(1&e){var n=f.ac();f.Zb(0,"button",39),f.hc("click",(function(){return f.Ic(n),f.lc(2).csvExportUserList()})),f.Zb(1,"mat-icon"),f.Sc(2,"archive"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()}2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Export as CSV")))}function ya(e,t){1&e&&(f.Zb(0,"button",48),f.Zb(1,"mat-icon"),f.Sc(2,"cloud_upload"),f.Yb(),f.Zb(3,"span"),f.Sc(4),f.mc(5,"translate"),f.Yb(),f.Yb()),2&e&&(f.Gb(4),f.Tc(f.nc(5,1,"Import")))}function Ya(e,t){1&e&&(f.Zb(0,"div"),f.Ub(1,"mat-divider"),f.Zb(2,"button",49),f.Zb(3,"mat-icon"),f.Sc(4,"settings"),f.Yb(),f.Zb(5,"span"),f.Sc(6),f.mc(7,"translate"),f.Yb(),f.Yb(),f.Yb()),2&e&&(f.Gb(6),f.Tc(f.nc(7,1,"Settings")))}function Za(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Qc(1,ga,6,3,"button",41),f.Qc(2,va,6,3,"button",42),f.Qc(3,Sa,2,1,"div",12),f.Zb(4,"button",39),f.hc("click",(function(){return f.Ic(n),f.lc().pdfExportUserList()})),f.Zb(5,"mat-icon"),f.Sc(6,"picture_as_pdf"),f.Yb(),f.Zb(7,"span"),f.Sc(8),f.mc(9,"translate"),f.Yb(),f.Yb(),f.Qc(10,_a,6,3,"button",41),f.Qc(11,Ga,6,3,"button",41),f.Qc(12,ya,6,3,"button",43),f.Qc(13,Ya,8,3,"div",44),f.Yb()}if(2&e){var a=f.lc();f.Gb(1),f.tc("osPerms","users.can_manage"),f.Gb(1),f.tc("osPerms","users.can_manage"),f.Gb(1),f.tc("ngIf",a.presenceViewConfigured),f.Gb(5),f.Tc(f.nc(9,8,"List of participants (PDF)")),f.Gb(2),f.tc("osPerms","users.can_manage"),f.Gb(1),f.tc("osPerms","users.can_manage"),f.Gb(1),f.tc("osPerms","users.can_manage"),f.Gb(1),f.tc("osPerms","core.can_manage_config")}}function Ca(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Ub(1,"mat-divider"),f.Zb(2,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).setStateSelected("is_active")})),f.Zb(3,"mat-icon"),f.Sc(4,"block"),f.Yb(),f.Zb(5,"span"),f.Sc(6),f.mc(7,"translate"),f.Yb(),f.Yb(),f.Zb(8,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).setStateSelected("is_present")})),f.Zb(9,"mat-icon"),f.Sc(10,"check_box"),f.Yb(),f.Zb(11,"span"),f.Sc(12),f.mc(13,"translate"),f.Yb(),f.Yb(),f.Zb(14,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).setStateSelected("is_committee")})),f.Zb(15,"mat-icon"),f.Sc(16,"account_balance"),f.Yb(),f.Zb(17,"span"),f.Sc(18),f.mc(19,"translate"),f.Yb(),f.Yb(),f.Ub(20,"mat-divider"),f.Zb(21,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).sendInvitationEmailSelected()})),f.Zb(22,"mat-icon"),f.Sc(23,"mail"),f.Yb(),f.Zb(24,"span"),f.Sc(25),f.mc(26,"translate"),f.Yb(),f.Yb(),f.Zb(27,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).resetPasswordsToDefaultSelected()})),f.Zb(28,"mat-icon"),f.Sc(29,"vpn_key"),f.Yb(),f.Zb(30,"span"),f.Sc(31),f.mc(32,"translate"),f.Yb(),f.Yb(),f.Zb(33,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(3).generateNewPasswordsPasswordsSelected()})),f.Zb(34,"mat-icon"),f.Sc(35,"vpn_key"),f.Yb(),f.Zb(36,"span"),f.Sc(37),f.mc(38,"translate"),f.Yb(),f.Yb(),f.Ub(39,"mat-divider"),f.Zb(40,"button",51),f.hc("click",(function(){return f.Ic(n),f.lc(3).deleteSelected()})),f.Zb(41,"mat-icon"),f.Sc(42,"delete"),f.Yb(),f.Zb(43,"span"),f.Sc(44),f.mc(45,"translate"),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=f.lc(3);f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(7,14,"Enable/disable account ...")),f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(13,16,"Set presence ...")),f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(19,18,"Set committee ...")),f.Gb(3),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(26,20,"Send invitation email")),f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(32,22,"Reset passwords to the default ones")),f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(38,24,"Generate new passwords")),f.Gb(3),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(45,26,"Delete"))}}function ka(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Ub(1,"mat-divider"),f.Zb(2,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc(2).setGroupSelected()})),f.Zb(3,"mat-icon"),f.Sc(4,"people"),f.Yb(),f.Zb(5,"span"),f.Sc(6),f.mc(7,"translate"),f.Yb(),f.Yb(),f.Qc(8,Ca,46,28,"div",44),f.Yb()}if(2&e){var a=f.lc(2);f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(7,3,"Add/remove groups ...")),f.Gb(2),f.tc("osPerms","users.can_manage")}}function Pa(e,t){if(1&e){var n=f.ac();f.Zb(0,"div"),f.Zb(1,"button",39),f.hc("click",(function(){return f.Ic(n),f.lc().selectAll()})),f.Zb(2,"mat-icon"),f.Sc(3,"done_all"),f.Yb(),f.Zb(4,"span"),f.Sc(5),f.mc(6,"translate"),f.Yb(),f.Yb(),f.Zb(7,"button",50),f.hc("click",(function(){return f.Ic(n),f.lc().deselectAll()})),f.Zb(8,"mat-icon"),f.Sc(9,"clear"),f.Yb(),f.Zb(10,"span"),f.Sc(11),f.mc(12,"translate"),f.Yb(),f.Yb(),f.Qc(13,ka,9,5,"div",44),f.Yb()}if(2&e){var a=f.lc();f.Gb(5),f.Tc(f.nc(6,4,"Select all")),f.Gb(2),f.tc("disabled",!a.selectedRows.length),f.Gb(4),f.Tc(f.nc(12,6,"Deselect all")),f.Gb(2),f.tc("osPerms","users.can_manage")}}function Ia(e,t){if(1&e&&(f.Zb(0,"mat-option",61),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n.id),f.Gb(1),f.Uc(" ",f.nc(2,2,n.getTitle())," ")}}function Ta(e,t){if(1&e&&(f.Zb(0,"mat-option",61),f.Sc(1),f.mc(2,"translate"),f.Yb()),2&e){var n=t.$implicit;f.tc("value",n),f.Gb(1),f.Tc(f.nc(2,2,n))}}var xa=function(e,t,n,a){return{groups_id:e,gender:t,number:n,structure_level:a}};function Ma(e,t){if(1&e){var n=f.ac();f.Zb(0,"h1",52),f.Zb(1,"span"),f.Sc(2),f.mc(3,"translate"),f.Yb(),f.Yb(),f.Zb(4,"div",53),f.Zb(5,"mat-form-field"),f.Zb(6,"mat-select",54),f.hc("ngModelChange",(function(e){return f.Ic(n),f.lc().infoDialog.groups_id=e})),f.mc(7,"translate"),f.Qc(8,Ia,3,4,"mat-option",55),f.Yb(),f.Yb(),f.Zb(9,"mat-form-field"),f.Zb(10,"mat-select",56),f.hc("ngModelChange",(function(e){return f.Ic(n),f.lc().infoDialog.gender=e})),f.mc(11,"translate"),f.Zb(12,"mat-option"),f.Sc(13,"-"),f.Yb(),f.Qc(14,Ta,3,4,"mat-option",55),f.Yb(),f.Yb(),f.Zb(15,"mat-form-field"),f.Zb(16,"input",57),f.hc("ngModelChange",(function(e){return f.Ic(n),f.lc().infoDialog.structure_level=e})),f.mc(17,"translate"),f.Yb(),f.Yb(),f.Zb(18,"mat-form-field"),f.Zb(19,"input",57),f.hc("ngModelChange",(function(e){return f.Ic(n),f.lc().infoDialog.number=e})),f.mc(20,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Zb(21,"div",58),f.Zb(22,"button",59),f.Zb(23,"span"),f.Sc(24),f.mc(25,"translate"),f.Yb(),f.Yb(),f.Zb(26,"button",60),f.Zb(27,"span"),f.Sc(28),f.mc(29,"translate"),f.Yb(),f.Yb(),f.Yb()}if(2&e){var a=f.lc();f.Gb(2),f.Vc("",f.nc(3,16,"Edit details for")," ",a.infoDialog.name,""),f.Gb(4),f.uc("placeholder",f.nc(7,18,"Groups")),f.tc("ngModel",a.infoDialog.groups_id),f.Gb(2),f.tc("ngForOf",a.groups),f.Gb(2),f.uc("placeholder",f.nc(11,20,"Gender")),f.tc("ngModel",a.infoDialog.gender),f.Gb(4),f.tc("ngForOf",a.genderList),f.Gb(2),f.uc("placeholder",f.nc(17,22,"Structure level")),f.tc("ngModel",a.infoDialog.structure_level),f.Gb(3),f.uc("placeholder",f.nc(20,24,"Participant number")),f.tc("ngModel",a.infoDialog.number),f.Gb(3),f.tc("mat-dialog-close",f.Cc(30,xa,a.infoDialog.groups_id,a.infoDialog.gender,a.infoDialog.number,a.infoDialog.structure_level)),f.Gb(2),f.Tc(f.nc(25,26,"Save")),f.Gb(2),f.tc("mat-dialog-close",null),f.Gb(2),f.Tc(f.nc(29,28,"Cancel"))}}var Oa,Da,Ea,Ua=function(){return["group","presence"]},Qa=[{path:"",component:(Oa=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c,i,o,s,l,u,b,m,d,f,p,h,g,v,w){var S;return _classCallCheck(this,n),(S=t.call(this,e,a,r,i)).translate=a,S.route=c,S.repo=o,S.groupRepo=s,S.choiceService=l,S.router=u,S.operator=b,S.csvExport=m,S.promptService=d,S.filterService=f,S.sortService=p,S.userPdf=g,S.dialog=v,S.pollService=w,S.genderList=ue.c,S._presenceViewConfigured=!1,S.tableColumnDefinition=[{prop:"short_name",width:"auto"},{prop:"group",width:"15%"},{prop:"infos",width:S.singleButtonWidth},{prop:"presence",width:"100px"}],S.filterProps=["full_name","groups","structure_level","number"],S.selfPresentConfStr="users_allow_self_set_present",S.canMultiSelect=!0,h.get("users_enable_presence_view").subscribe((function(e){return S._presenceViewConfigured=e})),h.get("users_activate_vote_weight").subscribe((function(e){return S.isVoteWeightActive=e})),h.get(S.selfPresentConfStr).subscribe((function(e){return S.allowSelfSetPresent=e})),S}return _createClass(n,[{key:"ngOnInit",value:function(){var e=this;_get(_getPrototypeOf(n.prototype),"setTitle",this).call(this,"Participants"),this.groups=this.groupRepo.getViewModelList().filter((function(e){return 1!==e.id})),this.groupRepo.getViewModelListObservable().subscribe((function(t){return e.groups=t.filter((function(e){return 1!==e.id}))}))}},{key:"onPlusButton",value:function(){this.router.navigate(["./new"],{relativeTo:this.route})}},{key:"isPresentToggleDisabled",value:function(e){return!!this.isMultiSelect||(!this.allowSelfSetPresent||this.operator.viewUser!==e)&&!this.operator.hasPerms(i.b.usersCanManage)}},{key:"openEditInfo",value:function(e,t){var n=this;if(!this.isMultiSelect&&this.operator.hasPerms(i.b.usersCanManage)){t.stopPropagation(),this.infoDialog={name:e.username,groups_id:e.groups_id,gender:e.gender,structure_level:e.structure_level,number:e.number};var a=this.dialog.open(this.userInfoDialog,m.a);a.keydownEvents().subscribe((function(e){"Enter"===e.key&&e.shiftKey&&a.close(n.infoDialog)})),a.afterClosed().subscribe((function(t){t&&n.repo.update(t,e)}))}}},{key:"csvExportUserList",value:function(){this.csvExport.export(this.dataSource.filteredData,[{property:"title"},{property:"first_name",label:"Given name"},{property:"last_name",label:"Surname"},{property:"structure_level",label:"Structure level"},{property:"number",label:"Participant number"},{label:"groups",map:function(e){return e.groups.map((function(e){return e.name})).join(",")}},{property:"comment"},{property:"is_active",label:"Is active"},{property:"is_present",label:"Is present"},{property:"is_committee",label:"Is a committee"},{property:"default_password",label:"Initial password"},{property:"email"},{property:"gender"}],this.translate.instant("Participants")+".csv")}},{key:"onDownloadAccessPdf",value:function(){this.userPdf.exportMultipleUserAccessPDF(this.dataSource.filteredData)}},{key:"pdfExportUserList",value:function(){this.userPdf.exportUserList(this.dataSource.filteredData)}},{key:"deleteSelected",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to delete all selected participants?"),e.next=3,this.promptService.open(t);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.repo.bulkDelete(this.selectedRows).catch(this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"setGroupSelected",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("This will add or remove the following groups for all selected participants:"),n=[Object(Rn.a)("add group(s)"),Object(Rn.a)("remove group(s)")],e.next=4,this.choiceService.open(t,this.groupRepo.getViewModelList(),!0,n);case 4:(a=e.sent)&&this.repo.bulkAlterGroups(this.selectedRows,a.action===n[0]?"add":"remove",a.items).catch(this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"setStateSelected",value:function(e){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,a,r,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="is_active"===t.t0?3:"is_present"===t.t0?5:"is_committee"===t.t0?7:8;break;case 3:return n=[Object(Rn.a)("active"),Object(Rn.a)("inactive")],a="active",t.abrupt("break",8);case 5:return n=[Object(Rn.a)("present"),Object(Rn.a)("absent")],a="present",t.abrupt("break",8);case 7:n=[Object(Rn.a)("committee"),Object(Rn.a)("no committee")],a="committee";case 8:return r=this.translate.instant("Set ".concat(a," status for selected participants:")),t.next=11,this.choiceService.open(r,null,!1,n);case 11:(c=t.sent)&&this.repo.bulkSetState(this.selectedRows,e,c.action===n[0]).catch(this.raiseError);case 13:case"end":return t.stop()}}),t,this)})))}},{key:"sendInvitationEmailSelected",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to send emails to all selected participants?"),n=this.selectedRows.length+" "+this.translate.instant("emails"),e.next=3,this.promptService.open(t,n);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.repo.bulkSendInvitationEmail(this.selectedRows).catch(this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getEmailSentTime",value:function(e){return e.isLastEmailSend?this.repo.lastSentEmailTimeString(e):this.translate.instant("No email sent")}},{key:"resetPasswordsToDefaultSelected",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to reset all passwords to the default ones?"),e.next=3,this.promptService.open(t);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.selectedRows.find((function(e){return e.user.id===n.operator.user.id}))&&this.raiseError(this.translate.instant("Note: Your own password was not changed. Please use the password change dialog instead.")),this.repo.bulkResetPasswordsToDefault(this.selectedRows).catch(this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"generateNewPasswordsPasswordsSelected",value:function(){return Object(o.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,a=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.translate.instant("Are you sure you want to generate new passwords for all selected participants?"),n=this.translate.instant("Note, that the default password will be changed to the new generated one."),e.next=3,this.promptService.open(t,n);case 3:if(e.t0=e.sent,!e.t0){e.next=6;break}this.selectedRows.find((function(e){return e.user.id===a.operator.user.id}))&&this.raiseError(this.translate.instant("Note: Your own password was not changed. Please use the password change dialog instead.")),this.repo.bulkGenerateNewPasswords(this.selectedRows).catch(this.raiseError);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"setPresent",value:function(e){e.user.is_present=!e.user.is_present,this.operator.hasPerms(i.b.usersCanManage)?this.repo.update(e.user,e).catch(this.raiseError):this.allowSelfSetPresent&&this.operator.viewUser===e&&this.operator.setPresence(e.user.is_present).catch(this.raiseError)}},{key:"presenceViewConfigured",get:function(){return this._presenceViewConfigured&&this.operator.hasPerms(i.b.usersCanManage)}},{key:"canAddUser",get:function(){return this.operator.hasPerms(i.b.usersCanManage)}},{key:"showVoteWeight",get:function(){return this.pollService.isElectronicVotingEnabled&&this.isVoteWeightActive}}]),n}(Nn.a),Oa.\u0275fac=function(e){return new(e||Oa)(f.Tb(p.d),f.Tb(h.k),f.Tb(g.a),f.Tb(c.a),f.Tb(Fn.a),f.Tb(j.a),f.Tb(u.a),f.Tb(An.a),f.Tb(c.f),f.Tb(i.a),f.Tb(St.a),f.Tb(b.a),f.Tb(jn),f.Tb(Wn),f.Tb(ee.a),f.Tb(pe),f.Tb(v.b),f.Tb(me.a))},Oa.\u0275cmp=f.Nb({type:Oa,selectors:[["os-user-list"]],viewQuery:function(e,t){var n;1&e&&f.Oc(zn,!0),2&e&&f.Dc(n=f.ic())&&(t.userInfoDialog=n.first)},features:[f.Db],decls:33,vars:27,consts:[[3,"hasMainButton","multiSelectMode","mainEvent"],[1,"title-slot"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"central-info-slot"],["mat-icon-button","",3,"click"],["listStorageKey","user",3,"listObservableProvider","filterService","sortService","columns","filterProps","showListOfSpeakers","multiSelect","hiddenInMobile","selectedRows","selectedRowsChange","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["class","cell-slot fill",3,"ngClass","click",4,"pblNgridCellDef"],["singleItemMenu","matMenu"],["matMenuContent",""],["userMenu","matMenu"],[4,"ngIf"],["userInfoDialog",""],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"nameCell"],["class","user-subtitle",4,"ngIf"],[1,"icon-group"],[3,"matTooltip",4,"ngIf"],[1,"detail-link",3,"routerLink"],[1,"user-subtitle"],[3,"matTooltip"],[1,"cell-slot","fill",3,"ngClass","click"],[1,"groupsCell"],["class","spacer-top-5",4,"ngIf"],["icon","people"],[4,"ngFor","ngForOf"],[1,"spacer-top-5"],["icon","flag"],["icon","perm_identity"],[1,"infoCell"],["inline","",3,"matTooltip",4,"ngIf"],["icon","device_hub",4,"ngIf"],["inline","",3,"matTooltip"],["icon","device_hub"],[1,"checkbox-ripple-padding",3,"checked","disabled","change"],["mat-icon-button","",3,"disabled","matMenuTriggerFor","matMenuTriggerData","click"],[3,"object","menuItem"],["mat-menu-item","",3,"click"],["color","accent"],["mat-menu-item","",3,"click",4,"osPerms"],["mat-menu-item","","routerLink","groups",4,"osPerms"],["mat-menu-item","","routerLink","import",4,"osPerms"],[4,"osPerms"],["mat-menu-item","","routerLink","groups"],["mat-menu-item","","routerLink","presence",4,"osPerms"],["mat-menu-item","","routerLink","presence"],["mat-menu-item","","routerLink","import"],["mat-menu-item","","routerLink","/settings/participants"],["mat-menu-item","",3,"disabled","click"],["mat-menu-item","",1,"red-warning-text",3,"disabled","click"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],["multiple","",3,"placeholder","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"placeholder","ngModel","ngModelChange"],["type","text","matInput","",3,"placeholder","ngModel","ngModelChange"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"mat-dialog-close"],["type","button","mat-button","",3,"mat-dialog-close"],[3,"value"]],template:function(e,t){if(1&e&&(f.Zb(0,"os-head-bar",0),f.hc("mainEvent",(function(){return t.onPlusButton()})),f.Zb(1,"div",1),f.Zb(2,"h2"),f.Sc(3),f.mc(4,"translate"),f.Yb(),f.Yb(),f.Zb(5,"div",2),f.Zb(6,"button",3),f.Zb(7,"mat-icon"),f.Sc(8,"more_vert"),f.Yb(),f.Yb(),f.Yb(),f.Zb(9,"div",4),f.Zb(10,"button",5),f.hc("click",(function(){return t.toggleMultiSelect()})),f.Zb(11,"mat-icon"),f.Sc(12,"arrow_back"),f.Yb(),f.Yb(),f.Zb(13,"span"),f.Sc(14),f.Yb(),f.Zb(15,"span"),f.Sc(16),f.mc(17,"translate"),f.Yb(),f.Yb(),f.Yb(),f.Zb(18,"os-list-view-table",6),f.hc("selectedRowsChange",(function(e){return t.selectedRows=e}))("dataSourceChange",(function(e){return t.onDataSourceChange(e)})),f.Qc(19,na,10,5,"div",7),f.Qc(20,sa,5,4,"div",8),f.Qc(21,ma,5,3,"div",7),f.Qc(22,da,5,5,"div",7),f.Qc(23,pa,4,5,"div",7),f.Yb(),f.Zb(24,"mat-menu",null,9),f.Qc(26,ha,7,6,"ng-template",10),f.Yb(),f.Zb(27,"mat-menu",null,11),f.Qc(29,Za,14,10,"div",12),f.Qc(30,Pa,14,8,"div",12),f.Yb(),f.Qc(31,Ma,30,35,"ng-template",null,13,f.Rc)),2&e){var n=f.Ec(28);f.tc("hasMainButton",t.canAddUser)("multiSelectMode",t.isMultiSelect),f.Gb(3),f.Tc(f.nc(4,22,"Participants")),f.Gb(3),f.tc("matMenuTriggerFor",n),f.Gb(8),f.Uc("",t.selectedRows.length,"\xa0"),f.Gb(2),f.Tc(f.nc(17,24,"selected")),f.Gb(2),f.tc("listObservableProvider",t.repo)("filterService",t.filterService)("sortService",t.sortService)("columns",t.tableColumnDefinition)("filterProps",t.filterProps)("showListOfSpeakers",!1)("multiSelect",t.isMultiSelect)("hiddenInMobile",f.yc(26,Ua))("selectedRows",t.selectedRows),f.Gb(1),f.tc("pblNgridCellDef","short_name"),f.Gb(1),f.tc("pblNgridCellDef","group"),f.Gb(1),f.tc("pblNgridCellDef","infos"),f.Gb(1),f.tc("pblNgridCellDef","presence"),f.Gb(1),f.tc("pblNgridCellDef","menu"),f.Gb(6),f.tc("ngIf",!t.isMultiSelect),f.Gb(1),f.tc("ngIf",t.isMultiSelect)}},directives:[w.a,C.b,he.e,B.a,$n.a,Hn.c,he.f,he.b,a.t,c.i,W.c,a.q,qn.a,a.s,G.a,Xn.a,he.c,Ge.a,c.g,ge.a,v.i,v.f,y.c,we.a,s.s,s.v,Se.n,Y.b,s.c,v.c,v.d],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.groupsCell[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.groupsCell[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80%}.infoCell[_ngcontent-%COMP%]{display:grid}.detail-link[_ngcontent-%COMP%]{z-index:2}.nameCell[_ngcontent-%COMP%]{position:relative;z-index:1;display:-ms-flexbox;display:flex}.nameCell[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:5px}.icon-group[_ngcontent-%COMP%]{margin-left:1em;z-index:3}"]}),Oa),pathMatch:"full",data:{basePerm:i.b.usersCanSeeName}},{path:"password",component:J,data:{basePerm:i.b.usersCanChangePassword}},{path:"password/:id",component:J,data:{basePerm:i.b.usersCanManage}},{path:"new",component:wt,data:{basePerm:i.b.usersCanManage}},{path:"import",component:Qn,data:{basePerm:i.b.usersCanManage}},{path:"presence",component:oe,data:{basePerm:i.b.usersCanManage}},{path:"groups",component:L,data:{basePerm:i.b.usersCanManage}},{path:":id",component:wt}],Ra=((Ea=function e(){_classCallCheck(this,e)}).\u0275mod=f.Rb({type:Ea}),Ea.\u0275inj=f.Qb({factory:function(e){return new(e||Ea)},imports:[[c.j.forChild(Qa)],c.j]}),Ea),Fa=((Da=function e(){_classCallCheck(this,e)}).\u0275mod=f.Rb({type:Da}),Da.\u0275inj=f.Qb({factory:function(e){return new(e||Da)},imports:[[a.c,Ra,r.a]]}),Da)},"Jc+d":function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n("mrSG"),r=n("Izkr"),c=n("0IaG"),i=n("fXoL"),o=n("3Pt+"),s=n("ofXK"),l=n("bTqV"),u=n("oqD5"),b=n("sYmb");function m(e,t){if(1&e&&(i.Zb(0,"h2",2),i.Sc(1),i.mc(2,"translate"),i.Yb()),2&e){var n=i.lc();i.Gb(1),i.Tc(i.nc(2,1,n.data.title))}}function d(e,t){if(1&e&&(i.Zb(0,"div",9),i.Ub(1,"os-search-value-selector",10),i.Yb()),2&e){var n=i.lc(2);i.Gb(1),i.tc("multiple",n.data.multiSelect)("formControl",n.selectForm.get("select"))("inputListValues",n.data.choices)}}function f(e,t){if(1&e){var n=i.ac();i.Zb(0,"button",12),i.hc("click",(function(){i.Ic(n);var e=t.$implicit;return i.lc(3).closeDialog(!0,e)})),i.Zb(1,"span"),i.Sc(2),i.mc(3,"translate"),i.Yb(),i.Yb()}if(2&e){var a=t.$implicit,r=i.lc(3);i.tc("disabled",!r.hasSelection),i.Gb(2),i.Tc(i.nc(3,2,a))}}function p(e,t){if(1&e&&(i.Zb(0,"div"),i.Qc(1,f,4,4,"button",11),i.Yb()),2&e){var n=i.lc(2);i.Gb(1),i.tc("ngForOf",n.data.actionButtons)}}function h(e,t){if(1&e){var n=i.ac();i.Zb(0,"button",12),i.hc("click",(function(){return i.Ic(n),i.lc(3).closeDialog(!0)})),i.Zb(1,"span"),i.Sc(2,"OK"),i.Yb(),i.Yb()}if(2&e){var a=i.lc(3);i.tc("disabled",!a.hasSelection)}}function g(e,t){if(1&e&&(i.Zb(0,"div"),i.Qc(1,h,3,1,"button",13),i.Yb()),2&e){var n=i.lc(2);i.Gb(1),i.tc("ngIf",!n.data.multiSelect||n.data.choices)}}function v(e,t){if(1&e){var n=i.ac();i.Zb(0,"button",8),i.hc("click",(function(){i.Ic(n);var e=i.lc(2);return e.closeDialog(!0,e.data.clearChoice)})),i.Zb(1,"span"),i.Sc(2),i.Yb(),i.Yb()}if(2&e){var a=i.lc(2);i.Gb(2),i.Tc(a.data.clearChoice)}}function w(e,t){if(1&e){var n=i.ac();i.Zb(0,"form",3),i.Qc(1,d,2,3,"div",4),i.Zb(2,"div",5),i.Qc(3,p,2,1,"div",6),i.Qc(4,g,2,1,"div",6),i.Qc(5,v,3,1,"button",7),i.Zb(6,"button",8),i.hc("click",(function(){return i.Ic(n),i.lc().closeDialog(!1)})),i.Zb(7,"span"),i.Sc(8),i.mc(9,"translate"),i.Yb(),i.Yb(),i.Yb(),i.Yb()}if(2&e){var a=i.lc();i.tc("formGroup",a.selectForm),i.Gb(1),i.tc("ngIf",a.data.choices),i.Gb(2),i.tc("ngIf",a.data.actionButtons),i.Gb(1),i.tc("ngIf",!a.data.actionButtons),i.Gb(1),i.tc("ngIf",a.data.clearChoice),i.Gb(3),i.Tc(i.nc(9,6,"Cancel"))}}var S,_,G=((_=function(){function e(t,n,a){_classCallCheck(this,e),this.dialogRef=t,this.formBuilder=n,this.data=a,this.selectedMultiChoices=[],this.selectForm=this.formBuilder.group({select:[]})}return _createClass(e,[{key:"closeDialog",value:function(e,t){this.data.multiSelect||null!==this.selectedChoice||(t=this.data.clearChoice),e?this.dialogRef.close({action:t||null,items:this.selectForm.get("select").value}):this.dialogRef.close()}},{key:"hasSelection",get:function(){return!(this.data&&this.data.choices&&(!this.selectForm.get("select").value||!this.selectForm.get("select").value&&!this.selectForm.get("select").value.length))}}]),e}()).\u0275fac=function(e){return new(e||_)(i.Tb(c.h),i.Tb(o.f),i.Tb(c.a))},_.\u0275cmp=i.Nb({type:_,selectors:[["os-choice-dialog"]],decls:2,vars:2,consts:[["mat-dialog-title","",4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-dialog-title",""],[3,"formGroup"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],[4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"],["mat-dialog-content",""],["ngDefaultControl","",3,"multiple","formControl","inputListValues"],["mat-button","",3,"disabled","click",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],["mat-button","",3,"disabled","click",4,"ngIf"]],template:function(e,t){1&e&&(i.Qc(0,m,3,3,"h2",0),i.Qc(1,w,10,8,"form",1)),2&e&&(i.tc("ngIf",t.data),i.Gb(1),i.tc("ngIf",t.data))},directives:[s.t,c.i,o.I,o.t,o.k,c.c,l.b,c.f,u.a,o.c,o.s,o.h,s.s],pipes:[b.j],styles:[".mat-form-field{width:100%}"],encapsulation:2}),_),y=((S=function(){function e(t){_classCallCheck(this,e),this.dialog=t}return _createClass(e,[{key:"open",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return Object(a.a)(this,void 0,void 0,regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.abrupt("return",this.dialog.open(G,Object.assign(Object.assign({},r.a),{data:{title:e,choices:t,multiSelect:n,actionButtons:c,clearChoice:i}})).afterClosed().toPromise());case 1:case"end":return a.stop()}}),a,this)})))}}]),e}()).\u0275fac=function(e){return new(e||S)(i.dc(c.b))},S.\u0275prov=i.Pb({token:S,factory:S.\u0275fac,providedIn:"root"}),S)},wL0i:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var a=function(e){_inherits(n,e);var t=_createSuper(n);function n(e,a,r,c){var i;return _classCallCheck(this,n),(i=t.call(this,e,a,r)).storage=c,i.canMultiSelect=!1,i._multiSelectMode=!1,i.singleButtonWidth="40px",i.badgeButtonWidth="45px",i.selectedRows=[],i}return _createClass(n,[{key:"onDataSourceChange",value:function(e){this.dataSource=e}},{key:"toggleMultiSelect",value:function(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}},{key:"selectAll",value:function(){var e;(e=this.dataSource.selection).select.apply(e,_toConsumableArray(this.dataSource.filteredData))}},{key:"deselectAll",value:function(){this.dataSource&&this.dataSource.selection.clear()}},{key:"isMultiSelect",get:function(){return this._multiSelectMode}}]),n}(n("mV3u").a)}}]);