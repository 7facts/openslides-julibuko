(window.webpackJsonp=window.webpackJsonp||[]).push([[22,36],{"68w7":function(t,e,n){"use strict";n.r(e),n.d(e,"CategoryModule",(function(){return yt}));var o=n("ofXK"),i=n("PCNd"),c=n("tyNb"),a=n("+QJK"),s=n("mrSG"),r=n("iTQr"),l=n("F48D"),b=n("/tkw"),d=n("mV3u"),m=n("fXoL"),u=n("jhN1"),h=n("sYmb"),g=n("dNgK"),f=n("mksl"),p=n("Wp6s");const v=["osSortedTree"];function C(t,e){1&t&&m.Sc(0),2&t&&m.Uc(" ",e.item.getTitle()," ")}let M=(()=>{class t extends d.a{constructor(t,e,n,o,i){super(t,e,n),this.categoryRepo=o,this.promptService=i,this.hasChanged=!1,this.categoriesObservable=this.categoryRepo.getViewModelListObservable()}onSave(){return Object(s.a)(this,void 0,void 0,(function*(){yield this.categoryRepo.sortCategories(this.osSortTree.getTreeData()).then(()=>this.osSortTree.setSubscription(),this.raiseError)}))}onCancel(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.canDeactivate())&&this.osSortTree.setSubscription()}))}receiveChanges(t){this.hasChanged=t}canDeactivate(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.hasChanged){const t=this.translate.instant("Do you really want to exit this page?"),e=this.translate.instant("You made changes.");return yield this.promptService.open(t,e)}return!0}))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.d),m.Tb(h.k),m.Tb(g.a),m.Tb(r.a),m.Tb(l.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["os-categories-sort"]],viewQuery:function(t,e){var n;1&t&&m.Oc(v,!0),2&t&&m.Dc(n=m.ic())&&(e.osSortTree=n.first)},features:[m.Db],decls:10,vars:6,consts:[[3,"editMode","nav","saveEvent","mainEvent"],[1,"title-slot"],["parentKey","parent_id","weightKey","weight",3,"model","hasChanged"],["osSortedTree",""],["innerNode",""]],template:function(t,e){1&t&&(m.Zb(0,"os-head-bar",0),m.hc("saveEvent",(function(){return e.onSave()}))("mainEvent",(function(){return e.onCancel()})),m.Zb(1,"div",1),m.Zb(2,"h2"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(5,"mat-card"),m.Zb(6,"os-sorting-tree",2,3),m.hc("hasChanged",(function(t){return e.receiveChanges(t)})),m.Qc(8,C,1,1,"ng-template",null,4,m.Rc),m.Yb(),m.Yb()),2&t&&(m.tc("editMode",e.hasChanged)("nav",!1),m.Gb(3),m.Tc(m.nc(4,4,"Sort categories")),m.Gb(3),m.tc("model",e.categoriesObservable))},directives:[f.a,p.a,b.a],pipes:[h.j],styles:[".line[_ngcontent-%COMP%]{display:table;width:100%;font-size:14px;min-height:50px;margin-bottom:5px}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{max-width:100%}.line[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%], .line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle}.line[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{padding-right:10px;width:auto;white-space:nowrap}"]}),t})();var O=n("3Pt+"),S=n("+0xr"),y=n("OwvW"),P=n("dOok"),Y=n("Izkr"),Z=n("0IaG"),_=n("3Xi6"),w=n("STbY"),G=n("NFeN"),T=n("f0Cb"),x=n("bTqV"),D=n("A5z7"),k=n("kmnG"),I=n("qFsG"),Q=n("IZUe");const R=["editForm"],L=["editDialog"];function F(t,e){if(1&t&&(m.Zb(0,"h2"),m.Sc(1),m.Yb()),2&t){const t=m.lc();m.Gb(1),m.Uc(" ",t.selectedCategory.prefixedName," ")}}function j(t,e){if(1&t&&(m.Zb(0,"div"),m.Zb(1,"button",11),m.Zb(2,"mat-icon"),m.Sc(3,"more_vert"),m.Yb(),m.Yb(),m.Yb()),2&t){m.lc();const t=m.Ec(8);m.Gb(1),m.tc("matMenuTriggerFor",t)}}function E(t,e){1&t&&(m.Zb(0,"mat-header-cell"),m.Zb(1,"span"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Gb(2),m.Tc(m.nc(3,1,"Motion")))}function N(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Sc(1),m.Yb()),2&t){const t=e.$implicit;m.Gb(1),m.Uc(" ",t.getTitle()," ")}}function U(t,e){1&t&&(m.Zb(0,"mat-header-cell"),m.Zb(1,"span"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Gb(2),m.Tc(m.nc(3,1,"State")))}function B(t,e){if(1&t&&(m.Zb(0,"mat-cell",22),m.Zb(1,"mat-basic-chip",23),m.Sc(2),m.Yb(),m.Yb()),2&t){const t=e.$implicit,n=m.lc(2);m.Gb(1),m.tc("ngClass",t.stateCssColor),m.Gb(1),m.Uc(" ",n.getStateLabel(t)," ")}}function z(t,e){1&t&&(m.Zb(0,"mat-header-cell"),m.Zb(1,"span"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb()),2&t&&(m.Gb(2),m.Tc(m.nc(3,1,"Recommendation")))}function V(t,e){if(1&t&&(m.Zb(0,"mat-basic-chip",25),m.Sc(1),m.Yb()),2&t){const t=m.lc().$implicit,e=m.lc(2);m.Gb(1),m.Uc(" ",e.getRecommendationLabel(t)," ")}}function q(t,e){if(1&t&&(m.Zb(0,"mat-cell",22),m.Qc(1,V,2,1,"mat-basic-chip",24),m.Yb()),2&t){const t=e.$implicit;m.Gb(1),m.tc("ngIf",t.recommendation)}}function K(t,e){1&t&&m.Ub(0,"mat-header-cell")}const X=function(){return{back:"true"}};function A(t,e){if(1&t&&(m.Zb(0,"mat-cell"),m.Ub(1,"a",26),m.Yb()),2&t){const t=e.$implicit;m.Gb(1),m.tc("routerLink",t.getDetailStateURL())("state",m.yc(2,X))}}function W(t,e){1&t&&m.Ub(0,"mat-header-row")}function $(t,e){1&t&&m.Ub(0,"mat-row")}function J(t,e){if(1&t&&(m.Zb(0,"div"),m.Zb(1,"h2"),m.Zb(2,"span"),m.Sc(3),m.Yb(),m.Sc(4),m.Yb(),m.Zb(5,"table",12),m.Xb(6,13),m.Qc(7,E,4,3,"mat-header-cell",14),m.Qc(8,N,2,1,"mat-cell",15),m.Wb(),m.Xb(9,16),m.Qc(10,U,4,3,"mat-header-cell",14),m.Qc(11,B,3,2,"mat-cell",17),m.Wb(),m.Xb(12,18),m.Qc(13,z,4,3,"mat-header-cell",14),m.Qc(14,q,2,1,"mat-cell",17),m.Wb(),m.Xb(15,19),m.Qc(16,K,1,0,"mat-header-cell",14),m.Qc(17,A,2,3,"mat-cell",15),m.Wb(),m.Qc(18,W,1,0,"mat-header-row",20),m.Qc(19,$,1,0,"mat-row",21),m.Yb(),m.Yb()),2&t){const t=e.$implicit,n=m.lc();m.Gb(3),m.Tc(n.getLevelDashes(t)),m.Gb(1),m.Uc(" ",t.prefixedName," "),m.Gb(1),m.tc("dataSource",n.dataSources[t.id]),m.Gb(13),m.tc("matHeaderRowDef",n.getColumnDefinition()),m.Gb(1),m.tc("matRowDefColumns",n.getColumnDefinition())}}function H(t,e){if(1&t){const t=m.ac();m.Zb(0,"h1",27),m.Zb(1,"span"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb(),m.Zb(4,"div",28),m.Zb(5,"form",29),m.hc("ngSubmit",(function(){return m.Ic(t),m.lc().save()}))("keydown",(function(e){return m.Ic(t),m.lc().onKeyDown(e)})),m.Zb(6,"mat-form-field"),m.Ub(7,"input",30),m.mc(8,"translate"),m.Yb(),m.Zb(9,"mat-form-field"),m.Ub(10,"input",31),m.mc(11,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Zb(12,"div",32),m.Zb(13,"button",33),m.hc("click",(function(){return m.Ic(t),m.lc().save()})),m.Zb(14,"span"),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Zb(17,"button",34),m.Zb(18,"span"),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Gb(2),m.Vc("",m.nc(3,9,"Edit details for")," ",t.selectedCategory.prefixedName,""),m.Gb(3),m.tc("formGroup",t.editForm),m.Gb(2),m.uc("placeholder",m.nc(8,11,"Prefix")),m.Gb(3),m.uc("placeholder",m.nc(11,13,"Name")),m.Gb(3),m.tc("disabled",!t.editForm.valid),m.Gb(2),m.Tc(m.nc(16,15,"Save")),m.Gb(2),m.tc("mat-dialog-close",null),m.Gb(2),m.Tc(m.nc(20,17,"Cancel"))}}let tt=(()=>{class t extends d.a{constructor(t,e,n,o,i,c,a,s,r,l,b){super(t,e,n),this.translate=e,this.route=o,this.operator=i,this.router=c,this.repo=a,this.motionRepo=s,this.promptService=r,this.fb=l,this.dialog=b,this.dataSources={}}get canEdit(){return this.operator.hasPerms(y.b.motionsCanManage)}ngOnInit(){const t=parseInt(this.route.snapshot.params.id,10);this.subscriptions.push(this.repo.getViewModelListObservable().subscribe(e=>{const n=e.findIndex(e=>e.id===t);if(n<0)return;let o;for(this.selectedCategory=e[n],super.setTitle(this.selectedCategory.prefixedName),o=n+1;o<e.length&&e[o].level>this.selectedCategory.level;o++);this.categories=e.slice(n,o),this.categories.forEach(t=>{const e=new S.o;e.data=t.motions,this.dataSources[t.id]=e})}))}getColumnDefinition(){return["title","state","recommendation","anchor"]}onDeleteButton(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete this category and all subcategories?"),e=this.selectedCategory.prefixedName;(yield this.promptService.open(t,e))&&(yield this.repo.delete(this.selectedCategory),this.router.navigate(["../"],{relativeTo:this.route}))}))}onKeyDown(t){"Escape"===t.key&&this.dialogRef.close(),"Enter"===t.key&&this.save()}save(){this.repo.update(this.editForm.value,this.selectedCategory).then(()=>this.dialogRef.close()).catch(this.raiseError)}toggleEditMode(){this.editForm=this.fb.group({prefix:[this.selectedCategory.prefix],name:[this.selectedCategory.name,O.G.required]}),this.dialogRef=this.dialog.open(this.editDialog,Y.a)}getRecommendationLabel(t){return this.motionRepo.getExtendedRecommendationLabel(t)}getStateLabel(t){return this.motionRepo.getExtendedStateLabel(t)}getLevelDashes(t){return"\u2013".repeat(t.level-this.selectedCategory.level)}numberMotions(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to renumber all motions of this category?"),e=this.selectedCategory.getTitle();(yield this.promptService.open(t,e))&&(yield this.repo.numberMotionsInCategory(this.selectedCategory).catch(this.raiseError))}))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.d),m.Tb(h.k),m.Tb(g.a),m.Tb(c.a),m.Tb(y.a),m.Tb(c.f),m.Tb(r.a),m.Tb(P.a),m.Tb(l.a),m.Tb(O.f),m.Tb(Z.b))},t.\u0275cmp=m.Nb({type:t,selectors:[["os-category-detail"]],viewQuery:function(t,e){var n;1&t&&(m.Oc(R,!0),m.Oc(L,!0)),2&t&&(m.Dc(n=m.ic())&&(e.editForm=n.first),m.Dc(n=m.ic())&&(e.editDialog=n.first))},features:[m.Db],decls:36,vars:17,consts:[[3,"nav"],[1,"title-slot"],[4,"ngIf"],[1,"menu-slot"],[4,"osPerms"],[4,"ngFor","ngForOf"],["categoryMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",1,"red-warning-text",3,"click"],["editDialog",""],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],["mat-table","",1,"os-headed-listview-table",3,"dataSource"],["matColumnDef","title"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","state"],["class","chip-container",4,"matCellDef"],["matColumnDef","recommendation"],["matColumnDef","anchor"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"chip-container"],["disableRipple","",3,"ngClass"],["disableRipple","","class","bluegrey",4,"ngIf"],["disableRipple","",1,"bluegrey"],[3,"routerLink","state"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],[1,"edit-form",3,"formGroup","ngSubmit","keydown"],["matInput","","osAutofocus","","formControlName","prefix",3,"placeholder"],["matInput","","osAutofocus","","formControlName","name","required","",3,"placeholder"],["mat-dialog-actions",""],["type","submit","mat-button","","color","accent",3,"disabled","click"],["type","button","mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(m.Zb(0,"os-head-bar",0),m.Zb(1,"div",1),m.Qc(2,F,2,1,"h2",2),m.Yb(),m.Zb(3,"div",3),m.Qc(4,j,4,1,"div",4),m.Yb(),m.Yb(),m.Zb(5,"mat-card"),m.Qc(6,J,20,5,"div",5),m.Yb(),m.Zb(7,"mat-menu",null,6),m.Zb(9,"button",7),m.hc("click",(function(){return e.toggleEditMode()})),m.Zb(10,"mat-icon"),m.Sc(11,"edit"),m.Yb(),m.Zb(12,"span"),m.Sc(13),m.mc(14,"translate"),m.Yb(),m.Yb(),m.Zb(15,"button",8),m.Zb(16,"mat-icon"),m.Sc(17,"sort"),m.Yb(),m.Zb(18,"span"),m.Sc(19),m.mc(20,"translate"),m.Yb(),m.Yb(),m.Zb(21,"button",7),m.hc("click",(function(){return e.numberMotions()})),m.Zb(22,"mat-icon"),m.Sc(23,"format_list_numbered"),m.Yb(),m.Zb(24,"span"),m.Sc(25),m.mc(26,"translate"),m.Yb(),m.Yb(),m.Ub(27,"mat-divider"),m.Zb(28,"button",9),m.hc("click",(function(){return e.onDeleteButton()})),m.Zb(29,"mat-icon"),m.Sc(30,"delete"),m.Yb(),m.Zb(31,"span"),m.Sc(32),m.mc(33,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Qc(34,H,21,19,"ng-template",null,10,m.Rc)),2&t&&(m.tc("nav",!1),m.Gb(2),m.tc("ngIf",e.selectedCategory),m.Gb(2),m.tc("osPerms","motions.can_manage"),m.Gb(2),m.tc("ngForOf",e.categories),m.Gb(7),m.Tc(m.nc(14,9,"Edit")),m.Gb(2),m.tc("routerLink","./sort"),m.Gb(4),m.Tc(m.nc(20,11,"Sort motions")),m.Gb(6),m.Tc(m.nc(26,13,"Number motions")),m.Gb(7),m.Tc(m.nc(33,15,"Delete")))},directives:[f.a,o.t,_.a,p.a,o.s,w.f,w.c,G.a,c.g,T.a,x.b,w.e,S.n,S.c,S.i,S.b,S.k,S.m,S.h,S.a,D.a,o.q,c.i,S.j,S.l,Z.i,Z.f,O.I,O.t,O.k,k.c,I.b,O.c,Q.a,O.s,O.i,O.D,Z.c,Z.d],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.block-title[_ngcontent-%COMP%]{padding:40px 40px 40px 25px;line-height:180%;font-size:120%;color:#317796}.block-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-weight:400}.block-card[_ngcontent-%COMP%]{margin:0 20px;padding:25px}.block-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin-right:5px}.chip-container[_ngcontent-%COMP%]{display:block;min-height:0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-title[_ngcontent-%COMP%]{-ms-flex:4 0 0px;flex:4 0 0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-recommendation[_ngcontent-%COMP%], .os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-state[_ngcontent-%COMP%]{-ms-flex:2 0 0px;flex:2 0 0}.os-headed-listview-table[_ngcontent-%COMP%]   .mat-column-remove[_ngcontent-%COMP%]{-ms-flex:1 0 0px;flex:1 0 0;-ms-flex-pack:end!important;justify-content:flex-end!important}.edit-form[_ngcontent-%COMP%]{overflow:hidden}"]}),t})();var et=n("AqIO"),nt=n("wL0i"),ot=n("0Obk"),it=n("dRZP"),ct=n("Qu3c");const at=["newCategoryDialog"];function st(t,e){if(1&t&&(m.Zb(0,"div",8),m.Zb(1,"button",9),m.Zb(2,"mat-icon"),m.Sc(3,"more_vert"),m.Yb(),m.Yb(),m.Yb()),2&t){m.lc();const t=m.Ec(10);m.Gb(1),m.tc("matMenuTriggerFor",t)}}function rt(t,e){if(1&t&&(m.Zb(0,"div",10),m.Ub(1,"a",11),m.Zb(2,"div"),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.row,n=m.lc();m.Gb(1),m.tc("routerLink",t.id),m.Gb(1),m.Pc("margin-left",n.getMargin(t)),m.Gb(1),m.Tc(t.prefixedName)}}function lt(t,e){if(1&t&&(m.Zb(0,"div",10),m.Zb(1,"span",12),m.mc(2,"translate"),m.Sc(3),m.Yb(),m.Yb()),2&t){const t=e.row;m.Gb(1),m.uc("matTooltip",m.nc(2,2,"Motions")),m.Gb(2),m.Tc(t.motions.length)}}function bt(t,e){1&t&&(m.Zb(0,"mat-error"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t&&(m.Gb(1),m.Uc(" ",m.nc(2,1,"A name is required")," "))}function dt(t,e){if(1&t){const t=m.ac();m.Zb(0,"h1",13),m.Zb(1,"span"),m.Sc(2),m.mc(3,"translate"),m.Yb(),m.Yb(),m.Zb(4,"div",14),m.Zb(5,"form",15),m.hc("keydown",(function(e){return m.Ic(t),m.lc().onKeyDown(e)})),m.Zb(6,"p"),m.Zb(7,"mat-form-field"),m.Ub(8,"input",16),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Zb(10,"p"),m.Zb(11,"mat-form-field"),m.Ub(12,"input",17),m.mc(13,"translate"),m.Qc(14,bt,3,3,"mat-error",18),m.Yb(),m.Yb(),m.Yb(),m.Yb(),m.Zb(15,"div",19),m.Zb(16,"button",20),m.Zb(17,"span"),m.Sc(18),m.mc(19,"translate"),m.Yb(),m.Yb(),m.Zb(20,"button",21),m.Zb(21,"span"),m.Sc(22),m.mc(23,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Gb(2),m.Tc(m.nc(3,10,"New category")),m.Gb(3),m.tc("formGroup",t.createForm),m.Gb(3),m.uc("placeholder",m.nc(9,12,"Prefix")),m.Gb(4),m.uc("placeholder",m.nc(13,14,"Name")),m.Gb(2),m.tc("ngIf",!t.createForm.controls.name.valid),m.Gb(2),m.tc("disabled",!t.createForm.valid)("mat-dialog-close",!0),m.Gb(2),m.Tc(m.nc(19,16,"Save")),m.Gb(2),m.tc("mat-dialog-close",!1),m.Gb(2),m.Tc(m.nc(23,18,"Cancel"))}}const mt=function(){return["menu"]};let ut=(()=>{class t extends nt.a{constructor(t,e,n,o,i,c,a,s){super(t,e,n,o),this.repo=i,this.formBuilder=c,this.dialog=a,this.operator=s,this.tableColumnDefinition=[{prop:"title",width:"auto"},{prop:"amount",width:this.singleButtonWidth}],this.filterProps=["prefixedName"],this.createForm=this.formBuilder.group({prefix:[""],name:["",O.G.required],parent_id:[""]})}get canEdit(){return this.operator.hasPerms(y.b.motionsCanManage)}ngOnInit(){super.setTitle("Categories")}onPlusButton(){this.createForm.reset(),this.dialogRef=this.dialog.open(this.newCategoryDialog,Y.a),this.dialogRef.afterClosed().subscribe(t=>{t&&this.save()})}save(){this.createForm.valid&&this.repo.create(this.createForm.value).catch(this.raiseError)}onKeyDown(t){"Enter"===t.key&&(this.save(),this.dialogRef.close()),"Escape"===t.key&&this.dialogRef.close()}getMargin(t){return 20*t.level+"px"}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.d),m.Tb(h.k),m.Tb(g.a),m.Tb(et.a),m.Tb(r.a),m.Tb(O.f),m.Tb(Z.b),m.Tb(y.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["os-category-list"]],viewQuery:function(t,e){var n;1&t&&m.Oc(at,!0),2&t&&m.Dc(n=m.ic())&&(e.newCategoryDialog=n.first)},features:[m.Db],decls:19,vars:20,consts:[["prevUrl","../..",3,"nav","hasMainButton","mainEvent"],[1,"title-slot"],["class","menu-slot",4,"osPerms"],["listStorageKey","category",3,"vScrollFixed","listObservableProvider","allowProjector","showListOfSpeakers","columns","filterProps","hiddenInMobile","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["categoryMenu","matMenu"],["mat-menu-item","",3,"routerLink"],["newCategoryDialog",""],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"cell-slot","fill"],[1,"detail-link",3,"routerLink"],[1,"os-amount-chip",3,"matTooltip"],["mat-dialog-title",""],["mat-dialog-content","",1,"os-form-card-mobile"],[3,"formGroup","keydown"],["formControlName","prefix","matInput","",3,"placeholder"],["formControlName","name","matInput","","required","",3,"placeholder"],[4,"ngIf"],["mat-dialog-actions",""],["mat-button","",3,"disabled","mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&(m.Zb(0,"os-head-bar",0),m.hc("mainEvent",(function(){return e.onPlusButton()})),m.Zb(1,"div",1),m.Zb(2,"h2"),m.Sc(3),m.mc(4,"translate"),m.Yb(),m.Yb(),m.Qc(5,st,4,1,"div",2),m.Yb(),m.Zb(6,"os-list-view-table",3),m.hc("dataSourceChange",(function(t){return e.onDataSourceChange(t)})),m.Qc(7,rt,4,4,"div",4),m.Qc(8,lt,4,4,"div",4),m.Yb(),m.Zb(9,"mat-menu",null,5),m.Zb(11,"button",6),m.Zb(12,"mat-icon"),m.Sc(13,"sort"),m.Yb(),m.Zb(14,"span"),m.Sc(15),m.mc(16,"translate"),m.Yb(),m.Yb(),m.Yb(),m.Qc(17,dt,24,20,"ng-template",null,7,m.Rc)),2&t&&(m.tc("nav",!1)("hasMainButton",e.canEdit),m.Gb(3),m.Tc(m.nc(4,15,"Categories")),m.Gb(2),m.tc("osPerms","motions.can_manage"),m.Gb(1),m.tc("vScrollFixed",64)("listObservableProvider",e.repo)("allowProjector",!1)("showListOfSpeakers",!1)("columns",e.tableColumnDefinition)("filterProps",e.filterProps)("hiddenInMobile",m.yc(19,mt)),m.Gb(1),m.tc("pblNgridCellDef","title"),m.Gb(1),m.tc("pblNgridCellDef","amount"),m.Gb(3),m.tc("routerLink","./sort"),m.Gb(4),m.Tc(m.nc(16,17,"Sort categories")))},directives:[f.a,_.a,ot.a,it.c,w.f,w.c,c.g,G.a,x.b,w.e,c.i,ct.c,Z.i,Z.f,O.I,O.t,O.k,k.c,O.c,I.b,O.s,O.i,O.D,o.t,Z.c,Z.d,k.b],pipes:[h.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}"]}),t})();var ht=n("2Vo4"),gt=n("Jc+d"),ft=n("IBZR");const pt=["sorter"];function vt(t,e){if(1&t&&(m.Zb(0,"h2"),m.Sc(1),m.mc(2,"translate"),m.Yb()),2&t){const t=m.lc();m.Gb(1),m.Vc("",m.nc(2,2,"Sort motions")," (",t.category.prefixedName,")")}}function Ct(t,e){if(1&t){const t=m.ac();m.Zb(0,"div"),m.Zb(1,"span"),m.Sc(2),m.Yb(),m.Zb(3,"span"),m.Sc(4),m.mc(5,"translate"),m.Yb(),m.Zb(6,"button",6),m.hc("click",(function(){return m.Ic(t),m.lc().moveToPosition()})),m.Zb(7,"span"),m.Sc(8),m.mc(9,"translate"),m.Yb(),m.Yb(),m.Yb()}if(2&t){const t=m.lc();m.Gb(2),m.Uc("",t.sortSelector.multiSelectedIndex.length,"\xa0"),m.Gb(2),m.Tc(m.nc(5,3,"selected")),m.Gb(4),m.Tc(m.nc(9,5,"move ..."))}}function Mt(t,e){if(1&t&&(m.Zb(0,"mat-basic-chip",7),m.mc(1,"translate"),m.Sc(2),m.Yb()),2&t){const t=e.$implicit;m.uc("matTooltip",m.nc(1,2,"Sequential number")),m.Gb(2),m.Uc(" ",t.id," ")}}const Ot=[{path:"",component:ut,pathMatch:"full"},{path:":id/sort",component:(()=>{class t extends d.a{constructor(t,e,n,o,i,c,a,s){super(t,e,n),this.translate=e,this.promptService=o,this.repo=i,this.route=c,this.motionRepo=a,this.choiceService=s,this.motionsSubject=new ht.a([]),this.motionsCount=0,this.hasChanged=!1,this.motionsCopy=[],this.motionsBackup=[]}get isMultiSelect(){return this.sortSelector.multiSelectedIndex.length>0}get motionObservable(){return this.motionsSubject.asObservable()}ngOnInit(){const t=+this.route.snapshot.params.id;this.repo.getViewModelObservable(t).subscribe(t=>{this.category=t}),this.motionRepo.getViewModelListObservable().subscribe(e=>{const n=e.filter(e=>e.category_id===t);this.motionsBackup=[...n],this.motionsCount=n.length,0===this.motionsCopy.length?this.initializeList(n):this.motionsSubject.next(this.handleMotionUpdates(n))})}initializeList(t){t.sort((t,e)=>t.category_weight-e.category_weight),this.motionsSubject.next(t),this.motionsCopy=t}onListUpdate(t){this.hasChanged=!0,this.motionsCopy=t}onCancel(){return Object(s.a)(this,void 0,void 0,(function*(){(yield this.canDeactivate())&&(this.motionsSubject.next([]),this.initializeList(this.motionsBackup),this.hasChanged=!1)}))}sendUpdate(){return Object(s.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Do you really want to save your changes?");if(yield this.promptService.open(t)){const t=this.motionsCopy.map(t=>t.id);this.repo.sortMotionsInCategory(this.category.category,t),this.hasChanged=!1}}))}handleMotionUpdates(t){const e=this.motionsCopy;if(t.length>e.length)for(const n of t)this.motionsCopy.includes(n)||e.push(n);else if(t.length<e.length)for(const n of e)t.includes(n)||e.splice(e.indexOf(n),1);else for(const n of e)if(!t.includes(n)){const o=t.find(t=>t.id===n.id);e.splice(e.indexOf(n),1,o)}return e}canDeactivate(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.hasChanged){const t=this.translate.instant("Do you really want to exit this page?"),e=this.translate.instant("You made changes.");return yield this.promptService.open(t,e)}return!0}))}moveToPosition(){return Object(s.a)(this,void 0,void 0,(function*(){if(this.sortSelector.multiSelectedIndex.length){const t=this.translate.instant("Move selected items ..."),e=this.sortSelector.sortedItems.filter(t=>!this.sortSelector.multiSelectedIndex.includes(t.id)),n=[this.translate.instant("Insert before"),this.translate.instant("Insert behind")],o=yield this.choiceService.open(t,e,!1,n);o&&this.sortSelector.drop({currentIndex:o.items,previousIndex:null},o.action===n[1])}}))}}return t.\u0275fac=function(e){return new(e||t)(m.Tb(u.d),m.Tb(h.k),m.Tb(g.a),m.Tb(l.a),m.Tb(r.a),m.Tb(c.a),m.Tb(P.a),m.Tb(gt.a))},t.\u0275cmp=m.Nb({type:t,selectors:[["os-category-motions-sort"]],viewQuery:function(t,e){var n;1&t&&m.Oc(pt,!0),2&t&&m.Dc(n=m.ic())&&(e.sortSelector=n.first)},features:[m.Db],decls:8,vars:5,consts:[[3,"editMode","nav","saveEvent","mainEvent"],[1,"title-slot"],[4,"ngIf"],[1,"os-form-card"],[3,"input","sortEvent"],["sorter",""],["mat-button","",3,"click"],["disableRipple","",1,"bluegrey",3,"matTooltip"]],template:function(t,e){1&t&&(m.Zb(0,"os-head-bar",0),m.hc("saveEvent",(function(){return e.sendUpdate()}))("mainEvent",(function(){return e.onCancel()})),m.Zb(1,"div",1),m.Qc(2,vt,3,4,"h2",2),m.Yb(),m.Yb(),m.Zb(3,"mat-card",3),m.Qc(4,Ct,10,7,"div",2),m.Zb(5,"os-sorting-list",4,5),m.hc("sortEvent",(function(t){return e.onListUpdate(t)})),m.Qc(7,Mt,3,4,"ng-template"),m.Yb(),m.Yb()),2&t&&(m.tc("editMode",e.hasChanged)("nav",!1),m.Gb(2),m.tc("ngIf",e.category),m.Gb(2),m.tc("ngIf",e.isMultiSelect),m.Gb(1),m.tc("input",e.motionObservable))},directives:[f.a,o.t,p.a,ft.a,x.b,D.a,ct.c],pipes:[h.j],styles:[""]}),t})(),canDeactivate:[a.a]},{path:"sort",component:M,canDeactivate:[a.a]},{path:":id",component:tt}];let St=(()=>{class t{}return t.\u0275mod=m.Rb({type:t}),t.\u0275inj=m.Qb({factory:function(e){return new(e||t)},imports:[[c.j.forChild(Ot)],c.j]}),t})(),yt=(()=>{class t{}return t.\u0275mod=m.Rb({type:t}),t.\u0275inj=m.Qb({factory:function(e){return new(e||t)},imports:[[o.c,St,i.a]]}),t})()},F48D:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var o=n("mrSG"),i=n("LBBb"),c=n("fXoL"),a=n("0IaG");let s=(()=>{class t{constructor(t){this.dialog=t}open(t,e=""){return Object(o.a)(this,void 0,void 0,(function*(){return this.dialog.open(i.a,{width:"250px",data:{title:t,content:e}}).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(c.dc(a.b))},t.\u0275prov=c.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"Jc+d":function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var o=n("mrSG"),i=n("Izkr"),c=n("0IaG"),a=n("fXoL"),s=n("3Pt+"),r=n("ofXK"),l=n("bTqV"),b=n("oqD5"),d=n("sYmb");function m(t,e){if(1&t&&(a.Zb(0,"h2",2),a.Sc(1),a.mc(2,"translate"),a.Yb()),2&t){const t=a.lc();a.Gb(1),a.Tc(a.nc(2,1,t.data.title))}}function u(t,e){if(1&t&&(a.Zb(0,"div",9),a.Ub(1,"os-search-value-selector",10),a.Yb()),2&t){const t=a.lc(2);a.Gb(1),a.tc("multiple",t.data.multiSelect)("formControl",t.selectForm.get("select"))("inputListValues",t.data.choices)}}function h(t,e){if(1&t){const t=a.ac();a.Zb(0,"button",12),a.hc("click",(function(){a.Ic(t);const n=e.$implicit;return a.lc(3).closeDialog(!0,n)})),a.Zb(1,"span"),a.Sc(2),a.mc(3,"translate"),a.Yb(),a.Yb()}if(2&t){const t=e.$implicit,n=a.lc(3);a.tc("disabled",!n.hasSelection),a.Gb(2),a.Tc(a.nc(3,2,t))}}function g(t,e){if(1&t&&(a.Zb(0,"div"),a.Qc(1,h,4,4,"button",11),a.Yb()),2&t){const t=a.lc(2);a.Gb(1),a.tc("ngForOf",t.data.actionButtons)}}function f(t,e){if(1&t){const t=a.ac();a.Zb(0,"button",12),a.hc("click",(function(){return a.Ic(t),a.lc(3).closeDialog(!0)})),a.Zb(1,"span"),a.Sc(2,"OK"),a.Yb(),a.Yb()}if(2&t){const t=a.lc(3);a.tc("disabled",!t.hasSelection)}}function p(t,e){if(1&t&&(a.Zb(0,"div"),a.Qc(1,f,3,1,"button",13),a.Yb()),2&t){const t=a.lc(2);a.Gb(1),a.tc("ngIf",!t.data.multiSelect||t.data.choices)}}function v(t,e){if(1&t){const t=a.ac();a.Zb(0,"button",8),a.hc("click",(function(){a.Ic(t);const e=a.lc(2);return e.closeDialog(!0,e.data.clearChoice)})),a.Zb(1,"span"),a.Sc(2),a.Yb(),a.Yb()}if(2&t){const t=a.lc(2);a.Gb(2),a.Tc(t.data.clearChoice)}}function C(t,e){if(1&t){const t=a.ac();a.Zb(0,"form",3),a.Qc(1,u,2,3,"div",4),a.Zb(2,"div",5),a.Qc(3,g,2,1,"div",6),a.Qc(4,p,2,1,"div",6),a.Qc(5,v,3,1,"button",7),a.Zb(6,"button",8),a.hc("click",(function(){return a.Ic(t),a.lc().closeDialog(!1)})),a.Zb(7,"span"),a.Sc(8),a.mc(9,"translate"),a.Yb(),a.Yb(),a.Yb(),a.Yb()}if(2&t){const t=a.lc();a.tc("formGroup",t.selectForm),a.Gb(1),a.tc("ngIf",t.data.choices),a.Gb(2),a.tc("ngIf",t.data.actionButtons),a.Gb(1),a.tc("ngIf",!t.data.actionButtons),a.Gb(1),a.tc("ngIf",t.data.clearChoice),a.Gb(3),a.Tc(a.nc(9,6,"Cancel"))}}let M=(()=>{class t{constructor(t,e,n){this.dialogRef=t,this.formBuilder=e,this.data=n,this.selectedMultiChoices=[],this.selectForm=this.formBuilder.group({select:[]})}get hasSelection(){return!(this.data&&this.data.choices&&(!this.selectForm.get("select").value||!this.selectForm.get("select").value&&!this.selectForm.get("select").value.length))}closeDialog(t,e){this.data.multiSelect||null!==this.selectedChoice||(e=this.data.clearChoice),t?this.dialogRef.close({action:e||null,items:this.selectForm.get("select").value}):this.dialogRef.close()}}return t.\u0275fac=function(e){return new(e||t)(a.Tb(c.h),a.Tb(s.f),a.Tb(c.a))},t.\u0275cmp=a.Nb({type:t,selectors:[["os-choice-dialog"]],decls:2,vars:2,consts:[["mat-dialog-title","",4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-dialog-title",""],[3,"formGroup"],["mat-dialog-content","",4,"ngIf"],["mat-dialog-actions",""],[4,"ngIf"],["mat-button","",3,"click",4,"ngIf"],["mat-button","",3,"click"],["mat-dialog-content",""],["ngDefaultControl","",3,"multiple","formControl","inputListValues"],["mat-button","",3,"disabled","click",4,"ngFor","ngForOf"],["mat-button","",3,"disabled","click"],["mat-button","",3,"disabled","click",4,"ngIf"]],template:function(t,e){1&t&&(a.Qc(0,m,3,3,"h2",0),a.Qc(1,C,10,8,"form",1)),2&t&&(a.tc("ngIf",e.data),a.Gb(1),a.tc("ngIf",e.data))},directives:[r.t,c.i,s.I,s.t,s.k,c.c,l.b,c.f,b.a,s.c,s.s,s.h,r.s],pipes:[d.j],styles:[".mat-form-field{width:100%}"],encapsulation:2}),t})(),O=(()=>{class t{constructor(t){this.dialog=t}open(t,e,n=!1,c,a){return Object(o.a)(this,void 0,void 0,(function*(){return this.dialog.open(M,Object.assign(Object.assign({},i.a),{data:{title:t,choices:e,multiSelect:n,actionButtons:c,clearChoice:a}})).afterClosed().toPromise()}))}}return t.\u0275fac=function(e){return new(e||t)(a.dc(c.b))},t.\u0275prov=a.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},LBBb:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var o=n("0IaG"),i=n("fXoL"),c=n("ofXK"),a=n("bTqV"),s=n("sYmb");function r(t,e){if(1&t&&(i.Zb(0,"div"),i.Zb(1,"h2",1),i.Sc(2),i.Yb(),i.Ub(3,"mat-dialog-content",2),i.Zb(4,"mat-dialog-actions"),i.Zb(5,"button",3),i.Sc(6),i.mc(7,"translate"),i.Yb(),i.Zb(8,"button",4),i.Sc(9),i.mc(10,"translate"),i.Yb(),i.Yb(),i.Yb()),2&t){const t=i.lc();i.Gb(2),i.Tc(t.data.title),i.Gb(1),i.tc("innerHTML",t.data.content,i.Jc),i.Gb(2),i.tc("mat-dialog-close",!0),i.Gb(1),i.Tc(i.nc(7,6,"Yes")),i.Gb(2),i.tc("mat-dialog-close",!1),i.Gb(1),i.Tc(i.nc(10,8,"Cancel"))}}let l=(()=>{class t{constructor(t,e){this.dialogRef=t,this.data=e}}return t.\u0275fac=function(e){return new(e||t)(i.Tb(o.h),i.Tb(o.a))},t.\u0275cmp=i.Nb({type:t,selectors:[["os-prompt-dialog"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-dialog-title",""],[3,"innerHTML"],["mat-button","","color","warn",3,"mat-dialog-close"],["mat-button","",3,"mat-dialog-close"]],template:function(t,e){1&t&&i.Qc(0,r,11,10,"div",0),2&t&&i.tc("ngIf",e.data)},directives:[c.t,o.i,o.f,o.c,a.b,o.d],pipes:[s.j],encapsulation:2}),t})()},wL0i:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var o=n("mV3u");class i extends o.a{constructor(t,e,n,o){super(t,e,n),this.storage=o,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);