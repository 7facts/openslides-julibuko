function _get(t,e,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=_superPropBase(t,e);if(i){var o=Object.getOwnPropertyDescriptor(i,e);return o.get?o.get.call(n):o.value}})(t,e,n||t)}function _superPropBase(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=_getPrototypeOf(t)););return t}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _createForOfIteratorHelper(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=_unsupportedIterableToArray(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,o=function(){};return{s:o,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,r=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return c=t.done,t},e:function(t){r=!0,a=t},f:function(){try{c||null==n.return||n.return()}finally{if(r)throw a}}}}function _unsupportedIterableToArray(t,e){if(t){if("string"==typeof t)return _arrayLikeToArray(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(t,e):void 0}}function _arrayLikeToArray(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _createSuper(t){var e=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{AP8A:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),o=n("xTJg"),a=n("Hila"),c=n("OwvW"),r=n("/iaR"),s=n("fXoL"),l=function(){var t=function(){function t(e,n,i){var o=this;_classCallCheck(this,t),this.operator=e,this.DS=n,this.http=i,e.getUserObservable().subscribe((function(){return o.updatePersonalNoteObject()})),this.DS.getChangeObservable(r.a).subscribe((function(t){o.updatePersonalNoteObject()}))}return _createClass(t,[{key:"updatePersonalNoteObject",value:function(){if(this.operator.isAnonymous)this.personalNoteObject=null;else{var t=this.operator.user.id,e=this.DS.filter(r.a,(function(e){return e.user_id===t}));this.personalNoteObject=0===e.length?null:e[0]}}},{key:"savePersonalNote",value:function(t,e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.savePersonalNoteObject([{collection:t.collectionString,id:t.id,content:e}]);case 2:case"end":return n.stop()}}),n,this)})))}},{key:"bulkSetStar",value:function(t,e){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t.length){n.next=2;break}return n.abrupt("return");case 2:return(i=this.personalNoteObject||{}).notes||(i.notes={}),o=t.map((function(t){return i.notes[t.collectionString]||(i.notes[t.collectionString]={}),i.notes[t.collectionString][t.id]?i.notes[t.collectionString][t.id].star=e:i.notes[t.collectionString][t.id]={star:e,note:""},{collection:t.collectionString,id:t.id,content:i.notes[t.collectionString][t.id]}})),n.next=7,this.savePersonalNoteObject(o);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"savePersonalNoteObject",value:function(t){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.http.post("/rest/users/personal-note/create_or_update/",t);case 2:case"end":return e.stop()}}),e,this)})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.dc(c.a),s.dc(o.a),s.dc(a.a))},t.\u0275prov=s.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},Q5D0:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("D/ll"),o=n("OwvW"),a=n("AqIO"),c=n("iTQr"),r=n("D5Qf"),s=n("+B0n"),l=n("s3dr"),m=n("lv9T"),u=n("+8Rz"),b=n("+KbT"),d=n("gtli"),f=n("3Y4h"),g=n("fXoL"),h=n("sYmb"),p=function(){var t=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l,m,u){var b;return _classCallCheck(this,n),(b=e.call(this,t,i)).workflowRepo=s,b.translate=l,b.operator=m,b.config=u,b.storageKey="MotionList",b.enabledWorkflows={statuteEnabled:!1,statute:null,motion:null},b.stateFilterOptions={property:"state_id",label:"State",options:[]},b.categoryFilterOptions={property:"category_id",label:"Category",options:[]},b.motionBlockFilterOptions={property:"motion_block_id",label:"Motion block",options:[]},b.motionCommentFilterOptions={property:"commentSectionIds",label:"Comment",options:[]},b.recommendationFilterOptions={property:"recommendation_id",label:"Recommendation",options:[]},b.tagFilterOptions={property:"tags_id",label:"Tags",options:[]},b.hasSpeakerOptions={property:"hasSpeakers",label:"Speakers",options:[{condition:!0,label:b.translate.instant("Has speakers")},{condition:!1,label:b.translate.instant("Has no speakers")}]},b.AmendmentFilterOption={property:"amendmentType",label:"Amendment",options:[{condition:f.a.Amendment,label:b.translate.instant("Is amendment")},{condition:f.a.Parent,label:b.translate.instant("Has amendments")},{condition:f.a.Lead,label:b.translate.instant("Is no amendment and has no amendments")}]},b.personalNoteFilterOptions=[{property:"star",label:b.translate.instant("Favorites"),options:[{condition:!0,label:b.translate.instant("Is favorite")},{condition:!1,label:b.translate.instant("Is not favorite")}]},{property:"hasNotes",label:b.translate.instant("Personal notes"),options:[{condition:!0,label:b.translate.instant("Has notes")},{condition:!1,label:b.translate.instant("Does not have notes")}]}],b.getWorkflowConfig(),b.getShowAmendmentConfig(),b.updateFilterForRepo(o,b.categoryFilterOptions,b.translate.instant("No category set")),b.updateFilterForRepo(a,b.motionBlockFilterOptions,b.translate.instant("No motion block set")),b.updateFilterForRepo(c,b.motionCommentFilterOptions,b.translate.instant("No comment")),b.updateFilterForRepo(r,b.tagFilterOptions,b.translate.instant("No tags")),b.subscribeWorkflows(),b.operator.getUserObservable().subscribe((function(){b.setFilterDefinitions()})),b}return _createClass(n,[{key:"preFilter",value:function(t){if(!this.showAmendmentsInMainTable)return t.filter((function(t){return!t.parent_id}))}},{key:"getShowAmendmentConfig",value:function(){var t=this;this.config.get("motions_amendments_main_table").subscribe((function(e){t.showAmendmentsInMainTable=e}))}},{key:"getWorkflowConfig",value:function(){var t=this;this.config.get("motions_statute_amendments_workflow").subscribe((function(e){t.enabledWorkflows.statute=+e})),this.config.get("motions_workflow").subscribe((function(e){t.enabledWorkflows.motion=+e})),this.config.get("motions_statutes_enabled").subscribe((function(e){t.enabledWorkflows.statuteEnabled=e}))}},{key:"getFilterDefinitions",value:function(){var t=[this.stateFilterOptions,this.categoryFilterOptions,this.motionBlockFilterOptions,this.recommendationFilterOptions,this.motionCommentFilterOptions,this.tagFilterOptions];return this.operator.hasPerms(o.b.agendaCanSeeListOfSpeakers)&&t.push(this.hasSpeakerOptions),this.showAmendmentsInMainTable&&t.push(this.AmendmentFilterOption),this.operator.isAnonymous||(t=t.concat(this.personalNoteFilterOptions)),t}},{key:"subscribeWorkflows",value:function(){var t=this;this.workflowRepo.getViewModelListObservable().subscribe((function(e){if(e&&e.length){var n,i=[],o=[],a=[],c=[],r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(t.isWorkflowEnabled(s.id)){i.push({name:s.name,filter:[]}),o.push({name:s.name,filter:[]});var l,m=_createForOfIteratorHelper(s.states);try{for(m.s();!(l=m.n()).done;){var u,b=l.value,f=b.restriction.filter((function(t){return t!==d.b.motionsIsSubmitter}));f.length&&!(u=t.operator).hasPerms.apply(u,_toConsumableArray(f))||(b.isFinalState?a.push(b.id):c.push(b.id),i[i.length-1].filter.push({condition:b.id,label:b.name}),b.recommendation_label&&o[i.length-1].filter.push({condition:b.id,label:b.recommendation_label}))}}catch(S){m.e(S)}finally{m.f()}}}}catch(S){r.e(S)}finally{r.f()}if(i&&i.length){var g=[];g.push({label:"Done",condition:a}),g.push({label:t.translate.instant("Undone"),condition:c}),g.push("-");var h,p=_createForOfIteratorHelper(i);try{for(p.s();!(h=p.n()).done;){var v=h.value;g.push(v.name),g=g.concat(v.filter)}}catch(S){p.e(S)}finally{p.f()}t.stateFilterOptions.options=g}if(o&&o.length){var k,_=[],y=_createForOfIteratorHelper(o);try{for(y.s();!(k=y.n()).done;){var C=k.value;_.push(C.name),_=_.concat(C.filter)}}catch(S){y.e(S)}finally{y.f()}_.push("-"),_.push({label:t.translate.instant("No recommendation"),condition:null}),t.recommendationFilterOptions.options=_}t.setFilterDefinitions()}}))}},{key:"isWorkflowEnabled",value:function(t){return t===this.enabledWorkflows.motion||this.enabledWorkflows.statuteEnabled&&t===this.enabledWorkflows.statute}}]),n}(u.a);return t.\u0275fac=function(e){return new(e||t)(g.dc(a.a),g.dc(i.a),g.dc(c.a),g.dc(r.a),g.dc(s.a),g.dc(m.a),g.dc(l.a),g.dc(h.k),g.dc(o.a),g.dc(b.a))},t.\u0275prov=g.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},QDTn:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionDetailModule",(function(){return Nc}));var i=n("ofXK"),o=n("PCNd"),a=n("tyNb"),c=n("mrSG"),r=n("3Pt+"),s=n("dOok"),l=n("+KbT"),m=n("F48D"),u=n("mV3u"),b=n("VaoK"),d=n("fXoL"),f=n("jhN1"),g=n("sYmb"),h=n("dNgK"),p=n("mksl"),v=n("xHqg"),k=n("fB2i"),_=n("bTqV"),y=n("bSwM"),C=n("QibW"),S=n("7jBc");function M(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",15),d.hc("click",(function(){return d.Ic(n),d.lc(),d.Ec(10).next()})),d.Zb(2,"span",16),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc();d.Gb(1),d.tc("disabled",0===i.contentForm.value.selectedParagraphs.length),d.Gb(2),d.Tc(d.nc(4,2,"Next"))}}function I(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",17),d.hc("click",(function(){return d.Ic(n),d.lc(),d.Ec(10).previous()})),d.Zb(2,"span",16),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Yb(),d.Yb()}2&t&&(d.Gb(3),d.Tc(d.nc(4,1,"Previous")))}function T(t,e){1&t&&(d.Sc(0),d.mc(1,"translate")),2&t&&d.Tc(d.nc(1,1,"Select paragraphs"))}function w(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-checkbox",22),d.hc("click",(function(t){return d.Ic(n),d.lc(2).checkboxClicked(t)})),d.Yb()}if(2&t){var i=d.lc().$implicit,o=d.lc();d.tc("checked",o.isParagraphSelected(i))}}function G(t,e){if(1&t&&d.Ub(0,"mat-radio-button",23),2&t){var n=d.lc().$implicit,i=d.lc();d.tc("checked",i.isParagraphSelected(n))}}function x(t,e){if(1&t){var n=d.ac();d.Zb(0,"section",18),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc().onParagraphClicked(t)})),d.Qc(1,w,1,1,"mat-checkbox",19),d.Qc(2,G,1,1,"mat-radio-button",20),d.Ub(3,"div",21),d.mc(4,"trust"),d.Yb()}if(2&t){var i=e.$implicit,o=e.index,a=d.lc();d.Kb("active",a.isParagraphSelected(i)),d.Gb(1),d.tc("ngIf",a.multipleParagraphsAllowed),d.Gb(1),d.tc("ngIf",!a.multipleParagraphsAllowed),d.Gb(1),d.tc("innerHTML",d.oc(4,5,a.getParagraphPreview(o),"html"),d.Jc)}}function Y(t,e){1&t&&(d.Sc(0),d.mc(1,"translate")),2&t&&d.Tc(d.nc(1,1,"Change paragraph"))}function Z(t,e){if(1&t&&(d.Zb(0,"span",26),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Vc(" ",d.nc(2,2,"Line")," ",n.lineFrom,":")}}function O(t,e){if(1&t&&(d.Zb(0,"span",26),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Wc(" ",d.nc(2,3,"Line")," ",n.lineFrom," - ",n.lineTo-1,":")}}function R(t,e){if(1&t&&(d.Zb(0,"section"),d.Zb(1,"h4"),d.Qc(2,Z,3,4,"span",24),d.Qc(3,O,3,5,"span",24),d.Yb(),d.Ub(4,"editor",25),d.Yb()),2&t){var n=e.$implicit,i=d.lc();d.Gb(2),d.tc("ngIf",n.lineFrom>=n.lineTo-1),d.Gb(1),d.tc("ngIf",n.lineFrom<n.lineTo-1),d.Gb(1),d.tc("formControlName","text_"+n.paragraphNo)("init",i.tinyMceSettings)}}function P(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"*"),d.Yb())}function F(t,e){1&t&&(d.Zb(0,"div",27),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"This field is required.")," "))}var N,L=((N=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l,m){var u;return _classCallCheck(this,n),(u=e.call(this,t,i,m)).translate=i,u.configService=o,u.formBuilder=a,u.repo=c,u.route=r,u.router=s,u.promptService=l,u.createForm(),u}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this.configService.get("motions_line_length").subscribe((function(e){t.lineLength=e,t.getMotionByUrl()})),this.configService.get("motions_reason_required").subscribe((function(e){t.reasonRequired=e})),this.configService.get("motions_amendments_multiple_paragraphs").subscribe((function(e){t.multipleParagraphsAllowed=e}))}},{key:"getMotionByUrl",value:function(){var t=this;this.route.params.subscribe((function(e){t.repo.getViewModelObservable(e.id).subscribe((function(e){e&&(t.paragraphs=t.repo.getParagraphsToChoose(e,t.lineLength),e.hasParent?(t.isAmendmentOfAmendment=!0,t.motion=e.parent,t.diffedParagraphs=t.repo.getDiffedParagraphToChoose(e,t.lineLength)):(t.isAmendmentOfAmendment=!1,t.motion=e))}))}))}},{key:"getParagraphPreview",value:function(t){return this.isAmendmentOfAmendment?this.diffedParagraphs[t].html:this.paragraphs[t].html}},{key:"cancelCreation",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(this.contentForm.dirty||this.contentForm.value.selectedParagraphs.length>0)){t.next=9;break}return e=this.translate.instant("Are you sure you want to discard this amendment?"),t.next=4,this.promptService.open(e);case 4:if(t.t0=t.sent,!t.t0){t.next=7;break}this.router.navigate([".."],{relativeTo:this.route});case 7:t.next=10;break;case 9:this.router.navigate([".."],{relativeTo:this.route});case 10:case"end":return t.stop()}}),t,this)})))}},{key:"createForm",value:function(){this.contentForm=this.formBuilder.group({selectedParagraphs:[[],r.G.required],reason:["",r.G.required]})}},{key:"isParagraphSelected",value:function(t){return!!this.contentForm.value.selectedParagraphs.find((function(e){return e.paragraphNo===t.paragraphNo}))}},{key:"checkboxClicked",value:function(t){t.preventDefault()}},{key:"setParagraph",value:function(t){var e=this;this.contentForm.value.selectedParagraphs.forEach((function(t){e.contentForm.removeControl("text_"+t.paragraphNo)})),this.contentForm.addControl("text_"+t.paragraphNo,new r.g(t.html,r.G.required)),this.contentForm.patchValue({selectedParagraphs:[t]})}},{key:"toggleParagraph",value:function(t){var e,n=this.contentForm.value.selectedParagraphs;this.isParagraphSelected(t)?(e=n.filter((function(e){return e.paragraphNo!==t.paragraphNo})),this.contentForm.patchValue({selectedParagraphs:e}),this.contentForm.removeControl("text_"+t.paragraphNo)):((e=Object.assign([],n)).push(t),e.sort((function(t,e){return t.paragraphNo<e.paragraphNo?-1:t.paragraphNo>e.paragraphNo?1:0})),this.contentForm.addControl("text_"+t.paragraphNo,new r.g(t.html,r.G.required)),this.contentForm.patchValue({selectedParagraphs:e}))}},{key:"onParagraphClicked",value:function(t){this.multipleParagraphsAllowed?this.toggleParagraph(t):this.setParagraph(t)}},{key:"saveAmendment",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i,o,a,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="",n=this.paragraphs.map((function(t,n){return c.contentForm.value.selectedParagraphs.find((function(t){return t.paragraphNo===n}))?(e=c.contentForm.value["text_"+n],c.contentForm.value["text_"+n]):null})),i=Object.assign(Object.assign({},this.contentForm.value),{title:this.translate.instant("Amendment to")+" "+this.motion.getIdentifierOrTitle(),text:e,parent_id:this.motion.id,category_id:this.motion.category_id,tags_id:this.motion.tags_id,motion_block_id:this.motion.motion_block_id,amendment_paragraphs:n}),(o=new b.a).deserialize(i),t.next=5,this.repo.create(o);case 5:a=t.sent,this.router.navigate(["./motions/"+a.id]);case 7:case"end":return t.stop()}}),t,this)})))}}]),n}(u.a)).\u0275fac=function(t){return new(t||N)(d.Tb(f.d),d.Tb(g.k),d.Tb(l.a),d.Tb(r.f),d.Tb(s.a),d.Tb(a.a),d.Tb(a.f),d.Tb(m.a),d.Tb(h.a))},N.\u0275cmp=d.Nb({type:N,selectors:[["os-amendment-create-wizard"]],features:[d.Db],decls:30,vars:22,consts:[["saveText","Create",3,"nav","editMode","isSaveButtonEnabled","saveEvent","cancelEditEvent"],[1,"title-slot"],[1,"extra-controls-slot"],[4,"ngIf"],[3,"formGroup","ngSubmit"],["linear",""],["matStepper",""],[3,"completed"],["matStepLabel",""],[1,"amendment-create-wizard-wrapper"],["class","paragraph-row",3,"active","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"ngClass"],["formControlName","reason","required","",3,"init"],["class","red-warning-text",4,"ngIf"],["mat-button","",3,"disabled","click"],[1,"upper"],["type","button","mat-button","",3,"click"],[1,"paragraph-row",3,"click"],["class","paragraph-select",3,"checked","click",4,"ngIf"],["class","paragraph-select",3,"checked",4,"ngIf"],[1,"paragraph-text","motion-text",3,"innerHTML"],[1,"paragraph-select",3,"checked","click"],[1,"paragraph-select",3,"checked"],["class","line-number",4,"ngIf"],[3,"formControlName","init"],[1,"line-number"],[1,"red-warning-text"]],template:function(t,e){if(1&t&&(d.Zb(0,"os-head-bar",0),d.hc("saveEvent",(function(){return e.saveAmendment()}))("cancelEditEvent",(function(){return e.cancelCreation()})),d.Zb(1,"div",1),d.Zb(2,"h2"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Yb(),d.Zb(5,"div",2),d.Qc(6,M,5,4,"div",3),d.Qc(7,I,5,3,"div",3),d.Yb(),d.Yb(),d.Zb(8,"form",4),d.hc("ngSubmit",(function(){return e.saveAmendment()})),d.Zb(9,"mat-horizontal-stepper",5,6),d.Zb(11,"mat-step",7),d.Qc(12,T,2,3,"ng-template",8),d.Zb(13,"div",9),d.Qc(14,x,5,8,"section",10),d.Yb(),d.Yb(),d.Zb(15,"mat-step"),d.Qc(16,Y,2,3,"ng-template",8),d.Zb(17,"h3"),d.Zb(18,"span"),d.Sc(19),d.mc(20,"translate"),d.Yb(),d.Yb(),d.Qc(21,R,5,4,"section",11),d.Zb(22,"h3",12),d.Zb(23,"span"),d.Sc(24),d.mc(25,"translate"),d.Yb(),d.Sc(26,"\xa0"),d.Qc(27,P,2,0,"span",3),d.Yb(),d.Ub(28,"editor",13),d.Qc(29,F,3,3,"div",14),d.Yb(),d.Yb(),d.Yb()),2&t){var n=d.Ec(10);d.tc("nav",!1)("editMode",!0)("isSaveButtonEnabled",1===n.selectedIndex),d.Gb(3),d.Tc(d.nc(4,16,"New amendment")),d.Gb(3),d.tc("ngIf",0===n.selectedIndex),d.Gb(1),d.tc("ngIf",1===n.selectedIndex),d.Gb(1),d.tc("formGroup",e.contentForm),d.Gb(3),d.tc("completed",e.contentForm.value.selectedParagraphs.length>0),d.Gb(3),d.tc("ngForOf",e.paragraphs),d.Gb(5),d.Tc(d.nc(20,18,"Amendment text")),d.Gb(2),d.tc("ngForOf",e.contentForm.value.selectedParagraphs),d.Gb(1),d.tc("ngClass",e.reasonRequired&&e.contentForm.get("reason").invalid&&(e.contentForm.get("reason").dirty||e.contentForm.get("reason").touched)?"red-warning-text":""),d.Gb(2),d.Tc(d.nc(25,20,"Reason")),d.Gb(3),d.tc("ngIf",e.reasonRequired),d.Gb(1),d.tc("init",e.tinyMceSettings),d.Gb(1),d.tc("ngIf",e.reasonRequired&&e.contentForm.get("reason").invalid&&(e.contentForm.get("reason").dirty||e.contentForm.get("reason").touched))}},directives:[p.a,i.t,r.I,r.t,r.k,v.a,v.b,v.d,i.s,i.q,k.a,r.s,r.i,r.D,_.b,y.a,C.a],pipes:[g.j,S.a],styles:[".amendment-create-wizard-wrapper .paragraph-row{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;cursor:pointer;padding:20px 0}.amendment-create-wizard-wrapper .paragraph-row.active{cursor:default}.amendment-create-wizard-wrapper .paragraph-row .paragraph-select{-ms-flex-preferred-size:50px;flex-basis:50px;-ms-flex-positive:0;flex-grow:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.amendment-create-wizard-wrapper .paragraph-row .paragraph-text{-ms-flex:1;flex:1}.amendment-create-wizard-wrapper .motion-text{padding-left:40px;position:relative}.amendment-create-wizard-wrapper .motion-text blockquote,.amendment-create-wizard-wrapper .motion-text li,.amendment-create-wizard-wrapper .motion-text ol,.amendment-create-wizard-wrapper .motion-text p,.amendment-create-wizard-wrapper .motion-text ul{margin-top:0;margin-bottom:0}.amendment-create-wizard-wrapper .motion-text li{padding-bottom:10px}.amendment-create-wizard-wrapper .motion-text ol,.amendment-create-wizard-wrapper .motion-text ul{margin-left:15px;margin-bottom:0}.amendment-create-wizard-wrapper .motion-text .os-line-number{display:inline-block;font-size:0;line-height:0;width:22px;height:22px;position:absolute;left:0;padding-right:55px}.amendment-create-wizard-wrapper .motion-text .os-line-number:after{content:attr(data-line-number);position:absolute;top:13px;vertical-align:top;color:grey;font-size:12px;font-weight:400}"],encapsulation:2}),N),E=n("iDj2"),Q=n("OwvW"),A=n("InfO"),j=n("iTQr"),U=n("pSLD"),D=n("D5Qf"),V=n("Mluu"),B=n("s3dr"),z=n("lv9T"),W=n("ZDbo"),q=n("a9XT"),$=n("AP8A"),H=n("KL36"),X=n("iu6c"),K=n("Izkr"),J=function(t){_inherits(n,t);var e=_createSuper(n);function n(t){var i;return _classCallCheck(this,n),(i=e.call(this,t)).getVerboseName=function(){throw new Error("This should not be used")},i}return _createClass(n,[{key:"motion",get:function(){return this._model}},{key:"submittersAsUsers",get:function(){return this._submitterUsers},set:function(t){this._submitterUsers=t,this._model.submitters_id=t.map((function(t){return t.id}))}}]),n}(n("jcOe").a),tt=n("2ErA"),et=n("3Y4h"),nt=n("VVsa"),it=n("AOla"),ot=n("f3I0"),at=n("Q5D0"),ct=n("y50V"),rt=n("SHqy"),st=n("ykax"),lt=n("T9hM"),mt=n("0IaG"),ut=n("4X/P");function bt(t,e){if(1&t&&(d.Zb(0,"mat-radio-button",12),d.Sc(1),d.Yb()),2&t){var n=e.$implicit;d.tc("value",n.value),d.Gb(1),d.Tc(n.title)}}function dt(t,e){if(1&t&&(d.Zb(0,"h4"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Sc(4),d.Yb()),2&t){var n=d.lc();d.Gb(2),d.Tc(d.nc(3,2,"Changed version in line")),d.Gb(2),d.Uc(" ",n.lineRange.from,": ")}}function ft(t,e){if(1&t&&(d.Zb(0,"h4"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Sc(4),d.Zb(5,"span"),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Sc(8),d.Yb()),2&t){var n=d.lc();d.Gb(2),d.Tc(d.nc(3,4,"Changed version in line")),d.Gb(2),d.Uc(" ",n.lineRange.from," "),d.Gb(2),d.Tc(d.nc(7,6,"to")),d.Gb(2),d.Uc(" ",n.lineRange.to-1,": ")}}var gt,ht,pt=((gt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s){var l;return _classCallCheck(this,n),(l=e.call(this,i,o,a)).data=t,l.translate=o,l.formBuilder=c,l.repo=r,l.dialogRef=s,l.editReco=!1,l.newReco=!1,l.replacementTypes=[{value:ut.b.TYPE_REPLACEMENT,title:l.translate.instant("Replacement")},{value:ut.b.TYPE_INSERTION,title:l.translate.instant("Insertion")},{value:ut.b.TYPE_DELETION,title:l.translate.instant("Deletion")}],l.editReco=t.editChangeRecommendation,l.newReco=t.newChangeRecommendation,l.changeReco=t.changeRecommendation,l.lineRange=t.lineRange,l.tinyMceSettings.toolbar="undo redo | bold italic underline strikethrough\n            | removeformat | bullist numlist | outdent indent | link charmap code",l.createForm(),l}return _createClass(n,[{key:"createForm",value:function(){this.contentForm=this.formBuilder.group({text:[this.changeReco.text,r.G.required],diffType:[this.changeReco.type,r.G.required],public:[!this.changeReco.internal]})}},{key:"saveChangeRecommendation",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.changeReco.updateChangeReco(this.contentForm.controls.diffType.value,this.contentForm.controls.text.value,!this.contentForm.controls.public.value),t.prev=1,!this.newReco){t.next=8;break}return t.next=5,this.repo.createByViewModel(this.changeReco);case 5:this.dialogRef.close(),t.next=11;break;case 8:return t.next=10,this.repo.update(this.changeReco.changeRecommendation,this.changeReco);case 10:this.dialogRef.close();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),this.raiseError(t.t0);case 16:case"end":return t.stop()}}),t,this,[[1,13]])})))}}]),n}(u.a)).\u0275fac=function(t){return new(t||gt)(d.Tb(mt.a),d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(r.f),d.Tb(U.a),d.Tb(mt.h))},gt.\u0275cmp=d.Nb({type:gt,selectors:[["os-motion-change-recommendation"]],features:[d.Db],decls:24,vars:17,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"motion-content",3,"formGroup","ngSubmit"],["formControlName","diffType"],["rGroup",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","text",3,"init"],["formControlName","public"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","mat-dialog-close",""],[3,"value"]],template:function(t,e){1&t&&(d.Zb(0,"h1",0),d.Sc(1),d.mc(2,"translate"),d.Yb(),d.Zb(3,"div",1),d.Zb(4,"form",2),d.hc("ngSubmit",(function(){return e.saveChangeRecommendation()})),d.Zb(5,"mat-radio-group",3,4),d.Qc(7,bt,2,2,"mat-radio-button",5),d.Yb(),d.Qc(8,dt,5,4,"h4",6),d.Qc(9,ft,9,8,"h4",6),d.Zb(10,"div"),d.Ub(11,"editor",7),d.Yb(),d.Zb(12,"mat-checkbox",8),d.Sc(13),d.mc(14,"translate"),d.Yb(),d.Yb(),d.Yb(),d.Zb(15,"div",9),d.Zb(16,"button",10),d.hc("click",(function(){return e.saveChangeRecommendation()})),d.Zb(17,"span"),d.Sc(18),d.mc(19,"translate"),d.Yb(),d.Yb(),d.Zb(20,"button",11),d.Zb(21,"span"),d.Sc(22),d.mc(23,"translate"),d.Yb(),d.Yb(),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,9,"New change recommendation")),d.Gb(3),d.tc("formGroup",e.contentForm),d.Gb(3),d.tc("ngForOf",e.replacementTypes),d.Gb(1),d.tc("ngIf",e.lineRange.to==e.lineRange.from+1),d.Gb(1),d.tc("ngIf",e.lineRange.to!=e.lineRange.from+1),d.Gb(2),d.tc("init",e.tinyMceSettings),d.Gb(2),d.Tc(d.nc(14,11,"Public")),d.Gb(5),d.Tc(d.nc(19,13,"Save")),d.Gb(4),d.Tc(d.nc(23,15,"Cancel")))},directives:[mt.i,mt.f,r.I,r.t,r.k,C.b,r.s,r.i,i.s,i.t,k.a,y.a,mt.c,_.b,mt.d,C.a],pipes:[g.j],styles:[""]}),gt),vt=n("kmnG"),kt=n("qFsG"),_t=((ht=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s){var l;return _classCallCheck(this,n),(l=e.call(this,i,o,a)).data=t,l.translate=o,l.formBuilder=c,l.repo=r,l.dialogRef=s,l.editReco=!1,l.newReco=!1,l.editReco=t.editChangeRecommendation,l.newReco=t.newChangeRecommendation,l.changeReco=t.changeRecommendation,l.createForm(),l}return _createClass(n,[{key:"createForm",value:function(){this.contentForm=this.formBuilder.group({title:[this.changeReco.text,r.G.required],public:[!this.changeReco.internal]})}},{key:"saveChangeRecommendation",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.changeReco.updateChangeReco(ut.b.TYPE_REPLACEMENT,this.contentForm.controls.title.value,!this.contentForm.controls.public.value),t.prev=1,!this.newReco){t.next=8;break}return t.next=5,this.repo.createByViewModel(this.changeReco);case 5:this.dialogRef.close(),t.next=11;break;case 8:return t.next=10,this.repo.update(this.changeReco.changeRecommendation,this.changeReco);case 10:this.dialogRef.close();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t.catch(1),this.raiseError(t.t0);case 16:case"end":return t.stop()}}),t,this,[[1,13]])})))}}]),n}(u.a)).\u0275fac=function(t){return new(t||ht)(d.Tb(mt.a),d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(r.f),d.Tb(U.a),d.Tb(mt.h))},ht.\u0275cmp=d.Nb({type:ht,selectors:[["os-title-motion-change-recommendation-dialog"]],features:[d.Db],decls:20,vars:16,consts:[["mat-dialog-title",""],[1,"motion-content",3,"formGroup","ngSubmit"],["matInput","","formControlName","title",3,"placeholder"],["formControlName","public"],["mat-button","",3,"click"],["mat-button","","mat-dialog-close",""]],template:function(t,e){1&t&&(d.Zb(0,"h1",0),d.Sc(1),d.mc(2,"translate"),d.Yb(),d.Zb(3,"mat-dialog-content"),d.Zb(4,"form",1),d.hc("ngSubmit",(function(){return e.saveChangeRecommendation()})),d.Zb(5,"mat-form-field"),d.Ub(6,"input",2),d.mc(7,"translate"),d.Yb(),d.Zb(8,"mat-checkbox",3),d.Sc(9),d.mc(10,"translate"),d.Yb(),d.Yb(),d.Yb(),d.Zb(11,"mat-dialog-actions"),d.Zb(12,"button",4),d.hc("click",(function(){return e.saveChangeRecommendation()})),d.Zb(13,"span"),d.Sc(14),d.mc(15,"translate"),d.Yb(),d.Yb(),d.Zb(16,"button",5),d.Zb(17,"span"),d.Sc(18),d.mc(19,"translate"),d.Yb(),d.Yb(),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,6,"New change recommendation")),d.Gb(3),d.tc("formGroup",e.contentForm),d.Gb(2),d.uc("placeholder",d.nc(7,8,"Changed title")),d.Gb(3),d.Tc(d.nc(10,10,"Public")),d.Gb(5),d.Tc(d.nc(15,12,"Save")),d.Gb(4),d.Tc(d.nc(19,14,"Cancel")))},directives:[mt.i,mt.f,r.I,r.t,r.k,vt.c,kt.b,r.c,r.s,r.i,y.a,mt.c,_.b,mt.d],pipes:[g.j],styles:[".motion-content .mat-form-field{width:100%}.mat-dialog-content{overflow:hidden}"],encapsulation:2}),ht),yt=n("STbY"),Ct=n("NFeN"),St=n("vYAO"),Mt=n("40uZ"),It=n("3Xi6"),Tt=n("f0Cb"),wt=n("Tp2j"),Gt=n("Qu3c"),xt=n("Wp6s"),Yt=n("+B0n"),Zt=n("5N+Y");function Ot(t,e){if(1&t&&(d.Ub(0,"div",13),d.mc(1,"trust")),2&t){var n=d.lc(3).$implicit,i=d.lc();d.tc("innerHTML",d.oc(1,1,i.comments[n.id].comment,"html"),d.Jc)}}function Rt(t,e){1&t&&(d.Zb(0,"div",14),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"No comment")," "))}function Pt(t,e){if(1&t&&(d.Xb(0),d.Qc(1,Ot,2,4,"div",11),d.Qc(2,Rt,3,3,"div",12),d.Wb()),2&t){var n=d.lc(2).$implicit,i=d.lc();d.Gb(1),d.tc("ngIf",i.comments[n.id]),d.Gb(1),d.tc("ngIf",!i.comments[n.id]||!i.comments[n.id].comment)}}function Ft(t,e){if(1&t){var n=d.ac();d.Zb(0,"form",15),d.Zb(1,"editor",16),d.hc("onInit",(function(t){return d.Ic(n),d.lc(3).onInitTinyMce(t)}))("onRemove",(function(t){return d.Ic(n),d.lc(3).onLeaveTinyMce(t)})),d.Yb(),d.Yb()}if(2&t){var i=d.lc(2).$implicit,o=d.lc();d.tc("formGroup",o.commentForms[i.id]),d.Gb(1),d.tc("id",i.id)("init",o.tinyMceSettings)}}function Nt(t,e){1&t&&(d.Zb(0,"div"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Ub(4,"br"),d.Zb(5,"span",17),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,2,"Touch the book icon to enter text")),d.Gb(4),d.Tc(d.nc(7,4,"Do not forget to save your changes!")))}function Lt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",18),d.hc("click",(function(){d.Ic(n);var t=d.lc(2).$implicit;return d.lc().editComment(t)})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"edit"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Edit"))}function Et(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",18),d.hc("click",(function(){d.Ic(n);var t=d.lc(2).$implicit;return d.lc().pdfExportSection(t)})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"picture_as_pdf"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Export comment"))}function Qt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",19),d.hc("click",(function(){d.Ic(n);var t=d.lc(2).$implicit;return d.lc().saveComment(t)})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"save"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Save"))}function At(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",18),d.hc("click",(function(){d.Ic(n);var t=d.lc(2).$implicit;return d.lc().cancelEditing(t)})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"close"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Cancel edit"))}function jt(t,e){if(1&t&&(d.Zb(0,"os-meta-text-block",3),d.Xb(1,4),d.Zb(2,"span"),d.Sc(3),d.Yb(),d.Wb(),d.Xb(4,5),d.Qc(5,Pt,3,2,"ng-container",6),d.Qc(6,Ft,2,3,"form",7),d.Qc(7,Nt,8,6,"div",6),d.Wb(),d.Xb(8,8),d.Qc(9,Lt,4,3,"button",9),d.Qc(10,Et,4,3,"button",9),d.Qc(11,Qt,4,3,"button",10),d.Qc(12,At,4,3,"button",9),d.Wb(),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc();d.tc("showActionRow",i.canEditSection(n)||i.comments[n.id].comment)("disableExpandControl",i.isCommentEdited(n)),d.Gb(3),d.Tc(n.getTitle()),d.Gb(2),d.tc("ngIf",!i.isCommentEdited(n)),d.Gb(1),d.tc("ngIf",i.isCommentEdited(n)),d.Gb(1),d.tc("ngIf",i.saveHint),d.Gb(2),d.tc("ngIf",!i.isCommentEdited(n)&&i.canEditSection(n)),d.Gb(1),d.tc("ngIf",!i.commentForms[n.id]&&(null==i.comments[n.id]?null:i.comments[n.id].comment)),d.Gb(1),d.tc("ngIf",i.isCommentEdited(n)),d.Gb(1),d.tc("ngIf",i.isCommentEdited(n))}}function Ut(t,e){if(1&t&&(d.Zb(0,"div",1),d.Qc(1,jt,13,10,"os-meta-text-block",2),d.Yb()),2&t){var n=e.$implicit,i=d.lc();d.Gb(1),d.tc("ngIf",i.sectionVisible(n))}}var Dt,Vt=((Dt=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s){var l;return _classCallCheck(this,n),(l=e.call(this,c,r,s)).commentRepo=t,l.formBuilder=i,l.operator=o,l.pdfService=a,l.sections=[],l.commentForms={},l.comments={},l.error=!1,l}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this.subscriptions.push(this.commentRepo.getViewModelListObservable().subscribe((function(e){e&&e.length&&(t.sections=e,t.filterSections())})))}},{key:"filterSections",value:function(){var t=this;this.sections&&this.sections.length&&(this.sections=this.sections.filter((function(e){var n;return(n=t.operator).isInGroupIds.apply(n,_toConsumableArray(e.read_groups_id))})),this.updateComments())}},{key:"canEditSection",value:function(t){var e;return(e=this.operator).isInGroupIds.apply(e,_toConsumableArray(t.write_groups_id))}},{key:"updateComments",value:function(){var t=this;this.comments={},this.motion&&this.sections&&this.sections.forEach((function(e){t.comments[e.id]=t.motion.getCommentForSection(e)}))}},{key:"editComment",value:function(t){var e=this.comments[t.id],n=this.formBuilder.group({comment:[e?e.comment:""]});this.commentForms[t.id]=n}},{key:"saveComment",value:function(t){var e=this,n=this.commentForms[t.id].get("comment").value;this.commentRepo.saveComment(this.motion,t,n).then((function(){e.cancelEditing(t)}),(function(n){e.error=!0,e.raiseError("".concat(n,' :"').concat(t.name,'"'))}))}},{key:"cancelEditing",value:function(t){delete this.commentForms[t.id]}},{key:"sectionVisible",value:function(t){return!!(this.canEditSection(t)||this.comments[t.id]&&this.comments[t.id].comment)}},{key:"isCommentEdited",value:function(t){return Object.keys(this.commentForms).includes(""+t.id)}},{key:"pdfExportSection",value:function(t){this.pdfService.exportComment(t,this.motion)}},{key:"motion",set:function(t){this._motion=t,this.updateComments()},get:function(){return this._motion}}]),n}(u.a)).\u0275fac=function(t){return new(t||Dt)(d.Tb(Yt.a),d.Tb(r.f),d.Tb(Q.a),d.Tb(ct.a),d.Tb(f.d),d.Tb(g.k),d.Tb(h.a))},Dt.\u0275cmp=d.Nb({type:Dt,selectors:[["os-motion-comments"]],inputs:{motion:"motion"},features:[d.Db],decls:1,vars:1,consts:[["class","text-warning",4,"ngFor","ngForOf"],[1,"text-warning"],["icon","comment",3,"showActionRow","disableExpandControl",4,"ngIf"],["icon","comment",3,"showActionRow","disableExpandControl"],[1,"meta-text-block-title"],[1,"meta-text-block-content"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"meta-text-block-action-row"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","click",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["class","no-content",4,"ngIf"],[3,"innerHTML"],[1,"no-content"],[3,"formGroup"],["formControlName","comment",3,"id","init","onInit","onRemove"],[1,"red-warning-text"],["mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"]],template:function(t,e){1&t&&d.Qc(0,Ut,2,1,"div",0),2&t&&d.tc("ngForOf",e.sections)},directives:[i.s,i.t,Zt.a,r.I,r.t,r.k,k.a,r.s,r.i,_.b,Gt.c,Ct.a],pipes:[S.a,g.j],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),Dt);function Bt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",8),d.hc("click",(function(){return d.Ic(n),d.lc().editPersonalNote()})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"edit"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Edit"))}function zt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",8),d.hc("click",(function(){return d.Ic(n),d.lc().printPersonalNote()})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"picture_as_pdf"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Export personal note only"))}function Wt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",9),d.hc("click",(function(){return d.Ic(n),d.lc().savePersonalNote()})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"save"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Save"))}function qt(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",8),d.hc("click",(function(){return d.Ic(n),d.lc().isEditMode=!1})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"close"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Cancel edit"))}function $t(t,e){if(1&t&&(d.Ub(0,"div",12),d.mc(1,"trust")),2&t){var n=d.lc(2);d.tc("innerHTML",d.oc(1,1,n.personalNoteText,"html"),d.Jc)}}function Ht(t,e){1&t&&(d.Zb(0,"div",13),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"No personal note")," "))}function Xt(t,e){if(1&t&&(d.Xb(0),d.Qc(1,$t,2,4,"div",10),d.Qc(2,Ht,3,3,"div",11),d.Wb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngIf",n.motion&&n.motion.personalNote),d.Gb(1),d.tc("ngIf",!n.motion||!n.motion.hasNotes)}}function Kt(t,e){if(1&t){var n=d.ac();d.Zb(0,"form",14),d.Zb(1,"editor",15),d.hc("onInit",(function(t){return d.Ic(n),d.lc().onInitTinyMce(t)}))("onRemove",(function(t){return d.Ic(n),d.lc().onLeaveTinyMce(t)})),d.Yb(),d.Yb()}if(2&t){var i=d.lc();d.tc("formGroup",i.personalNoteForm),d.Gb(1),d.tc("init",i.tinyMceSettings)}}function Jt(t,e){1&t&&(d.Zb(0,"div"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Ub(4,"br"),d.Zb(5,"span",16),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,2,"Touch the book icon to enter text")),d.Gb(4),d.Tc(d.nc(7,4,"Do not forget to save your changes!")))}var te,ee=((te=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r){var s;return _classCallCheck(this,n),(s=e.call(this,t,i,o)).personalNoteService=a,s.pdfService=r,s.isEditMode=!1,s.personalNoteForm=c.group({note:[""]}),s}return _createClass(n,[{key:"editPersonalNote",value:function(){this.personalNoteForm.reset(),this.personalNoteForm.patchValue({note:this.motion.personalNote?this.motion.personalNote.note:""}),this.isEditMode=!0}},{key:"savePersonalNote",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.motion.personalNote?(e=Object.assign({},this.motion.personalNote)).note=this.personalNoteForm.get("note").value:e={note:this.personalNoteForm.get("note").value,star:!1},t.prev=1,t.next=4,this.personalNoteService.savePersonalNote(this.motion.motion,e);case 4:this.isEditMode=!1,t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),this.raiseError(t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"printPersonalNote",value:function(){this.pdfService.exportPersonalNote(this.motion.personalNote,this.motion)}},{key:"personalNoteText",get:function(){return this.motion.personalNoteText}}]),n}(u.a)).\u0275fac=function(t){return new(t||te)(d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb($.a),d.Tb(r.f),d.Tb(ct.a))},te.\u0275cmp=d.Nb({type:te,selectors:[["os-personal-note"]],inputs:{motion:"motion"},features:[d.Db],decls:14,vars:11,consts:[["showActionRow","true","icon","speaker_notes",3,"disableExpandControl"],[1,"meta-text-block-title"],[1,"meta-text-block-action-row"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","click",4,"ngIf"],[1,"meta-text-block-content"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],[3,"innerHTML",4,"ngIf"],["class","no-content",4,"ngIf"],[3,"innerHTML"],[1,"no-content"],[3,"formGroup"],["formControlName","note",3,"init","onInit","onRemove"],[1,"red-warning-text"]],template:function(t,e){1&t&&(d.Zb(0,"os-meta-text-block",0),d.Xb(1,1),d.Zb(2,"span"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Wb(),d.Xb(5,2),d.Qc(6,Bt,4,3,"button",3),d.Qc(7,zt,4,3,"button",3),d.Qc(8,Wt,4,3,"button",4),d.Qc(9,qt,4,3,"button",3),d.Wb(),d.Xb(10,5),d.Qc(11,Xt,3,2,"ng-container",6),d.Qc(12,Kt,2,2,"form",7),d.Qc(13,Jt,8,6,"div",6),d.Wb(),d.Yb()),2&t&&(d.tc("disableExpandControl",!0),d.Gb(3),d.Tc(d.nc(4,9,"Personal note")),d.Gb(3),d.tc("ngIf",!e.isEditMode),d.Gb(1),d.tc("ngIf",!e.isEditMode&&e.motion&&e.motion.personalNote&&e.motion.personalNote.note),d.Gb(1),d.tc("ngIf",e.isEditMode),d.Gb(1),d.tc("ngIf",e.isEditMode),d.Gb(2),d.tc("ngIf",!e.isEditMode),d.Gb(1),d.tc("ngIf",e.isEditMode),d.Gb(1),d.tc("ngIf",e.saveHint))},directives:[Zt.a,i.t,_.b,Gt.c,Ct.a,r.I,r.t,r.k,k.a,r.s,r.i],pipes:[g.j,S.a],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),te),ne=n("2Vo4"),ie=n("oJo9"),oe=n("8adq"),ae=n("A5z7"),ce=n("IBZR"),re=n("oqD5");function se(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",3),d.hc("click",(function(){return d.Ic(n),d.lc().onEdit()})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Yb()}}function le(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",7),d.Sc(1),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Tc(n.getTitle())}}function me(t,e){if(1&t&&(d.Zb(0,"mat-chip-list",5),d.Qc(1,le,2,1,"mat-basic-chip",6),d.Yb()),2&t){var n=e.$implicit;d.Gb(1),d.tc("ngIf",n)}}function ue(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,me,2,1,"mat-chip-list",4),d.Yb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngForOf",n.motion.submittersAsUsers)}}function be(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",11),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(2).onRemove(t)})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"close"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Remove"))}function de(t,e){if(1&t&&(d.Zb(0,"form",12),d.Zb(1,"mat-form-field"),d.Ub(2,"os-search-value-selector",13),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.tc("formGroup",n.addSubmitterForm),d.Gb(2),d.uc("placeholder",d.nc(3,3,"Select or search new submitter ...")),d.tc("inputListValues",n.users)}}function fe(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"os-sorting-list",8),d.hc("sortEvent",(function(t){return d.Ic(n),d.lc().onSortingChange(t)})),d.Qc(2,be,4,3,"ng-template"),d.Yb(),d.Qc(3,de,4,5,"form",9),d.Zb(4,"p"),d.Zb(5,"button",10),d.hc("click",(function(){return d.Ic(n),d.lc().onSave()})),d.Zb(6,"span"),d.Sc(7),d.mc(8,"translate"),d.Yb(),d.Yb(),d.Zb(9,"button",10),d.hc("click",(function(){return d.Ic(n),d.lc().onCancel()})),d.Zb(10,"span"),d.Sc(11),d.mc(12,"translate"),d.Yb(),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc();d.Gb(1),d.tc("input",i.editSubmitterObservable)("live",!0)("count",!1),d.Gb(2),d.tc("ngIf",i.users&&i.users.value.length>0),d.Gb(4),d.Tc(d.nc(8,6,"Save")),d.Gb(4),d.Tc(d.nc(12,8,"Cancel"))}}var ge,he,pe=((ge=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,s,l){var m;return _classCallCheck(this,n),(m=e.call(this,t,i,o)).viewModelStore=a,m.motionRepository=c,m.userRepository=s,m.perms=l,m.editSubmitterSubject=new ne.a([]),m.isEditMode=!1,m.addSubmitterForm=new r.j({userId:new r.g([])}),m.editSubmitterObservable=m.editSubmitterSubject.asObservable(),m.addSubmitterForm.valueChanges.subscribe((function(t){t&&t.userId&&m.addNewSubmitter(t.userId)})),m}return _createClass(n,[{key:"onEdit",value:function(){this.isEditMode=!0,this.editSubmitterSubject.next(this.motion.submittersAsUsers),this.addSubmitterForm.reset(),this.users=this.userRepository.getViewModelListBehaviorSubject()}},{key:"onSave",value:function(){var t=this;this.motionRepository.setSubmitters(this.motion,this.editSubmitterSubject.getValue()).then((function(){return t.isEditMode=!1}),this.raiseError)}},{key:"onCancel",value:function(){this.isEditMode=!1}},{key:"addNewSubmitter",value:function(t){var e=this.editSubmitterSubject.getValue();e.map((function(t){return t.id})).includes(t)||(e.push(this.viewModelStore.get(oe.a,t)),this.editSubmitterSubject.next(e)),this.addSubmitterForm.reset()}},{key:"onSortingChange",value:function(t){this.editSubmitterSubject.next(t)}},{key:"onRemove",value:function(t){var e=this.editSubmitterSubject.getValue();this.editSubmitterSubject.next(e.filter((function(e){return e.id!==t.id})))}}]),n}(u.a)).\u0275fac=function(t){return new(t||ge)(d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(ie.a),d.Tb(s.a),d.Tb(W.a),d.Tb(ot.a))},ge.\u0275cmp=d.Nb({type:ge,selectors:[["os-manage-submitters"]],inputs:{motion:"motion"},features:[d.Db],decls:7,vars:6,consts:[[1,"title-font"],["class","small-button","type","button","mat-icon-button","","disableRipple","",3,"click",4,"ngIf"],[4,"ngIf"],["type","button","mat-icon-button","","disableRipple","",1,"small-button",3,"click"],["class","user",4,"ngFor","ngForOf"],[1,"user"],["disableRipple","",4,"ngIf"],["disableRipple",""],[3,"input","live","count","sortEvent"],[3,"formGroup",4,"ngIf"],["type","button","mat-button","",3,"click"],["type","button","mat-icon-button","",3,"matTooltip","click"],[3,"formGroup"],["formControlName","userId",1,"search-users",3,"placeholder","inputListValues"]],template:function(t,e){1&t&&(d.Zb(0,"h4"),d.Zb(1,"span",0),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Qc(4,se,3,0,"button",1),d.Yb(),d.Qc(5,ue,2,1,"div",2),d.Qc(6,fe,13,10,"div",2)),2&t&&(d.Gb(2),d.Tc(d.nc(3,4,"Submitters")),d.Gb(2),d.tc("ngIf",!e.isEditMode&&e.perms.isAllowed("change_metadata")),d.Gb(1),d.tc("ngIf",!e.isEditMode||!e.perms.isAllowed("change_metadata")),d.Gb(1),d.tc("ngIf",e.isEditMode&&e.perms.isAllowed("change_metadata")))},directives:[i.t,_.b,Ct.a,i.s,ae.d,ae.a,ce.a,Gt.c,r.I,r.t,r.k,vt.c,re.a,r.s,r.i],pipes:[g.j],styles:[".search-users[_ngcontent-%COMP%]{display:grid}.search-users[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}h4[_ngcontent-%COMP%]{margin:0}.small-button[_ngcontent-%COMP%]{width:20px;height:20px;line-height:inherit}.small-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:100%}.user[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{border-radius:16px!important;padding:5px 15px!important;margin:5px 0;border:1px solid #ddd;height:auto}"]}),ge),ve=n("+KR1"),ke=n("acQf"),_e=n("owL4"),ye=n("EHvM"),Ce=n("a9GI"),Se=((he=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c){var r;return _classCallCheck(this,n),(r=e.call(this,o,a)).translate=t,r.motionRepo=i,r.pdfService=c,r.configService.get("motions_pdf_ballot_papers_number").subscribe((function(t){return r.ballotCustomCount=t})),r.configService.get("motions_pdf_ballot_papers_selection").subscribe((function(t){return r.ballotCountSelection=t})),r}return _createClass(n,[{key:"printBallots",value:function(t,e,n){var i=this.motionRepo.getViewModel(t.motion_id),o="".concat(this.translate.instant("Motion")," - ").concat(i.identifier," - ").concat(this.translate.instant("ballot-paper"));e||(e="".concat(this.translate.instant("Motion")," - ").concat(i.identifier),i.polls.length>1&&(e+=" (".concat(this.translate.instant("Vote")," ").concat(i.polls.length,")"))),n||(n=i.title),n.length>90&&(n=n.substring(0,90)+"..."),this.pdfService.downloadWithBallotPaper(this.getPages(4,{sheetend:40,title:e,subtitle:n}),o,this.logo)}},{key:"createBallot",value:function(t){return{stack:[this.getHeader(),this.getTitle(t.title),this.getSubtitle(t.subtitle),this.createBallotOption(this.translate.instant("Yes")),this.createBallotOption(this.translate.instant("No")),this.createBallotOption(this.translate.instant("Abstain"))],margin:[0,0,0,t.sheetend]}}}]),n}(ye.a)).\u0275fac=function(t){return new(t||he)(d.dc(g.k),d.dc(s.a),d.dc(l.a),d.dc(W.a),d.dc(Ce.b))},he.\u0275prov=d.Pb({token:he,factory:he.\u0275fac,providedIn:"root"}),he),Me=n("c3p6"),Ie=n("M0z7"),Te=n("Xqcw"),we=n("pA48"),Ge=n("Xa2L");function xe(t,e){if(1&t&&(d.Zb(0,"div"),d.Ub(1,"os-poll-progress",3),d.Yb()),2&t){var n=d.lc();d.Gb(1),d.tc("poll",n.poll)}}function Ye(t,e){if(1&t){var n=d.ac();d.Zb(0,"div",8),d.Zb(1,"button",9),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(3).saveVote(t.vote)})),d.Zb(2,"mat-icon"),d.Sc(3),d.Yb(),d.Yb(),d.Zb(4,"span",10),d.Sc(5),d.mc(6,"translate"),d.Yb(),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(3);d.Gb(1),d.tc("ngClass",o.currentVote&&o.currentVote.vote===i.vote?i.css:"")("disabled",o.deliveringVote),d.Gb(2),d.Uc(" ",i.icon,""),d.Gb(2),d.Uc(" ",d.nc(6,4,i.label)," ")}}function Ze(t,e){if(1&t&&(d.Zb(0,"div",6),d.Qc(1,Ye,7,6,"div",7),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngForOf",n.voteOptions)}}function Oe(t,e){1&t&&(d.Zb(0,"div",11),d.Ub(1,"mat-spinner",12),d.Ub(2,"br"),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Delivering vote... Please wait!")))}function Re(t,e){if(1&t&&(d.Xb(0),d.Qc(1,Ze,2,1,"div",4),d.Qc(2,Oe,6,3,"div",5),d.Wb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngIf",n.vmanager.canVote(n.poll)&&!n.deliveringVote),d.Gb(1),d.tc("ngIf",n.deliveringVote)}}function Pe(t,e){1&t&&(d.Zb(0,"div",13),d.Zb(1,"div"),d.Zb(2,"mat-icon",14),d.Sc(3," check_circle "),d.Yb(),d.Ub(4,"br"),d.Zb(5,"span"),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Yb(),d.Yb()),2&t&&(d.Gb(6),d.Tc(d.nc(7,1,"Voting successful.")))}var Fe,Ne=((Fe=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l){var m;return _classCallCheck(this,n),(m=e.call(this,t,i,o,a)).vmanager=c,m.pollRepo=r,m.promptService=s,m.cd=l,m.currentVote={},m.voteOptions=[{vote:"Y",css:"voted-yes",icon:"thumb_up",label:"Yes"},{vote:"N",css:"voted-no",icon:"thumb_down",label:"No"},{vote:"A",css:"voted-abstain",icon:"trip_origin",label:"Abstain"}],m}return _createClass(n,[{key:"saveVote",value:function(t){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var n,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentVote.vote=t,n=this.translate.instant("Submit selection now?"),i=this.translate.instant("Your decision cannot be changed afterwards."),e.next=4,this.promptService.open(n,i);case 4:if(e.t0=e.sent,!e.t0){e.next=7;break}this.deliveringVote=!0,this.cd.markForCheck(),this.pollRepo.vote(t,this.poll.id).catch(this.raiseError).finally((function(){o.deliveringVote=!1}));case 7:case"end":return e.stop()}}),e,this)})))}}]),n}(Te.a)).\u0275fac=function(t){return new(t||Fe)(d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(Q.a),d.Tb(Ie.b),d.Tb(ke.a),d.Tb(m.a),d.Tb(d.h))},Fe.\u0275cmp=d.Nb({type:Fe,selectors:[["os-motion-poll-vote"]],features:[d.Db],decls:4,vars:4,consts:[[4,"osPerms","osPermsAnd"],[4,"ngIf","ngIfElse"],["userHasVotes",""],[3,"poll"],["class","vote-button-grid",4,"ngIf"],["class","submit-vote-indicator",4,"ngIf"],[1,"vote-button-grid"],["class","vote-button",4,"ngFor","ngForOf"],[1,"vote-button"],["mat-raised-button","",3,"ngClass","disabled","click"],[1,"vote-label"],[1,"submit-vote-indicator"],[1,"small-spinner"],[1,"user-has-voted"],[1,"vote-submitted"]],template:function(t,e){if(1&t&&(d.Qc(0,xe,2,1,"div",0),d.Qc(1,Re,3,2,"ng-container",1),d.Qc(2,Pe,8,3,"ng-template",null,2,d.Rc)),2&t){var n=d.Ec(3);d.tc("osPerms","motions.can_manage_polls")("osPermsAnd",e.poll&&e.poll.isStarted),d.Gb(1),d.tc("ngIf",e.poll&&!e.poll.user_has_voted)("ngIfElse",n)}},directives:[It.a,i.t,we.a,i.s,_.b,i.q,Ct.a,Ge.c],pipes:[g.j],styles:[".yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.vote-button-grid[_ngcontent-%COMP%]{display:grid;grid-gap:20px;margin-top:2em;grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}.submit-vote-indicator[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.submit-vote-indicator[_ngcontent-%COMP%]   .mat-spinner[_ngcontent-%COMP%]{margin:auto}.vote-button[_ngcontent-%COMP%]{display:inline-grid;grid-gap:1em;margin:auto}.user-has-voted[_ngcontent-%COMP%], .vote-button[_ngcontent-%COMP%]   .vote-label[_ngcontent-%COMP%]{text-align:center}.user-has-voted[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.user-has-voted[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:1em;margin-left:auto;margin-right:auto}.user-has-voted[_ngcontent-%COMP%]   .vote-submitted[_ngcontent-%COMP%]{color:#4caf50;font-size:200%}"],changeDetection:0}),Fe),Le=n("iCsr"),Ee=n("j7f2"),Qe=n("QUb3");function Ae(t,e){if(1&t&&(d.Zb(0,"span",21),d.Zb(1,"button",22),d.Zb(2,"mat-icon",23),d.Sc(3,"more_horiz"),d.Yb(),d.Yb(),d.Yb()),2&t){d.lc(2);var n=d.Ec(8);d.Gb(1),d.tc("matMenuTriggerFor",n)}}function je(t,e){if(1&t){var n=d.ac();d.Zb(0,"span"),d.Zb(1,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(2).openVotingWarning()})),d.Zb(2,"mat-icon"),d.Sc(3," warning "),d.Yb(),d.Yb(),d.Yb()}}function Ue(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.Uc(" ",d.nc(2,1,n.poll.typeVerbose)," \xb7 ")}}function De(t,e){if(1&t&&(d.Xb(0),d.Sc(1),d.mc(2,"translate"),d.Wb()),2&t){var n=d.lc(3);d.Gb(1),d.Uc(" ",d.nc(2,1,n.poll.nextStateActionVerbose)," ")}}function Ve(t,e){1&t&&(d.Xb(0),d.Sc(1),d.mc(2,"translate"),d.Wb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"In progress, please wait...")," "))}function Be(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",25),d.hc("click",(function(){d.Ic(n);var t=d.lc(2);return t.changeState(t.poll.nextState)})),d.Zb(2,"mat-icon"),d.Sc(3),d.Yb(),d.Zb(4,"span",26),d.Qc(5,De,3,3,"ng-container",17),d.Qc(6,Ve,3,3,"ng-container",17),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(1),d.tc("ngClass",i.pollStateActions[i.poll.state].css)("disabled",i.stateChangePending),d.Gb(2),d.Uc(" ",i.pollStateActions[i.poll.state].icon,""),d.Gb(2),d.tc("ngIf",!i.stateChangePending),d.Gb(1),d.tc("ngIf",i.stateChangePending)}}function ze(t,e){if(1&t&&(d.Xb(0),d.Ub(1,"os-motion-poll-vote",27),d.Wb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("poll",n.poll)}}function We(t,e){if(1&t&&(d.Zb(0,"a",28),d.mc(1,"translate"),d.Zb(2,"mat-icon",23),d.Sc(3," visibility "),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.uc("matTooltip",d.nc(1,2,"More")),d.tc("routerLink",n.pollLink)}}function qe(t,e){if(1&t&&(d.Zb(0,"mat-card",9),d.Zb(1,"div",10),d.Zb(2,"div",11),d.Zb(3,"span",12),d.Zb(4,"a",13),d.Sc(5),d.mc(6,"translate"),d.Yb(),d.Yb(),d.Yb(),d.Qc(7,Ae,4,1,"span",14),d.Yb(),d.Zb(8,"div",15),d.Qc(9,je,4,0,"span",16),d.Qc(10,Ue,3,3,"span",17),d.Zb(11,"span"),d.Sc(12),d.mc(13,"translate"),d.Yb(),d.Yb(),d.Qc(14,Be,7,5,"div",16),d.Qc(15,ze,2,1,"ng-container",18),d.Zb(16,"div",19),d.Qc(17,We,4,4,"a",20),d.Yb(),d.Yb()),2&t){var n=d.lc(),i=d.Ec(2);d.Gb(4),d.tc("routerLink",n.pollLink),d.Gb(1),d.Uc(" ",d.nc(6,12,n.poll.title)," "),d.Gb(2),d.tc("osPerms","motions.can_manage_polls"),d.Gb(2),d.tc("osPerms","motions.can_manage_polls")("osPermsAnd","pseudoanonymous"===n.poll.type),d.Gb(1),d.tc("ngIf",n.pollService.isElectronicVotingEnabled&&"analog"!==n.poll.type),d.Gb(2),d.Uc(" ",d.nc(13,14,n.poll.stateVerbose)," "),d.Gb(2),d.tc("osPerms","motions.can_manage_polls")("osPermsAnd",!n.hideChangeState),d.Gb(1),d.tc("ngIf",n.poll&&!n.poll.stateHasVotes&&"analog"!==n.poll.type)("ngIfElse",i),d.Gb(2),d.tc("ngIf",n.poll.isPublished)}}function $e(t,e){if(1&t&&(d.Zb(0,"div",29),d.Vb(1,30),d.Yb()),2&t){var n=d.lc(),i=d.Ec(4),o=d.Ec(6);d.Gb(1),d.tc("ngTemplateOutlet",n.poll.hasVotes&&n.poll.stateHasVotes?i:o)}}function He(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"pollPercentBase"),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc(3);d.Gb(1),d.Uc(" ",d.oc(2,1,n.value[0].amount,i.poll)," ")}}function Xe(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"os-icon-container",38),d.Sc(2),d.mc(3,"parsePollNumber"),d.Qc(4,He,3,4,"span",17),d.Yb(),d.Yb()),2&t){var n=e.$implicit;d.Ib(n.votingOption),d.Gb(1),d.tc("icon",n.value[0].icon),d.Gb(1),d.Uc(" ",d.nc(3,5,n.value[0].amount)," "),d.Gb(2),d.tc("ngIf",n.value[0].showPercent)}}function Ke(t,e){if(1&t&&(d.Ub(0,"os-charts",39),d.mc(1,"async")),2&t){var n=d.lc(3);d.tc("data",d.nc(1,1,n.chartDataSubject))}}function Je(t,e){if(1&t&&(d.Zb(0,"div",33),d.Zb(1,"div",34),d.Qc(2,Xe,5,7,"div",35),d.Yb(),d.Zb(3,"div",36),d.Qc(4,Ke,2,3,"os-charts",37),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("routerLink",n.pollLink),d.Gb(1),d.tc("ngForOf",n.reducedPollTableData)("ngForTrackBy",n.trackByIndex),d.Gb(1),d.tc("routerLink",n.pollLink),d.Gb(1),d.tc("ngIf",n.showChart)}}function tn(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"Counting of votes is in progress ...")," "))}function en(t,e){if(1&t&&(d.Zb(0,"div",40),d.Qc(1,tn,3,3,"span",17),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.poll.isFinished)}}function nn(t,e){if(1&t&&(d.Qc(0,Je,5,5,"div",31),d.Qc(1,en,2,1,"div",32)),2&t){var n=d.lc();d.tc("osPerms","motions.can_manage_polls")("osPermsOr",n.poll.isPublished),d.Gb(1),d.tc("osPerms","motions.can_manage_polls")("osPermsComplement",!0)}}function on(t,e){1&t&&(d.Zb(0,"div"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"Edit to enter votes.")," "))}function an(t,e){if(1&t&&d.Qc(0,on,3,3,"div",16),2&t){var n=d.lc();d.tc("osPerms","motions.can_manage_polls")("osPermsAnd","analog"===n.poll.type)}}function cn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",7),d.hc("click",(function(){return d.Ic(n),d.lc().openDialog()})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Edit")))}function rn(t,e){if(1&t&&d.Ub(0,"os-projector-button",41),2&t){var n=d.lc();d.tc("menuItem",!0)("object",n.poll)}}function sn(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Ub(1,"mat-divider"),d.Zb(2,"button",7),d.hc("click",(function(){return d.Ic(n),d.lc().refreshPoll()})),d.Zb(3,"mat-icon"),d.Sc(4,"refresh"),d.Yb(),d.Zb(5,"span"),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Yb(),d.Zb(8,"button",7),d.hc("click",(function(){return d.Ic(n),d.lc().resetState()})),d.Zb(9,"mat-icon",42),d.Sc(10,"replay"),d.Yb(),d.Zb(11,"span"),d.Sc(12),d.mc(13,"translate"),d.Yb(),d.Yb(),d.Zb(14,"button",7),d.hc("click",(function(){return d.Ic(n),d.lc().deletePoll()})),d.Zb(15,"mat-icon",42),d.Sc(16,"delete"),d.Yb(),d.Zb(17,"span"),d.Sc(18),d.mc(19,"translate"),d.Yb(),d.Yb(),d.Yb()}2&t&&(d.Gb(6),d.Tc(d.nc(7,3,"Refresh")),d.Gb(6),d.Tc(d.nc(13,5,"Reset state")),d.Gb(6),d.Tc(d.nc(19,7,"Delete")))}var ln,mn=((ln=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l,m,u){var b;return _classCallCheck(this,n),(b=e.call(this,t,i,s,c,o,r,a)).dialog=c,b.pollRepo=r,b.translate=s,b.pollService=l,b.pdfService=m,b.operator=u,b}return _createClass(n,[{key:"openVotingWarning",value:function(){this.dialog.open(_e.a,K.a)}},{key:"downloadPdf",value:function(){this.pdfService.printBallots(this.poll)}},{key:"deletePoll",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Are you sure you want to delete this vote?"),n=this.poll.getTitle(),t.next=3,this.promptService.open(e,n);case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}this.repo.delete(this.poll).catch(this.raiseError);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"poll",set:function(t){this.initPoll(t);var e=this.pollService.generateChartData(t);this.chartDataSubject.next(e)},get:function(){return this._poll}},{key:"pollLink",get:function(){return"/motions/polls/"+this.poll.id}},{key:"showChart",get:function(){return this.pollService.showChart(this.poll)}},{key:"reducedPollTableData",get:function(){return this.pollService.generateTableData(this.poll).filter((function(t){return["yes","no","abstain","votesinvalid"].includes(t.votingOption)}))}},{key:"showPoll",get:function(){return!(!this.poll||!(this.operator.hasPerms(Q.b.motionsCanManagePolls)||this.poll.isPublished||this.poll.isEVoting&&!this.poll.isCreated))}},{key:"isEVotingEnabled",get:function(){return this.pollService.isElectronicVotingEnabled}}]),n}(Me.a)).\u0275fac=function(t){return new(t||ln)(d.Tb(f.d),d.Tb(h.a),d.Tb(m.a),d.Tb(rt.a),d.Tb(mt.b),d.Tb(ke.a),d.Tb(g.k),d.Tb(st.a),d.Tb(Se),d.Tb(Q.a))},ln.\u0275cmp=d.Nb({type:ln,selectors:[["os-motion-poll"]],inputs:{poll:"poll"},features:[d.Db],decls:18,vars:7,consts:[["class","motion-poll-wrapper",4,"ngIf"],["votingResult",""],["viewTemplate",""],["emptyTemplate",""],["pollDetailMenu","matMenu"],["mat-menu-item","",3,"click",4,"osPerms"],[3,"menuItem","object",4,"osPerms"],["mat-menu-item","",3,"click"],[4,"osPerms"],[1,"motion-poll-wrapper"],[1,"poll-title-wrapper"],[1,"poll-title-area"],[1,"poll-title"],[3,"routerLink"],["class","poll-actions",4,"osPerms"],[1,"italic","spacer-bottom-20"],[4,"osPerms","osPermsAnd"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"poll-detail-button-wrapper"],["mat-icon-button","",3,"routerLink","matTooltip",4,"ngIf"],[1,"poll-actions"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"small-icon"],["mat-icon-button","","color","warn",3,"click"],["mat-stroked-button","",3,"ngClass","disabled","click"],[1,"next-state-label"],[3,"poll"],["mat-icon-button","",3,"routerLink","matTooltip"],[1,"poll-link-wrapper"],[3,"ngTemplateOutlet"],["class","poll-chart-wrapper",4,"osPerms","osPermsOr"],["class","motion-couting-in-progress-hint",4,"osPerms","osPermsComplement"],[1,"poll-chart-wrapper"],[1,"vote-legend",3,"routerLink"],[3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"doughnut-chart",3,"routerLink"],["type","doughnut",3,"data",4,"ngIf"],["size","large",3,"icon"],["type","doughnut",3,"data"],[1,"motion-couting-in-progress-hint"],[3,"menuItem","object"],["color","warn"]],template:function(t,e){1&t&&(d.Qc(0,qe,18,16,"mat-card",0),d.Qc(1,$e,2,1,"ng-template",null,1,d.Rc),d.Qc(3,nn,2,4,"ng-template",null,2,d.Rc),d.Qc(5,an,1,2,"ng-template",null,3,d.Rc),d.Zb(7,"mat-menu",null,4),d.Qc(9,cn,6,3,"button",5),d.Qc(10,rn,1,2,"os-projector-button",6),d.Zb(11,"button",7),d.hc("click",(function(){return e.downloadPdf()})),d.Zb(12,"mat-icon"),d.Sc(13,"picture_as_pdf"),d.Yb(),d.Zb(14,"span"),d.Sc(15),d.mc(16,"translate"),d.Yb(),d.Yb(),d.Qc(17,sn,20,9,"div",8),d.Yb()),2&t&&(d.tc("ngIf",e.showPoll),d.Gb(9),d.tc("osPerms","motions.can_manage_polls"),d.Gb(1),d.tc("osPerms","core.can_manage_projector"),d.Gb(5),d.Tc(d.nc(16,5,"Ballot papers")),d.Gb(2),d.tc("osPerms","motions.can_manage_polls"))},directives:[i.t,yt.f,It.a,yt.c,Ct.a,xt.a,a.i,_.b,yt.e,i.q,Ne,_.a,Gt.c,i.A,a.g,i.s,St.a,Le.a,wt.a,Tt.a],pipes:[g.j,Ee.a,Qe.a,i.b],styles:['.yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.poll-link-wrapper[_ngcontent-%COMP%]{outline:none}.motion-poll-wrapper[_ngcontent-%COMP%]{margin-bottom:30px}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]{display:grid;grid-gap:10px;grid-template-areas:"title actions";grid-template-columns:auto -webkit-min-content;grid-template-columns:auto min-content}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-title-area[_ngcontent-%COMP%]{grid-area:title;margin-top:1em}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-title-area[_ngcontent-%COMP%]   .poll-title[_ngcontent-%COMP%]{font-size:125%}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-actions[_ngcontent-%COMP%]{grid-area:actions}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]{cursor:pointer;display:grid;grid-gap:20px;margin:2em;grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]   .doughnut-chart[_ngcontent-%COMP%]{display:block;max-width:200px;margin-top:auto;margin-bottom:auto}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]   .vote-legend[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{margin-top:20px}.poll-detail-button-wrapper[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;margin:auto 0}.poll-detail-button-wrapper[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{margin-left:auto}.next-state-label[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.motion-couting-in-progress-hint[_ngcontent-%COMP%]{margin-top:1em;font-style:italic}']}),ln),un=n("IZUe"),bn=n("d3UM"),dn=n("FKr1");function fn(t,e){if(1&t){var n=d.ac();d.Zb(0,"li",4),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(2).gotoReco(t)})),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(2);d.Pc("top",o.calcRecoTop(i))("height",o.calcRecoHeight(i)),d.Kb("delete",o.recoIsDeletion(i))("insert",o.recoIsInsertion(i))("replace",o.recoIsReplacement(i)),d.tc("title",i.getTitle())}}function gn(t,e){if(1&t&&(d.Zb(0,"ul",2),d.Qc(1,fn,1,11,"li",3),d.Yb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngForOf",n.getTextChangeRecommendations())}}var hn,pn=((hn=function(){function t(e,n,i,o){_classCallCheck(this,t),this.renderer=e,this.el=n,this.cd=i,this.operator=o,this.selectedFrom=null,this.createChangeRecommendation=new d.p,this.gotoChangeRecommendation=new d.p,this.showChangeRecommendations=!1,this.can_manage=!1,this.minLineNo=null,this.maxLineNo=null,this.operator.getUserObservable().subscribe(this.onPermissionsChanged.bind(this))}return _createClass(t,[{key:"update",value:function(){this.element&&(this.element.innerHTML=this.html,this.startCreating())}},{key:"onPermissionsChanged",value:function(){this.operator.hasPerms(Q.b.motionsCanManage)?(this.can_manage=!0,null===this.selectedFrom&&this.startCreating()):(this.can_manage=!1,this.selectedFrom=null,this.element&&Array.from(this.element.querySelectorAll(".os-line-number")).forEach((function(t){t.classList.remove("selectable"),t.classList.remove("selected")})))}},{key:"getTextChangeRecommendations",value:function(){var t=this;return this.changeRecommendations.filter((function(t){return!t.isTitleChange()})).filter((function(e){return e.line_from>=t.minLineNo&&e.line_from<=t.maxLineNo}))}},{key:"setLineNumberCache",value:function(){var t=this;Array.from(this.element.querySelectorAll(".os-line-number")).forEach((function(e){var n=parseInt(e.getAttribute("data-line-number"),10);(null===t.minLineNo||n<t.minLineNo)&&(t.minLineNo=n),(null===t.maxLineNo||n>t.maxLineNo)&&(t.maxLineNo=n)}))}},{key:"getAffectedLineNumbers",value:function(){var t=[];return this.changeRecommendations.forEach((function(e){if(!e.isTitleChange())for(var n=e.line_from;n<e.line_to;n++)t.push(n)})),t}},{key:"startCreating",value:function(){if(this.can_manage&&this.element){var t=this.getAffectedLineNumbers();Array.from(this.element.querySelectorAll(".os-line-number")).forEach((function(e){e.classList.remove("selected"),-1===t.indexOf(parseInt(e.getAttribute("data-line-number"),10))?e.classList.add("selectable"):e.classList.remove("selectable")}))}}},{key:"clickedLineNumber",value:function(t){null===this.selectedFrom?this.selectedFrom=t:(this.createChangeRecommendation.emit(t>this.selectedFrom?{from:this.selectedFrom,to:t+1}:{from:t,to:this.selectedFrom+1}),this.selectedFrom=null,this.startCreating())}},{key:"hoverLineNumber",value:function(t){var e=this;null!==this.selectedFrom&&Array.from(this.element.querySelectorAll(".os-line-number")).forEach((function(n){var i=parseInt(n.getAttribute("data-line-number"),10);i>=e.selectedFrom&&i<=t||i>=t&&i<=e.selectedFrom?n.classList.add("selected"):n.classList.remove("selected")}))}},{key:"calcRecoTop",value:function(t){return this.element.querySelector(".os-line-number.line-number-"+t.line_from.toString(10)).offsetTop.toString()+"px"}},{key:"calcRecoHeight",value:function(t){var e=this.element.querySelector(".os-line-number.line-number-"+t.line_from.toString(10)),n=this.element.querySelector(".os-line-number.line-number-"+t.line_to.toString(10));return n?(n.offsetTop-e.offsetTop).toString()+"px":"20px"}},{key:"recoIsInsertion",value:function(t){return t.type===ut.b.TYPE_INSERTION}},{key:"recoIsDeletion",value:function(t){return t.type===ut.b.TYPE_DELETION}},{key:"recoIsReplacement",value:function(t){return t.type===ut.b.TYPE_REPLACEMENT}},{key:"gotoReco",value:function(t){this.gotoChangeRecommendation.emit(t)}},{key:"ngOnInit",value:function(){var t=this;this.element=this.el.nativeElement.querySelector(".text"),this.renderer.listen(this.el.nativeElement,"click",(function(e){var n=e.target;n.classList.contains("os-line-number")&&n.classList.contains("selectable")&&t.clickedLineNumber(parseInt(n.getAttribute("data-line-number"),10))})),this.renderer.listen(this.el.nativeElement,"mouseover",(function(e){var n=e.target;n.classList.contains("os-line-number")&&n.classList.contains("selectable")&&t.hoverLineNumber(parseInt(n.getAttribute("data-line-number"),10))})),this.update(),window.setTimeout((function(){t.setLineNumberCache(),t.showChangeRecommendations=!0,t.cd.detectChanges()}),1)}},{key:"ngOnChanges",value:function(t){this.update()}}]),t}()).\u0275fac=function(t){return new(t||hn)(d.Tb(d.I),d.Tb(d.m),d.Tb(d.h),d.Tb(Q.a))},hn.\u0275cmp=d.Nb({type:hn,selectors:[["os-motion-detail-original-change-recommendations"]],inputs:{html:"html",changeRecommendations:"changeRecommendations"},outputs:{createChangeRecommendation:"createChangeRecommendation",gotoChangeRecommendation:"gotoChangeRecommendation"},features:[d.Eb],decls:2,vars:1,consts:[[1,"text"],["class","change-recommendation-list",4,"ngIf"],[1,"change-recommendation-list"],[3,"title","top","height","delete","insert","replace","click",4,"ngFor","ngForOf"],[3,"title","click"]],template:function(t,e){1&t&&(d.Ub(0,"div",0),d.Qc(1,gn,2,1,"ul",1)),2&t&&(d.Gb(1),d.tc("ngIf",e.showChangeRecommendations))},directives:[i.t,i.s],styles:[".change-recommendation-list[_ngcontent-%COMP%]{position:absolute;top:0;left:-10px;width:4px;list-style-type:none;padding:0;margin:0}.change-recommendation-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:absolute;width:4px;left:0;cursor:pointer;padding:0;margin:0}.change-recommendation-list[_ngcontent-%COMP%] > li.insert[_ngcontent-%COMP%]{background-color:#0a0}.change-recommendation-list[_ngcontent-%COMP%] > li.delete[_ngcontent-%COMP%]{background-color:#a00}.change-recommendation-list[_ngcontent-%COMP%] > li.replace[_ngcontent-%COMP%]{background-color:#0333ff}.change-recommendation-list[_ngcontent-%COMP%] > li.other[_ngcontent-%COMP%]{background-color:#777}.change-recommendation-list[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none}"]}),hn),vn=n("GEzB"),kn=n("30jZ");function _n(t,e){if(1&t&&(d.Zb(0,"span",16),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc(2);d.Gb(1),d.Vc(" ",d.nc(2,2,"Line")," ",i.formatLineRange(n)," ")}}function yn(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Title")))}function Cn(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" (",d.nc(2,1,"Change recommendation"),")"))}function Sn(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Vc(" (",d.nc(2,2,"Amendment")," ",n.getIdentifier(),")")}}function Mn(t,e){if(1&t&&(d.Zb(0,"span",17),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc(2);d.Gb(1),d.Uc(" \u2013 ",d.nc(2,1,i.getRecommendationTypeName(n))," ")}}function In(t,e){1&t&&(d.Xb(0),d.Sc(1," \u2013 "),d.Zb(2,"span"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Wb()),2&t&&(d.Gb(3),d.Tc(d.nc(4,1,"Rejected")))}function Tn(t,e){if(1&t&&(d.Xb(0),d.Sc(1),d.mc(2,"translate"),d.Wb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Uc(" \u2013 ",d.nc(2,1,n.stateName),"")}}function wn(t,e){if(1&t){var n=d.ac();d.Zb(0,"li"),d.Zb(1,"a",12),d.hc("click",(function(t){d.Ic(n);var i=e.$implicit;return d.lc(2).scrollToChangeClicked(i,t)})),d.Qc(2,_n,3,4,"span",13),d.Qc(3,yn,3,3,"span",3),d.Qc(4,Cn,3,3,"span",3),d.Qc(5,Sn,3,4,"span",3),d.Qc(6,Mn,3,3,"span",14),d.Zb(7,"span",15),d.Qc(8,In,5,3,"ng-container",3),d.Qc(9,Tn,3,3,"ng-container",3),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(2);d.Gb(1),d.Kb("amendment",o.isAmendment(i))("recommendation",o.isChangeRecommendation(i)),d.Gb(1),d.tc("ngIf",!i.isTitleChange()),d.Gb(1),d.tc("ngIf",i.isTitleChange()),d.Gb(1),d.tc("ngIf",o.isChangeRecommendation(i)),d.Gb(1),d.tc("ngIf",o.isAmendment(i)),d.Gb(1),d.tc("ngIf",o.isChangeRecommendation(i)),d.Gb(2),d.tc("ngIf",i.isRejected()&&!o.isAmendment(i)),d.Gb(1),d.tc("ngIf",(i.isAccepted()||o.isAmendment(i))&&i.stateName)}}function Gn(t,e){1&t&&(d.Zb(0,"div",18),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"No change recommendations yet")))}function xn(t,e){if(1&t&&(d.Zb(0,"section",10),d.Zb(1,"strong"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Zb(4,"ul"),d.Qc(5,wn,10,11,"li",4),d.Yb(),d.Qc(6,Gn,3,3,"div",11),d.Yb()),2&t){var n=d.lc();d.Gb(2),d.Uc(" ",d.nc(3,3,"Summary of changes"),": "),d.Gb(3),d.tc("ngForOf",n.changes),d.Gb(1),d.tc("ngIf",0===n.changes.length)}}var Yn=function(t){return{change:t}};function Zn(t,e){if(1&t&&(d.Zb(0,"button",26),d.Zb(1,"mat-icon"),d.Sc(2,"more_horiz"),d.Yb(),d.Yb()),2&t){var n=d.lc(2).ngIf;d.lc();var i=d.Ec(13);d.tc("matMenuTriggerFor",i)("matMenuTriggerData",d.zc(2,Yn,n))}}function On(t,e){if(1&t&&(d.Zb(0,"div",24),d.Qc(1,Zn,3,4,"button",25),d.Yb()),2&t){var n=d.lc().ngIf,i=d.lc();d.Gb(1),d.tc("ngIf",i.isRecommendation(n))}}function Rn(t,e){1&t&&(d.Zb(0,"div",27),d.Zb(1,"i",28),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"Rejected")))}function Pn(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"div"),d.Qc(2,On,2,1,"div",19),d.Qc(3,Rn,4,3,"div",20),d.Zb(4,"div",21),d.Zb(5,"div",22),d.Sc(6),d.mc(7,"translate"),d.Yb(),d.Ub(8,"div",23),d.mc(9,"trust"),d.Yb(),d.Yb(),d.Yb()),2&t){var n=e.ngIf,i=d.lc();d.Gb(1),d.Jb("diff-box diff-box-",n.getChangeId()," clearfix"),d.Gb(1),d.tc("osPerms","motions.can_manage"),d.Gb(1),d.tc("ngIf",n.isRejected()),d.Gb(1),d.Kb("line-numbers-none",i.isLineNumberingNone())("line-numbers-inline",i.isLineNumberingInline())("line-numbers-outside",i.isLineNumberingOutside()),d.Hb("data-change-id",n.getChangeId()),d.Gb(2),d.Uc("",d.nc(7,14,"Changed title"),":"),d.Gb(2),d.tc("innerHTML",d.oc(9,16,i.getFormattedTitleDiff(),"html"),d.Jc)}}function Fn(t,e){1&t&&(d.Zb(0,"div",31),d.Zb(1,"mat-icon",32),d.mc(2,"translate"),d.Sc(3,"warning"),d.Yb(),d.Yb()),2&t&&(d.Gb(1),d.uc("matTooltip",d.nc(2,1,"This change collides with another one.")))}function Nn(t,e){if(1&t&&(d.Zb(0,"button",26),d.Zb(1,"mat-icon"),d.Sc(2,"more_horiz"),d.Yb(),d.Yb()),2&t){var n=d.lc(2).$implicit;d.lc();var i=d.Ec(13);d.tc("matMenuTriggerFor",i)("matMenuTriggerData",d.zc(2,Yn,n))}}function Ln(t,e){if(1&t&&(d.Zb(0,"button",26),d.Zb(1,"mat-icon"),d.Sc(2,"more_horiz"),d.Yb(),d.Yb()),2&t){var n=d.lc(2).$implicit;d.lc();var i=d.Ec(10);d.tc("matMenuTriggerFor",i)("matMenuTriggerData",d.zc(2,Yn,n))}}function En(t,e){if(1&t&&(d.Zb(0,"div",24),d.Qc(1,Nn,3,4,"button",25),d.Qc(2,Ln,3,4,"button",25),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc();d.Gb(1),d.tc("ngIf",i.isRecommendation(n)),d.Gb(1),d.tc("ngIf",i.isAmendment(n))}}function Qn(t,e){1&t&&(d.Zb(0,"div",27),d.Zb(1,"i",28),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"Rejected")))}function An(t,e){if(1&t&&(d.Zb(0,"div",27),d.Zb(1,"i",28),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(2),d.Vc("",n.amendment.identifier," - ",d.nc(3,2,n.amendment.state.name),"")}}var jn=function(){return[]};function Un(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"div",5),d.Zb(2,"os-motion-detail-original-change-recommendations",6),d.hc("createChangeRecommendation",(function(t){return d.Ic(n),d.lc().onCreateChangeRecommendation(t)})),d.Yb(),d.Yb(),d.Zb(3,"div"),d.Qc(4,Fn,4,3,"div",29),d.Qc(5,En,3,2,"div",19),d.Qc(6,Qn,4,3,"div",20),d.Qc(7,An,4,4,"div",20),d.Ub(8,"div",30),d.mc(9,"trust"),d.Yb(),d.Yb()}if(2&t){var i=e.$implicit,o=e.index,a=d.lc();d.Gb(1),d.Kb("line-numbers-none",a.isLineNumberingNone())("line-numbers-inline",a.isLineNumberingInline())("line-numbers-outside",a.isLineNumberingOutside()),d.Gb(1),d.tc("html",a.getTextBetweenChanges(a.getAllTextChangingObjects()[o-1],i))("changeRecommendations",d.yc(28,jn)),d.Gb(1),d.Jb("diff-box diff-box-",i.getChangeId()," clearfix"),d.Kb("collides",a.hasCollissions(i,a.getAllTextChangingObjects())),d.Gb(1),d.tc("ngIf",a.hasCollissions(i,a.getAllTextChangingObjects())),d.Gb(1),d.tc("osPerms","motions.can_manage"),d.Gb(1),d.tc("ngIf",a.isChangeRecommendation(i)&&i.isRejected()),d.Gb(1),d.tc("ngIf",a.isAmendment(i)&&a.showAllAmendments),d.Gb(1),d.Kb("line-numbers-none",a.isLineNumberingNone())("line-numbers-inline",a.isLineNumberingInline())("line-numbers-outside",a.isLineNumberingOutside()),d.tc("innerHTML",d.oc(9,25,a.getDiff(i),"html"),d.Jc),d.Hb("data-change-id",i.getChangeId())}}function Dn(t,e){1&t&&d.Ub(0,"mat-divider")}function Vn(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xa0..."),d.Yb())}function Bn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",35),d.hc("click",(function(){d.Ic(n);var t=e.$implicit,i=d.lc().change;return d.lc().setAmendmentState(i,t.id)})),d.Sc(1),d.mc(2,"translate"),d.Qc(3,Vn,2,0,"span",3),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(1),d.Uc(" ",d.nc(2,2,i.name)," "),d.Gb(2),d.tc("ngIf",i.show_state_extension_field)}}function zn(t,e){1&t&&d.Ub(0,"mat-divider")}function Wn(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xa0..."),d.Yb())}function qn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",35),d.hc("click",(function(){d.Ic(n);var t=e.$implicit,i=d.lc().change;return d.lc().setAmendmentState(i,t.id)})),d.Zb(1,"mat-icon"),d.Sc(2,"arrow_back"),d.Yb(),d.Sc(3),d.mc(4,"translate"),d.Qc(5,Wn,2,0,"span",3),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(3),d.Uc(" ",d.nc(4,2,i.name)," "),d.Gb(2),d.tc("ngIf",i.show_state_extension_field)}}var $n=function(){return{back:"true"}};function Hn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",33),d.Zb(1,"mat-icon"),d.Sc(2,"visibility_on"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb(),d.Qc(6,Dn,1,0,"mat-divider",3),d.Qc(7,Bn,4,4,"button",34),d.Qc(8,zn,1,0,"mat-divider",3),d.Qc(9,qn,6,4,"button",34),d.Zb(10,"button",35),d.hc("click",(function(){d.Ic(n);var t=e.change;return d.lc().setAmendmentState(t,null)})),d.Zb(11,"mat-icon"),d.Sc(12,"replay"),d.Yb(),d.Sc(13),d.mc(14,"translate"),d.Yb()}if(2&t){var i=e.change;d.tc("routerLink",i.amendment.getDetailStateURL())("state",d.yc(12,$n)),d.Gb(4),d.Tc(d.nc(5,8,"Show amendment")),d.Gb(2),d.tc("ngIf",i.amendment.state.next_states.length>0),d.Gb(1),d.tc("ngForOf",i.amendment.state.next_states),d.Gb(1),d.tc("ngIf",i.amendment.state.next_states.length>0),d.Gb(1),d.tc("ngForOf",i.amendment.state.previous_states),d.Gb(4),d.Uc(" ",d.nc(14,10,"Reset state")," ")}}function Xn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",36),d.hc("click",(function(t){d.Ic(n);var e=d.lc().change;return d.lc().editChangeRecommendation(e,t)})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Edit")))}function Kn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",36),d.hc("click",(function(t){d.Ic(n);var e=d.lc().change;return d.lc().editTitleChangeRecommendation(e,t)})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Edit")))}function Jn(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",36),d.hc("click",(function(){d.Ic(n);var t=e.change;return d.lc().setAcceptanceValue(t,"accepted")})),d.Zb(1,"mat-icon"),d.Sc(2,"thumb_up"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Zb(6,"mat-icon",37),d.Sc(7),d.Yb(),d.Yb(),d.Zb(8,"button",36),d.hc("click",(function(){d.Ic(n);var t=e.change;return d.lc().setAcceptanceValue(t,"rejected")})),d.Zb(9,"mat-icon"),d.Sc(10,"thumb_down"),d.Yb(),d.Zb(11,"span"),d.Sc(12),d.mc(13,"translate"),d.Yb(),d.Zb(14,"mat-icon",37),d.Sc(15),d.Yb(),d.Yb(),d.Zb(16,"button",36),d.hc("click",(function(){d.Ic(n);var t=e.change;return d.lc().setInternal(t,!t.internal)})),d.Zb(17,"mat-icon"),d.Sc(18),d.Yb(),d.Zb(19,"span"),d.Sc(20),d.mc(21,"translate"),d.Yb(),d.Yb(),d.Zb(22,"button",36),d.hc("click",(function(t){d.Ic(n);var i=e.change;return d.lc().deleteChangeRecommendation(i,t)})),d.Zb(23,"mat-icon"),d.Sc(24,"delete"),d.Yb(),d.Zb(25,"span"),d.Sc(26),d.mc(27,"translate"),d.Yb(),d.Yb(),d.Qc(28,Xn,6,3,"button",38),d.Qc(29,Kn,6,3,"button",38)}if(2&t){var i=e.change;d.Gb(4),d.Tc(d.nc(5,9,"Accept")),d.Gb(3),d.Tc(i.isAccepted()?"done":""),d.Gb(5),d.Tc(d.nc(13,11,"Reject")),d.Gb(3),d.Tc(i.isRejected()?"done":""),d.Gb(3),d.Tc(i.internal?"check_box_outline_blank":"check_box"),d.Gb(2),d.Tc(d.nc(21,13,"Public")),d.Gb(6),d.Tc(d.nc(27,15,"Delete")),d.Gb(2),d.tc("ngIf",!i.isTitleChange()),d.Gb(1),d.tc("ngIf",i.isTitleChange())}}var ti,ei=((ti=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l,m,u,b){var f;return _classCallCheck(this,n),(f=e.call(this,t,i,o)).translate=i,f.diff=a,f.lineNumbering=c,f.recoRepo=r,f.motionRepo=s,f.dialogService=l,f.configService=m,f.el=u,f.promptService=b,f.getRecommendationTypeName=kn.a,f.createChangeRecommendation=new d.p,f.configService.get("motions_line_length").subscribe((function(t){return f.lineLength=t})),f.configService.get("motions_preamble").subscribe((function(t){return f.preamble=t})),f}return _createClass(n,[{key:"getTextBetweenChanges",value:function(t,e){var n,i={from:t?t.getLineTo():1,to:e?e.getLineFrom():null};return i.from>=i.to?"":(n=this.motion.isParagraphBasedAmendment()?this.motionRepo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!0).join("\n"):this.lineNumbering.insertLineNumbers(this.motion.text,this.lineLength),this.diff.extractMotionLineRange(n,i,!0,this.lineLength,this.highlightedLine))}},{key:"hasCollissions",value:function(t,e){return e.filter((function(e){return e.getChangeId()!==t.getChangeId()&&(e.getLineFrom()>=t.getLineFrom()&&e.getLineFrom()<t.getLineTo()||e.getLineTo()>t.getLineFrom()&&e.getLineTo()<=t.getLineTo()||e.getLineFrom()<t.getLineFrom()&&e.getLineTo()>t.getLineTo())})).length>0}},{key:"getDiff",value:function(t){var e;e=this.motion.isParagraphBasedAmendment()?this.motionRepo.getViewModel(this.motion.parent_id).text:this.motion.text;var n=this.lineNumbering.insertLineNumbers(e,this.lineLength);return this.diff.getChangeDiff(n,t,this.lineLength,this.highlightedLine)}},{key:"getTextRemainderAfterLastChange",value:function(){return this.lineLength?(t=this.motion.isParagraphBasedAmendment()?this.motionRepo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!0).join("\n"):this.lineNumbering.insertLineNumbers(this.motion.text,this.lineLength),this.diff.getTextRemainderAfterLastChange(t,this.changes,this.lineLength,this.highlightedLine)):"";var t}},{key:"formatLineRange",value:function(t){return t.getLineFrom()<t.getLineTo()-1?t.getLineFrom().toString(10)+" - "+(t.getLineTo()-1).toString(10):t.getLineFrom().toString(10)}},{key:"isRecommendation",value:function(t){return t.getChangeType()===vn.a.TYPE_CHANGE_RECOMMENDATION}},{key:"isLineNumberingNone",value:function(){return this.lineNumberingMode===et.d.None}},{key:"isLineNumberingInline",value:function(){return this.lineNumberingMode===et.d.Inside}},{key:"isLineNumberingOutside",value:function(){return this.lineNumberingMode===et.d.Outside}},{key:"isAmendment",value:function(t){return t.getChangeType()===vn.a.TYPE_AMENDMENT}},{key:"isChangeRecommendation",value:function(t){return t.getChangeType()===vn.a.TYPE_CHANGE_RECOMMENDATION}},{key:"getAllTextChangingObjects",value:function(){return this.changes.filter((function(t){return!t.isTitleChange()}))}},{key:"getTitleChangingObject",value:function(){return this.changes.find((function(t){return t.isTitleChange()}))}},{key:"getFormattedTitleDiff",value:function(){var t=this.getTitleChangingObject();return this.recoRepo.getTitleChangesAsDiff(this.motion.title,t)}},{key:"setAcceptanceValue",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0="accepted"===e,!n.t0){n.next=5;break}return n.next=5,this.recoRepo.setAccepted(t);case 5:if(n.t1="rejected"===e,!n.t1){n.next=9;break}return n.next=9,this.recoRepo.setRejected(t);case 9:n.next=14;break;case 11:n.prev=11,n.t2=n.catch(0),this.raiseError(n.t2);case 14:case"end":return n.stop()}}),n,this,[[0,11]])})))}},{key:"setInternal",value:function(t,e){this.recoRepo.setInternal(t,e).catch(this.raiseError)}},{key:"deleteChangeRecommendation",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.stopPropagation(),e.preventDefault(),i=this.translate.instant("Are you sure you want to delete this change recommendation?"),n.next=4,this.promptService.open(i);case 4:if(n.t0=n.sent,!n.t0){n.next=7;break}this.recoRepo.delete(t).catch(this.raiseError);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"editChangeRecommendation",value:function(t,e){e.stopPropagation(),e.preventDefault();var n={editChangeRecommendation:!0,newChangeRecommendation:!1,lineRange:{from:t.getLineFrom(),to:t.getLineTo()},changeRecommendation:t};this.dialogService.open(pt,Object.assign(Object.assign({},K.c),{data:n}))}},{key:"editTitleChangeRecommendation",value:function(t,e){e.stopPropagation(),e.preventDefault();var n={editChangeRecommendation:!0,newChangeRecommendation:!1,changeRecommendation:t};this.dialogService.open(_t,Object.assign(Object.assign({},K.c),{data:n}))}},{key:"setAmendmentState",value:function(t,e){this.motionRepo.setState(t.amendment,e).catch(this.raiseError)}},{key:"scrollToChangeElement",value:function(t){this.el.nativeElement.querySelector('[data-change-id="'+t.getChangeId()+'"]').scrollIntoView({behavior:"smooth"})}},{key:"scrollToChangeClicked",value:function(t,e){e.preventDefault(),e.stopPropagation(),this.scrollToChangeElement(t)}},{key:"onCreateChangeRecommendation",value:function(t){this.createChangeRecommendation.emit(t)}},{key:"ngAfterViewInit",value:function(){var t=this;this.scrollToChange&&window.setTimeout((function(){t.scrollToChangeElement(t.scrollToChange)}),50)}}]),n}(u.a)).\u0275fac=function(t){return new(t||ti)(d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(ut.a),d.Tb(q.a),d.Tb(U.a),d.Tb(s.a),d.Tb(mt.b),d.Tb(l.a),d.Tb(d.m),d.Tb(m.a))},ti.\u0275cmp=d.Nb({type:ti,selectors:[["os-motion-detail-diff"]],inputs:{motion:"motion",changes:"changes",scrollToChange:"scrollToChange",highlightedLine:"highlightedLine",lineNumberingMode:"lineNumberingMode",showAllAmendments:"showAllAmendments"},outputs:{createChangeRecommendation:"createChangeRecommendation"},features:[d.Db],decls:15,vars:15,consts:[["class","change-recommendation-overview",4,"ngIf"],[1,"text-prefix-label"],[1,"motion-text-with-diffs"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"motion-text"],[3,"html","changeRecommendations","createChangeRecommendation"],["amendmentMenu","matMenu"],["matMenuContent",""],["changeRecommendationMenu","matMenu"],[1,"change-recommendation-overview"],["class","no-changes",4,"ngIf"],["href","",3,"click"],["class","line-number",4,"ngIf"],["class","operation",4,"ngIf"],[1,"status"],[1,"line-number"],[1,"operation"],[1,"no-changes"],["class","action-row",4,"osPerms"],["class","status-row",4,"ngIf"],[1,"motion-text","motion-text-diff"],[1,"bold"],[3,"innerHTML"],[1,"action-row"],["mat-icon-button","","type","button",3,"matMenuTriggerFor","matMenuTriggerData",4,"ngIf"],["mat-icon-button","","type","button",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"status-row"],[1,"grey"],["class","collission-hint",4,"ngIf"],[1,"motion-text","motion-text-diff",3,"innerHTML"],[1,"collission-hint"],[3,"matTooltip"],["type","button","mat-menu-item","",3,"routerLink","state"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["type","button","mat-menu-item","",3,"click"],[1,"active-indicator"],["type","button","mat-menu-item","",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(d.Qc(0,xn,7,5,"section",0),d.Zb(1,"span",1),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Zb(4,"div",2),d.Qc(5,Pn,10,19,"div",3),d.Qc(6,Un,10,29,"div",4),d.Zb(7,"div",5),d.Zb(8,"os-motion-detail-original-change-recommendations",6),d.hc("createChangeRecommendation",(function(t){return e.onCreateChangeRecommendation(t)})),d.Yb(),d.Yb(),d.Yb(),d.Zb(9,"mat-menu",null,7),d.Qc(11,Hn,15,13,"ng-template",8),d.Yb(),d.Zb(12,"mat-menu",null,9),d.Qc(14,Jn,30,17,"ng-template",8),d.Yb()),2&t&&(d.tc("ngIf",e.changes.length>0),d.Gb(2),d.Tc(d.nc(3,12,e.preamble)),d.Gb(3),d.tc("ngIf",e.getTitleChangingObject()),d.Gb(1),d.tc("ngForOf",e.getAllTextChangingObjects()),d.Gb(1),d.Kb("line-numbers-none",e.isLineNumberingNone())("line-numbers-inline",e.isLineNumberingInline())("line-numbers-outside",e.isLineNumberingOutside()),d.Gb(1),d.tc("html",e.getTextRemainderAfterLastChange())("changeRecommendations",d.yc(14,jn)))},directives:[i.t,i.s,pn,yt.f,yt.b,It.a,_.b,yt.e,Ct.a,Gt.c,yt.c,a.g,Tt.a],pipes:[g.j,S.a],styles:['.diff-box[_ngcontent-%COMP%]{position:relative;border-radius:3px;margin-bottom:0;padding-top:0;padding-right:40px}.diff-box[_ngcontent-%COMP%]:hover   .action-row[_ngcontent-%COMP%]{opacity:1}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]{position:absolute;right:0;font-size:.8em;opacity:.5;overflow:hidden}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{margin-left:5px;color:red}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{margin-left:5px}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-amend-info[_ngcontent-%COMP%]{margin-left:5px;min-width:68px}.diff-box[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]{font-style:italic;color:grey}.diff-box[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:after{content:":"}.change-recommendation-overview[_ngcontent-%COMP%]{border-radius:3px;margin-bottom:15px;padding:5px 10px}.change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, .change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:link{text-decoration:none}.change-recommendation-overview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:10px}.change-recommendation-overview[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;display:table}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-row;cursor:pointer}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{text-decoration:underline}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:table-cell;padding:1px}.change-recommendation-overview[_ngcontent-%COMP%]   .no-changes[_ngcontent-%COMP%], .change-recommendation-overview[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{color:grey;font-style:italic}.active-indicator[_ngcontent-%COMP%]{font-size:18px;margin-left:10px;margin-right:0;margin-top:3px}']}),ti),ni=n("MutI"),ii=n("JAMN"),oi=n("6Ehv");function ai(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.Tc(n.motion.identifier)}}function ci(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.Tc(n.contentForm.get("identifier").value)}}function ri(t,e){if(1&t&&(d.Zb(0,"h2"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Zb(4,"span"),d.Sc(5,"\xa0"),d.Yb(),d.Qc(6,ai,2,1,"span",2),d.Qc(7,ci,2,1,"span",2),d.Yb()),2&t){var n=d.lc();d.Gb(2),d.Tc(d.nc(3,3,"Motion")),d.Gb(4),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("ngIf",n.editMotion)}}function si(t,e){1&t&&(d.Zb(0,"h2"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"New motion")))}function li(t,e){1&t&&(d.Zb(0,"h2"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"New amendment")))}function mi(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",20),d.hc("click",(function(){d.Ic(n);var t=d.lc(2);return t.navigateToMotion(t.previousMotion)})),d.Zb(2,"os-icon-container",21),d.Sc(3),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(3),d.Uc(" ",i.previousMotion.identifier," ")}}function ui(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",20),d.hc("click",(function(){d.Ic(n);var t=d.lc(2);return t.navigateToMotion(t.nextMotion)})),d.Zb(2,"os-icon-container",22),d.Sc(3),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(2),d.tc("swap",!0),d.Gb(1),d.Uc(" ",i.nextMotion.identifier," ")}}function bi(t,e){if(1&t&&(d.Zb(0,"div",19),d.Qc(1,mi,4,1,"div",2),d.Qc(2,ui,4,2,"div",2),d.Yb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngIf",n.previousMotion),d.Gb(1),d.tc("ngIf",n.nextMotion)}}function di(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=d.lc(3);return t.navigateToMotion(t.previousMotion)})),d.Zb(1,"mat-icon"),d.Sc(2,"chevron_left"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(4),d.Vc("",d.nc(5,2,"Motion")," ",i.previousMotion.identifier,"")}}function fi(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=d.lc(3);return t.navigateToMotion(t.nextMotion)})),d.Zb(1,"mat-icon"),d.Sc(2,"chevron_right"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(4),d.Vc("",d.nc(5,2,"Motion")," ",i.nextMotion.identifier,"")}}function gi(t,e){1&t&&d.Ub(0,"mat-divider")}function hi(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,di,6,4,"button",28),d.Qc(2,fi,6,4,"button",28),d.Qc(3,gi,1,0,"mat-divider",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.previousMotion),d.Gb(1),d.tc("ngIf",n.nextMotion),d.Gb(1),d.tc("ngIf",n.previousMotion||n.nextMotion)}}function pi(t,e){1&t&&d.Ub(0,"mat-divider")}function vi(t,e){if(1&t&&d.Ub(0,"os-projector-button",23),2&t){var n=d.lc(2);d.tc("object",n.motion)("menuItem",!0)}}function ki(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(3).addToAgenda()})),d.Zb(1,"mat-icon"),d.Sc(2,"add"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Add to agenda")))}function _i(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(3).removeFromAgenda()})),d.Zb(1,"mat-icon"),d.Sc(2,"remove"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Remove from agenda")))}function yi(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,ki,6,3,"button",28),d.Qc(2,_i,6,3,"button",28),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.motion&&!n.motion.item),d.Gb(1),d.tc("ngIf",n.motion&&n.motion.item)}}var Ci=function(){return["/history"]},Si=function(t){return{element:t}};function Mi(t,e){if(1&t&&(d.Zb(0,"button",30),d.Zb(1,"mat-icon"),d.Sc(2,"history"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.tc("routerLink",d.yc(5,Ci))("queryParams",d.zc(6,Si,n.motion.elementId)),d.Gb(4),d.Uc(" ",d.nc(5,3,"History")," ")}}function Ii(t,e){1&t&&d.Ub(0,"mat-divider")}function Ti(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(2).setEditMode(!0)})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Edit")))}function wi(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",31),d.hc("click",(function(){return d.Ic(n),d.lc(2).deleteMotionButton()})),d.Zb(1,"mat-icon"),d.Sc(2,"delete"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Delete")))}var Gi=function(){return["core.can_manage_projector","agenda.can_manage","core.can_see_history"]};function xi(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Qc(1,hi,4,3,"div",2),d.Ub(2,"os-speaker-button",23),d.Zb(3,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc().onDownloadPdf()})),d.Zb(4,"mat-icon"),d.Sc(5,"picture_as_pdf"),d.Yb(),d.Zb(6,"span"),d.Sc(7),d.mc(8,"translate"),d.Yb(),d.Yb(),d.Qc(9,pi,1,0,"mat-divider",25),d.Qc(10,vi,1,2,"os-projector-button",26),d.Qc(11,yi,3,2,"div",25),d.Qc(12,Mi,6,8,"button",27),d.Qc(13,Ii,1,0,"mat-divider",2),d.Qc(14,Ti,6,3,"button",28),d.Qc(15,wi,6,3,"button",29),d.Yb()}if(2&t){var i=d.lc();d.Gb(1),d.tc("ngIf",i.vp.isMobile),d.Gb(1),d.tc("object",i.motion)("menuItem",!0),d.Gb(5),d.Tc(d.nc(8,11,"PDF")),d.Gb(2),d.tc("osPerms",d.yc(13,Gi)),d.Gb(1),d.tc("osPerms","core.can_manage_projector"),d.Gb(1),d.tc("osPerms","agenda.can_manage"),d.Gb(1),d.tc("osPerms","core.can_see_history"),d.Gb(1),d.tc("ngIf",i.perms.isAllowed("update",i.motion)||i.perms.isAllowed("manage")),d.Gb(1),d.tc("ngIf",i.perms.isAllowed("update",i.motion)),d.Gb(1),d.tc("ngIf",i.perms.isAllowed("manage"))}}function Yi(t,e){if(1&t){var n=d.ac();d.Zb(0,"span",39),d.hc("click",(function(){d.Ic(n);var t=d.lc(3);return t.gotoChangeRecommendation(t.getTitleChangingObject())})),d.Yb()}}function Zi(t,e){if(1&t){var n=d.ac();d.Zb(0,"span",40),d.hc("click",(function(){return d.Ic(n),d.lc(3).createTitleChangeRecommendation()})),d.Yb()}}function Oi(t,e){if(1&t&&(d.Zb(0,"span"),d.Qc(1,Yi,1,0,"span",37),d.Qc(2,Zi,1,0,"span",38),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.getTitleChangingObject()),d.Gb(1),d.tc("osPerms","motions.can_manage")("osPermsAnd",!n.getTitleChangingObject())}}function Ri(t,e){if(1&t&&(d.Zb(0,"span"),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Sc(4),d.Yb()),2&t){var n=d.lc(2);d.Gb(2),d.Tc(d.nc(3,2,"Sequential number")),d.Gb(2),d.Uc("\xa0",n.motion.id," ")}}function Pi(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xb7\xa0"),d.Yb())}var Fi=function(){return{back:"true"}};function Ni(t,e){if(1&t&&(d.Zb(0,"span"),d.Zb(1,"span"),d.Zb(2,"span"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Sc(5,"\xa0"),d.Zb(6,"a",41),d.Sc(7),d.Yb(),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.Gb(3),d.Tc(d.nc(4,4,"Amendment to")),d.Gb(3),d.tc("routerLink",n.motion.parent.getDetailStateURL())("state",d.yc(6,Fi)),d.Gb(1),d.Uc(" ",n.motion.parent.identifier||n.motion.parent.title," ")}}function Li(t,e){if(1&t){var n=d.ac();d.Zb(0,"div",32),d.Zb(1,"div",33),d.Zb(2,"h1",34),d.Qc(3,Oi,3,3,"span",2),d.Sc(4),d.Yb(),d.Zb(5,"button",35),d.hc("click",(function(){return d.Ic(n),d.lc().toggleFavorite()})),d.mc(6,"translate"),d.Zb(7,"mat-icon"),d.Sc(8),d.Yb(),d.Yb(),d.Yb(),d.Zb(9,"span",36),d.Qc(10,Ri,5,4,"span",2),d.Qc(11,Pi,2,0,"span",2),d.Qc(12,Ni,8,7,"span",2),d.Yb(),d.Yb()}if(2&t){var i=d.lc();d.Gb(3),d.tc("ngIf",i.titleCanBeChanged()),d.Gb(1),d.Uc(" ",i.getTitleWithChanges()," "),d.Gb(1),d.uc("matTooltip",d.nc(6,7,"Mark as personal favorite")),d.Gb(3),d.Tc(i.motion.star?"star":"star_border"),d.Gb(2),d.tc("ngIf",i.showSequential),d.Gb(1),d.tc("ngIf",i.showSequential&&i.motion.parent_id),d.Gb(1),d.tc("ngIf",i.motion.parent_id)}}function Ei(t,e){1&t&&d.Vb(0)}function Qi(t,e){1&t&&d.Vb(0)}function Ai(t,e){1&t&&d.Vb(0)}function ji(t,e){if(1&t&&d.Ub(0,"os-motion-comments",47),2&t){var n=d.lc(3);d.tc("motion",n.motion)}}function Ui(t,e){if(1&t&&d.Ub(0,"os-personal-note",47),2&t){var n=d.lc(3);d.tc("motion",n.motion)}}function Di(t,e){if(1&t&&(d.Zb(0,"div",43),d.Zb(1,"div"),d.Qc(2,Qi,1,0,"ng-container",44),d.Yb(),d.Zb(3,"mat-card",45),d.Qc(4,Ai,1,0,"ng-container",44),d.Yb(),d.Qc(5,ji,1,1,"os-motion-comments",46),d.Qc(6,Ui,1,1,"os-personal-note",46),d.Yb()),2&t){var n=d.lc(2),i=d.Ec(21),o=d.Ec(23);d.Gb(2),d.tc("ngTemplateOutlet",i),d.Gb(1),d.tc("ngClass",n.editMotion?"os-form-card-mobile":"os-card"),d.Gb(1),d.tc("ngTemplateOutlet",o),d.Gb(1),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("ngIf",!n.editMotion&&!n.operator.isAnonymous)}}function Vi(t,e){if(1&t&&d.Qc(0,Di,7,5,"div",42),2&t){var n=d.lc();d.tc("ngIf",n.motion)}}function Bi(t,e){1&t&&d.Vb(0)}function zi(t,e){if(1&t&&d.Ub(0,"os-motion-comments",47),2&t){var n=d.lc(3);d.tc("motion",n.motion)}}function Wi(t,e){if(1&t&&d.Ub(0,"os-personal-note",47),2&t){var n=d.lc(3);d.tc("motion",n.motion)}}function qi(t,e){1&t&&d.Vb(0)}function $i(t,e){if(1&t&&(d.Zb(0,"div",49),d.Zb(1,"div",50),d.Zb(2,"div"),d.Qc(3,Bi,1,0,"ng-container",44),d.Yb(),d.Qc(4,zi,1,1,"os-motion-comments",46),d.Qc(5,Wi,1,1,"os-personal-note",46),d.Yb(),d.Zb(6,"div",51),d.Zb(7,"mat-card",45),d.Qc(8,qi,1,0,"ng-container",44),d.Yb(),d.Yb(),d.Yb()),2&t){var n=d.lc(2),i=d.Ec(21),o=d.Ec(23);d.Gb(3),d.tc("ngTemplateOutlet",i),d.Gb(1),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("ngIf",!n.editMotion&&!n.operator.isAnonymous),d.Gb(2),d.tc("ngClass",n.editMotion?"os-form-card":"os-card"),d.Gb(1),d.tc("ngTemplateOutlet",o)}}function Hi(t,e){if(1&t&&d.Qc(0,$i,9,5,"div",48),2&t){var n=d.lc();d.tc("ngIf",n.motion)}}function Xi(t,e){if(1&t&&(d.Zb(0,"div"),d.Ub(1,"os-manage-submitters",47),d.Yb()),2&t){var n=d.lc(3);d.Gb(1),d.tc("motion",n.motion)}}function Ki(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Xi,2,1,"div",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",!n.editMotion)}}function Ji(t,e){1&t&&(d.Zb(0,"h4"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Supporters")))}function to(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",56),d.hc("click",(function(){return d.Ic(n),d.lc(3).support()})),d.Zb(1,"mat-icon"),d.Sc(2,"thumb_up"),d.Yb(),d.Sc(3),d.mc(4,"translate"),d.Yb()}2&t&&(d.Gb(3),d.Uc(" ",d.nc(4,1,"Support")," "))}function eo(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",56),d.hc("click",(function(){return d.Ic(n),d.lc(3).unsupport()})),d.Zb(1,"mat-icon"),d.Sc(2,"thumb_down"),d.Yb(),d.Sc(3),d.mc(4,"translate"),d.Yb()}2&t&&(d.Gb(3),d.Uc(" ",d.nc(4,1,"Unsupport")," "))}function no(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",57),d.hc("click",(function(){return d.Ic(n),d.lc(3).openSupportersDialog()})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(1),d.Vc(" ",i.motion.supporters.length," ",d.nc(2,2,"supporters")," ")}}function io(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,", "),d.Yb())}function oo(t,e){if(1&t&&(d.Zb(0,"span"),d.Sc(1),d.Qc(2,io,2,0,"span",2),d.Yb()),2&t){var n=e.$implicit,i=e.last;d.Gb(1),d.Uc(" ",n.full_name,""),d.Gb(1),d.tc("ngIf",!i)}}function ao(t,e){if(1&t&&(d.Zb(0,"p",58),d.Qc(1,oo,3,2,"span",59),d.Yb()),2&t){var n=d.lc(3);d.Gb(1),d.tc("ngForOf",n.motion.supporters)}}function co(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Ji,3,3,"h4",2),d.Qc(2,to,5,3,"button",53),d.Qc(3,eo,5,3,"button",53),d.Qc(4,no,3,4,"button",54),d.Qc(5,ao,2,1,"p",55),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("support",n.motion)||n.motion.hasSupporters()),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("support",n.motion)),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("unsupport",n.motion)),d.Gb(1),d.tc("ngIf",n.motion.hasSupporters()),d.Gb(1),d.tc("ngIf",n.showSupporters)}}function ro(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xa0..."),d.Yb())}function so(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(4).setState(t.id)})),d.Sc(1),d.mc(2,"translate"),d.Qc(3,ro,2,0,"span",2),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(1),d.Uc(" ",d.nc(2,2,i.name)," "),d.Gb(2),d.tc("ngIf",i.show_state_extension_field)}}function lo(t,e){1&t&&d.Ub(0,"mat-divider")}function mo(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xa0..."),d.Yb())}function uo(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(4).setState(t.id)})),d.Zb(1,"mat-icon"),d.Sc(2,"arrow_back"),d.Yb(),d.Sc(3),d.mc(4,"translate"),d.Qc(5,mo,2,0,"span",2),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(3),d.Uc(" ",d.nc(4,2,i.name)," "),d.Gb(2),d.tc("ngIf",i.show_state_extension_field)}}function bo(t,e){if(1&t){var n=d.ac();d.Zb(0,"span",62),d.Qc(1,so,4,4,"button",63),d.Zb(2,"div"),d.Qc(3,lo,1,0,"mat-divider",2),d.Qc(4,uo,6,4,"button",63),d.Zb(5,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(3).setState(null)})),d.Zb(6,"mat-icon"),d.Sc(7,"replay"),d.Yb(),d.Sc(8),d.mc(9,"translate"),d.Yb(),d.Yb(),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(1),d.tc("ngForOf",i.motion.state.next_states),d.Gb(2),d.tc("ngIf",i.motion.state.next_states.length>0),d.Gb(1),d.tc("ngForOf",i.motion.state.previous_states),d.Gb(4),d.Uc(" ",d.nc(9,4,"Reset state")," ")}}function fo(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"os-extension-field",60),d.hc("success",(function(t){return d.Ic(n),d.lc(2).setStateExtension(t)})),d.mc(2,"translate"),d.mc(3,"translate"),d.Qc(4,bo,10,6,"span",61),d.Yb(),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(1),d.uc("title",d.nc(2,8,"State")),d.uc("extensionLabel",d.nc(3,10,"Extension")),d.tc("canBeEdited",i.perms.isAllowed("change_state",i.motion))("hasExtension",i.motion.state&&i.motion.state.show_state_extension_field)("chipValue",i.stateLabel)("inputValue",i.newStateExtension)("classes",i.motion.stateCssColor),d.Gb(3),d.tc("ngIf",i.motion.state)}}function go(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"\xa0..."),d.Yb())}function ho(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(3).setRecommendation(t.id)})),d.Sc(1),d.mc(2,"translate"),d.Qc(3,go,2,0,"span",2),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(1),d.Uc(" ",d.nc(2,2,i.recommendation_label)," "),d.Gb(2),d.tc("ngIf",i.show_recommendation_extension_field)}}function po(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",66),d.hc("click",(function(){return d.Ic(n),d.lc(3).onFollowRecButton()})),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"Follow recommendation")))}function vo(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"os-extension-field",64),d.hc("success",(function(t){return d.Ic(n),d.lc(2).setRecommendationExtension(t)})),d.mc(2,"translate"),d.mc(3,"translate"),d.Zb(4,"span",62),d.Qc(5,ho,4,4,"button",63),d.Ub(6,"mat-divider"),d.Zb(7,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(2).setRecommendation(null)})),d.Zb(8,"mat-icon"),d.Sc(9,"replay"),d.Yb(),d.Sc(10),d.mc(11,"translate"),d.Yb(),d.Yb(),d.Yb(),d.Qc(12,po,4,3,"button",65),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(1),d.uc("title",i.recommender),d.uc("extensionLabel",d.nc(2,11,"Extension")),d.uc("searchListLabel",d.nc(3,13,"Motions")),d.tc("inputValue",i.recommendationStateExtension)("canBeEdited",i.perms.isAllowed("change_metadata",i.motion))("chipValue",i.recommendationLabel)("hasExtension",i.motion.recommendation&&i.motion.recommendation.show_recommendation_extension_field)("searchList",i.motionObserver),d.Gb(4),d.tc("ngForOf",i.motion.possibleRecommendations),d.Gb(5),d.Uc(" ",d.nc(11,15,"Reset recommendation")," "),d.Gb(2),d.tc("ngIf",i.canFollowRecommendation())}}function ko(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1," \xb7 "),d.Yb())}function _o(t,e){if(1&t&&(d.Zb(0,"span"),d.Zb(1,"a",67),d.Sc(2),d.Yb(),d.Qc(3,ko,2,0,"span",2),d.Yb()),2&t){var n=e.$implicit,i=e.last;d.Gb(1),d.tc("routerLink",n.getDetailStateURL()),d.Gb(1),d.Tc(n.identifierOrTitle),d.Gb(1),d.tc("ngIf",!i)}}function yo(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"h4"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Qc(4,_o,4,3,"span",59),d.Yb()),2&t){var n=d.lc(2);d.Gb(2),d.Tc(d.nc(3,2,"Referring motions")),d.Gb(2),d.tc("ngForOf",n.recommendationReferencingMotions)}}function Co(t,e){1&t&&(d.Zb(0,"h4"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Category")))}function So(t,e){1&t&&(d.Zb(0,"mat-icon"),d.Sc(1,"check"),d.Yb())}function Mo(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(3).setCategory(t.id)})),d.Qc(1,So,2,0,"mat-icon",2),d.Sc(2),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(3);d.Gb(1),d.tc("ngIf",o.motion.category_id===i.id),d.Gb(1),d.Uc(" ",i.prefixedNameWithParents," ")}}function Io(t,e){if(1&t&&(d.Zb(0,"div"),d.Sc(1),d.Yb()),2&t){var n=d.lc(5);d.Gb(1),d.Uc(" ",n.motion.category.parent," ")}}function To(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc("",d.nc(2,1,"Subcategory"),":"))}function wo(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Io,2,1,"div",2),d.Qc(2,To,3,3,"span",2),d.Sc(3),d.Yb()),2&t){var n=d.lc(4);d.Gb(1),d.tc("ngIf",n.motion.category.parent),d.Gb(1),d.tc("ngIf",n.motion.category.parent),d.Gb(1),d.Uc(" ",n.motion.category," ")}}function Go(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"-"),d.Yb())}function xo(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",71),d.Qc(1,wo,4,3,"div",2),d.Qc(2,Go,2,0,"span",2),d.Yb()),2&t){d.lc();var n=d.Ec(3),i=d.lc(2);d.tc("matMenuTriggerFor",n),d.Gb(1),d.tc("ngIf",i.motion.category),d.Gb(1),d.tc("ngIf",!i.motion.category)}}function Yo(t,e){if(1&t&&(d.Zb(0,"div"),d.Sc(1),d.Yb()),2&t){var n=d.lc(5);d.Gb(1),d.Uc(" ",n.motion.category.parent," ")}}function Zo(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc("",d.nc(2,1,"Subcategory"),":"))}function Oo(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Yo,2,1,"div",2),d.Qc(2,Zo,3,3,"span",2),d.Sc(3),d.Yb()),2&t){var n=d.lc(4);d.Gb(1),d.tc("ngIf",n.motion.category.parent),d.Gb(1),d.tc("ngIf",n.motion.category.parent),d.Gb(1),d.Uc(" ",n.motion.category," ")}}function Ro(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",72),d.Qc(1,Oo,4,3,"div",2),d.Yb()),2&t){var n=d.lc(3);d.Gb(1),d.tc("ngIf",n.motion.category)}}function Po(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Co,3,3,"h4",2),d.Zb(2,"mat-menu",null,68),d.Qc(4,Mo,3,2,"button",63),d.Yb(),d.Qc(5,xo,3,3,"mat-basic-chip",69),d.Qc(6,Ro,2,1,"mat-basic-chip",70),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)||n.motion.category),d.Gb(3),d.tc("ngForOf",n.categoryObserver.value),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)),d.Gb(1),d.tc("ngIf",!n.perms.isAllowed("change_metadata",n.motion)&&n.motion.category)}}function Fo(t,e){1&t&&(d.Zb(0,"h4"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Tags")))}function No(t,e){1&t&&(d.Zb(0,"mat-icon"),d.Sc(1,"check"),d.Yb())}function Lo(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(t){d.Ic(n);var i=e.$implicit;return d.lc(4).setTag(t,i.id)})),d.Qc(1,No,2,0,"mat-icon",2),d.Sc(2),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(4);d.Gb(1),d.tc("ngIf",o.motion.tags.includes(i)),d.Gb(1),d.Uc(" ",i," ")}}function Eo(t,e){1&t&&(d.Zb(0,"mat-basic-chip",78),d.Sc(1),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ","\u2013"," "))}function Qo(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",78),d.Sc(1),d.Yb()),2&t){var n=e.$implicit;d.Gb(1),d.Uc(" ",n," ")}}function Ao(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"mat-menu",null,73),d.Qc(3,Lo,3,2,"button",63),d.Yb(),d.Zb(4,"div",74),d.Qc(5,Eo,2,1,"mat-basic-chip",75),d.Zb(6,"mat-chip-list",76),d.Qc(7,Qo,2,1,"mat-basic-chip",77),d.Yb(),d.Yb(),d.Yb()),2&t){var n=d.Ec(2),i=d.lc(3);d.Gb(3),d.tc("ngForOf",i.tagObserver.value),d.Gb(1),d.tc("matMenuTriggerFor",n),d.Gb(1),d.tc("ngIf",!i.motion.hasTags()),d.Gb(2),d.tc("ngForOf",i.motion.tags)}}function jo(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",72),d.Sc(1),d.Yb()),2&t){var n=e.$implicit;d.Gb(1),d.Uc(" ",n," ")}}function Uo(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"mat-chip-list",76),d.Qc(2,jo,2,1,"mat-basic-chip",79),d.Yb(),d.Yb()),2&t){var n=d.lc(3);d.Gb(2),d.tc("ngForOf",n.motion.tags)}}function Do(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Fo,3,3,"h4",2),d.Qc(2,Ao,8,4,"div",2),d.Qc(3,Uo,3,1,"div",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)||n.motion.hasTags()),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)),d.Gb(1),d.tc("ngIf",!n.perms.isAllowed("change_metadata",n.motion))}}function Vo(t,e){1&t&&(d.Zb(0,"h4"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"Motion block")," "))}function Bo(t,e){1&t&&(d.Zb(0,"mat-icon"),d.Sc(1,"check"),d.Yb())}function zo(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(3).setBlock(t.id)})),d.Qc(1,Bo,2,0,"mat-icon",2),d.Sc(2),d.Yb()}if(2&t){var i=e.$implicit,o=d.lc(3);d.Gb(1),d.tc("ngIf",o.motion.motion_block_id===i.id),d.Gb(1),d.Uc(" ",i," ")}}function Wo(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",82),d.Sc(1),d.Yb()),2&t){d.lc();var n=d.Ec(3),i=d.lc(2);d.tc("matMenuTriggerFor",n),d.Gb(1),d.Uc(" ",i.motion.motion_block||"\u2013"," ")}}function qo(t,e){if(1&t&&(d.Zb(0,"mat-basic-chip",72),d.Sc(1),d.Yb()),2&t){var n=d.lc(3);d.Gb(1),d.Uc(" ",n.motion.motion_block," ")}}function $o(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Vo,3,3,"h4",2),d.Zb(2,"mat-menu",null,80),d.Qc(4,zo,3,2,"button",63),d.Yb(),d.Qc(5,Wo,2,2,"mat-basic-chip",81),d.Qc(6,qo,2,1,"mat-basic-chip",70),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)||n.motion.motion_block),d.Gb(3),d.tc("ngForOf",n.blockObserver.value),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion)),d.Gb(1),d.tc("ngIf",!n.perms.isAllowed("change_metadata",n.motion)&&n.motion.motion_block)}}function Ho(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"h4"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Sc(4),d.Yb()),2&t){var n=d.lc(2);d.Gb(2),d.Tc(d.nc(3,2,"Origin")),d.Gb(2),d.Uc(" ",n.motion.origin," ")}}function Xo(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Amendment")))}function Ko(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Amendments")))}function Jo(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-checkbox",84),d.hc("ngModelChange",(function(t){return d.Ic(n),d.lc(3).showAllAmendments=t})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc(3);d.tc("ngModel",i.showAllAmendments),d.Gb(1),d.Uc(" ",d.nc(2,2,"Show all changes")," ")}}var ta=function(t){return["/motions/amendments",t]};function ea(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"h4"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Zb(4,"a",41),d.Sc(5),d.Qc(6,Xo,3,3,"span",2),d.Qc(7,Ko,3,3,"span",2),d.Yb(),d.Ub(8,"br"),d.Qc(9,Jo,3,4,"mat-checkbox",83),d.Yb()),2&t){var n=d.lc(2);d.Gb(2),d.Tc(d.nc(3,7,"Amendments")),d.Gb(2),d.tc("routerLink",d.zc(9,ta,n.motion.id))("state",d.yc(11,Fi)),d.Gb(1),d.Uc(" ",n.amendments.length," "),d.Gb(1),d.tc("ngIf",1===n.amendments.length),d.Gb(1),d.tc("ngIf",n.amendments.length>1),d.Gb(2),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.Diff))}}function na(t,e){1&t&&d.Ub(0,"os-motion-poll",88),2&t&&d.tc("poll",e.$implicit)}function ia(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",89),d.hc("click",(function(){return d.Ic(n),d.lc(3).openDialog()})),d.Zb(1,"mat-icon",90),d.Sc(2,"add"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"New vote")))}function oa(t,e){if(1&t&&(d.Zb(0,"div",85),d.Qc(1,na,1,1,"os-motion-poll",86),d.Qc(2,ia,6,3,"button",87),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngForOf",n.motion.polls)("ngForTrackBy",n.trackByIndex),d.Gb(1),d.tc("ngIf",n.perms.isAllowed("createpoll",n.motion))}}function aa(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,Ki,2,1,"div",2),d.Qc(2,co,6,5,"div",2),d.Qc(3,fo,5,12,"div",2),d.Qc(4,vo,13,17,"div",2),d.Qc(5,yo,5,4,"div",2),d.Qc(6,Po,7,4,"div",2),d.Qc(7,Do,4,3,"div",2),d.Qc(8,$o,7,4,"div",2),d.Qc(9,Ho,5,4,"div",2),d.Qc(10,ea,10,12,"div",2),d.Qc(11,oa,3,3,"div",52),d.Yb()),2&t){var n=d.lc();d.Gb(1),d.tc("ngIf",n.motion.submitters||n.newMotion),d.Gb(1),d.tc("ngIf",n.minSupporters&&!n.editMotion),d.Gb(1),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("ngIf",(n.perms.isAllowed("change_metadata")||n.motion.recommendation)&&n.recommender&&n.motion.possibleRecommendations.length&&!n.editMotion),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.recommendationReferencingMotions.length>0&&n.showReferringMotions),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.categoryObserver.value.length),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.tagObserver.value.length>0),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.blockObserver.value.length>0),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.motion.origin),d.Gb(1),d.tc("ngIf",!n.editMotion&&n.amendments&&n.amendments.length>0),d.Gb(1),d.tc("ngIf",!n.editMotion)}}function ca(t,e){1&t&&(d.Zb(0,"mat-error"),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Tc(d.nc(2,1,"Invalid line number")))}function ra(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",110),d.hc("click",(function(){d.Ic(n);var t=d.lc(4);return t.gotoHighlightedLine(t.highlightedLineTyping),t.highlightedLineTyping=""})),d.Zb(1,"mat-icon"),d.Sc(2,"redo"),d.Yb(),d.Yb()}}var sa=function(){return{standalone:!0}};function la(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-form-field",107),d.Zb(1,"input",108),d.hc("ngModelChange",(function(t){return d.Ic(n),d.lc(3).highlightedLineTyping=t})),d.mc(2,"translate"),d.Yb(),d.Qc(3,ca,3,3,"mat-error",2),d.Qc(4,ra,3,0,"button",109),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(1),d.uc("placeholder",d.nc(2,6,"Go to line")),d.tc("ngModel",i.highlightedLineTyping)("ngModelOptions",d.yc(8,sa))("errorStateMatcher",i.highlightedLineMatcher),d.Gb(2),d.tc("ngIf",i.highlightedLineTyping>10),d.Gb(1),d.tc("ngIf",i.highlightedLineTyping)}}function ma(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",111),d.hc("click",(function(){return d.Ic(n),d.lc(3).highlightedLineOpened=!1})),d.Zb(1,"mat-icon"),d.Sc(2,"cancel"),d.Yb(),d.Yb()}}function ua(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1," \xa0("),d.Zb(2,"span"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Sc(5,") "),d.Yb()),2&t&&(d.Gb(3),d.Tc(d.nc(4,1,"none")))}function ba(t,e){if(1&t&&(d.Zb(0,"button",105),d.Zb(1,"mat-icon"),d.Sc(2,"rate_review"),d.Yb(),d.Sc(3," \xa0"),d.Zb(4,"span"),d.Sc(5),d.mc(6,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(3),i=d.Ec(30);d.tc("matMenuTriggerFor",i),d.Gb(5),d.Tc(d.nc(6,2,n.verboseChangeRecoMode[n.crMode]))}}function da(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",116),d.hc("click",(function(){return d.Ic(n),d.lc(4).createModifiedFinalVersion()})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"file_copy"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Create final print template"))}function fa(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",117),d.hc("click",(function(){return d.Ic(n),d.lc(4).editModifiedFinal()})),d.Zb(1,"mat-icon"),d.Sc(2,"edit"),d.Yb(),d.Yb()}}function ga(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",118),d.hc("click",(function(){return d.Ic(n),d.lc(4).onSubmitFinalVersion()})),d.Zb(1,"mat-icon"),d.Sc(2,"save"),d.Yb(),d.Yb()}if(2&t){var i=d.lc(4);d.tc("disabled",!i.finalVersionEdited)}}function ha(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",117),d.hc("click",(function(){return d.Ic(n),d.lc(4).cancelFinalVersionEdit()})),d.Zb(1,"mat-icon"),d.Sc(2,"close"),d.Yb(),d.Yb()}}function pa(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",119),d.hc("click",(function(){return d.Ic(n),d.lc(4).deleteModifiedFinalVersion()})),d.mc(1,"translate"),d.Zb(2,"mat-icon"),d.Sc(3,"delete"),d.Yb(),d.Yb()}2&t&&d.uc("matTooltip",d.nc(1,1,"Delete final print template"))}function va(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,da,4,3,"button",112),d.Qc(2,fa,3,0,"button",113),d.Qc(3,ga,3,1,"button",114),d.Qc(4,ha,3,0,"button",113),d.Qc(5,pa,4,3,"button",115),d.Yb()),2&t){var n=d.lc(3);d.Gb(1),d.tc("ngIf",n.motion.state.isFinalState&&!n.motion.modified_final_version),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.ModifiedFinal)&&!n.isFinalEdit),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.ModifiedFinal)&&n.isFinalEdit),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.ModifiedFinal)&&n.isFinalEdit),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.ModifiedFinal)&&!n.isFinalEdit)}}function ka(t,e){if(1&t&&(d.Zb(0,"div",101),d.Zb(1,"div",102),d.Qc(2,la,5,9,"mat-form-field",103),d.Qc(3,ma,3,0,"button",104),d.Zb(4,"button",105),d.Zb(5,"mat-icon"),d.Sc(6,"format_list_numbered"),d.Yb(),d.Sc(7," \xa0"),d.Zb(8,"span"),d.Sc(9),d.mc(10,"translate"),d.Yb(),d.Qc(11,ua,6,3,"span",2),d.Yb(),d.Qc(12,ba,7,4,"button",106),d.Yb(),d.Qc(13,va,6,5,"div",25),d.Yb()),2&t){var n=d.lc(2),i=d.Ec(27);d.Gb(2),d.tc("ngIf",n.highlightedLineOpened),d.Gb(1),d.tc("ngIf",n.highlightedLineOpened),d.Gb(1),d.tc("matMenuTriggerFor",i),d.Gb(5),d.Tc(d.nc(10,7,"Line numbering")),d.Gb(2),d.tc("ngIf",n.lnMode===n.LineNumberingMode.None),d.Gb(1),d.tc("ngIf",n.motion&&(n.allChangingObjects&&n.allChangingObjects.length||n.motion.modified_final_version)),d.Gb(1),d.tc("osPerms","motions.can_manage")}}function _a(t,e){if(1&t&&(d.Zb(0,"mat-option",124),d.Sc(1),d.Yb()),2&t){var n=e.$implicit;d.tc("value",n.id),d.Gb(1),d.Uc(" ",n.title," ")}}function ya(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-form-field"),d.Zb(1,"mat-select",122),d.hc("valueChange",(function(t){return d.Ic(n),d.lc(3).onStatuteParagraphChange(t)})),d.mc(2,"translate"),d.Qc(3,_a,2,2,"mat-option",123),d.Yb(),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(1),d.tc("placeholder",d.nc(2,2,"Statute paragraph")),d.Gb(2),d.tc("ngForOf",i.statuteParagraphs)}}function Ca(t,e){if(1&t){var n=d.ac();d.Zb(0,"div",120),d.Zb(1,"mat-checkbox",121),d.hc("change",(function(t){return d.Ic(n),d.lc(2).onStatuteAmendmentChange(t)})),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Qc(4,ya,4,4,"mat-form-field",2),d.Yb()}if(2&t){var i=d.lc(2);d.Gb(2),d.Uc(" ",d.nc(3,2,"Statute amendment")," "),d.Gb(2),d.tc("ngIf",i.contentForm.value.statute_amendment)}}function Sa(t,e){if(1&t&&(d.Xb(0),d.Zb(1,"mat-form-field"),d.Ub(2,"os-search-value-selector",126),d.mc(3,"translate"),d.Yb(),d.Wb()),2&t){var n=d.lc(3);d.Gb(2),d.uc("placeholder",d.nc(3,3,"Submitters")),d.tc("multiple",!0)("inputListValues",n.submitterObserver)}}function Ma(t,e){if(1&t&&(d.Zb(0,"div",125),d.Qc(1,Sa,4,5,"ng-container",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion))}}function Ia(t,e){1&t&&(d.Zb(0,"mat-form-field"),d.Ub(1,"input",128),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.uc("placeholder",d.nc(2,1,"Identifier")))}function Ta(t,e){if(1&t&&(d.Zb(0,"div",127),d.Qc(1,Ia,3,3,"mat-form-field",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.editMotion)}}function wa(t,e){1&t&&(d.Zb(0,"mat-form-field"),d.Ub(1,"input",130),d.mc(2,"translate"),d.Zb(3,"mat-error"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(1),d.uc("placeholder",d.nc(2,2,"Title")),d.Gb(3),d.Tc(d.nc(5,4,"The title is required")))}function Ga(t,e){if(1&t&&(d.Zb(0,"div",129),d.Qc(1,wa,6,6,"mat-form-field",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.editMotion)}}function xa(t,e){if(1&t&&(d.Zb(0,"span",131),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.Tc(d.nc(2,1,n.preamble))}}function Ya(t,e){if(1&t){var n=d.ac();d.Zb(0,"os-motion-detail-original-change-recommendations",137),d.hc("createChangeRecommendation",(function(t){return d.Ic(n),d.lc(4).createChangeRecommendation(t)}))("gotoChangeRecommendation",(function(t){return d.Ic(n),d.lc(4).gotoChangeRecommendation(t)})),d.Yb()}if(2&t){var i=d.lc(4);d.tc("html",i.getFormattedTextPlain())("changeRecommendations",i.changeRecommendations)}}function Za(t,e){if(1&t&&(d.Ub(0,"div",138),d.mc(1,"trust")),2&t){var n=d.lc(4);d.tc("innerHTML",d.oc(1,1,n.getFormattedTextPlain(),"html"),d.Jc)}}function Oa(t,e){if(1&t&&(d.Zb(0,"div",134),d.Qc(1,Ya,1,2,"os-motion-detail-original-change-recommendations",135),d.Qc(2,Za,2,4,"div",136),d.Yb()),2&t){var n=d.lc(3);d.Kb("line-numbers-none",n.isLineNumberingNone())("line-numbers-inline",n.isLineNumberingInline())("line-numbers-outside",n.isLineNumberingOutside()),d.Gb(1),d.tc("ngIf",n.isLineNumberingOutside()&&n.isRecoMode(n.ChangeRecoMode.Original)),d.Gb(1),d.tc("ngIf",!n.isLineNumberingOutside()||!n.isRecoMode(n.ChangeRecoMode.Original))}}function Ra(t,e){if(1&t){var n=d.ac();d.Zb(0,"os-motion-detail-diff",139),d.hc("createChangeRecommendation",(function(t){return d.Ic(n),d.lc(3).createChangeRecommendation(t)})),d.Yb()}if(2&t){var i=d.lc(3);d.tc("motion",i.motion)("changes",i.getChangesForDiffMode())("scrollToChange",i.scrollToChange)("highlightedLine",i.highlightedLine)("showAllAmendments",i.showAllAmendments)("lineNumberingMode",i.lnMode)}}function Pa(t,e){1&t&&(d.Zb(0,"div",142),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"This field is required.")," "))}function Fa(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"editor",140),d.hc("onChange",(function(){return d.Ic(n),d.lc(3).detectChanges()})),d.Yb(),d.Qc(2,Pa,3,3,"div",141),d.Yb()}if(2&t){var i=d.lc(3);d.Gb(1),d.tc("hidden",!i.isFinalEdit)("init",i.tinyMceSettings),d.Gb(1),d.tc("ngIf",i.contentForm.get("modified_final_version").invalid&&(i.contentForm.get("modified_final_version").dirty||i.contentForm.get("modified_final_version").touched))}}function Na(t,e){if(1&t&&(d.Xb(0),d.Qc(1,Oa,3,8,"div",132),d.Qc(2,Ra,1,6,"os-motion-detail-diff",133),d.Qc(3,Fa,3,3,"div",2),d.Wb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",!n.isRecoMode(n.ChangeRecoMode.Diff)&&!n.isFinalEdit),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.Diff)),d.Gb(1),d.tc("ngIf",n.isFinalEdit)}}function La(t,e){if(1&t&&(d.Ub(0,"div",143),d.mc(1,"trust")),2&t){var n=d.lc(2);d.tc("innerHTML",d.oc(1,1,n.getFormattedStatuteAmendment(),"html"),d.Jc)}}function Ea(t,e){1&t&&(d.Zb(0,"div",142),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"This field is required.")," "))}function Qa(t,e){if(1&t){var n=d.ac();d.Xb(0),d.Zb(1,"editor",144),d.hc("ngModelChange",(function(){return d.Ic(n),d.lc(2).detectChanges()})),d.Yb(),d.Qc(2,Ea,3,3,"div",141),d.Wb()}if(2&t){var i=d.lc(2);d.Gb(1),d.tc("init",i.tinyMceSettings),d.Gb(1),d.tc("ngIf",i.contentForm.get("text").invalid&&(i.contentForm.get("text").dirty||i.contentForm.get("text").touched))}}function Aa(t,e){if(1&t&&(d.Zb(0,"span",147),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Vc(" ",d.nc(2,2,"Line")," ",n.lineFrom," ")}}function ja(t,e){if(1&t&&(d.Zb(0,"span",147),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t){var n=d.lc().$implicit;d.Gb(1),d.Wc(" ",d.nc(2,3,"Line")," ",n.lineFrom," - ",n.lineTo-1," ")}}function Ua(t,e){1&t&&(d.Zb(0,"div",142),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"This field is required.")," "))}function Da(t,e){if(1&t&&(d.Zb(0,"section"),d.Zb(1,"h3"),d.Qc(2,Aa,3,4,"span",145),d.Qc(3,ja,3,5,"span",145),d.Yb(),d.Ub(4,"editor",146),d.Qc(5,Ua,3,3,"div",141),d.Yb()),2&t){var n=e.$implicit,i=d.lc(3);d.Gb(2),d.tc("ngIf",n.lineFrom>=n.lineTo-1),d.Gb(1),d.tc("ngIf",n.lineFrom<n.lineTo-1),d.Gb(1),d.tc("formControlName","text_"+n.paragraphNo)("init",i.tinyMceSettings),d.Gb(1),d.tc("ngIf",i.contentForm.get("text_"+n.paragraphNo).invalid&&(i.contentForm.get("text_"+n.paragraphNo).dirty||i.contentForm.get("text_"+n.paragraphNo).touched))}}function Va(t,e){if(1&t&&(d.Xb(0),d.Qc(1,Da,6,5,"section",59),d.Wb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngForOf",n.contentForm.value.selected_paragraphs)}}function Ba(t,e){1&t&&d.Vb(0)}function za(t,e){if(1&t&&(d.Xb(0),d.Qc(1,Ba,1,0,"ng-container",44),d.Wb()),2&t){d.lc(2);var n=d.Ec(25);d.Gb(1),d.tc("ngTemplateOutlet",n)}}function Wa(t,e){1&t&&(d.Zb(0,"span"),d.Sc(1,"*"),d.Yb())}function qa(t,e){if(1&t&&(d.Ub(0,"div",150),d.mc(1,"trust")),2&t){var n=d.lc(3);d.tc("innerHtml",d.oc(1,1,n.motion.reason,"html"),d.Jc)}}function $a(t,e){if(1&t&&d.Ub(0,"editor",151),2&t){var n=d.lc(3);d.tc("init",n.tinyMceSettings)("required",n.reasonRequired)}}function Ha(t,e){1&t&&(d.Zb(0,"div",142),d.Sc(1),d.mc(2,"translate"),d.Yb()),2&t&&(d.Gb(1),d.Uc(" ",d.nc(2,1,"This field is required.")," "))}function Xa(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"h3",45),d.Zb(2,"span"),d.Sc(3),d.mc(4,"translate"),d.Yb(),d.Sc(5,"\xa0"),d.Qc(6,Wa,2,0,"span",2),d.Yb(),d.Qc(7,qa,2,4,"div",148),d.Qc(8,$a,1,2,"editor",149),d.Qc(9,Ha,3,3,"div",141),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngClass",n.reasonRequired&&n.contentForm.get("reason").invalid&&(n.contentForm.get("reason").dirty||n.contentForm.get("reason").touched)?"red-warning-text":""),d.Gb(2),d.Tc(d.nc(4,6,"Reason")),d.Gb(3),d.tc("ngIf",n.reasonRequired&&n.editMotion),d.Gb(1),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("ngIf",n.editMotion),d.Gb(1),d.tc("ngIf",n.reasonRequired&&n.contentForm.get("reason").invalid&&(n.contentForm.get("reason").dirty||n.contentForm.get("reason").touched))}}function Ka(t,e){if(1&t&&(d.Zb(0,"div",125),d.Zb(1,"mat-form-field"),d.Ub(2,"os-search-value-selector",152),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(2);d.Gb(2),d.uc("placeholder",d.nc(3,3,"Category")),d.tc("includeNone",!0)("inputListValues",n.categoryObserver)}}function Ja(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-list-item"),d.Zb(1,"a",155),d.hc("click",(function(){d.Ic(n);var t=e.$implicit;return d.lc(4).onClickAttachment(t)})),d.Sc(2),d.Yb(),d.Yb()}if(2&t){var i=e.$implicit;d.Gb(2),d.Tc(i.title)}}function tc(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"h3"),d.Sc(2),d.mc(3,"translate"),d.Zb(4,"mat-icon"),d.Sc(5,"attach_file"),d.Yb(),d.Yb(),d.Zb(6,"mat-list",154),d.Qc(7,Ja,3,1,"mat-list-item",59),d.Yb(),d.Yb()),2&t){var n=d.lc(3);d.Gb(2),d.Tc(d.nc(3,2,"Attachments")),d.Gb(5),d.tc("ngForOf",n.motion.attachments)}}function ec(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"os-attachment-control",156),d.hc("errorHandler",(function(t){return d.Ic(n),d.lc(3).showUploadError(t)})),d.Yb(),d.Yb()}}function nc(t,e){if(1&t&&(d.Zb(0,"div",125),d.Qc(1,tc,8,4,"div",2),d.Qc(2,ec,2,0,"div",153),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",!n.editMotion),d.Gb(1),d.tc("osPerms","motions.can_manage")("osPermsAnd",n.editMotion)}}function ic(t,e){if(1&t&&(d.Zb(0,"div"),d.Ub(1,"os-agenda-content-object-form",157),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("form",n.contentForm)}}function oc(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"mat-form-field"),d.Ub(2,"os-search-value-selector",158),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(3);d.Gb(2),d.uc("placeholder",d.nc(3,3,"Supporters")),d.tc("multiple",!0)("inputListValues",n.supporterObserver)}}function ac(t,e){if(1&t&&(d.Zb(0,"div",125),d.Qc(1,oc,4,5,"div",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion))}}function cc(t,e){if(1&t&&(d.Zb(0,"div"),d.Zb(1,"mat-form-field"),d.Ub(2,"os-search-value-selector",159),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t){var n=d.lc(3);d.Gb(2),d.uc("placeholder",d.nc(3,2,"Workflow")),d.tc("inputListValues",n.workflowObserver)}}function rc(t,e){if(1&t&&(d.Zb(0,"div",125),d.Qc(1,cc,4,4,"div",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion))}}function sc(t,e){1&t&&(d.Zb(0,"div"),d.Zb(1,"mat-form-field"),d.Ub(2,"input",160),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.uc("placeholder",d.nc(3,1,"Origin")))}function lc(t,e){if(1&t&&(d.Zb(0,"div",125),d.Qc(1,sc,4,3,"div",2),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.perms.isAllowed("change_metadata",n.motion))}}function mc(t,e){if(1&t){var n=d.ac();d.Zb(0,"form",91),d.hc("keydown",(function(t){return d.Ic(n),d.lc().onKeyDown(t)})),d.Qc(1,ka,14,9,"div",92),d.Qc(2,Ca,5,4,"div",93),d.Qc(3,Ma,2,1,"div",94),d.Zb(4,"div",95),d.Qc(5,Ta,2,1,"div",96),d.Qc(6,Ga,2,1,"div",97),d.Yb(),d.Qc(7,xa,3,3,"span",98),d.Qc(8,Na,4,3,"ng-container",2),d.Qc(9,La,2,4,"div",99),d.Qc(10,Qa,3,2,"ng-container",2),d.Qc(11,Va,2,1,"ng-container",2),d.Qc(12,za,2,1,"ng-container",2),d.Qc(13,Xa,10,8,"div",2),d.Qc(14,Ka,4,5,"div",94),d.Zb(15,"div",100),d.Qc(16,nc,3,3,"div",94),d.Qc(17,ic,2,1,"div",2),d.Qc(18,ac,2,1,"div",94),d.Qc(19,rc,2,1,"div",94),d.Qc(20,lc,2,1,"div",94),d.Yb(),d.Yb()}if(2&t){var i=d.lc();d.tc("formGroup",i.contentForm),d.Gb(1),d.tc("ngIf",!i.editMotion&&!i.motion.isStatuteAmendment()),d.Gb(1),d.tc("ngIf",i.newMotion&&i.statuteParagraphs.length>0&&i.statutesEnabled),d.Gb(1),d.tc("ngIf",i.newMotion),d.Gb(2),d.tc("ngIf",i.editMotion&&!i.newMotion&&i.perms.isAllowed("change_metadata",i.motion)),d.Gb(1),d.tc("ngIf",i.editMotion),d.Gb(1),d.tc("ngIf",!i.isRecoMode(i.ChangeRecoMode.Diff)),d.Gb(1),d.tc("ngIf",!i.editMotion&&!i.motion.isStatuteAmendment()&&!i.motion.isParagraphBasedAmendment()),d.Gb(1),d.tc("ngIf",!i.editMotion&&i.motion.isStatuteAmendment()),d.Gb(1),d.tc("ngIf",i.motion&&i.editMotion&&!i.motion.isParagraphBasedAmendment()),d.Gb(1),d.tc("ngIf",i.motion&&i.editMotion&&i.motion.isParagraphBasedAmendment()),d.Gb(1),d.tc("ngIf",!i.editMotion&&i.motion.isParagraphBasedAmendment()),d.Gb(1),d.tc("ngIf",i.motion.reason||i.editMotion),d.Gb(1),d.tc("ngIf",i.newMotion&&i.categoryObserver.value.length>0),d.Gb(2),d.tc("ngIf",i.motion.hasAttachments()||i.editMotion),d.Gb(1),d.tc("ngIf",i.newMotion),d.Gb(1),d.tc("ngIf",i.editMotion&&i.minSupporters),d.Gb(1),d.tc("ngIf",i.editMotion&&i.workflowObserver.value.length>1),d.Gb(1),d.tc("ngIf",i.editMotion)}}function uc(t,e){1&t&&(d.Zb(0,"div",163),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"No changes at the text.")))}function bc(t,e){if(1&t&&(d.Zb(0,"h3",168),d.Sc(1),d.Yb()),2&t){var n=d.lc().$implicit,i=d.lc(4);d.Gb(1),d.Uc(" ",i.getAmendmentParagraphLinesTitle(n)," ")}}function dc(t,e){if(1&t){var n=d.ac();d.Zb(0,"os-motion-detail-original-change-recommendations",137),d.hc("createChangeRecommendation",(function(t){return d.Ic(n),d.lc(5).createChangeRecommendation(t)}))("gotoChangeRecommendation",(function(t){return d.Ic(n),d.lc(5).gotoChangeRecommendation(t)})),d.Yb()}if(2&t){var i=d.lc().$implicit,o=d.lc(4);d.tc("html",o.getAmendmentDiffTextWithContext(i))("changeRecommendations",o.changeRecommendations)}}function fc(t,e){if(1&t&&(d.Ub(0,"div",169),d.mc(1,"trust")),2&t){var n=d.lc().$implicit,i=d.lc(4);d.tc("outerHTML",d.oc(1,1,i.getAmendmentDiffTextWithContext(n),"html"),d.Jc)}}function gc(t,e){if(1&t&&(d.Zb(0,"div",165),d.Qc(1,bc,2,1,"h3",166),d.Qc(2,dc,1,2,"os-motion-detail-original-change-recommendations",135),d.Qc(3,fc,2,4,"div",167),d.Yb()),2&t){var n=d.lc(4);d.Kb("line-numbers-none",n.isLineNumberingNone())("line-numbers-inline",n.isLineNumberingInline())("line-numbers-outside",n.isLineNumberingOutside())("amendment-context",n.showAmendmentContext),d.Gb(1),d.tc("ngIf",!n.showAmendmentContext),d.Gb(1),d.tc("ngIf",n.isLineNumberingOutside()&&(n.isRecoMode(n.ChangeRecoMode.Original)||n.isRecoMode(n.ChangeRecoMode.Changed))),d.Gb(1),d.tc("ngIf",!n.isLineNumberingOutside()||!(n.isRecoMode(n.ChangeRecoMode.Original)||n.isRecoMode(n.ChangeRecoMode.Changed)))}}function hc(t,e){if(1&t&&(d.Xb(0),d.Qc(1,gc,4,11,"div",164),d.Wb()),2&t){var n=d.lc(3);d.Gb(1),d.tc("ngForOf",n.getAmendmentParagraphs())}}function pc(t,e){if(1&t){var n=d.ac();d.Zb(0,"os-motion-detail-diff",139),d.hc("createChangeRecommendation",(function(t){return d.Ic(n),d.lc(3).createChangeRecommendation(t)})),d.Yb()}if(2&t){var i=d.lc(3);d.tc("motion",i.motion)("changes",i.getChangesForDiffMode())("scrollToChange",i.scrollToChange)("highlightedLine",i.highlightedLine)("showAllAmendments",i.showAllAmendments)("lineNumberingMode",i.lnMode)}}function vc(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,uc,4,3,"div",162),d.Qc(2,hc,2,1,"ng-container",2),d.Qc(3,pc,1,6,"os-motion-detail-diff",133),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",0===n.motion.diffLines.length),d.Gb(1),d.tc("ngIf",!n.isRecoMode(n.ChangeRecoMode.Diff)&&!n.isFinalEdit),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.Diff))}}function kc(t,e){1&t&&(d.Zb(0,"div"),d.Zb(1,"span",142),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()),2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"There is an error with this amendment. Please edit it manually.")))}function _c(t,e){if(1&t){var n=d.ac();d.Zb(0,"mat-checkbox",171),d.hc("change",(function(){d.Ic(n);var t=d.lc(3);return t.showAmendmentContext=!t.showAmendmentContext})),d.Zb(1,"span"),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(2),d.Tc(d.nc(3,1,"Show entire motion text")))}function yc(t,e){if(1&t&&(d.Zb(0,"div"),d.Qc(1,_c,4,3,"mat-checkbox",170),d.Yb()),2&t){var n=d.lc(2);d.Gb(1),d.tc("ngIf",n.motion&&n.motion.isParagraphBasedAmendment())}}function Cc(t,e){if(1&t&&(d.Zb(0,"section",161),d.Qc(1,vc,4,3,"div",2),d.Qc(2,kc,4,3,"div",2),d.Yb(),d.Qc(3,yc,2,1,"div",2)),2&t){var n=d.lc();d.Gb(1),d.tc("ngIf",n.motion.diffLines),d.Gb(1),d.tc("ngIf",!n.motion.diffLines),d.Gb(1),d.tc("ngIf",n.isRecoMode(n.ChangeRecoMode.Original)||n.isRecoMode(n.ChangeRecoMode.Changed))}}function Sc(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",24),d.hc("click",(function(){return d.Ic(n),d.lc(2).highlightedLineOpened=!0})),d.Zb(1,"mat-icon"),d.Sc(2,"redo"),d.Yb(),d.Zb(3,"span"),d.Sc(4),d.mc(5,"translate"),d.Yb(),d.Yb()}2&t&&(d.Gb(4),d.Tc(d.nc(5,1,"Go to line")))}var Mc=function(t){return{selected:t}};function Ic(t,e){if(1&t){var n=d.ac();d.Zb(0,"div"),d.Zb(1,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setLineNumberingMode(t.LineNumberingMode.None)})),d.Sc(2),d.mc(3,"translate"),d.Yb(),d.Zb(4,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setLineNumberingMode(t.LineNumberingMode.Inside)})),d.Sc(5),d.mc(6,"translate"),d.Yb(),d.Zb(7,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setLineNumberingMode(t.LineNumberingMode.Outside)})),d.Sc(8),d.mc(9,"translate"),d.Yb(),d.Ub(10,"mat-divider"),d.Qc(11,Sc,6,3,"button",28),d.Yb()}if(2&t){var i=d.lc();d.Gb(1),d.tc("ngClass",d.zc(13,Mc,i.lnMode===i.LineNumberingMode.None)),d.Gb(1),d.Uc(" ",d.nc(3,7,"none")," "),d.Gb(2),d.tc("ngClass",d.zc(15,Mc,i.lnMode===i.LineNumberingMode.Inside)),d.Gb(1),d.Uc(" ",d.nc(6,9,"inline")," "),d.Gb(2),d.tc("ngClass",d.zc(17,Mc,i.lnMode===i.LineNumberingMode.Outside)),d.Gb(1),d.Uc(" ",d.nc(9,11,"outside")," "),d.Gb(3),d.tc("ngIf",!i.highlightedLineOpened)}}function Tc(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setChangeRecoMode(t.ChangeRecoMode.Changed)})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc();d.tc("ngClass",d.zc(4,Mc,i.crMode===i.ChangeRecoMode.Changed)),d.Gb(1),d.Uc(" ",d.nc(2,2,"Changed version")," ")}}function wc(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setChangeRecoMode(t.ChangeRecoMode.Diff)})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc();d.tc("ngClass",d.zc(4,Mc,i.crMode===i.ChangeRecoMode.Diff)),d.Gb(1),d.Uc(" ",d.nc(2,2,"Diff version")," ")}}function Gc(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setChangeRecoMode(t.ChangeRecoMode.Final)})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc();d.tc("ngClass",d.zc(4,Mc,i.crMode===i.ChangeRecoMode.Final)),d.Gb(1),d.Uc(" ",d.nc(2,2,"Final version")," ")}}function xc(t,e){if(1&t){var n=d.ac();d.Zb(0,"button",17),d.hc("click",(function(){d.Ic(n);var t=d.lc();return t.setChangeRecoMode(t.ChangeRecoMode.ModifiedFinal)})),d.Sc(1),d.mc(2,"translate"),d.Yb()}if(2&t){var i=d.lc();d.tc("ngClass",d.zc(4,Mc,i.crMode===i.ChangeRecoMode.ModifiedFinal)),d.Gb(1),d.Uc(" ",d.nc(2,2,"Final print template")," ")}}var Yc,Zc,Oc,Rc=[{path:"",component:(Yc=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,o,a,c,r,s,l,m,u,b,d,f,g,h,p,v,k,_,y,C,S,M,I,T,w,G,x,Y,Z,O,R,P){var F;return _classCallCheck(this,n),(F=e.call(this,t,i,o)).translate=i,F.vp=a,F.operator=c,F.perms=r,F.router=s,F.route=l,F.formBuilder=m,F.dialogService=u,F.el=b,F.repo=d,F.changeRecoRepo=f,F.statuteRepo=g,F.configService=h,F.promptService=p,F.pdfExport=v,F.personalNoteService=k,F.linenumberingService=_,F.categoryRepo=y,F.userRepo=C,F.notifyService=S,F.tagRepo=M,F.workflowRepo=I,F.blockRepo=T,F.itemRepo=w,F.motionSortService=G,F.amendmentSortService=x,F.motionFilterService=Y,F.amendmentFilterService=Z,F.cd=O,F.pollDialog=R,F.motionPollService=P,F.editMotion=!1,F.amendmentEdit=!1,F.newMotion=!1,F.motionLogExpanded=!1,F.finalEditMode=!1,F.amendmentChangeRecos={},F.amendmentChangeRecoSubscriptions={},F.allChangingObjects=[],F.statuteParagraphs=[],F.showSupporters=!1,F.scrollToChange=null,F.showAmendmentContext=!1,F.showAllAmendments=!1,F.ChangeRecoMode=et.b,F.verboseChangeRecoMode=et.k,F.LineNumberingMode=et.d,F.newStateExtension="",F.recommendationStateExtension="",F.NOTIFICATION_EDIT_MOTION="notifyEditMotion",F.otherWorkOnMotion=[],F.recommendationReferencingMotions=[],F}return _createClass(n,[{key:"ngOnInit",value:function(){var t=this;this.tagObserver=this.tagRepo.getViewModelListBehaviorSubject(),this.workflowObserver=this.workflowRepo.getViewModelListBehaviorSubject(),this.blockObserver=this.blockRepo.getViewModelListBehaviorSubject(),this.motionObserver=this.repo.getViewModelListBehaviorSubject(),this.submitterObserver=this.userRepo.getViewModelListBehaviorSubject(),this.supporterObserver=this.userRepo.getViewModelListBehaviorSubject(),this.categoryObserver=this.categoryRepo.getViewModelListBehaviorSubject(),this.createForm(),this.observeRoute(),this.getMotionByUrl(),this.configService.get("motions_statutes_enabled").subscribe((function(e){return t.statutesEnabled=e})),this.configService.get("motions_reason_required").subscribe((function(e){return t.reasonRequired=e})),this.configService.get("motions_hide_referring_motions").subscribe((function(e){return t.showReferringMotions=!e})),this.configService.get("motions_min_supporters").subscribe((function(e){return t.minSupporters=e})),this.configService.get("motions_preamble").subscribe((function(e){return t.preamble=e})),this.configService.get("motions_amendments_enabled").subscribe((function(e){return t.amendmentsEnabled=e})),this.configService.get("motions_line_length").subscribe((function(e){t.lineLength=e,t.recalcUnifiedChanges()})),this.configService.get("motions_default_line_numbering").subscribe((function(e){return t.lnMode=e})),this.configService.get("motions_recommendation_text_mode").subscribe((function(e){e&&(t.crMode=t.determineCrMode(e))})),this.configService.get("motions_show_sequential_numbers").subscribe((function(e){return t.showSequential=e})),this.statuteRepo.getViewModelListObservable().subscribe((function(e){t.statuteParagraphs=e})),this.configService.instant("motions_amendments_main_table")?(this.motionFilterService.initFilters(this.motionObserver),this.motionSortService.initSorting(this.motionFilterService.outputObservable),this.sortedMotionsObservable=this.motionSortService.outputObservable):this.motion&&this.motion.parent_id?(this.amendmentFilterService.initFilters(this.repo.amendmentsTo(this.motion.parent_id)),this.amendmentSortService.initSorting(this.amendmentFilterService.outputObservable),this.sortedMotionsObservable=this.amendmentSortService.outputObservable):this.sortedMotions=[],this.sortedMotionsObservable&&this.subscriptions.push(this.sortedMotionsObservable.subscribe((function(e){e&&(t.sortedMotions=e,t.setSurroundingMotions())}))),this.vp.isMobileSubject.subscribe((function(){t.cd.markForCheck()}))}},{key:"ngOnDestroy",value:function(){this.unsubscribeEditNotifications(et.e.TYPE_CLOSING_EDITING_MOTION),this.navigationSubscription&&this.navigationSubscription.unsubscribe(),_get(_getPrototypeOf(n.prototype),"ngOnDestroy",this).call(this),this.cd.detach()}},{key:"observeRoute",value:function(){var t=this;this.navigationSubscription=this.router.events.subscribe((function(e){e instanceof a.c&&(t.cleanSubjects(),t.getMotionByUrl())}))}},{key:"resetAmendmentChangeRecoListener",value:function(){var t=this;this.amendments.forEach((function(e){void 0===t.amendmentChangeRecoSubscriptions[e.id]&&(t.amendmentChangeRecoSubscriptions[e.id]=t.changeRecoRepo.getChangeRecosOfMotionObservable(e.id).subscribe((function(n){t.amendmentChangeRecos[e.id]=n,t.recalcUnifiedChanges()})))}))}},{key:"recalcUnifiedChanges",value:function(){var t=this;this.lineLength&&(this.allChangingObjects=[],this.changeRecommendations&&this.changeRecommendations.forEach((function(e){t.allChangingObjects.push(e)})),this.amendments&&this.amendments.filter((function(t){return t.isParagraphBasedAmendment()})).forEach((function(e){var n=(t.amendmentChangeRecos[e.id]||[]).filter((function(t){return t.showInFinalView()}));t.repo.getAmendmentAmendedParagraphs(e,t.lineLength,n).forEach((function(e){t.allChangingObjects.push(e)}))})),this.allChangingObjects.sort((function(t,e){return t.getLineFrom()<e.getLineFrom()?-1:t.getLineFrom()>e.getLineFrom()?1:0})),this.crMode&&(this.crMode=this.determineCrMode(this.crMode)),this.cd.markForCheck())}},{key:"getMotionByUrl",value:function(){var t=this,e=this.route.snapshot.params;if(e&&e.id){var i=+e.id;this.subscriptions.push(this.repo.getViewModelObservable(i).subscribe((function(e){if(e){e.isParagraphBasedAmendment()&&(t.contentForm.get("text").clearValidators(),t.contentForm.get("text").updateValueAndValidity());var i=e.getTitle();_get(_getPrototypeOf(n.prototype),"setTitle",t).call(t,i),t.motion=e,t.newStateExtension=t.motion.stateExtension,t.recommendationStateExtension=t.motion.recommendationExtension,t.editMotion||t.patchForm(t.motion),t.cd.markForCheck()}})),this.repo.amendmentsTo(i).subscribe((function(e){t.amendments=e,t.resetAmendmentChangeRecoListener(),t.recalcUnifiedChanges()})),this.repo.getRecommendationReferencingMotions(i).subscribe((function(e){return t.recommendationReferencingMotions=e})),this.changeRecoRepo.getChangeRecosOfMotionObservable(i).subscribe((function(e){t.changeRecommendations=e,t.recalcUnifiedChanges()})))}else{_get(_getPrototypeOf(n.prototype),"setTitle",this).call(this,"New motion"),this.newMotion=!0,this.editMotion=!0;var o={};if(this.route.snapshot.queryParams.parent){this.amendmentEdit=!0;var a=this.repo.getViewModel(this.route.snapshot.queryParams.parent),c="".concat(this.translate.instant("Amendment to")," ").concat(a.identifierOrTitle);o.title=c,o.parent_id=a.id,o.category_id=a.category_id,o.tags_id=a.tags_id,o.motion_block_id=a.motion_block_id,this.contentForm.patchValue({title:c,category_id:a.category_id,motion_block_id:a.motion_block_id,parent_id:a.id,tags_id:a.tags_id}),"fulltext"===this.configService.instant("motions_amendments_text_mode")&&(o.text=a.text,this.contentForm.patchValue({text:o.text}))}this.motion=new J(new b.a(o))}}},{key:"patchForm",value:function(t){var e=this,n={};if(Object.keys(this.contentForm.controls).forEach((function(e){n[e]=t[e]})),t.isParagraphBasedAmendment()){n.selected_paragraphs=[];var i=this.repo.getViewModel(t.parent_id);i&&this.lineLength&&this.repo.getParagraphsToChoose(i,this.lineLength).forEach((function(i,o){null!==t.amendment_paragraphs[o]&&(e.contentForm.addControl("text_"+o,new r.g("")),n.selected_paragraphs.push(i),n.text=t.amendment_paragraphs[o],n["text_"+o]=t.amendment_paragraphs[o])}))}n.statute_amendment=t.isStatuteAmendment(),this.contentForm.patchValue(n)}},{key:"createForm",value:function(){var t=[""];this.reasonRequired&&t.push(r.G.required),this.contentForm=this.formBuilder.group({identifier:[""],title:["",r.G.required],text:["",r.G.required],reason:t,category_id:[""],attachments_id:[[]],agenda_create:[""],agenda_parent_id:[],agenda_type:[""],submitters_id:[],supporters_id:[[]],workflow_id:[],tags_id:[],origin:[""],selected_paragraphs:[],statute_amendment:[""],statute_paragraph_id:[""],motion_block_id:[],parent_id:[],modified_final_version:[""]}),this.updateWorkflowIdForCreateForm();var e=this;this.highlightedLineMatcher=new(function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"isErrorState",value:function(t){var n=t&&t.value?t.value+"":"",i=e.repo.getLastLineNumber(e.motion,e.lineLength);return null!==n.match(/[^\d]/)||parseInt(n,10)>=i}}]),t}())}},{key:"onKeyDown",value:function(t){"Enter"===t.key&&t.shiftKey&&this.saveMotion()}},{key:"onKeyNavigation",value:function(t){"ArrowLeft"===t.key&&t.altKey&&t.shiftKey&&this.navigateToMotion(this.previousMotion),"ArrowRight"===t.key&&t.altKey&&t.shiftKey&&this.navigateToMotion(this.nextMotion)}},{key:"prepareMotionForSave",value:function(t,e){var n=new e;return this.motion.isParagraphBasedAmendment()&&(n.amendment_paragraphs=this.motion.amendment_paragraphs.map((function(e,n){return null===e?null:t["text_"+n]})),t.text=""),n.deserialize(t),n}},{key:"createMotion",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(e=Object.assign({},this.contentForm.value)).agenda_parent_id||delete e.agenda_parent_id,n=this.prepareMotionForSave(e,b.a),t.prev=3,t.next=6,this.repo.create(n);case 6:i=t.sent,this.router.navigate(["./motions/"+i.id]),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(3),this.raiseError(this.translate.instant(t.t0));case 13:case"end":return t.stop()}}),t,this,[[3,10]])})))}},{key:"updateMotionFromForm",value:function(){var t=this,e=Object.assign({},this.contentForm.value);this.updateMotion(e,this.motion).then((function(){t.editMotion=!1,t.amendmentEdit=!1}),this.raiseError)}},{key:"updateMotion",value:function(t,e){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=this.prepareMotionForSave(t,X.a),n.next=3,this.repo.update(i,e);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"saveMotion",value:function(){this.newMotion?this.createMotion():(this.updateMotionFromForm(),this.unsubscribeEditNotifications(et.e.TYPE_SAVING_EDITING_MOTION))}},{key:"getFormattedTextPlain",value:function(){var t=Object.assign([],this.getAllTextChangingObjects());return this.repo.formatMotion(this.motion.id,this.crMode,t,this.lineLength,this.highlightedLine)}},{key:"getAmendmentDiffTextWithContext",value:function(t){return'<div class="paragraphcontext">'+t.textPre+"</div><div>"+t.text+'</div><div class="paragraphcontext">'+t.textPost+"</div>"}},{key:"getAmendmentParagraphs",value:function(){return this.repo.getAmendmentParagraphLines(this.motion,this.lineLength,this.crMode,this.changeRecommendations,this.showAmendmentContext)}},{key:"getAmendmentParagraphLinesTitle",value:function(t){return this.repo.getAmendmentParagraphLinesTitle(t)}},{key:"getFormattedStatuteAmendment",value:function(){return this.repo.formatStatuteAmendment(this.statuteParagraphs,this.motion,this.lineLength)}},{key:"getChangesForDiffMode",value:function(){var t=this;return this.allChangingObjects.filter((function(e){return!!t.showAllAmendments||e.showInDiffView()}))}},{key:"getChangesForFinalMode",value:function(){return this.allChangingObjects.filter((function(t){return t.showInFinalView()}))}},{key:"getAllTextChangingObjects",value:function(){return this.allChangingObjects.filter((function(t){return!t.isTitleChange()}))}},{key:"getTitleChangingObject",value:function(){return this.allChangingObjects.find((function(t){return t.isTitleChange()}))}},{key:"getTitleWithChanges",value:function(){return this.changeRecoRepo.getTitleWithChanges(this.motion.title,this.getTitleChangingObject(),this.crMode)}},{key:"deleteMotionButton",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Are you sure you want to delete this motion?"),n=this.motion.getTitle(),t.next=3,this.promptService.open(e,n);case 3:if(t.t0=t.sent,!t.t0){t.next=8;break}return t.next=7,this.repo.delete(this.motion);case 7:this.router.navigate(["../motions/"]);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"setLineNumberingMode",value:function(t){this.lnMode=t}},{key:"isLineNumberingNone",value:function(){return this.lnMode===et.d.None}},{key:"isLineNumberingInline",value:function(){return this.lnMode===et.d.Inside}},{key:"isLineNumberingOutside",value:function(){return this.lnMode===et.d.Outside}},{key:"setChangeRecoMode",value:function(t){this.crMode=t}},{key:"isRecoMode",value:function(t){return this.crMode===t}},{key:"gotoHighlightedLine",value:function(t){var e=this,n=this.repo.getLastLineNumber(this.motion,this.lineLength);t>=n||(this.highlightedLine=t,window.setTimeout((function(){var n=e.el.nativeElement,i=n.querySelector(".os-line-number.line-number-"+t.toString(10)).getBoundingClientRect();i.top>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)||n.querySelector(t>4?".os-line-number.line-number-"+(t-4).toString(10):".title-line").scrollIntoView({behavior:"smooth"})}),1))}},{key:"createChangeRecommendation",value:function(t){var e={editChangeRecommendation:!1,newChangeRecommendation:!0,lineRange:t,changeRecommendation:null};if(this.motion.isParagraphBasedAmendment()){var n=this.repo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!1);e.changeRecommendation=this.changeRecoRepo.createAmendmentChangeRecommendationTemplate(this.motion,n,t,this.lineLength)}else e.changeRecommendation=this.changeRecoRepo.createMotionChangeRecommendationTemplate(this.motion,t,this.lineLength);this.dialogService.open(pt,Object.assign(Object.assign({},K.c),{data:e}))}},{key:"createTitleChangeRecommendation",value:function(){var t={editChangeRecommendation:!1,newChangeRecommendation:!0,changeRecommendation:this.changeRecoRepo.createTitleChangeRecommendationTemplate(this.motion,this.lineLength)};this.dialogService.open(_t,Object.assign(Object.assign({},K.a),{data:t}))}},{key:"titleCanBeChanged",value:function(){return!this.editMotion&&!this.motion.isStatuteAmendment()&&!this.motion.isParagraphBasedAmendment()&&(this.isRecoMode(et.b.Original)||this.isRecoMode(et.b.Diff))}},{key:"gotoChangeRecommendation",value:function(t){this.scrollToChange=t,this.setChangeRecoMode(et.b.Diff)}},{key:"createAmendment",value:function(){"paragraph"===this.configService.instant("motions_amendments_text_mode")?this.router.navigate(["./create-amendment"],{relativeTo:this.route}):this.router.navigate(["./motions/new-amendment"],{relativeTo:this.route.snapshot.params.relativeTo,queryParams:{parent:this.motion.id||null}})}},{key:"createModifiedFinalVersion",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object.assign([],this.getChangesForFinalMode()),n=this.repo.formatMotion(this.motion.id,et.b.Final,e,this.lineLength,this.highlightedLine),n=this.linenumberingService.stripLineNumbers(n),t.prev=3,t.next=6,this.updateMotion({modified_final_version:n},this.motion);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(3),this.raiseError(t.t0);case 11:case"end":return t.stop()}}),t,this,[[3,8]])})))}},{key:"deleteModifiedFinalVersion",value:function(){return Object(c.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.translate.instant("Are you sure you want to delete the print template?"),t.next=3,this.promptService.open(e);case 3:if(t.t0=t.sent,!t.t0){t.next=6;break}this.finalEditMode=!1,this.updateMotion({modified_final_version:""},this.motion).then((function(){return n.setChangeRecoMode(et.b.Final)}),this.raiseError);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"setEditMode",value:function(t){this.editMotion=t,t&&(this.patchForm(this.motion),this.editNotificationSubscription=this.listenToEditNotification(),this.sendEditNotification(et.e.TYPE_BEGIN_EDITING_MOTION)),!t&&this.newMotion&&this.router.navigate(["./motions/"]),t||this.newMotion||this.unsubscribeEditNotifications(et.e.TYPE_CLOSING_EDITING_MOTION)}},{key:"updateWorkflowIdForCreateForm",value:function(t){var e=!!this.contentForm.get("statute_amendment").value&&!!t,n=this.configService.instant(e?"motions_statute_amendments_workflow":"motions_workflow");this.contentForm.patchValue({workflow_id:+n})}},{key:"onStatuteAmendmentChange",value:function(t){this.contentForm.patchValue({statute_paragraph_id:null}),this.updateWorkflowIdForCreateForm()}},{key:"onStatuteParagraphChange",value:function(t){var e=this.statuteParagraphs.find((function(e){return e.id===t}));this.contentForm.patchValue({title:this.translate.instant("Statute amendment for")+" "+e.title,text:e.text}),this.updateWorkflowIdForCreateForm(t)}},{key:"navigateToMotion",value:function(t){t&&(this.router.navigate(["../"+t.id],{relativeTo:this.route.parent}),this.motion=t,this.setSurroundingMotions())}},{key:"setSurroundingMotions",value:function(){var t=this,e=this.sortedMotions.findIndex((function(e){return e===t.motion}));this.previousMotion=e>0?this.sortedMotions[e-1]:null,this.nextMotion=e>-1&&e<this.sortedMotions.length-1?this.sortedMotions[e+1]:null,this.cd.markForCheck()}},{key:"support",value:function(){this.repo.support(this.motion).catch(this.raiseError)}},{key:"unsupport",value:function(){this.repo.unsupport(this.motion).catch(this.raiseError)}},{key:"openSupportersDialog",value:function(){this.showSupporters=!this.showSupporters}},{key:"setState",value:function(t){this.repo.setState(this.motion,t).catch(this.raiseError)}},{key:"setStateExtension",value:function(t){this.repo.setStateExtension(this.motion,t)}},{key:"setRecommendation",value:function(t){this.repo.setRecommendation(this.motion,t)}},{key:"setRecommendationExtension",value:function(t){this.repo.setRecommendationExtension(this.motion,t)}},{key:"setCategory",value:function(t){t===this.motion.category_id&&(t=null),this.repo.setCatetory(this.motion,t).catch(this.raiseError)}},{key:"setTag",value:function(t,e){t.stopPropagation(),this.repo.setTag(this.motion,e).catch(this.raiseError)}},{key:"setBlock",value:function(t){t===this.motion.motion_block_id&&(t=null),this.repo.setBlock(this.motion,t).catch(this.raiseError)}},{key:"setupRecommender",value:function(){var t=this;if(this.motion){var e=this.motion.isStatuteAmendment()?"motions_statute_recommendations_by":"motions_recommendations_by";this.recommenderSubscription&&this.recommenderSubscription.unsubscribe(),this.recommenderSubscription=this.configService.get(e).subscribe((function(e){t.recommender=e}))}}},{key:"onDownloadPdf",value:function(){this.pdfExport.exportSingleMotion(this.motion,{lnMode:this.lnMode===this.LineNumberingMode.Inside?this.LineNumberingMode.Outside:this.lnMode,crMode:this.crMode,comments:this.motion.commentSectionIds.concat([et.f])})}},{key:"onClickAttachment",value:function(t){window.open(t.url)}},{key:"canFollowRecommendation",value:function(){return!!(this.perms.isAllowed("createpoll",this.motion)&&this.motion.recommendation&&this.motion.recommendation.recommendation_label)}},{key:"onFollowRecButton",value:function(){this.repo.followRecommendation(this.motion)}},{key:"sendEditNotification",value:function(t,e){var n={motionId:this.motion.id,senderId:this.operator.viewUser.id,senderName:this.operator.viewUser.short_name,type:t};e?this.notifyService.sendToUsers(this.NOTIFICATION_EDIT_MOTION,n,e):this.notifyService.sendToAllUsers(this.NOTIFICATION_EDIT_MOTION,n)}},{key:"determineCrMode",value:function(t){var e,n,i,o,a;if(t===et.b.Final){if(null===(e=this.motion)||void 0===e?void 0:e.modified_final_version)return et.b.ModifiedFinal;if(!(null===(n=this.allChangingObjects)||void 0===n?void 0:n.length))return et.b.Original}else{if(t===et.b.Changed&&!(null===(i=this.allChangingObjects)||void 0===i?void 0:i.length))return et.b.Original;if(t===et.b.Diff&&!(null===(o=this.changeRecommendations)||void 0===o?void 0:o.length)&&(null===(a=this.motion)||void 0===a?void 0:a.isParagraphBasedAmendment()))return et.b.Original}return t}},{key:"listenToEditNotification",value:function(){var t=this;return this.notifyService.getMessageObservable(this.NOTIFICATION_EDIT_MOTION).subscribe((function(e){var n=e.content;if(t.operator.viewUser.id!==n.senderId&&n.motionId===t.motion.id){var i="";switch(n.type){case et.e.TYPE_BEGIN_EDITING_MOTION:case et.e.TYPE_ALSO_EDITING_MOTION:t.otherWorkOnMotion.includes(n.senderName)||t.otherWorkOnMotion.push(n.senderName),i="".concat(t.translate.instant("Following users are currently editing this motion:")," ").concat(t.otherWorkOnMotion),n.type===et.e.TYPE_BEGIN_EDITING_MOTION&&t.sendEditNotification(et.e.TYPE_ALSO_EDITING_MOTION,e.senderUserId);break;case et.e.TYPE_CLOSING_EDITING_MOTION:t.recognizeOtherWorkerOnMotion(n.senderName);break;case et.e.TYPE_SAVING_EDITING_MOTION:i="".concat(n.senderName," ").concat(t.translate.instant("has saved his work on this motion.")),setTimeout((function(){return t.recognizeOtherWorkerOnMotion(n.senderName)}),2e3)}""!==i&&t.raiseWarning(i)}}))}},{key:"recognizeOtherWorkerOnMotion",value:function(t){this.otherWorkOnMotion=this.otherWorkOnMotion.filter((function(e){return e!==t})),0===this.otherWorkOnMotion.length&&this.closeSnackBar()}},{key:"unsubscribeEditNotifications",value:function(t){this.editNotificationSubscription&&!this.editNotificationSubscription.closed&&(this.sendEditNotification(t),this.closeSnackBar(),this.editNotificationSubscription.unsubscribe())}},{key:"onSubmitFinalVersion",value:function(){var t=this,e=this.contentForm.get("modified_final_version").value;this.updateMotion({modified_final_version:e},this.motion).then((function(){t.finalEditMode=!1,t.contentForm.get("modified_final_version").markAsPristine()}),this.raiseError)}},{key:"cancelFinalVersionEdit",value:function(){this.finalEditMode=!1,this.contentForm.patchValue({modified_final_version:this.motion.modified_final_version})}},{key:"toggleFavorite",value:function(){this.motion.personalNote?this.motion.personalNote.star=!this.motion.personalNote.star:this.motion.personalNote={note:"",star:!0},this.personalNoteService.savePersonalNote(this.motion,this.motion.personalNote).catch(this.raiseError)}},{key:"showUploadError",value:function(t){this.raiseError(t)}},{key:"stopClosing",value:function(t){this.editMotion&&(t.returnValue=null)}},{key:"swipe",value:function(t,e){var n=[t.changedTouches[0].pageX,t.changedTouches[0].pageY],i=(new Date).getTime();if("start"===e)this.swipeCoord=n,this.swipeTime=i;else if("end"===e){var o=[n[0]-this.swipeCoord[0],n[1]-this.swipeCoord[1]];i-this.swipeTime<1e3&&Math.abs(o[0])>30&&Math.abs(o[0])>Math.abs(3*o[1])&&(o[0]>0&&this.navigateToMotion(this.previousMotion),o[0]<0&&this.navigateToMotion(this.nextMotion))}}},{key:"editModifiedFinal",value:function(){this.finalEditMode=!0}},{key:"addToAgenda",value:function(){this.itemRepo.addItemToAgenda(this.motion).catch(this.raiseError)}},{key:"removeFromAgenda",value:function(){this.itemRepo.removeFromAgenda(this.motion.item).catch(this.raiseError)}},{key:"detectChanges",value:function(){this.cd.markForCheck()}},{key:"openDialog",value:function(){var t=Object.assign({collectionString:tt.a.COLLECTIONSTRING,motion_id:this.motion.id,motion:this.motion},this.motionPollService.getDefaultPollData(this.motion.id));this.pollDialog.openDialog(t)}},{key:"motion",set:function(t){this._motion=t,this.setupRecommender()},get:function(){return this._motion}},{key:"recommendationLabel",get:function(){return this.repo.getExtendedRecommendationLabel(this.motion)}},{key:"stateLabel",get:function(){return this.repo.getExtendedStateLabel(this.motion)}},{key:"isFinalEdit",get:function(){return this.finalEditMode}},{key:"finalVersionEdited",get:function(){return this.crMode===et.b.ModifiedFinal&&this.contentForm.get("modified_final_version").value!==this.motion.modified_final_version}}]),n}(u.a),Yc.\u0275fac=function(t){return new(t||Yc)(d.Tb(f.d),d.Tb(g.k),d.Tb(h.a),d.Tb(H.a),d.Tb(Q.a),d.Tb(ot.a),d.Tb(a.f),d.Tb(a.a),d.Tb(r.f),d.Tb(mt.b),d.Tb(d.m),d.Tb(s.a),d.Tb(U.a),d.Tb(V.a),d.Tb(l.a),d.Tb(m.a),d.Tb(ct.a),d.Tb($.a),d.Tb(q.a),d.Tb(j.a),d.Tb(W.a),d.Tb(E.a),d.Tb(z.a),d.Tb(B.a),d.Tb(D.a),d.Tb(A.a),d.Tb(lt.a),d.Tb(it.a),d.Tb(at.a),d.Tb(nt.a),d.Tb(d.h),d.Tb(rt.a),d.Tb(st.a))},Yc.\u0275cmp=d.Nb({type:Yc,selectors:[["os-motion-detail"]],hostBindings:function(t,e){1&t&&d.hc("keydown",(function(t){return e.onKeyNavigation(t)}),!1,d.Gc)("beforeunload",(function(t){return e.stopClosing(t)}),!1,d.Hc)},features:[d.Db],decls:38,vars:25,consts:[["mainActionTooltip","New amendment","prevUrl","../..",3,"hasMainButton","nav","editMode","isSaveButtonEnabled","mainEvent","cancelEditEvent","saveEvent"],[1,"title-slot"],[4,"ngIf"],["class","extra-controls-slot prev-next-motion-controls",4,"ngIf"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],["motionExtraMenu","matMenu"],[1,"content-container","spacer-bottom-60",3,"touchstart","touchend"],["class","title",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["mobileView",""],["desktopView",""],["metaInfoTemplate",""],["contentTemplate",""],["paragraphBasedAmendment",""],["lineNumberingMenu","matMenu"],["changeRecoMenu","matMenu"],["mat-menu-item","",3,"ngClass","click"],["mat-menu-item","",3,"ngClass","click",4,"ngIf"],[1,"extra-controls-slot","prev-next-motion-controls"],["mat-button","",3,"click"],["icon","chevron_left"],["icon","chevron_right",3,"swap"],[3,"object","menuItem"],["mat-menu-item","",3,"click"],[4,"osPerms"],[3,"object","menuItem",4,"osPerms"],["mat-menu-item","",3,"routerLink","queryParams",4,"osPerms"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","red-warning-text",3,"click",4,"ngIf"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",1,"red-warning-text",3,"click"],[1,"title"],[1,"title-line"],[1,"motion-title"],["mat-icon-button","",1,"primary-accent-by-theme",3,"matTooltip","click"],[1,"main-nav-color","title-font"],["class","title-change-indicator",3,"click",4,"ngIf"],["class","change-title",3,"click",4,"osPerms","osPermsAnd"],[1,"title-change-indicator",3,"click"],[1,"change-title",3,"click"],[3,"routerLink","state"],["class","mobile-view",4,"ngIf"],[1,"mobile-view"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"motion",4,"ngIf"],[3,"motion"],["class","desktop-view",4,"ngIf"],[1,"desktop-view"],[1,"desktop-left"],[1,"desktop-right"],["class","spacer-top-20 spacer-bottom-20",4,"ngIf"],["type","button","mat-stroked-button","","color","accent",3,"click",4,"ngIf"],["type","button","mat-button","",3,"click",4,"ngIf"],["class","supporters",4,"ngIf"],["type","button","mat-stroked-button","","color","accent",3,"click"],["type","button","mat-button","",3,"click"],[1,"supporters"],[4,"ngFor","ngForOf"],[3,"title","canBeEdited","hasExtension","chipValue","inputValue","classes","extensionLabel","success"],["class","trigger-menu",4,"ngIf"],[1,"trigger-menu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["listValuePrefix","motion:",3,"title","inputValue","canBeEdited","chipValue","hasExtension","extensionLabel","searchList","searchListLabel","success"],["mat-stroked-button","","class","spacer-top-10",3,"click",4,"ngIf"],["mat-stroked-button","",1,"spacer-top-10",3,"click"],[1,"nowrap",3,"routerLink"],["categoryMenu","matMenu"],["class","grey multi-line-chip","disableRipple","",3,"matMenuTriggerFor",4,"ngIf"],["class","grey","disableRipple","",4,"ngIf"],["disableRipple","",1,"grey","multi-line-chip",3,"matMenuTriggerFor"],["disableRipple","",1,"grey"],["tagMenu","matMenu"],[3,"matMenuTriggerFor"],["class","grey","disabled","","disableRipple","",4,"ngIf"],[1,"mat-chip-list-stacked"],["class","grey","disabled","","disableRipple","",4,"ngFor","ngForOf"],["disabled","","disableRipple","",1,"grey"],["class","grey","disableRipple","",4,"ngFor","ngForOf"],["blockMenu","matMenu"],["class","grey","disableRipple","",3,"matMenuTriggerFor",4,"ngIf"],["disableRipple","",1,"grey",3,"matMenuTriggerFor"],[3,"ngModel","ngModelChange",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"spacer-top-20","spacer-bottom-20"],[3,"poll",4,"ngFor","ngForOf","ngForTrackBy"],["class","create-poll-button","create-poll-button","","mat-stroked-button","",3,"click",4,"ngIf"],[3,"poll"],["create-poll-button","","mat-stroked-button","",1,"create-poll-button",3,"click"],[1,"main-nav-color"],[1,"motion-content",3,"formGroup","keydown"],["class","motion-text-toolbar-wrapper",4,"ngIf"],["class","statute-amendment-selector",4,"ngIf"],["class","content-field",4,"ngIf"],[1,"form-id-title"],["class","content-field form-identifier",4,"ngIf"],["class","content-field form-title",4,"ngIf"],["class","text-prefix-label",4,"ngIf"],["class","motion-text line-numbers-none",3,"innerHTML",4,"ngIf"],[1,"extra-data"],[1,"motion-text-toolbar-wrapper"],[1,"motion-text-controls"],["class","motion-goto-line",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-button","",3,"matMenuTriggerFor"],["type","button","mat-button","",3,"matMenuTriggerFor",4,"ngIf"],[1,"motion-goto-line"],["type","number","min","1","matInput","","osAutofocus","",3,"placeholder","ngModel","ngModelOptions","errorStateMatcher","ngModelChange"],["type","submit","mat-button","","matSuffix","","mat-icon-button","","aria-label","Go to line",3,"click",4,"ngIf"],["type","submit","mat-button","","matSuffix","","mat-icon-button","","aria-label","Go to line",3,"click"],["mat-icon-button","",3,"click"],["type","button","mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["type","button","mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-icon-button","",3,"disabled","click",4,"ngIf"],["type","button","class","red-warning-text","mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["type","button","mat-icon-button","",3,"matTooltip","click"],["type","button","mat-icon-button","",3,"click"],["type","button","mat-icon-button","",3,"disabled","click"],["type","button","mat-icon-button","",1,"red-warning-text",3,"matTooltip","click"],[1,"statute-amendment-selector"],["formControlName","statute_amendment",3,"change"],["formControlName","statute_paragraph_id",3,"placeholder","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"content-field"],["formControlName","submitters_id",3,"multiple","placeholder","inputListValues"],[1,"content-field","form-identifier"],["matInput","","autofocus","","formControlName","identifier",3,"placeholder"],[1,"content-field","form-title"],["matInput","","formControlName","title","required","",3,"placeholder"],[1,"text-prefix-label"],["class","motion-text",3,"line-numbers-none","line-numbers-inline","line-numbers-outside",4,"ngIf"],[3,"motion","changes","scrollToChange","highlightedLine","showAllAmendments","lineNumberingMode","createChangeRecommendation",4,"ngIf"],[1,"motion-text"],[3,"html","changeRecommendations","createChangeRecommendation","gotoChangeRecommendation",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[3,"html","changeRecommendations","createChangeRecommendation","gotoChangeRecommendation"],[3,"innerHTML"],[3,"motion","changes","scrollToChange","highlightedLine","showAllAmendments","lineNumberingMode","createChangeRecommendation"],["formControlName","modified_final_version","required","",3,"hidden","init","onChange"],["class","red-warning-text",4,"ngIf"],[1,"red-warning-text"],[1,"motion-text","line-numbers-none",3,"innerHTML"],["formControlName","text","required","",3,"init","ngModelChange"],["class","line-number",4,"ngIf"],[3,"formControlName","init"],[1,"line-number"],["class","motion-text",3,"innerHtml",4,"ngIf"],["formControlName","reason",3,"init","required",4,"ngIf"],[1,"motion-text",3,"innerHtml"],["formControlName","reason",3,"init","required"],["formControlName","category_id",3,"includeNone","placeholder","inputListValues"],[4,"osPerms","osPermsAnd"],["dense",""],[3,"routerLink","click"],["formControlName","attachments_id",3,"errorHandler"],[3,"form"],["formControlName","supporters_id",3,"multiple","placeholder","inputListValues"],["formControlName","workflow_id",3,"placeholder","inputListValues"],["matInput","","formControlName","origin",3,"placeholder"],[1,"text-holder"],["class","alert alert-info",4,"ngIf"],[1,"alert","alert-info"],["class","motion-text motion-text-diff amendment-view",3,"line-numbers-none","line-numbers-inline","line-numbers-outside","amendment-context",4,"ngFor","ngForOf"],[1,"motion-text","motion-text-diff","amendment-view"],["class","amendment-line-header",4,"ngIf"],[3,"outerHTML",4,"ngIf"],[1,"amendment-line-header"],[3,"outerHTML"],["class","show-entire-text-check",3,"change",4,"ngIf"],[1,"show-entire-text-check",3,"change"]],template:function(t,e){if(1&t&&(d.Zb(0,"os-head-bar",0),d.hc("mainEvent",(function(){return e.createAmendment()}))("cancelEditEvent",(function(){return e.setEditMode(!1)}))("saveEvent",(function(){return e.saveMotion()})),d.Zb(1,"div",1),d.Qc(2,ri,8,5,"h2",2),d.Qc(3,si,3,3,"h2",2),d.Qc(4,li,3,3,"h2",2),d.Yb(),d.Qc(5,bi,3,2,"div",3),d.Zb(6,"div",4),d.Zb(7,"button",5),d.Zb(8,"mat-icon"),d.Sc(9,"more_vert"),d.Yb(),d.Yb(),d.Yb(),d.Zb(10,"mat-menu",null,6),d.Qc(12,xi,16,14,"div",2),d.Yb(),d.Yb(),d.Zb(13,"div",7),d.hc("touchstart",(function(t){return e.swipe(t,"start")}))("touchend",(function(t){return e.swipe(t,"end")})),d.Qc(14,Li,13,9,"div",8),d.Qc(15,Ei,1,0,"ng-container",9),d.Yb(),d.Qc(16,Vi,1,1,"ng-template",null,10,d.Rc),d.Qc(18,Hi,1,1,"ng-template",null,11,d.Rc),d.Qc(20,aa,12,11,"ng-template",null,12,d.Rc),d.Qc(22,mc,21,19,"ng-template",null,13,d.Rc),d.Qc(24,Cc,4,3,"ng-template",null,14,d.Rc),d.Zb(26,"mat-menu",null,15),d.Qc(28,Ic,12,19,"div",2),d.Yb(),d.Zb(29,"mat-menu",null,16),d.Zb(31,"button",17),d.hc("click",(function(){return e.setChangeRecoMode(e.ChangeRecoMode.Original)})),d.Sc(32),d.mc(33,"translate"),d.Yb(),d.Qc(34,Tc,3,6,"button",18),d.Qc(35,wc,3,6,"button",18),d.Qc(36,Gc,3,6,"button",18),d.Qc(37,xc,3,6,"button",18),d.Yb()),2&t){var n=d.Ec(11),i=d.Ec(17),o=d.Ec(19);d.tc("hasMainButton",e.perms.isAllowed("can_create_amendments",e.motion))("nav",!1)("editMode",e.editMotion)("isSaveButtonEnabled",e.contentForm.valid),d.Gb(2),d.tc("ngIf",e.motion&&!e.newMotion),d.Gb(1),d.tc("ngIf",e.newMotion&&!e.amendmentEdit),d.Gb(1),d.tc("ngIf",e.amendmentEdit),d.Gb(1),d.tc("ngIf",!e.editMotion&&!e.vp.isMobile),d.Gb(2),d.tc("matMenuTriggerFor",n),d.Gb(5),d.tc("ngIf",e.motion),d.Gb(2),d.tc("ngIf",e.motion&&!e.editMotion),d.Gb(1),d.tc("ngIf",e.vp.isMobile)("ngIfThen",i)("ngIfElse",o),d.Gb(13),d.tc("ngIf",e.motion),d.Gb(3),d.tc("ngClass",d.zc(23,Mc,e.crMode===e.ChangeRecoMode.Original)),d.Gb(1),d.Uc(" ",d.nc(33,21,"Original version")," "),d.Gb(2),d.tc("ngIf",e.allChangingObjects&&e.allChangingObjects.length),d.Gb(1),d.tc("ngIf",e.allChangingObjects&&e.allChangingObjects.length),d.Gb(1),d.tc("ngIf",e.motion&&!e.motion.isParagraphBasedAmendment()&&e.allChangingObjects&&e.allChangingObjects.length),d.Gb(1),d.tc("ngIf",e.motion&&e.motion.modified_final_version&&!e.motion.isParagraphBasedAmendment())}},directives:[p.a,i.t,_.b,yt.e,Ct.a,yt.f,yt.c,i.q,St.a,Mt.a,It.a,Tt.a,wt.a,a.g,Gt.c,a.i,i.A,xt.a,Vt,ee,pe,i.s,ve.a,ae.a,ae.d,y.a,r.s,r.v,mn,r.I,r.t,r.k,vt.c,r.y,kt.b,r.c,un.a,vt.b,vt.j,r.i,bn.a,dn.n,re.a,r.D,pn,ei,k.a,ni.a,ni.d,ii.a,oi.a],pipes:[g.j,S.a],styles:['.motion-text .insert,.motion-text ins{color:green;text-decoration:underline}.motion-text .delete,.motion-text del{color:red;text-decoration:line-through}.motion-text li{padding-bottom:10px}.motion-text ol,.motion-text ul{margin-left:15px;margin-bottom:0}.motion-text .highlight{background-color:#ff0}.motion-text.line-numbers-outside{padding-left:40px;position:relative}.motion-text.line-numbers-outside .os-line-number{display:inline-block;font-size:0;line-height:0;width:22px;height:22px;position:absolute;left:0;padding-right:55px}.motion-text.line-numbers-outside .os-line-number:after{content:attr(data-line-number);position:absolute;top:13px;vertical-align:top;color:grey;font-size:12px;font-weight:400}.motion-text.line-numbers-outside .os-line-number.selectable:hover:before,.motion-text.line-numbers-outside .os-line-number.selected:before{position:absolute;top:4px;left:20px;display:inline-block;cursor:pointer;content:"";width:16px;height:16px;background:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" fill="%23337ab7"/><path d="M0 0h24v24H0z" fill="none"/></svg>\');background-size:16px 16px}.motion-text.line-numbers-inline .os-line-break{display:none}.motion-text.line-numbers-inline .os-line-number{display:inline-block}.motion-text.line-numbers-inline .os-line-number:after{display:inline-block;content:attr(data-line-number);vertical-align:top;font-size:10px;font-weight:400;color:grey;margin-top:-3px;margin-left:0;margin-right:0}.motion-text.line-numbers-none .os-line-break,.motion-text.line-numbers-none .os-line-number{display:none}.motion-text .os-split-before{margin-top:0;padding-top:0}.motion-text .os-split-after{margin-bottom:0;padding-bottom:0}.motion-text li.os-split-before{list-style:none}.amendment-view .os-split-after{margin-bottom:0}.amendment-view .os-split-before{margin-top:0}.amendment-view .paragraphcontext{opacity:.5}.amendment-view.amendment-context .paragraphcontext{opacity:1}span{margin:0}.create-poll-button{margin-bottom:1em}.prev-next-motion-controls div{display:inherit}.motion-content{display:flow-root}.motion-text-toolbar-wrapper{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;margin-bottom:16px}.motion-text-toolbar-wrapper button{font-weight:400}.motion-text-toolbar-wrapper>button{margin-top:7px}.motion-text-toolbar-wrapper .motion-text-controls .motion-goto-line{width:150px}.motion-text-toolbar-wrapper .motion-text-controls input[type=number]::-webkit-inner-spin-button,.motion-text-toolbar-wrapper .motion-text-controls input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.motion-text-toolbar-wrapper .motion-text-controls input[type=number]{-moz-appearance:textfield}.meta-info-panel{padding-top:25px}.meta-info-panel a:hover{cursor:pointer}.mat-accordion{display:block;margin-top:0}.mat-expansion-panel{padding-top:0}.mat-expansion-panel .expansion-panel-custom-body{padding-left:55px}.statute-amendment-selector mat-form-field{margin-left:20px;width:calc(100% - 20px)}.amendment-line-header{font-style:italic}.motion-content h4{margin:10px 10px 15px 0;display:block;font-weight:500;font-size:110%}.motion-content h5{margin:15px 10px 10px 0;display:block;font-weight:500;font-size:100%}.motion-content .motion-text{clear:both;margin-left:0}.motion-content .text-prefix-label{display:block;margin:0 10px 20px 0}.motion-content .extra-data{margin-top:1em}.motion-content .content-field{display:inline-block;width:100%}.motion-content .form-id-title{display:-ms-flexbox;display:flex}.motion-content .form-id-title .form-identifier{-ms-flex:0 0 95px;flex:0 0 95px;max-width:95px;margin-right:1em}.motion-content .form-id-title .form-title{-ms-flex:1 1 auto;flex:1 1 auto}.desktop-view .desktop-left{width:30%;float:left;padding-right:25px}.desktop-view .desktop-right .os-form-card{margin-bottom:20px}.desktop-view .desktop-right .os-card{display:grid;max-width:900px;min-width:400px;margin-left:0!important;margin-top:0!important}.mobile-view .os-card{padding:27px;max-width:calc(100% - 54px)}.title-line{display:-ms-flexbox;display:flex}.title-line .motion-title{position:relative;z-index:1;margin-left:-20px;padding-left:20px}.title-line .motion-title .change-title{position:relative;width:0;height:0}.title-line .motion-title .change-title:before{position:absolute;top:18px;left:-17px;display:none;cursor:pointer;content:"";width:16px;height:16px;background:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" fill="%23337ab7"/><path d="M0 0h24v24H0z" fill="none"/></svg>\');background-size:16px 16px}.title-line .motion-title:hover .change-title:before{display:block}.title-line .motion-title .title-change-indicator{background-color:#0333ff;position:absolute;width:4px;height:32px;left:10px;top:5px;cursor:pointer}.mat-chip-list-stacked .mat-chip{margin:4px}.supporters{font-size:12px;margin-top:4px}.show-entire-text-check{font-size:70%;float:right}'],encapsulation:2,changeDetection:0}),Yc),pathMatch:"full",runGuardsAndResolvers:"paramsChange"},{path:"create-amendment",component:L}],Pc=((Zc=function t(){_classCallCheck(this,t)}).\u0275mod=d.Rb({type:Zc}),Zc.\u0275inj=d.Qb({factory:function(t){return new(t||Zc)},imports:[[a.j.forChild(Rc)],a.j]}),Zc),Fc=n("tSYa"),Nc=((Oc=function t(){_classCallCheck(this,t)}).\u0275mod=d.Rb({type:Oc}),Oc.\u0275inj=d.Qb({factory:function(t){return new(t||Oc)},imports:[[i.c,Pc,o.a,Fc.MotionPollModule]]}),Oc)},T9hM:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n("mrSG"),o=n("4u49"),a=n("D/ll"),c=n("AqIO"),r=n("g96W"),s=n("A6Ob"),l=n("+KbT"),m=n("fXoL"),u=n("sYmb"),b=function(){var t=function(t){_inherits(n,t);var e=_createSuper(n);function n(t,i,a,c){var s;return _classCallCheck(this,n),(s=e.call(this,t,i,a)).storageKey="MotionList",s.defaultSortingLoaded=new r.a,s.motionSortOptions=[{property:"weight",label:"Call list"},{property:"identifier"},{property:"title"},{property:"submitters"},{property:"category",sortFn:s.categorySortFn},{property:"motion_block_id",label:"Motion block"},{property:"state"},{property:"creationDate",label:Object(o.a)("Creation date")},{property:"lastChangeDate",label:Object(o.a)("Last modified")}],c.get("motions_motions_sorting").subscribe((function(t){t&&(s.defaultMotionSorting=t,s.defaultSortingLoaded.resolve())})),s}return _createClass(n,[{key:"getSortOptions",value:function(){return this.motionSortOptions}},{key:"getDefaultDefinition",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.defaultSortingLoaded;case 2:return t.abrupt("return",{sortProperty:this.defaultMotionSorting,sortAscending:!0});case 3:case"end":return t.stop()}}),t,this)})))}},{key:"categorySortFn",value:function(t,e,n){return t.category_id===e.category_id?t.category_weight<e.category_weight===n?-1:1:t.category.weight<e.category.weight===n?-1:1}}]),n}(s.a);return t.\u0275fac=function(e){return new(e||t)(m.dc(u.k),m.dc(c.a),m.dc(a.a),m.dc(l.a))},t.\u0275prov=m.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}]);