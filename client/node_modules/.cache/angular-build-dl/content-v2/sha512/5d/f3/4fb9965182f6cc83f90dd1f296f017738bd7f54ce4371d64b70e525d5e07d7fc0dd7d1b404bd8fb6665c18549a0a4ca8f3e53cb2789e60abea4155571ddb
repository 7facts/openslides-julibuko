(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{"0FyJ":function(t,e,n){"use strict";n.r(e),n.d(e,"AgendaModule",(function(){return In}));var i=n("ofXK"),c=n("tyNb"),a=n("mrSG"),o=n("4u49"),s=n("1NkQ"),r=n("fXoL"),l=n("sYmb");let b=(()=>{class t{constructor(t,e){this.csvExport=t,this.translate=e}exportItemList(t){this.csvExport.export(t,[{label:"Title",map:t=>t.getTitle()},{label:"Text",map:t=>t.contentObject?t.contentObject.getCSVExportText():""},{label:"Duration",property:"duration"},{label:"Comment",property:"comment"},{label:"Item type",property:"verboseCsvType"},{label:"Tags",property:"tags"}],this.translate.instant("Agenda")+".csv")}}return t.\u0275fac=function(e){return new(e||t)(r.dc(s.a),r.dc(l.k))},t.\u0275prov=r.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var u=n("D/ll"),d=n("AqIO"),m=n("lv9T"),p=n("+8Rz"),f=n("+az0");let h=(()=>{class t extends p.a{constructor(t,e,n,i){super(t,e),this.translate=n,this.storageKey="AgendaList",this.tagFilterOptions={property:"tags_id",label:"Tags",options:[]},this.updateFilterForRepo(i,this.tagFilterOptions,this.translate.instant("No tags"))}getFilterDefinitions(){return[{label:"Status",property:"closed",options:[{label:this.translate.instant("Open items"),condition:!1},{label:this.translate.instant("Closed items"),condition:!0}]},this.tagFilterOptions,{label:"Visibility",property:"type",options:this.createVisibilityFilterOptions()},{label:"Type",property:"collection",options:[{label:this.translate.instant("Motions"),condition:"motions/motion"},{label:this.translate.instant("Topics"),condition:"topics/topic"},{label:this.translate.instant("Motion blocks"),condition:"motions/motion-block"},{label:this.translate.instant("Elections"),condition:"assignments/assignment"}]}]}preFilter(t){return t.filter(t=>void 0!==t.type)}createVisibilityFilterOptions(){return f.b.map(t=>({condition:t.key,label:t.name}))}}return t.\u0275fac=function(e){return new(e||t)(r.dc(d.a),r.dc(u.a),r.dc(l.k),r.dc(m.a))},t.\u0275prov=r.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var g=n("pqYe");let S=(()=>{class t{constructor(t,e){this.translate=t,this.treeService=e}agendaListToDocDef(t){const e=this.treeService.makeTree(t,"weight","parent_id");return[{text:this.translate.instant("Agenda"),style:"title"},this.createEntries(e)]}createEntries(t){const e=[];return t.forEach(t=>e.push(...this.parseItem(t,0))),e}parseItem(t,e){const n=[];if(!t.item.item.is_hidden){const i={style:e?"listChild":"listParent",columns:[{width:15*e,text:""},{width:60,text:t.item.item_number},{text:t.item.contentObject.getTitle()}]};n.push(i),t.children&&t.children.length&&t.children.forEach(t=>{n.push(...this.parseItem(t,e+1))})}return n}}return t.\u0275fac=function(e){return new(e||t)(r.dc(l.k),r.dc(g.a))},t.\u0275prov=r.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var v=n("OwvW"),k=n("a9GI"),Z=n("InfO"),Y=n("3Y/2"),T=n("cffc"),O=n("+KbT"),C=n("2aHC"),w=n("F48D"),G=n("KL36"),_=n("Izkr"),I=n("wL0i"),M=n("Q/67"),y=n("0IaG");const P=t=>/^\s*([0-9]+)(:)?([0-5][0-9]?)?\s*[h|m]?$/g.test(t.value)||""===t.value?null:{valid:!1};n("cVnz");var x=n("3Pt+"),L=n("kmnG"),D=n("d3UM"),Q=n("qFsG"),j=n("ihCf"),E=n("bTqV"),F=n("FKr1");function R(t,e){if(1&t&&(r.Zb(0,"h1",12),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=r.lc();r.Gb(1),r.Vc("",r.nc(2,2,"Edit details for")," ",t.item.getTitle(),"")}}function A(t,e){if(1&t&&(r.Zb(0,"mat-option",14),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=e.$implicit;r.tc("value",t.id),r.Gb(1),r.Uc(" ",r.nc(2,2,t.getTitle())," ")}}function U(t,e){if(1&t&&(r.Zb(0,"mat-form-field"),r.Zb(1,"mat-select",13),r.mc(2,"translate"),r.Qc(3,A,3,4,"mat-option",5),r.Yb(),r.Yb()),2&t){const t=r.lc();r.Gb(1),r.uc("placeholder",r.nc(2,2,"Tags")),r.Gb(2),r.tc("ngForOf",t.tags)}}function N(t,e){if(1&t&&(r.Zb(0,"mat-option",14),r.Zb(1,"span"),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Yb()),2&t){const t=e.$implicit;r.tc("value",t.key),r.Gb(2),r.Tc(r.nc(3,2,t.name))}}function V(t,e){1&t&&(r.Zb(0,"mat-error"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Uc(" ",r.nc(2,1,'Your input does not match the following structure: "hh:mm"')," "))}let B=(()=>{class t{constructor(t,e,n,i,c){this.formBuilder=t,this.durationService=e,this.dialogRef=n,this.tagRepo=i,this.item=c,this.itemVisibility=f.b,this.tags=[],this.agendaInfoForm=this.formBuilder.group({tags_id:[],type:[""],durationText:["",P],item_number:[""],comment:[""]})}ngOnInit(){this.item&&(this.agendaInfoForm.get("tags_id").setValue(this.item.tags_id),this.agendaInfoForm.get("type").setValue(this.item.type),this.agendaInfoForm.get("durationText").setValue(this.durationService.durationToString(this.item.duration,"h")),this.agendaInfoForm.get("item_number").setValue(this.item.item_number),this.agendaInfoForm.get("comment").setValue(this.item.comment)),this.tagRepo.getViewModelListObservable().subscribe(t=>{this.tags=t})}isTagAvailable(){return!!this.tags&&this.tags.length>0}saveItemInfo(){this.dialogRef.close(this.agendaInfoForm.value)}onCancelButton(){this.dialogRef.close()}onKeyDown(t){"Enter"===t.key&&t.shiftKey&&this.saveItemInfo()}}return t.\u0275fac=function(e){return new(e||t)(r.Tb(x.f),r.Tb(C.a),r.Tb(y.h),r.Tb(m.a),r.Tb(y.a))},t.\u0275cmp=r.Nb({type:t,selectors:[["os-item-info-dialog"]],decls:27,vars:24,consts:[["mat-dialog-title","",4,"ngIf"],["mat-dialog-content",""],[1,"item-dialog-form",3,"formGroup","keydown"],[4,"ngIf"],["formControlName","type",3,"placeholder"],[3,"value",4,"ngFor","ngForOf"],["type","string","matInput","","formControlName","durationText",3,"placeholder"],["matInput","","formControlName","item_number",3,"placeholder"],["matInput","","formControlName","comment","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","5",3,"placeholder"],["mat-dialog-actions",""],["mat-button","",3,"disabled","click"],["mat-button","",3,"click"],["mat-dialog-title",""],["formControlName","tags_id","multiple","",3,"placeholder"],[3,"value"]],template:function(t,e){1&t&&(r.Qc(0,R,3,4,"h1",0),r.Zb(1,"div",1),r.Zb(2,"form",2),r.hc("keydown",(function(t){return e.onKeyDown(t)})),r.Qc(3,U,4,4,"mat-form-field",3),r.Zb(4,"mat-form-field"),r.Zb(5,"mat-select",4),r.mc(6,"translate"),r.Qc(7,N,4,4,"mat-option",5),r.Yb(),r.Yb(),r.Zb(8,"mat-form-field"),r.Ub(9,"input",6),r.mc(10,"translate"),r.Qc(11,V,3,3,"mat-error",3),r.Yb(),r.Zb(12,"mat-form-field"),r.Ub(13,"input",7),r.mc(14,"translate"),r.Yb(),r.Zb(15,"mat-form-field"),r.Ub(16,"textarea",8),r.mc(17,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Zb(18,"div",9),r.Zb(19,"button",10),r.hc("click",(function(){return e.saveItemInfo()})),r.Zb(20,"span"),r.Sc(21),r.mc(22,"translate"),r.Yb(),r.Yb(),r.Zb(23,"button",11),r.hc("click",(function(){return e.onCancelButton()})),r.Zb(24,"span"),r.Sc(25),r.mc(26,"translate"),r.Yb(),r.Yb(),r.Yb()),2&t&&(r.tc("ngIf",e.item),r.Gb(2),r.tc("formGroup",e.agendaInfoForm),r.Gb(1),r.tc("ngIf",e.isTagAvailable()),r.Gb(2),r.uc("placeholder",r.nc(6,12,"Agenda visibility")),r.Gb(2),r.tc("ngForOf",e.itemVisibility),r.Gb(2),r.uc("placeholder",r.nc(10,14,"Duration")),r.Gb(2),r.tc("ngIf",e.agendaInfoForm.invalid),r.Gb(2),r.uc("placeholder",r.nc(14,16,"Item number")),r.Gb(3),r.uc("placeholder",r.nc(17,18,"Comment")),r.Gb(3),r.tc("disabled",e.agendaInfoForm.invalid),r.Gb(2),r.Tc(r.nc(22,20,"Save")),r.Gb(4),r.Tc(r.nc(26,22,"Cancel")))},directives:[i.t,y.f,x.I,x.t,x.k,L.c,D.a,x.s,x.i,i.s,Q.b,x.c,j.c,y.c,E.b,y.i,F.n,L.b],pipes:[l.j],styles:[".item-dialog-form[_ngcontent-%COMP%]{display:inline-block}.item-dialog-form[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var $=n("jhN1"),z=n("dNgK"),W=n("mksl"),H=n("STbY"),K=n("NFeN"),X=n("0Obk"),q=n("dRZP"),J=n("vYAO"),tt=n("3Xi6"),et=n("Tp2j"),nt=n("f0Cb"),it=n("40uZ");function ct(t,e){if(1&t&&r.Ub(0,"a",20),2&t){const t=r.lc().row,e=r.lc();r.tc("routerLink",e.getDetailUrl(t))}}function at(t,e){1&t&&(r.Zb(0,"span",21),r.Zb(1,"mat-icon"),r.Sc(2,"check"),r.Yb(),r.Yb())}function ot(t,e){if(1&t&&(r.Zb(0,"div",18),r.Zb(1,"os-icon-container",22),r.Sc(2),r.Yb(),r.Yb()),2&t){const t=r.lc().row;r.Gb(1),r.tc("noWrap",!0),r.Gb(1),r.Uc(" ",t.comment," ")}}const st=function(t){return{"margin-left":t}};function rt(t,e){if(1&t&&(r.Zb(0,"div",13),r.Qc(1,ct,1,1,"a",14),r.Zb(2,"div",15),r.Zb(3,"div",16),r.Qc(4,at,3,0,"span",17),r.Zb(5,"span"),r.Sc(6),r.Yb(),r.Yb(),r.Zb(7,"div",18),r.Sc(8),r.Yb(),r.Qc(9,ot,3,2,"div",19),r.Yb(),r.Yb()),2&t){const t=e.row,n=r.lc();r.Gb(1),r.tc("ngIf",!n.isMultiSelect),r.Gb(1),r.tc("ngStyle",r.zc(6,st,25*t.level+"px")),r.Gb(2),r.tc("ngIf",t.closed),r.Gb(2),r.Uc(" ",t.getListTitle()," "),r.Gb(2),r.Uc(" ",t.getSubtitle()," "),r.Gb(1),r.tc("ngIf",t.comment)}}function lt(t,e){1&t&&(r.Zb(0,"span"),r.Sc(1,",\xa0"),r.Yb())}function bt(t,e){if(1&t&&(r.Zb(0,"span"),r.Sc(1),r.Qc(2,lt,2,0,"span",10),r.Yb()),2&t){const t=e.$implicit,n=e.last;r.Gb(1),r.Uc(" ",t.getTitle()," "),r.Gb(1),r.tc("ngIf",!n)}}function ut(t,e){if(1&t&&(r.Zb(0,"div"),r.Zb(1,"os-icon-container",27),r.Qc(2,bt,3,2,"span",28),r.Yb(),r.Yb()),2&t){const t=r.lc().row;r.Gb(2),r.tc("ngForOf",t.tags)}}function dt(t,e){if(1&t&&(r.Zb(0,"div",29),r.Zb(1,"os-icon-container",30),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Yb()),2&t){const t=r.lc().row;r.Gb(2),r.Tc(r.nc(3,1,t.verboseType))}}function mt(t,e){if(1&t&&(r.Zb(0,"div",29),r.Zb(1,"os-icon-container",31),r.Sc(2),r.Yb(),r.Yb()),2&t){const t=r.lc().row,e=r.lc();r.Gb(2),r.Uc(" ",e.durationService.durationToString(t.duration,"h")," ")}}function pt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div",23),r.hc("click",(function(){r.Ic(t);const n=e.row;return r.lc().openEditInfo(n)})),r.Zb(1,"div",24),r.Qc(2,ut,3,1,"div",10),r.Qc(3,dt,4,3,"div",25),r.Qc(4,mt,3,1,"div",26),r.Yb(),r.Yb()}if(2&t){const t=e.row;r.Gb(2),r.tc("ngIf",t.tags&&t.tags.length),r.Gb(1),r.tc("osPerms","agenda.can_manage")("osPermsAnd",t.verboseType),r.Gb(1),r.tc("ngIf",t.duration)}}const ft=function(t){return{item:t}};function ht(t,e){if(1&t){const t=r.ac();r.Zb(0,"div",13),r.Zb(1,"button",32),r.hc("click",(function(e){return r.Ic(t),e.stopPropagation()})),r.Zb(2,"mat-icon"),r.Sc(3,"more_vert"),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=e.row,n=r.lc(),i=r.Ec(27);r.Gb(1),r.tc("disabled",n.isMultiSelect)("matMenuTriggerFor",i)("matMenuTriggerData",r.zc(3,ft,t))}}function gt(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",38),r.hc("click",(function(){return r.Ic(t),r.lc(3).onAutoNumbering()})),r.Zb(1,"mat-icon"),r.Sc(2,"format_list_numbered"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Numbering")))}function St(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Zb(1,"button",38),r.hc("click",(function(){return r.Ic(t),r.lc(2).toggleMultiSelect()})),r.Zb(2,"mat-icon"),r.Sc(3,"library_add"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.mc(6,"translate"),r.Yb(),r.Yb(),r.Ub(7,"mat-divider"),r.Qc(8,gt,6,3,"button",40),r.Zb(9,"button",41),r.Zb(10,"mat-icon"),r.Sc(11,"sort"),r.Yb(),r.Zb(12,"span"),r.Sc(13),r.mc(14,"translate"),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=r.lc(2);r.Gb(5),r.Tc(r.nc(6,3,"Multiselect")),r.Gb(3),r.tc("ngIf",t.isNumberingAllowed),r.Gb(5),r.Tc(r.nc(14,5,"Sort"))}}function vt(t,e){1&t&&(r.Zb(0,"button",42),r.Zb(1,"mat-icon"),r.Sc(2,"mic"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()),2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Current list of speakers")))}function kt(t,e){1&t&&(r.Zb(0,"button",43),r.Zb(1,"mat-icon"),r.Sc(2,"local_offer"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()),2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Tags")))}function Zt(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",38),r.hc("click",(function(){return r.Ic(t),r.lc(2).csvExportItemList()})),r.Zb(1,"mat-icon"),r.Sc(2,"archive"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Export as CSV")))}function Yt(t,e){1&t&&(r.Zb(0,"button",44),r.Zb(1,"mat-icon"),r.Sc(2,"cloud_upload"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()),2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Import")))}function Tt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Ub(1,"mat-divider"),r.Zb(2,"button",45),r.hc("click",(function(){return r.Ic(t),r.lc(2).deleteAllSpeakersOfAllListsOfSpeakers()})),r.Zb(3,"mat-icon"),r.Sc(4,"delete"),r.Yb(),r.Zb(5,"span"),r.Sc(6),r.mc(7,"translate"),r.Yb(),r.Yb(),r.Yb()}2&t&&(r.Gb(6),r.Tc(r.nc(7,1,"Clear all list of speakers")))}function Ot(t,e){1&t&&(r.Zb(0,"div"),r.Ub(1,"mat-divider"),r.Zb(2,"button",46),r.Zb(3,"mat-icon"),r.Sc(4,"settings"),r.Yb(),r.Zb(5,"span"),r.Sc(6),r.mc(7,"translate"),r.Yb(),r.Yb(),r.Yb()),2&t&&(r.Gb(6),r.Tc(r.nc(7,1,"Settings")))}function Ct(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Qc(1,St,15,7,"div",33),r.Ub(2,"os-projector-button",34),r.Qc(3,vt,6,3,"button",35),r.Qc(4,kt,6,3,"button",36),r.Ub(5,"mat-divider"),r.Qc(6,Zt,6,3,"button",37),r.Zb(7,"button",38),r.hc("click",(function(){return r.Ic(t),r.lc().onDownloadPdf()})),r.Zb(8,"mat-icon"),r.Sc(9,"archive"),r.Yb(),r.Zb(10,"span"),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Qc(13,Yt,6,3,"button",39),r.Qc(14,Tt,8,3,"div",33),r.Qc(15,Ot,8,3,"div",33),r.Yb()}if(2&t){const t=r.lc();r.Gb(1),r.tc("osPerms","agenda.can_manage"),r.Gb(1),r.tc("object",t.itemListSlide)("menuItem",!0),r.Gb(1),r.tc("osPerms","agenda.can_see_list_of_speakers"),r.Gb(1),r.tc("osPerms","core.can_manage_tags"),r.Gb(2),r.tc("osPerms","agenda.can_manage"),r.Gb(5),r.Tc(r.nc(12,10,"Export as PDF")),r.Gb(2),r.tc("osPerms","agenda.can_manage"),r.Gb(1),r.tc("osPerms","agenda.can_manage"),r.Gb(1),r.tc("osPerms","core.can_manage_config")}}function wt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Zb(1,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).setClosedSelected(!0)})),r.Zb(2,"mat-icon"),r.Sc(3,"done"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.mc(6,"translate"),r.Yb(),r.Yb(),r.Zb(7,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).setClosedSelected(!1)})),r.Zb(8,"mat-icon"),r.Sc(9,"redo"),r.Yb(),r.Zb(10,"span"),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Ub(13,"mat-divider"),r.Zb(14,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).setAgendaType(1)})),r.Zb(15,"mat-icon"),r.Sc(16,"public"),r.Yb(),r.Zb(17,"span"),r.Sc(18),r.mc(19,"translate"),r.Yb(),r.Yb(),r.Zb(20,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).setAgendaType(2)})),r.Zb(21,"mat-icon"),r.Sc(22,"visibility"),r.Yb(),r.Zb(23,"span"),r.Sc(24),r.mc(25,"translate"),r.Yb(),r.Yb(),r.Zb(26,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).setAgendaType(3)})),r.Zb(27,"mat-icon"),r.Sc(28,"visibility_off"),r.Yb(),r.Zb(29,"span"),r.Sc(30),r.mc(31,"translate"),r.Yb(),r.Yb(),r.Ub(32,"mat-divider"),r.Zb(33,"button",47),r.hc("click",(function(){r.Ic(t);const e=r.lc(2);return e.duplicateMultipleTopics(e.selectedRows)})),r.Zb(34,"mat-icon"),r.Sc(35,"file_copy"),r.Yb(),r.Zb(36,"span"),r.Sc(37),r.mc(38,"translate"),r.Yb(),r.Yb(),r.Zb(39,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(2).removeSelected()})),r.Zb(40,"mat-icon"),r.Sc(41,"remove"),r.Yb(),r.Zb(42,"span"),r.Sc(43),r.mc(44,"translate"),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=r.lc(2);r.Gb(1),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(6,14,"Close")),r.Gb(2),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(12,16,"Open")),r.Gb(3),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(19,18,"Set public")),r.Gb(2),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(25,20,"Set internal")),r.Gb(2),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(31,22,"Set hidden")),r.Gb(3),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(38,24,"Duplicate")),r.Gb(2),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(44,26,"Remove from agenda"))}}function Gt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Zb(1,"button",38),r.hc("click",(function(){return r.Ic(t),r.lc().selectAll()})),r.Zb(2,"mat-icon"),r.Sc(3,"done_all"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.mc(6,"translate"),r.Yb(),r.Yb(),r.Zb(7,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc().deselectAll()})),r.Zb(8,"mat-icon"),r.Sc(9,"clear"),r.Yb(),r.Zb(10,"span"),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Ub(13,"mat-divider"),r.Qc(14,wt,45,28,"div",33),r.Yb()}if(2&t){const t=r.lc();r.Gb(5),r.Tc(r.nc(6,4,"Select all")),r.Gb(2),r.tc("disabled",!t.selectedRows.length),r.Gb(4),r.Tc(r.nc(12,6,"Deselect all")),r.Gb(3),r.tc("osPerms","agenda.can_manage")}}function _t(t,e){if(1&t&&(r.Zb(0,"div"),r.Ub(1,"os-projector-button",34),r.Ub(2,"os-speaker-button",34),r.Yb()),2&t){const t=r.lc().item;r.Gb(1),r.tc("object",t.contentObject)("menuItem",!0),r.Gb(1),r.tc("object",t.contentObjectData)("menuItem",!0)}}function It(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",38),r.hc("click",(function(){r.Ic(t);const e=r.lc(2).item;return r.lc().duplicateTopic(e.contentObject)})),r.Zb(1,"mat-icon"),r.Sc(2,"file_copy"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Duplicate")))}function Mt(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",38),r.hc("click",(function(){r.Ic(t);const e=r.lc(2).item;return r.lc().removeFromAgenda(e)})),r.Zb(1,"mat-icon"),r.Sc(2,"remove"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Remove from agenda")))}function yt(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",45),r.hc("click",(function(){r.Ic(t);const e=r.lc(2).item;return r.lc().deleteTopic(e)})),r.Zb(1,"mat-icon"),r.Sc(2,"delete"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Delete")))}function Pt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div"),r.Zb(1,"button",38),r.hc("click",(function(){r.Ic(t);const e=r.lc().item;return r.lc().onDoneSingleButton(e)})),r.Zb(2,"mat-icon",48),r.Sc(3),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.mc(6,"translate"),r.Yb(),r.Yb(),r.Zb(7,"button",38),r.hc("click",(function(e){r.Ic(t);const n=r.lc().item;return r.lc().openEditInfo(n,e)})),r.Zb(8,"mat-icon"),r.Sc(9,"edit"),r.Yb(),r.Zb(10,"span"),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Qc(13,It,6,3,"button",40),r.Qc(14,Mt,6,3,"button",40),r.Qc(15,yt,6,3,"button",49),r.Yb()}if(2&t){const t=r.lc().item,e=r.lc();r.Gb(3),r.Uc(" ",t.closed?"check_box":"check_box_outline_blank"," "),r.Gb(2),r.Tc(r.nc(6,6,"Done")),r.Gb(6),r.Tc(r.nc(12,8,"Edit details")),r.Gb(2),r.tc("ngIf",e.isTopic(t.contentObject)),r.Gb(1),r.tc("ngIf",!e.isTopic(t.contentObject)),r.Gb(1),r.tc("ngIf",e.isTopic(t.contentObject))}}function xt(t,e){if(1&t&&(r.Qc(0,_t,3,4,"div",10),r.Qc(1,Pt,16,10,"div",33)),2&t){const t=r.lc();r.tc("ngIf",t.vp.isMobile),r.Gb(1),r.tc("osPerms","agenda.can_manage")}}const Lt=function(){return["info"]};let Dt=(()=>{class t extends I.a{constructor(t,e,n,i,c,a,s,r,l,b,u,d,m,p,f,h,g,S){super(t,e,n,i),this.translate=e,this.operator=c,this.router=a,this.repo=s,this.promptService=r,this.dialog=l,this.config=b,this.vp=u,this.durationService=d,this.csvExport=m,this.filterService=p,this.agendaPdfService=f,this.pdfService=h,this.listOfSpeakersRepo=g,this.topicRepo=S,this.itemListSlide={getBasicProjectorElement:t=>({name:"agenda/item-list",getIdentifiers:()=>["name"]}),slideOptions:[{key:"only_main_items",displayName:Object(o.a)("Only main agenda items"),default:!1}],projectionDefaultName:"agenda_all_items",getDialogTitle:()=>this.translate.instant("Agenda")},this.tableColumnDefinition=[{prop:"title",width:"auto"},{prop:"info",width:"15%"}],this.restrictedColumns=[{columnName:"menu",permission:v.b.agendaCanManage}],this.filterProps=["item_number","comment","getListTitle"],this.canMultiSelect=!0}get canManage(){return this.operator.hasPerms(v.b.agendaCanManage)}ngOnInit(){super.setTitle("Agenda"),this.config.get("agenda_enable_numbering").subscribe(t=>this.isNumberingAllowed=t),this.config.get("agenda_show_subtitle").subscribe(t=>this.showSubtitle=t)}getListOfSpeakers(t){return this.listOfSpeakersRepo.findByContentObject(t.item.content_object)}getDetailUrl(t){if(t.contentObject&&!this.isMultiSelect)return t.contentObject.getDetailStateURL()}openEditInfo(t){!this.isMultiSelect&&this.canManage&&this.dialog.open(B,Object.assign(Object.assign({},_.a),{data:t})).afterClosed().subscribe(e=>{e&&(e.duration=e.durationText?this.durationService.stringToDuration(e.durationText):0,this.repo.update(e,t).catch(this.raiseError))})}onAutoNumbering(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to number all agenda items?");(yield this.promptService.open(t))&&(yield this.repo.autoNumbering().catch(this.raiseError))}))}onDoneSingleButton(t){return Object(a.a)(this,void 0,void 0,(function*(){yield this.repo.update({closed:!t.closed},t).catch(this.raiseError)}))}onPlusButton(){this.router.navigate(["/topics/new"])}removeFromAgenda(t){return Object(a.a)(this,void 0,void 0,(function*(){const e=this.translate.instant("Are you sure you want to remove this entry from the agenda?"),n=t.contentObject.getTitle();(yield this.promptService.open(e,n))&&(yield this.repo.removeFromAgenda(t).catch(this.raiseError))}))}deleteTopic(t){return Object(a.a)(this,void 0,void 0,(function*(){if(!(t.contentObject instanceof M.a))return;const e=this.translate.instant("Are you sure you want to delete this topic?"),n=t.contentObject.getTitle();(yield this.promptService.open(e,n))&&(yield this.topicRepo.delete(t.contentObject).catch(this.raiseError))}))}removeSelected(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to remove all selected items from the agenda?"),e=this.translate.instant("All topics will be deleted and won't be accessible afterwards.");if(yield this.promptService.open(t,e))try{for(const t of this.selectedRows)t.contentObject instanceof M.a?yield this.topicRepo.delete(t.contentObject):yield this.repo.removeFromAgenda(t)}catch(n){this.raiseError(n)}}))}setClosedSelected(t){return Object(a.a)(this,void 0,void 0,(function*(){try{for(const e of this.selectedRows)yield this.repo.update({closed:t},e)}catch(e){this.raiseError(e)}}))}setAgendaType(t){return Object(a.a)(this,void 0,void 0,(function*(){try{for(const e of this.selectedRows)yield this.repo.update({type:t},e).catch(this.raiseError)}catch(e){this.raiseError(e)}}))}csvExportItemList(){this.csvExport.exportItemList(this.dataSource.filteredData)}onDownloadPdf(){const t=this.translate.instant("Agenda");this.pdfService.download(this.agendaPdfService.agendaListToDocDef(this.dataSource.filteredData),t)}getDurationEndString(){const t=this.repo.calculateDuration();if(!t)return"";const e=this.durationService.durationToString(t,"h"),n=this.repo.calculateEndTime(),i=`${this.translate.instant("Duration")}: ${e}`;return n?i+` (${this.translate.instant("Estimated end")}:\n            ${n.toLocaleTimeString(this.translate.currentLang,{hour:"numeric",minute:"numeric"})} h)`:i}deleteAllSpeakersOfAllListsOfSpeakers(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to clear all speakers of all lists?"),e=this.translate.instant("All lists of speakers will be cleared.");(yield this.promptService.open(t,e))&&this.listOfSpeakersRepo.deleteAllSpeakersOfAllListsOfSpeakers().catch(this.raiseError)}))}duplicateTopic(t){this.topicRepo.duplicateTopic(t)}duplicateMultipleTopics(t){for(const e of t)this.isTopic(e.contentObject)&&this.duplicateTopic(e.contentObject)}isTopic(t){return!!t&&void 0!==t.collectionString&&t.collectionString===M.a.COLLECTIONSTRING&&!!t.topic}}return t.\u0275fac=function(e){return new(e||t)(r.Tb($.d),r.Tb(l.k),r.Tb(z.a),r.Tb(d.a),r.Tb(v.a),r.Tb(c.f),r.Tb(Z.a),r.Tb(w.a),r.Tb(y.b),r.Tb(O.a),r.Tb(G.a),r.Tb(C.a),r.Tb(b),r.Tb(h),r.Tb(S),r.Tb(k.b),r.Tb(Y.a),r.Tb(T.a))},t.\u0275cmp=r.Nb({type:t,selectors:[["os-agenda-list"]],features:[r.Db],decls:29,vars:26,consts:[[3,"hasMainButton","multiSelectMode","mainEvent"],[1,"title-slot"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"central-info-slot"],["mat-icon-button","",3,"click"],["listStorageKey","agenda",3,"listObservableProvider","vScrollFixed","filterService","columns","multiSelect","restricted","hiddenInMobile","alwaysShowMenu","filterProps","selectedRows","selectedRowsChange","dataSourceChange"],["class","cell-slot fill",4,"pblNgridCellDef"],["class","cell-slot fill clickable",3,"click",4,"pblNgridCellDef"],["agendaMenu","matMenu"],[4,"ngIf"],["singleItemMenu","matMenu"],["matMenuContent",""],[1,"cell-slot","fill"],["class","detail-link",3,"routerLink",4,"ngIf"],[1,"innerTable",3,"ngStyle"],[1,"title-line","ellipsis-overflow"],["class","icon-prefix",4,"ngIf"],[1,"subtitle","ellipsis-overflow"],["class","subtitle ellipsis-overflow",4,"ngIf"],[1,"detail-link",3,"routerLink"],[1,"icon-prefix"],["size","small","icon","comment",3,"noWrap"],[1,"cell-slot","fill","clickable",3,"click"],[1,"info-col-items"],["class","spacer-top-5",4,"osPerms","osPermsAnd"],["class","spacer-top-5",4,"ngIf"],["icon","local_offer"],[4,"ngFor","ngForOf"],[1,"spacer-top-5"],["icon","visibility"],["icon","access_time"],["mat-icon-button","",3,"disabled","matMenuTriggerFor","matMenuTriggerData","click"],[4,"osPerms"],[3,"object","menuItem"],["mat-menu-item","","routerLink","speakers",4,"osPerms"],["mat-menu-item","","routerLink","/tags",4,"osPerms"],["mat-menu-item","",3,"click",4,"osPerms"],["mat-menu-item","",3,"click"],["mat-menu-item","","routerLink","import",4,"osPerms"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","routerLink","sort-agenda"],["mat-menu-item","","routerLink","speakers"],["mat-menu-item","","routerLink","/tags"],["mat-menu-item","","routerLink","import"],["mat-menu-item","",1,"red-warning-text",3,"click"],["mat-menu-item","","routerLink","/settings/agenda"],["mat-menu-item","",3,"disabled","click"],["color","accent"],["mat-menu-item","","class","red-warning-text",3,"click",4,"ngIf"]],template:function(t,e){if(1&t&&(r.Zb(0,"os-head-bar",0),r.hc("mainEvent",(function(){return e.onPlusButton()})),r.Zb(1,"div",1),r.Zb(2,"h2"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Yb(),r.Zb(5,"div",2),r.Zb(6,"button",3),r.Zb(7,"mat-icon"),r.Sc(8,"more_vert"),r.Yb(),r.Yb(),r.Yb(),r.Zb(9,"div",4),r.Zb(10,"button",5),r.hc("click",(function(){return e.toggleMultiSelect()})),r.Zb(11,"mat-icon"),r.Sc(12,"arrow_back"),r.Yb(),r.Yb(),r.Zb(13,"span"),r.Sc(14),r.Yb(),r.Zb(15,"span"),r.Sc(16),r.mc(17,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Zb(18,"os-list-view-table",6),r.hc("selectedRowsChange",(function(t){return e.selectedRows=t}))("dataSourceChange",(function(t){return e.onDataSourceChange(t)})),r.Qc(19,rt,10,8,"div",7),r.Qc(20,pt,5,4,"div",8),r.Qc(21,ht,4,5,"div",7),r.Yb(),r.Zb(22,"mat-menu",null,9),r.Qc(24,Ct,16,12,"div",10),r.Qc(25,Gt,15,8,"div",10),r.Yb(),r.Zb(26,"mat-menu",null,11),r.Qc(28,xt,2,2,"ng-template",12),r.Yb()),2&t){const t=r.Ec(23);r.tc("hasMainButton",e.canManage)("multiSelectMode",e.isMultiSelect),r.Gb(3),r.Tc(r.nc(4,21,"Agenda")),r.Gb(3),r.tc("matMenuTriggerFor",t),r.Gb(8),r.Uc("",e.selectedRows.length,"\xa0"),r.Gb(2),r.Tc(r.nc(17,23,"selected")),r.Gb(2),r.tc("listObservableProvider",e.repo)("vScrollFixed",76)("filterService",e.filterService)("columns",e.tableColumnDefinition)("multiSelect",e.isMultiSelect)("restricted",e.restrictedColumns)("hiddenInMobile",r.yc(25,Lt))("alwaysShowMenu",!0)("filterProps",e.filterProps)("selectedRows",e.selectedRows),r.Gb(1),r.tc("pblNgridCellDef","title"),r.Gb(1),r.tc("pblNgridCellDef","info"),r.Gb(1),r.tc("pblNgridCellDef","menu"),r.Gb(3),r.tc("ngIf",!e.isMultiSelect),r.Gb(1),r.tc("ngIf",e.isMultiSelect)}},directives:[W.a,E.b,H.e,K.a,X.a,q.c,H.f,i.t,H.b,i.w,c.i,J.a,tt.a,i.s,et.a,nt.a,H.c,c.g,it.a],pipes:[l.j],styles:[".title-line[_ngcontent-%COMP%]{font-weight:500;font-size:16px}.title-line[_ngcontent-%COMP%]   .icon-prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:16px;height:16px;width:16px}.title-line[_ngcontent-%COMP%]   .favorite-star[_ngcontent-%COMP%]{padding-right:3px}.mat-table[_ngcontent-%COMP%]{width:100%}.mat-table[_ngcontent-%COMP%]   .mat-header-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{display:none}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]{position:absolute!important;top:0;right:0;bottom:0;left:0;opacity:.1;z-index:1}.mat-table[_ngcontent-%COMP%]   .mat-row[_ngcontent-%COMP%]   .mat-column-anchor[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;height:100%;width:100%}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]{position:relative}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]{position:absolute;display:inherit;height:100%;width:100%;line-height:0}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%]   .fill[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.mat-table[_ngcontent-%COMP%]   .mat-cell[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{z-index:2}.mat-table[_ngcontent-%COMP%]   .mat-table-sticky[_ngcontent-%COMP%]{z-index:3!important}.info-col-items[_ngcontent-%COMP%]{display:inline-block;white-space:nowrap;font-size:14px}.info-col-items[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{display:-ms-inline-flexbox;display:inline-flex;vertical-align:middle;font-size:18px;height:18px;width:18px}.align-right[_ngcontent-%COMP%]{margin-left:auto}"],changeDetection:0}),t})();var Qt=n("2Vo4"),jt=n("Qy/R"),Et=n("XhcP"),Ft=n("Wp6s"),Rt=n("/tkw"),At=n("bSwM"),Ut=n("Qu3c");function Nt(t,e){if(1&t){const t=r.ac();r.Zb(0,"div",18),r.Zb(1,"div"),r.Zb(2,"span"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Sc(5,":\xa0 "),r.Yb(),r.Zb(6,"div"),r.Zb(7,"button",4),r.hc("click",(function(){return r.Ic(t),r.lc().resetFilters()})),r.Zb(8,"mat-icon",19),r.Sc(9,"cancel"),r.Yb(),r.Zb(10,"span"),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Yb()}2&t&&(r.Gb(3),r.Tc(r.nc(4,2,"Active filters")),r.Gb(8),r.Tc(r.nc(12,4,"Visibility")))}function Vt(t,e){if(1&t){const t=r.ac();r.Zb(0,"mat-checkbox",20),r.hc("ngModelChange",(function(n){return r.Ic(t),e.$implicit.state=n}))("change",(function(){r.Ic(t);const n=e.$implicit;return r.lc().onFilterChange(n.id)})),r.Zb(1,"mat-icon",21),r.mc(2,"translate"),r.Sc(3),r.Yb(),r.Sc(4),r.mc(5,"translate"),r.Yb()}if(2&t){const t=e.$implicit,n=r.lc();r.tc("ngModel",t.state),r.Gb(1),r.uc("matTooltip",r.nc(2,4,t.label)),r.Gb(2),r.Tc(n.getIcon(t.label)),r.Gb(1),r.Uc(" ",r.nc(5,6,t.label)," ")}}function Bt(t,e){if(1&t&&(r.Zb(0,"span",22),r.Sc(1),r.Yb(),r.Zb(2,"span",23),r.Sc(3),r.mc(4,"translate"),r.Zb(5,"mat-icon"),r.Sc(6),r.Yb(),r.Yb()),2&t){const t=e.item,n=r.lc();r.Gb(1),r.Tc(t.getTitle()),r.Gb(2),r.Uc(" ",r.nc(4,3,t.verboseType)," "),r.Gb(3),r.Tc(n.getIcon(t.verboseType))}}let $t=(()=>{class t extends jt.a{constructor(t,e,n,i,c){super(t,e,n,c),this.agendaRepo=i,this.filterOptions=f.b.map(t=>({label:t.name,id:t.key,state:!1})),this.activeFilters=new Qt.a([]),this.itemsObservable=this.agendaRepo.getViewModelListObservable()}onFilterChange(t){const e=this.activeFilters.value;e.includes(t)?e.splice(e.indexOf(t),1):e.push(t),this.activeFilters.next(e)}ngOnInit(){const t=this.activeFilters.subscribe(t=>{this.hasActiveFilter=0!==t.length,this.changeFilter.emit(e=>!(t.includes(e.type)||0===t.length))});this.subscriptions.push(t)}resetFilters(){for(const t of this.filterOptions)t.state=!1;this.activeFilters.next([])}onSave(){return Object(a.a)(this,void 0,void 0,(function*(){yield this.agendaRepo.sortItems(this.osSortTree.getTreeData()).then(()=>this.osSortTree.setSubscription(),this.raiseError)}))}onStateChange(t){this.changeState.emit(t)}getIcon(t){switch(t.toLowerCase()){case"public item":return"public";case"internal item":return"visibility";case"hidden item":return"visibility_off"}}}return t.\u0275fac=function(e){return new(e||t)(r.Tb($.d),r.Tb(l.k),r.Tb(z.a),r.Tb(Z.a),r.Tb(w.a))},t.\u0275cmp=r.Nb({type:t,selectors:[["os-agenda-sort"]],features:[r.Db],decls:43,vars:27,consts:[[3,"nav","editMode","mainEvent","saveEvent"],[1,"title-slot"],[1,"custom-table-header","sort-header"],[1,"button-menu","left"],["mat-button","",3,"click"],["class","current-filters",4,"ngIf"],[1,"button-menu","right"],["mode","over","position","end"],["visibilityFilter",""],[1,"sort-drawer-content"],[1,"sort-grid"],[1,"hint"],[3,"ngModel","ngModelChange","change",4,"ngFor","ngForOf"],[1,"current-nodes"],["parentKey","parent_id","weightKey","weight",3,"model","stateChange","filterChange","hasChanged","visibleNodes"],["osSortedTree",""],["class","sorting-tree-node"],["innerNode",""],[1,"current-filters"],["inline",""],[3,"ngModel","ngModelChange","change"],[3,"matTooltip"],[1,"sort-node-title"],[1,"sort-node-icon"]],template:function(t,e){if(1&t){const t=r.ac();r.Zb(0,"os-head-bar",0),r.hc("mainEvent",(function(){return e.onCancel()}))("saveEvent",(function(){return e.onSave()})),r.Zb(1,"div",1),r.Zb(2,"h2"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Zb(5,"div",2),r.Zb(6,"div",3),r.Zb(7,"button",4),r.hc("click",(function(){return e.onStateChange(!0)})),r.Sc(8),r.mc(9,"translate"),r.Yb(),r.Zb(10,"button",4),r.hc("click",(function(){return e.onStateChange(!1)})),r.Sc(11),r.mc(12,"translate"),r.Yb(),r.Yb(),r.Qc(13,Nt,13,6,"div",5),r.Zb(14,"div",6),r.Zb(15,"button",4),r.hc("click",(function(){r.Ic(t);const e=r.Ec(18);return e.opened?e.close():e.open()})),r.Sc(16," Filter "),r.Yb(),r.Zb(17,"mat-drawer",7,8),r.Zb(19,"section",9),r.Zb(20,"button",4),r.hc("click",(function(){return r.Ic(t),r.Ec(18).toggle()})),r.Zb(21,"mat-icon"),r.Sc(22,"keyboard_arrow_right"),r.Yb(),r.Yb(),r.Zb(23,"span",10),r.Zb(24,"div",11),r.Sc(25),r.mc(26,"translate"),r.Yb(),r.Zb(27,"div"),r.Qc(28,Vt,6,8,"mat-checkbox",12),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Zb(29,"mat-card"),r.Zb(30,"div",13),r.Sc(31),r.Zb(32,"span"),r.Sc(33),r.mc(34,"translate"),r.Yb(),r.Sc(35),r.Zb(36,"span"),r.Sc(37),r.mc(38,"translate"),r.Yb(),r.Yb(),r.Zb(39,"os-sorting-tree",14,15),r.hc("hasChanged",(function(t){return e.receiveChanges(t)}))("visibleNodes",(function(t){return e.onChangeAmountOfItems(t)})),r.Qc(41,Bt,7,5,"ng-template",16,17,r.Rc),r.Yb(),r.Yb()}2&t&&(r.tc("nav",!1)("editMode",e.hasChanged),r.Gb(3),r.Tc(r.nc(4,15,"Sort agenda")),r.Gb(5),r.Tc(r.nc(9,17,"Expand all")),r.Gb(3),r.Tc(r.nc(12,19,"Collapse all")),r.Gb(2),r.tc("ngIf",e.hasActiveFilter),r.Gb(12),r.Tc(r.nc(26,21,"Visibility")),r.Gb(3),r.tc("ngForOf",e.filterOptions),r.Gb(3),r.Uc(" ",e.seenNodes[0]," "),r.Gb(2),r.Tc(r.nc(34,23,"of")),r.Gb(2),r.Uc(" ",e.seenNodes[1]," "),r.Gb(2),r.Tc(r.nc(38,25,"items")),r.Gb(2),r.tc("model",e.itemsObservable)("stateChange",e.changeState)("filterChange",e.changeFilter))},directives:[W.a,E.b,i.t,Et.a,K.a,i.s,Ft.a,Rt.a,At.a,x.s,x.v,Ut.c],pipes:[l.j],styles:[".sort-header[_ngcontent-%COMP%]{display:block;padding:0 8px;width:auto;position:relative;text-align:center}.sort-header[_ngcontent-%COMP%]   .button-menu[_ngcontent-%COMP%]{display:inline-block}.sort-header[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{float:left}.sort-header[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{float:right}.sort-header[_ngcontent-%COMP%]   mat-drawer[_ngcontent-%COMP%]{min-width:320px}.sort-header[_ngcontent-%COMP%]   .sort-drawer-content[_ngcontent-%COMP%]{text-align:left}.sort-header[_ngcontent-%COMP%]   .sort-drawer-content[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{margin-left:8px}.sort-header[_ngcontent-%COMP%]   .sort-drawer-content[_ngcontent-%COMP%]   .sort-grid[_ngcontent-%COMP%]{display:inline-grid;grid-template-columns:auto;grid-template-rows:20px 30px;margin:8px;vertical-align:top;line-height:1.5}.sort-header[_ngcontent-%COMP%]   .sort-drawer-content[_ngcontent-%COMP%]   .sort-grid[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]:not(:last-child){margin-right:8px}.sort-header[_ngcontent-%COMP%]   .current-filters[_ngcontent-%COMP%]{display:inline-block}.sort-header[_ngcontent-%COMP%]   .current-filters[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:inline}.current-nodes[_ngcontent-%COMP%]{position:relative;margin-bottom:8px}.sort-node-icon[_ngcontent-%COMP%]{margin:0 12px 0 auto}.sort-node-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px;vertical-align:middle}"]}),t})();var zt=n("+QJK"),Wt=n("gjbj"),Ht=n("E2rH"),Kt=n("W+e+"),Xt=n("P6Fj");let qt=(()=>{class t extends Ht.a{constructor(t,e,n,i,c){super(n,i,c),this.durationService=t,this.repo=e,this.headerMap=["title","text","agenda_duration","agenda_comment","agenda_type"],this.requiredHeaderLength=1,this.errorList={NoTitle:"A Topic needs a title",ParsingErrors:"Some csv values could not be read correctly."},this.expectedHeader=this.headerMap}clearData(){}mapData(t){const e=new Kt.a,n=Math.min(this.expectedHeader.length,t.length);let i=!1;for(let o=0;o<n;o++)switch(this.expectedHeader[o]){case"agenda_duration":try{const n=this.parseDuration(t[o]);n>0&&(e.agenda_duration=n)}catch(a){if(a instanceof TypeError){i=!0;continue}}break;case"agenda_type":try{e.agenda_type=this.parseType(t[o])}catch(a){if(a instanceof TypeError){i=!0;continue}}break;default:e[this.expectedHeader[o]]=t[o]}e.agenda_type||(e.agenda_type=1);const c={newEntry:e,status:"new",errors:[]};return i&&this.setError(c,"ParsingErrors"),c.newEntry.isValid||this.setError(c,"NoTitle"),c}doImport(){return Object(a.a)(this,void 0,void 0,(function*(){for(const t of this.entries)"new"===t.status&&(yield this.repo.create(t.newEntry),t.status="done");this.updatePreview()}))}parseDuration(t){return this.durationService.stringToDuration(t)}parseType(t){if(!t)return 1;if("string"==typeof t){const e=f.b.find(e=>e.csvName===t);if(e)return e.key}else{if(1!==t)throw new TypeError("type could not be matched");{const t=f.b.find(t=>"Internal item"===t.name);if(t)return t.key}}}parseTextArea(t){const e=[];this.clearData(),this.clearPreview(),t.split("\n").forEach(t=>{if(!t.length)return;const n=new Kt.a(new Kt.a({title:t,agenda_type:1}));e.push({newEntry:n,status:"new",errors:[]})}),this.setParsedEntries(e)}}return t.\u0275fac=function(e){return new(e||t)(r.dc(C.a),r.dc(T.a),r.dc(l.k),r.dc(Xt.a),r.dc(z.a))},t.\u0275prov=r.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Jt=n("wZkO"),te=n("IZUe"),ee=n("+0xr"),ne=n("Dh3D");function ie(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",20),r.hc("click",(function(){return r.Ic(t),r.lc().doImport()})),r.Zb(1,"span",21),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(2),r.Tc(r.nc(3,1,"Import")))}function ce(t,e){if(1&t&&(r.Zb(0,"mat-option",22),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=e.$implicit;r.tc("value",t.value),r.Gb(1),r.Uc(" ",r.nc(2,2,t.label)," ")}}function ae(t,e){if(1&t&&(r.Zb(0,"mat-option",22),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=e.$implicit;r.tc("value",t.value),r.Gb(1),r.Uc(" ",r.nc(2,2,t.label)," ")}}function oe(t,e){if(1&t&&(r.Zb(0,"mat-option",22),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=e.$implicit;r.tc("value",t.value),r.Gb(1),r.Uc(" ",r.nc(2,2,t.label)," ")}}function se(t,e){if(1&t&&(r.Zb(0,"div"),r.Sc(1," \xa0 "),r.Zb(2,"mat-icon",42),r.Sc(3,"playlist_add"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.Yb(),r.Zb(6,"span"),r.Sc(7),r.mc(8,"translate"),r.Yb(),r.Yb()),2&t){const t=r.lc(2);r.Gb(5),r.Uc("\xa0",t.newCount,"\xa0"),r.Gb(2),r.Tc(r.nc(8,2,"Topics(s) will be imported."))}}function re(t,e){if(1&t&&(r.Zb(0,"div",43),r.Sc(1," \xa0 "),r.Zb(2,"mat-icon",42),r.Sc(3,"warning"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.Yb(),r.Zb(6,"span"),r.Sc(7),r.mc(8,"translate"),r.Yb(),r.Yb()),2&t){const t=r.lc(2);r.Gb(5),r.Uc("\xa0",t.nonImportableCount,"\xa0"),r.Gb(2),r.Tc(r.nc(8,2,"entries will be ommitted."))}}function le(t,e){if(1&t&&(r.Zb(0,"div",44),r.Sc(1," \xa0 "),r.Zb(2,"mat-icon",42),r.Sc(3,"done"),r.Yb(),r.Zb(4,"span"),r.Sc(5),r.Yb(),r.Zb(6,"span"),r.Sc(7),r.mc(8,"translate"),r.Yb(),r.Yb()),2&t){const t=r.lc(2);r.Gb(5),r.Uc("\xa0",t.doneCount,"\xa0"),r.Gb(2),r.Tc(r.nc(8,2,"Topics have been imported."))}}function be(t,e){1&t&&(r.Zb(0,"div"),r.Zb(1,"span"),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Yb()),2&t&&(r.Gb(2),r.Tc(r.nc(3,1,'After verifiy the preview click on "import" please (see top right).')))}function ue(t,e){if(1&t){const t=r.ac();r.Zb(0,"mat-select",45),r.hc("valueChange",(function(e){return r.Ic(t),r.lc(2).shown=e}))("selectionChange",(function(){return r.Ic(t),r.lc(2).setFilter()})),r.Zb(1,"mat-option",46),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Zb(4,"mat-option",47),r.Sc(5),r.mc(6,"translate"),r.Yb(),r.Zb(7,"mat-option",48),r.Sc(8),r.mc(9,"translate"),r.Yb(),r.Yb()}if(2&t){const t=r.lc(2);r.tc("value",t.shown),r.Gb(2),r.Tc(r.nc(3,4,"Show all")),r.Gb(3),r.Tc(r.nc(6,6,"Show errors only")),r.Gb(3),r.Tc(r.nc(9,8,"Show correct entries only"))}}function de(t,e){1&t&&r.Ub(0,"mat-header-cell")}function me(t,e){if(1&t&&(r.Zb(0,"div"),r.Zb(1,"mat-icon",50),r.mc(2,"translate"),r.Sc(3),r.Yb(),r.Yb()),2&t){const t=r.lc().$implicit,e=r.lc(2);r.Gb(1),r.wc("matTooltip","",t.errors.length," ",r.nc(2,3,"errors"),""),r.Gb(2),r.Uc(" ",e.getActionIcon(t)," ")}}function pe(t,e){if(1&t&&(r.Zb(0,"div"),r.Zb(1,"mat-icon",51),r.mc(2,"translate"),r.Sc(3),r.Yb(),r.Yb()),2&t){const t=r.lc().$implicit,e=r.lc(2);r.Gb(1),r.uc("matTooltip",r.nc(2,2,"Topic will be imported")),r.Gb(2),r.Uc(" ",e.getActionIcon(t)," ")}}function fe(t,e){if(1&t&&(r.Zb(0,"div"),r.Zb(1,"mat-icon",51),r.mc(2,"translate"),r.Sc(3),r.Yb(),r.Yb()),2&t){const t=r.lc().$implicit,e=r.lc(2);r.Gb(1),r.uc("matTooltip",r.nc(2,2,"Topic has been imported")),r.Gb(2),r.Uc(" ",e.getActionIcon(t)," ")}}function he(t,e){if(1&t&&(r.Zb(0,"mat-cell",49),r.Qc(1,me,4,5,"div",24),r.Qc(2,pe,4,4,"div",24),r.Qc(3,fe,4,4,"div",24),r.Yb()),2&t){const t=e.$implicit;r.Gb(1),r.tc("ngIf","error"===t.status),r.Gb(1),r.tc("ngIf","new"===t.status),r.Gb(1),r.tc("ngIf","done"===t.status)}}function ge(t,e){1&t&&(r.Zb(0,"mat-header-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Title")))}function Se(t,e){if(1&t&&(r.Zb(0,"mat-icon",53),r.mc(1,"translate"),r.Sc(2," warning "),r.Yb()),2&t){const t=r.lc(3);r.uc("matTooltip",r.nc(1,1,t.getVerboseError("Duplicates")))}}function ve(t,e){if(1&t&&(r.Zb(0,"mat-icon",53),r.mc(1,"translate"),r.Sc(2," warning "),r.Yb()),2&t){const t=r.lc(3);r.uc("matTooltip",r.nc(1,1,t.getVerboseError("NoTitle")))}}function ke(t,e){if(1&t&&(r.Zb(0,"mat-cell"),r.Qc(1,Se,3,3,"mat-icon",52),r.Qc(2,ve,3,3,"mat-icon",52),r.Sc(3),r.Yb()),2&t){const t=e.$implicit,n=r.lc(2);r.Gb(1),r.tc("ngIf",n.hasError(t,"Duplicates")),r.Gb(1),r.tc("ngIf",n.hasError(t,"NoTitle")),r.Gb(1),r.Uc(" ",t.newEntry.title," ")}}function Ze(t,e){1&t&&(r.Zb(0,"mat-header-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Text")))}function Ye(t,e){if(1&t&&(r.Zb(0,"mat-cell",51),r.Sc(1),r.Yb()),2&t){const t=e.$implicit,n=r.lc(2);r.uc("matTooltip",n.getLongPreview(t.newEntry.text)),r.Gb(1),r.Uc(" ",n.getShortPreview(t.newEntry.text)," ")}}function Te(t,e){1&t&&(r.Zb(0,"mat-header-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Duration")))}function Oe(t,e){if(1&t&&(r.Zb(0,"mat-cell"),r.Sc(1),r.Yb()),2&t){const t=e.$implicit,n=r.lc(2);r.Gb(1),r.Uc(" ",n.getDuration(t.newEntry.agenda_duration)," ")}}function Ce(t,e){1&t&&(r.Zb(0,"mat-header-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Comment")))}function we(t,e){if(1&t&&(r.Zb(0,"mat-cell"),r.Sc(1),r.Yb()),2&t){const t=e.$implicit;r.Gb(1),r.Uc(" ",t.newEntry.agenda_comment," ")}}function Ge(t,e){1&t&&(r.Zb(0,"mat-header-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Type")))}function _e(t,e){if(1&t&&(r.Zb(0,"mat-cell"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=e.$implicit,n=r.lc(2);r.Gb(1),r.Uc(" ",r.nc(2,1,n.getTypeString(t.newEntry.agenda_type))," ")}}function Ie(t,e){1&t&&r.Ub(0,"mat-header-row")}function Me(t,e){if(1&t&&r.Ub(0,"mat-row",54),2&t){const t=e.$implicit,n=r.lc(2);r.tc("ngClass",n.getStateClass(t))}}function ye(t,e){if(1&t&&(r.Zb(0,"mat-card",4),r.Zb(1,"h3"),r.Sc(2),r.mc(3,"translate"),r.Yb(),r.Zb(4,"div",23),r.Qc(5,se,9,4,"div",24),r.Qc(6,re,9,4,"div",25),r.Qc(7,le,9,4,"div",26),r.Yb(),r.Qc(8,be,4,3,"div",24),r.Zb(9,"div"),r.Qc(10,ue,10,10,"mat-select",27),r.Yb(),r.Zb(11,"div",28),r.Zb(12,"table",29),r.Xb(13,30),r.Qc(14,de,1,0,"mat-header-cell",31),r.Qc(15,he,4,3,"mat-cell",32),r.Wb(),r.Xb(16,33),r.Qc(17,ge,3,3,"mat-header-cell",31),r.Qc(18,ke,4,3,"mat-cell",34),r.Wb(),r.Xb(19,35),r.Qc(20,Ze,3,3,"mat-header-cell",31),r.Qc(21,Ye,2,2,"mat-cell",36),r.Wb(),r.Xb(22,37),r.Qc(23,Te,3,3,"mat-header-cell",31),r.Qc(24,Oe,2,1,"mat-cell",34),r.Wb(),r.Xb(25,38),r.Qc(26,Ce,3,3,"mat-header-cell",31),r.Qc(27,we,2,1,"mat-cell",34),r.Wb(),r.Xb(28,39),r.Qc(29,Ge,3,3,"mat-header-cell",31),r.Qc(30,_e,3,3,"mat-cell",34),r.Wb(),r.Qc(31,Ie,1,0,"mat-header-row",40),r.Qc(32,Me,1,1,"mat-row",41),r.Yb(),r.Yb(),r.Yb()),2&t){const t=r.lc();r.Gb(2),r.Tc(r.nc(3,9,"Preview")),r.Gb(3),r.tc("ngIf",t.newCount),r.Gb(1),r.tc("ngIf",t.nonImportableCount),r.Gb(1),r.tc("ngIf",t.doneCount),r.Gb(1),r.tc("ngIf",t.newCount),r.Gb(2),r.tc("ngIf",t.nonImportableCount),r.Gb(2),r.tc("dataSource",t.dataSource),r.Gb(19),r.tc("matHeaderRowDef",t.getColumnDefinition()),r.Gb(1),r.tc("matRowDefColumns",t.getColumnDefinition())}}let Pe=(()=>{class t extends Wt.a{constructor(t,e,n,i,c,a,o){super(i,t,n,e),this.exporter=a,this.durationService=o,this.textAreaForm=c.group({inputtext:[""]})}downloadCsvExample(){this.exporter.dummyCSVExport(["Title","Text","Duration","Comment","Internal item"],[["Demo 1","Demo text 1","1:00","test comment",null],["Break",null,"0:10",null,"internal",null],["Demo 2","Demo text 2","1:30",null,"hidden"]],`${this.translate.instant("Agenda")}-${this.translate.instant("example")}.csv`)}getTypeString(t){const e=f.b.find(e=>e.key===t);return e?e.name:""}parseTextArea(){this.importer.parseTextArea(this.textAreaForm.get("inputtext").value)}onTabChange(){this.importer.clearPreview()}getDuration(t){return t>=0?this.durationService.durationToString(t,"h"):""}}return t.\u0275fac=function(e){return new(e||t)(r.Tb($.d),r.Tb(z.a),r.Tb(l.k),r.Tb(qt),r.Tb(x.f),r.Tb(s.a),r.Tb(C.a))},t.\u0275cmp=r.Nb({type:t,selectors:[["os-topic-import-list"]],features:[r.Db],decls:91,vars:68,consts:[[3,"nav"],[1,"title-slot"],[1,"menu-slot"],["mat-button","",3,"click",4,"ngIf"],[1,"os-form-card","import-table","spacer-bottom-60"],[3,"selectedTabChange"],[3,"label"],[3,"formGroup"],["matInput","","osAutofocus","","formControlName","inputtext","cdkTextareaAutosize","","cdkAutosizeMinRows","3","cdkAutosizeMaxRows","10",3,"placeholder"],["mat-button","","color","accent",3,"click"],[1,"code","red-warning-text"],[1,"wrapper"],[1,"selection",3,"value","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",1,"selection",3,"selectionChange"],["value",'"',1,"selection",3,"selectionChange"],["id","agenda-import-file-input","type","file","accept","text",1,"hidden-input",3,"change"],["fileInput",""],["mat-button","","onclick","document.getElementById('agenda-import-file-input').click()"],["class","os-form-card import-table spacer-bottom-60",4,"ngIf"],["mat-button","",3,"click"],[1,"upper"],[3,"value"],[1,"summary"],[4,"ngIf"],["class","red-warning-text",4,"ngIf"],["class","green-text",4,"ngIf"],["class","filter-imports",3,"value","valueChange","selectionChange",4,"ngIf"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","status","sticky","",1,"first-column"],[4,"matHeaderCellDef"],["class","first-column",4,"matCellDef"],["matColumnDef","title"],[4,"matCellDef"],["matColumnDef","text"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","agenda_duration"],["matColumnDef","agenda_comment"],["matColumnDef","agenda_type"],[4,"matHeaderRowDef"],[3,"ngClass",4,"matRowDef","matRowDefColumns"],["inline",""],[1,"red-warning-text"],[1,"green-text"],[1,"filter-imports",3,"value","valueChange","selectionChange"],["value","all"],["value","error"],["value","noerror"],[1,"first-column"],[1,"red-warning-text",3,"matTooltip"],[3,"matTooltip"],["color","warn","inline","",3,"matTooltip",4,"ngIf"],["color","warn","inline","",3,"matTooltip"],[3,"ngClass"]],template:function(t,e){1&t&&(r.Zb(0,"os-head-bar",0),r.Zb(1,"div",1),r.Zb(2,"h2"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Yb(),r.Zb(5,"div",2),r.Qc(6,ie,4,3,"button",3),r.Yb(),r.Yb(),r.Zb(7,"mat-card",4),r.Zb(8,"mat-tab-group",5),r.hc("selectedTabChange",(function(){return e.onTabChange()})),r.Zb(9,"mat-tab",6),r.mc(10,"translate"),r.Zb(11,"div",7),r.Zb(12,"div"),r.Zb(13,"span"),r.Sc(14),r.mc(15,"translate"),r.Yb(),r.Zb(16,"span"),r.Sc(17),r.mc(18,"translate"),r.Yb(),r.Yb(),r.Zb(19,"mat-form-field"),r.Ub(20,"textarea",8),r.mc(21,"translate"),r.Yb(),r.Yb(),r.Zb(22,"div"),r.Zb(23,"button",9),r.hc("click",(function(){return e.parseTextArea()})),r.Zb(24,"span"),r.Sc(25),r.mc(26,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Zb(27,"mat-tab",6),r.mc(28,"translate"),r.Zb(29,"span"),r.Sc(30),r.mc(31,"translate"),r.Yb(),r.Ub(32,"br"),r.Zb(33,"div",10),r.Zb(34,"span"),r.Sc(35),r.mc(36,"translate"),r.Yb(),r.Sc(37,",\xa0 "),r.Zb(38,"span"),r.Sc(39),r.mc(40,"translate"),r.Yb(),r.Sc(41,",\xa0 "),r.Zb(42,"span"),r.Sc(43),r.mc(44,"translate"),r.Yb(),r.Sc(45,",\xa0 "),r.Zb(46,"span"),r.Sc(47),r.mc(48,"translate"),r.Yb(),r.Sc(49,",\xa0 "),r.Zb(50,"span"),r.Sc(51),r.mc(52,"translate"),r.Yb(),r.Yb(),r.Zb(53,"ul"),r.Zb(54,"li"),r.Sc(55),r.mc(56,"translate"),r.Yb(),r.Zb(57,"li"),r.Sc(58),r.mc(59,"translate"),r.Yb(),r.Yb(),r.Zb(60,"button",9),r.hc("click",(function(){return e.downloadCsvExample()})),r.Sc(61),r.mc(62,"translate"),r.Yb(),r.Zb(63,"div",11),r.Zb(64,"mat-form-field"),r.Zb(65,"mat-label"),r.Sc(66),r.mc(67,"translate"),r.Yb(),r.Zb(68,"mat-select",12),r.hc("selectionChange",(function(t){return e.selectEncoding(t)})),r.Qc(69,ce,3,4,"mat-option",13),r.Yb(),r.Yb(),r.Zb(70,"mat-form-field"),r.Zb(71,"mat-label"),r.Sc(72),r.mc(73,"translate"),r.Yb(),r.Zb(74,"mat-select",14),r.hc("selectionChange",(function(t){return e.selectColSep(t)})),r.Qc(75,ae,3,4,"mat-option",13),r.Yb(),r.Yb(),r.Zb(76,"mat-form-field"),r.Zb(77,"mat-label"),r.Sc(78),r.mc(79,"translate"),r.Yb(),r.Zb(80,"mat-select",15),r.hc("selectionChange",(function(t){return e.selectTextSep(t)})),r.Qc(81,oe,3,4,"mat-option",13),r.Yb(),r.Yb(),r.Yb(),r.Zb(82,"div"),r.Zb(83,"div"),r.Zb(84,"input",16,17),r.hc("change",(function(t){return e.onSelectFile(t)})),r.Yb(),r.Zb(86,"button",18),r.Zb(87,"span"),r.Sc(88),r.mc(89,"translate"),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Yb(),r.Qc(90,ye,33,11,"mat-card",19)),2&t&&(r.tc("nav",!1),r.Gb(3),r.Tc(r.nc(4,28,"Import topics")),r.Gb(3),r.tc("ngIf",e.hasFile&&e.newCount),r.Gb(3),r.uc("label",r.nc(10,30,"Text import")),r.Gb(2),r.tc("formGroup",e.textAreaForm),r.Gb(3),r.Tc(r.nc(15,32,"Paste/write your topics in this textbox.")),r.Gb(3),r.Tc(r.nc(18,34,"Keep each item in a single line.")),r.Gb(3),r.uc("placeholder",r.nc(21,36,"Insert topics here")),r.Gb(5),r.Tc(r.nc(26,38,"Preview")),r.Gb(2),r.uc("label",r.nc(28,40,"CSV import")),r.Gb(3),r.Tc(r.nc(31,42,"Required comma or semicolon separated values with these column header names in the first row:")),r.Gb(5),r.Tc(r.nc(36,44,"Title")),r.Gb(4),r.Tc(r.nc(40,46,"Text")),r.Gb(4),r.Tc(r.nc(44,48,"Duration")),r.Gb(4),r.Tc(r.nc(48,50,"Comment")),r.Gb(4),r.Tc(r.nc(52,52,"Internal item")),r.Gb(4),r.Tc(r.nc(56,54,"Title is required. All other fields are optional and may be empty.")),r.Gb(3),r.Uc(" ",r.nc(59,56,"Additional columns after the required ones may be present and will not affect the import.")," "),r.Gb(3),r.Uc(" ",r.nc(62,58,"Download CSV example file")," "),r.Gb(5),r.Tc(r.nc(67,60,"Encoding of the file")),r.Gb(2),r.tc("value",e.encodings[0].value),r.Gb(1),r.tc("ngForOf",e.encodings),r.Gb(3),r.Tc(r.nc(73,62,"Column separator")),r.Gb(3),r.tc("ngForOf",e.columnSeparators),r.Gb(3),r.Tc(r.nc(79,64,"Text separator")),r.Gb(3),r.tc("ngForOf",e.textSeparators),r.Gb(7),r.Tc(r.nc(89,66,"Select file")),r.Gb(2),r.tc("ngIf",e.hasFile))},directives:[W.a,i.t,Ft.a,Jt.c,Jt.a,x.t,x.k,L.c,Q.b,x.c,j.c,te.a,x.s,x.i,E.b,L.g,D.a,i.s,F.n,ee.n,ne.a,ee.c,ee.i,ee.b,ee.k,ee.m,K.a,ee.h,ee.a,Ut.c,ee.j,ee.l,i.q],pipes:[l.j],encapsulation:2}),t})();var xe=n("TG9O"),Le=n("3moa"),De=n("ZDbo"),Qe=n("IBZR"),je=n("mV3u"),Ee=n("kYDr"),Fe=n("DJZM"),Re=n("FyoB"),Ae=n("7EHt"),Ue=n("MutI"),Ne=n("oqD5");function Ve(t,e){1&t&&(r.Zb(0,"span"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"List of speakers")))}function Be(t,e){1&t&&(r.Zb(0,"span"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Tc(r.nc(2,1,"Current list of speakers")))}function $e(t,e){if(1&t){const t=r.ac();r.Zb(0,"div",11),r.Zb(1,"button",12),r.hc("click",(function(){return r.Ic(t),r.lc().readdLastSpeaker()})),r.mc(2,"translate"),r.Zb(3,"mat-icon"),r.Sc(4,"undo"),r.Yb(),r.Yb(),r.Zb(5,"button",13),r.Zb(6,"mat-icon"),r.Sc(7,"more_vert"),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=r.lc(),e=r.Ec(8);r.Gb(1),r.uc("matTooltip",r.nc(2,3,"Re-add last speaker")),r.tc("disabled",!t.finishedSpeakers||!t.finishedSpeakers.length),r.Gb(4),r.tc("matMenuTriggerFor",e)}}function ze(t,e){1&t&&(r.Zb(0,"mat-icon"),r.Sc(1," lock "),r.Yb())}function We(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",30),r.hc("click",(function(){r.Ic(t);const e=r.lc().$implicit;return r.lc(3).onDeleteButton(e)})),r.mc(1,"translate"),r.Zb(2,"mat-icon"),r.Sc(3,"close"),r.Yb(),r.Yb()}2&t&&r.uc("matTooltip",r.nc(1,1,"Remove"))}function He(t,e){if(1&t&&(r.Zb(0,"mat-list-item"),r.Zb(1,"div",24),r.Zb(2,"div",25),r.Sc(3),r.Yb(),r.Zb(4,"div",26),r.Sc(5),r.Yb(),r.Zb(6,"div",27),r.Sc(7),r.mc(8,"translate"),r.Yb(),r.Zb(9,"div",28),r.Qc(10,We,4,3,"button",29),r.Yb(),r.Yb(),r.Yb()),2&t){const t=e.$implicit,n=e.index,i=r.lc(3);r.Gb(3),r.Uc("",n+1,"."),r.Gb(2),r.Tc(t.getTitle()),r.Gb(2),r.Wc(" ",i.durationString(t)," (",r.nc(8,6,"Start time"),": ",i.startTimeToString(t),") "),r.Gb(3),r.tc("osPerms","agenda.can_manage_list_of_speakers")}}function Ke(t,e){if(1&t&&(r.Zb(0,"mat-expansion-panel",22),r.Zb(1,"mat-expansion-panel-header"),r.Zb(2,"mat-panel-title"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Yb(),r.Zb(5,"mat-list"),r.Qc(6,He,11,8,"mat-list-item",23),r.Yb(),r.Yb()),2&t){const t=r.lc(2);r.Gb(3),r.Tc(r.nc(4,2,"Last speakers")),r.Gb(3),r.tc("ngForOf",t.finishedSpeakers)}}function Xe(t,e){1&t&&r.Ub(0,"mat-divider")}function qe(t,e){1&t&&r.Ub(0,"div",31)}function Je(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",30),r.hc("click",(function(){return r.Ic(t),r.lc(3).onStopButton()})),r.mc(1,"translate"),r.Zb(2,"mat-icon"),r.Sc(3,"stop"),r.Yb(),r.Yb()}2&t&&r.uc("matTooltip",r.nc(1,1,"End speech"))}function tn(t,e){if(1&t&&(r.Zb(0,"div",32),r.Zb(1,"span",33),r.Zb(2,"mat-icon"),r.Sc(3,"mic"),r.Yb(),r.Yb(),r.Zb(4,"span",26),r.Sc(5),r.Yb(),r.Zb(6,"span",34),r.Qc(7,Je,4,3,"button",29),r.Yb(),r.Yb()),2&t){const t=r.lc(2);r.Gb(5),r.Tc(t.activeSpeaker.getListTitle()),r.Gb(2),r.tc("osPerms","agenda.can_manage_list_of_speakers")}}function en(t,e){if(1&t&&(r.Zb(0,"span",38),r.Sc(1),r.Zb(2,"span"),r.Sc(3),r.mc(4,"translate"),r.Yb(),r.Yb()),2&t){const t=r.lc(2).$implicit,e=r.lc(3);r.Gb(1),r.Uc(" ",e.hasSpokenCount(t)+1,". "),r.Gb(2),r.Tc(r.nc(4,2,"contribution"))}}function nn(t,e){1&t&&(r.Zb(0,"span",38),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t&&(r.Gb(1),r.Uc(" ",r.nc(2,1,"First speech")," "))}function cn(t,e){if(1&t&&(r.Zb(0,"span"),r.Sc(1),r.mc(2,"translate"),r.Yb()),2&t){const t=r.lc(2).$implicit;r.Gb(1),r.Uc("(",r.nc(2,1,t.gender),")")}}function an(t,e){if(1&t&&(r.Zb(0,"span"),r.Qc(1,en,5,4,"span",37),r.Qc(2,nn,3,3,"span",37),r.Qc(3,cn,3,3,"span",2),r.Yb()),2&t){const t=r.lc().$implicit,e=r.lc(3);r.Gb(1),r.tc("ngIf",e.hasSpokenCount(t)),r.Gb(1),r.tc("ngIf",e.showFistContributionHint&&e.isFirstContribution(t)),r.Gb(1),r.tc("ngIf",t.gender)}}function on(t,e){if(1&t){const t=r.ac();r.Zb(0,"span"),r.Zb(1,"button",30),r.hc("click",(function(){r.Ic(t);const e=r.lc().$implicit;return r.lc(3).onStartButton(e)})),r.mc(2,"translate"),r.Zb(3,"mat-icon"),r.Sc(4,"play_arrow"),r.Yb(),r.Yb(),r.Zb(5,"button",30),r.hc("click",(function(){r.Ic(t);const e=r.lc().$implicit;return r.lc(3).onMarkButton(e)})),r.mc(6,"translate"),r.Zb(7,"mat-icon"),r.Sc(8),r.Yb(),r.Yb(),r.Zb(9,"button",30),r.hc("click",(function(){r.Ic(t);const e=r.lc().$implicit;return r.lc(3).onDeleteButton(e)})),r.mc(10,"translate"),r.Zb(11,"mat-icon"),r.Sc(12,"close"),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=r.lc().$implicit;r.Gb(1),r.uc("matTooltip",r.nc(2,4,"Begin speech")),r.Gb(4),r.uc("matTooltip",r.nc(6,6,"Mark speaker")),r.Gb(3),r.Tc(t.marked?"star":"star_border"),r.Gb(1),r.uc("matTooltip",r.nc(10,8,"Remove"))}}function sn(t,e){1&t&&(r.Qc(0,an,4,3,"span",20),r.Qc(1,on,13,10,"span",20)),2&t&&(r.tc("osPerms","agenda.can_manage_list_of_speakers"),r.Gb(1),r.tc("osPerms","agenda.can_manage_list_of_speakers"))}function rn(t,e){if(1&t){const t=r.ac();r.Zb(0,"div",35),r.Zb(1,"os-sorting-list",36),r.hc("sortEvent",(function(e){return r.Ic(t),r.lc(2).onSortingChanged(e)})),r.Qc(2,sn,2,2,"ng-template"),r.Yb(),r.Yb()}if(2&t){const t=r.lc(2);r.Gb(1),r.tc("live",!0)("input",t.speakers)("count",!0)("enable",t.opCanManage()&&t.isSortMode)}}function ln(t,e){if(1&t){const t=r.ac();r.Zb(0,"form",40),r.Zb(1,"mat-form-field",41),r.Zb(2,"os-search-value-selector",42),r.hc("clickNotFound",(function(e){return r.Ic(t),r.lc(3).onCreateUser(e)})),r.mc(3,"translate"),r.Xb(4,43),r.Zb(5,"mat-icon"),r.Sc(6,"add"),r.Yb(),r.Sc(7),r.mc(8,"translate"),r.Wb(),r.Yb(),r.Yb(),r.Yb()}if(2&t){const t=r.lc(3);r.tc("formGroup",t.addSpeakerForm),r.Gb(2),r.uc("placeholder",r.nc(3,5,"Select or search new speaker ...")),r.tc("inputListValues",t.filteredUsers)("showNotFoundButton",!0),r.Gb(5),r.Uc(" ",r.nc(8,7,"Create user")," ")}}function bn(t,e){if(1&t&&(r.Zb(0,"div"),r.Qc(1,ln,9,9,"form",39),r.Yb()),2&t){const t=r.lc(2);r.Gb(1),r.tc("ngIf",t.filteredUsers&&t.filteredUsers.value.length>0)}}function un(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",47),r.hc("click",(function(){return r.Ic(t),r.lc(4).addNewSpeaker()})),r.Zb(1,"mat-icon"),r.Sc(2,"add"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}if(2&t){const t=r.lc(4);r.tc("disabled",t.viewListOfSpeakers.closed),r.Gb(4),r.Tc(r.nc(5,2,"Add me"))}}function dn(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",48),r.hc("click",(function(){return r.Ic(t),r.lc(4).onDeleteButton()})),r.Zb(1,"mat-icon"),r.Sc(2,"remove"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Remove me")))}function mn(t,e){if(1&t&&(r.Zb(0,"div"),r.Qc(1,un,6,4,"button",45),r.Qc(2,dn,6,3,"button",46),r.Yb()),2&t){const t=r.lc(3);r.Gb(1),r.tc("ngIf",!t.isOpInList()&&t.canAddSelf),r.Gb(1),r.tc("ngIf",t.isOpInList())}}function pn(t,e){if(1&t&&(r.Zb(0,"div",44),r.Qc(1,mn,3,2,"div",2),r.Yb()),2&t){const t=r.lc(2);r.Gb(1),r.tc("ngIf",t.speakers&&!t.closedList)}}function fn(t,e){if(1&t&&(r.Zb(0,"mat-card",14),r.Zb(1,"h1",15),r.Sc(2),r.Qc(3,ze,2,0,"mat-icon",2),r.Yb(),r.Qc(4,Ke,7,4,"mat-expansion-panel",16),r.Qc(5,Xe,1,0,"mat-divider",2),r.Qc(6,qe,1,0,"div",17),r.Qc(7,tn,8,2,"div",18),r.Qc(8,rn,3,4,"div",19),r.Qc(9,bn,2,1,"div",20),r.Qc(10,pn,2,1,"div",21),r.Yb()),2&t){const t=r.lc();r.Gb(2),r.Uc(" ",t.viewListOfSpeakers.getTitle()," "),r.Gb(1),r.tc("ngIf",t.viewListOfSpeakers.closed),r.Gb(1),r.tc("ngIf",t.finishedSpeakers&&t.finishedSpeakers.length>0),r.Gb(1),r.tc("ngIf",t.finishedSpeakers&&t.finishedSpeakers.length),r.Gb(1),r.tc("ngIf",t.finishedSpeakers&&t.finishedSpeakers.length),r.Gb(1),r.tc("ngIf",t.activeSpeaker),r.Gb(1),r.tc("ngIf",t.speakers&&t.speakers.length>0),r.Gb(1),r.tc("osPerms","agenda.can_manage_list_of_speakers"),r.Gb(1),r.tc("osPerms","agenda.can_be_speaker")}}function hn(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",49),r.hc("click",(function(){return r.Ic(t),r.lc().isSortMode=!0})),r.Zb(1,"mat-icon"),r.Sc(2,"sort"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Sort")))}function gn(t,e){if(1&t&&r.Ub(0,"os-projector-button",50),2&t){const t=r.lc();r.tc("object",t.getClosSlide())("menuItem",!0)}}function Sn(t,e){if(1&t&&r.Ub(0,"os-projector-button",51),2&t){const t=r.lc();r.tc("object",t.viewListOfSpeakers)("menuItem",!0)}}function vn(t,e){if(1&t&&r.Ub(0,"os-projector-button",52),2&t){const t=r.lc();r.tc("object",t.viewListOfSpeakers.contentObject)("menuItem",!0)("text",t.getContentObjectProjectorButtonText())}}function kn(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",49),r.hc("click",(function(){return r.Ic(t),r.lc().openSpeakerList()})),r.Zb(1,"mat-icon"),r.Sc(2,"lock_open"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Open list of speakers")))}function Zn(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",49),r.hc("click",(function(){return r.Ic(t),r.lc().closeSpeakerList()})),r.Zb(1,"mat-icon"),r.Sc(2,"lock"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Close list of speakers")))}function Yn(t,e){1&t&&r.Ub(0,"mat-divider")}function Tn(t,e){if(1&t){const t=r.ac();r.Zb(0,"button",53),r.hc("click",(function(){return r.Ic(t),r.lc().clearSpeakerList()})),r.Zb(1,"mat-icon"),r.Sc(2,"delete"),r.Yb(),r.Zb(3,"span"),r.Sc(4),r.mc(5,"translate"),r.Yb(),r.Yb()}2&t&&(r.Gb(4),r.Tc(r.nc(5,1,"Remove all speakers")))}const On=function(){return["agenda.can_manage_list_of_speakers","core.can_manage_projector"]};let Cn=(()=>{class t extends je.a{constructor(t,e,n,i,c,a,o,s,r,l,b,u,d,m,p,f){super(t,e,n),this.translate=e,this.projectorRepo=i,this.route=c,this.listOfSpeakersRepo=a,this.operator=o,this.promptService=s,this.currentListOfSpeakersService=r,this.durationService=l,this.userRepository=b,this.collectionStringMapper=u,this.currentListOfSpeakersSlideService=d,this.config=m,this.viewport=p,this.cd=f,this.isCurrentListOfSpeakers=!1,this.isSortMode=!1,this.users=new Qt.a([]),this.filteredUsers=new Qt.a([]),this.isMobile=!1,this.speakerListAsSelectable=[],this.addSpeakerForm=new x.j({user_id:new x.g})}get isListOfSpeakersClosed(){return this.viewListOfSpeakers&&this.viewListOfSpeakers.closed}get isListOfSpeakersEmpty(){return!(this.speakers&&this.speakers.length||this.finishedSpeakers&&this.finishedSpeakers.length||this.activeSpeaker)}get canAddSelf(){return!this.config.instant("agenda_present_speakers_only")||this.operator.user.is_present}ngOnInit(){this.isCurrentListOfSpeakers=!(this.route.snapshot.url.length>0)||"speakers"===this.route.snapshot.url[this.route.snapshot.url.length-1].path,this.isCurrentListOfSpeakers?(this.projectors=this.projectorRepo.getViewModelList(),this.updateClosProjector(),this.subscriptions.push(this.projectorRepo.getViewModelListObservable().subscribe(t=>{this.projectors=t,this.updateClosProjector()}))):this.setListOfSpeakersId(+this.route.snapshot.url[this.route.snapshot.url.length-1].path),this.subscriptions.push(this.userRepository.getViewModelListObservable().subscribe(t=>{this.users.next(t),this.filterUsers(),this.cd.markForCheck()}),this.addSpeakerForm.valueChanges.subscribe(t=>{t&&t.user_id&&this.addNewSpeaker(t.user_id)}),this.viewport.isMobileSubject.subscribe(t=>this.checkSortMode(t)),this.config.get("agenda_present_speakers_only").subscribe(()=>{this.filterUsers()}),this.config.get("agenda_show_first_contribution").subscribe(t=>{this.showFistContributionHint=t}))}opCanManage(){return this.operator.hasPerms(v.b.agendaCanManageListOfSpeakers)}updateClosProjector(){if(!this.projectors.length)return;const t=this.projectors[0].referenceProjector;t&&t.id!==this.closReferenceProjectorId&&(this.closReferenceProjectorId=t.id,this.projectorSubscription&&(this.projectorSubscription.unsubscribe(),this.viewListOfSpeakers=null),this.projectorSubscription=this.currentListOfSpeakersService.getListOfSpeakersObservable(t).subscribe(t=>{t&&this.setListOfSpeakers(t)}),this.subscriptions.push(this.projectorSubscription))}getClosSlide(){return this.currentListOfSpeakersSlideService.getSlide(!1)}setListOfSpeakersId(t){this.closSubscription&&this.closSubscription.unsubscribe(),this.closSubscription=this.listOfSpeakersRepo.getViewModelObservable(t).subscribe(t=>{t&&this.setListOfSpeakers(t)})}setListOfSpeakers(t){const e=this.isCurrentListOfSpeakers?"Current list of speakers":t.getTitle()+" - "+this.translate.instant("List of speakers");super.setTitle(e),this.viewListOfSpeakers=t;const n=this.viewListOfSpeakers.speakers.sort((t,e)=>t.weight-e.weight);this.speakers=n.filter(t=>t.state===Re.a.WAITING),this.speakers.sort((t,e)=>t.weight-e.weight),this.filterUsers(),this.finishedSpeakers=n.filter(t=>t.state===Re.a.FINISHED),this.finishedSpeakers.sort((t,e)=>new Date(t.begin_time).getTime()-new Date(e.begin_time).getTime()),this.activeSpeaker=n.find(t=>t.state===Re.a.CURRENT)}getContentObjectProjectorButtonText(){return this.collectionStringMapper.getRepository(this.viewListOfSpeakers.listOfSpeakers.content_object.collection).getVerboseName()}addNewSpeaker(t){this.listOfSpeakersRepo.createSpeaker(this.viewListOfSpeakers,t).then(()=>this.addSpeakerForm.reset(),this.raiseError)}onMobileSaveSorting(){this.onSaveSorting(this.speakerListAsSelectable),this.isSortMode=!1}onSortingChanged(t){this.speakerListAsSelectable=t,this.isMobile||this.onSaveSorting(t)}onCancelSorting(){this.isSortMode&&(this.isSortMode=!1,this.listElement.restore())}onStartButton(t){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.listOfSpeakersRepo.startSpeaker(this.viewListOfSpeakers,t),this.filterUsers()}catch(e){this.raiseError(e)}}))}onStopButton(){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.listOfSpeakersRepo.stopCurrentSpeaker(this.viewListOfSpeakers),this.filterUsers()}catch(t){this.raiseError(t)}}))}onMarkButton(t){this.listOfSpeakersRepo.markSpeaker(this.viewListOfSpeakers,t,!t.marked).catch(this.raiseError)}readdLastSpeaker(){this.listOfSpeakersRepo.readdLastSpeaker(this.viewListOfSpeakers).catch(this.raiseError)}onDeleteButton(t){return Object(a.a)(this,void 0,void 0,(function*(){const e=this.translate.instant("Are you sure you want to delete this speaker from this list of speakers?");if(yield this.promptService.open(e))try{yield this.listOfSpeakersRepo.delete(this.viewListOfSpeakers,t?t.id:null),this.filterUsers()}catch(n){this.raiseError(n)}}))}isOpInList(){return this.speakers.some(t=>t.user_id===this.operator.user.id)}hasSpokenCount(t){return this.finishedSpeakers.filter(e=>{if(e&&e.user)return e.user.id===t.user.id}).length}isFirstContribution(t){return this.listOfSpeakersRepo.isFirstContribution(t)}closeSpeakerList(){if(!this.viewListOfSpeakers.closed)return this.listOfSpeakersRepo.update({closed:!0},this.viewListOfSpeakers).catch(this.raiseError)}openSpeakerList(){if(this.viewListOfSpeakers.closed)return this.listOfSpeakersRepo.update({closed:!1},this.viewListOfSpeakers).catch(this.raiseError)}clearSpeakerList(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete all speakers from this list of speakers?");(yield this.promptService.open(t))&&this.listOfSpeakersRepo.deleteAllSpeakers(this.viewListOfSpeakers)}))}startTimeToString(t){return new Date(t.begin_time).toLocaleString(this.translate.currentLang)}durationString(t){const e=Math.floor((new Date(t.end_time).valueOf()-new Date(t.begin_time).valueOf())/1e3);return""+this.durationService.durationToString(e,"m")}onCreateUser(t){this.userRepository.createFromString(t).then(t=>{this.addNewSpeaker(t.id)})}filterUsers(){const t=this.config.instant("agenda_present_speakers_only")?this.users.getValue().filter(t=>t.is_present):this.users.getValue();this.filteredUsers.next(this.speakers&&this.speakers.length?t.filter(t=>!this.speakers.some(e=>e.user_id===t.id)):t)}onSaveSorting(t){this.isSortMode&&this.listOfSpeakersRepo.sortSpeakers(this.viewListOfSpeakers,t.map(t=>t.id)).catch(this.raiseError)}checkSortMode(t){this.isMobile=t,this.isSortMode=!t}}return t.\u0275fac=function(e){return new(e||t)(r.Tb($.d),r.Tb(l.k),r.Tb(z.a),r.Tb(Le.a),r.Tb(c.a),r.Tb(Y.a),r.Tb(v.a),r.Tb(w.a),r.Tb(Fe.a),r.Tb(C.a),r.Tb(De.a),r.Tb(xe.a),r.Tb(Ee.a),r.Tb(O.a),r.Tb(G.a),r.Tb(r.h))},t.\u0275cmp=r.Nb({type:t,selectors:[["os-list-of-speakers"]],viewQuery:function(t,e){var n;1&t&&r.Zc(Qe.a,!0),2&t&&r.Dc(n=r.ic())&&(e.listElement=n.first)},features:[r.Db],decls:17,vars:16,consts:[[3,"nav","goBack","editMode","cancelEditEvent","saveEvent"],[1,"title-slot"],[4,"ngIf"],["class","menu-slot",4,"osPerms"],["class","os-card speaker-card",4,"ngIf"],["speakerMenu","matMenu"],["mat-menu-item","",3,"click",4,"ngIf"],["text","Current list of speakers (as slide)",3,"object","menuItem",4,"ngIf"],["text","List of speakers",3,"object","menuItem",4,"ngIf"],[3,"object","menuItem","text",4,"ngIf"],["mat-menu-item","","class","red-warning-text",3,"click",4,"ngIf"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matTooltip","disabled","click"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],[1,"os-card","speaker-card"],[1,"los-title"],["class","finished-list",4,"ngIf"],["class","spacer-bottom-40",4,"ngIf"],["class","current-speaker",4,"ngIf"],["class","waiting-list",4,"ngIf"],[4,"osPerms"],["class","add-self-buttons",4,"osPerms"],[1,"finished-list"],[4,"ngFor","ngForOf"],[1,"finished-speaker-grid"],[1,"number"],[1,"name"],[1,"time"],[1,"controls"],["mat-icon-button","",3,"matTooltip","click",4,"osPerms"],["mat-icon-button","",3,"matTooltip","click"],[1,"spacer-bottom-40"],[1,"current-speaker"],[1,"prefix"],[1,"suffix"],[1,"waiting-list"],[3,"live","input","count","enable","sortEvent"],["class","red-warning-text speaker-warning",4,"ngIf"],[1,"red-warning-text","speaker-warning"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],[1,"search-users-field"],["formControlName","user_id",1,"search-users",3,"placeholder","inputListValues","showNotFoundButton","clickNotFound"],["notFoundDescription",""],[1,"add-self-buttons"],["mat-stroked-button","",3,"disabled","click",4,"ngIf"],["mat-stroked-button","",3,"click",4,"ngIf"],["mat-stroked-button","",3,"disabled","click"],["mat-stroked-button","",3,"click"],["mat-menu-item","",3,"click"],["text","Current list of speakers (as slide)",3,"object","menuItem"],["text","List of speakers",3,"object","menuItem"],[3,"object","menuItem","text"],["mat-menu-item","",1,"red-warning-text",3,"click"]],template:function(t,e){1&t&&(r.Zb(0,"os-head-bar",0),r.hc("cancelEditEvent",(function(){return e.onCancelSorting()}))("saveEvent",(function(){return e.onMobileSaveSorting()})),r.Zb(1,"div",1),r.Zb(2,"h2"),r.Qc(3,Ve,3,3,"span",2),r.Qc(4,Be,3,3,"span",2),r.Yb(),r.Yb(),r.Qc(5,$e,8,5,"div",3),r.Yb(),r.Qc(6,fn,11,9,"mat-card",4),r.Zb(7,"mat-menu",null,5),r.Qc(9,hn,6,3,"button",6),r.Qc(10,gn,1,2,"os-projector-button",7),r.Qc(11,Sn,1,2,"os-projector-button",8),r.Qc(12,vn,1,3,"os-projector-button",9),r.Qc(13,kn,6,3,"button",6),r.Qc(14,Zn,6,3,"button",6),r.Qc(15,Yn,1,0,"mat-divider",2),r.Qc(16,Tn,6,3,"button",10),r.Yb()),2&t&&(r.tc("nav",!1)("goBack",!0)("editMode",e.isMobile&&e.isSortMode),r.Gb(3),r.tc("ngIf",!e.isCurrentListOfSpeakers),r.Gb(1),r.tc("ngIf",e.isCurrentListOfSpeakers),r.Gb(1),r.tc("osPerms",r.yc(15,On)),r.Gb(1),r.tc("ngIf",e.viewListOfSpeakers),r.Gb(3),r.tc("ngIf",e.isMobile),r.Gb(1),r.tc("ngIf",e.viewListOfSpeakers&&e.projectors&&e.projectors.length>1),r.Gb(1),r.tc("ngIf",e.viewListOfSpeakers),r.Gb(1),r.tc("ngIf",e.viewListOfSpeakers),r.Gb(1),r.tc("ngIf",e.isListOfSpeakersClosed),r.Gb(1),r.tc("ngIf",!e.isListOfSpeakersClosed),r.Gb(1),r.tc("ngIf",!e.isListOfSpeakersEmpty),r.Gb(1),r.tc("ngIf",!e.isListOfSpeakersEmpty))},directives:[W.a,i.t,tt.a,H.f,E.b,Ut.c,K.a,H.e,Ft.a,Ae.c,Ae.g,Ae.h,Ue.a,i.s,Ue.d,nt.a,Qe.a,x.I,x.t,x.k,L.c,Ne.a,x.s,x.i,H.c,et.a],pipes:[l.j],styles:['.los-title[_ngcontent-%COMP%]{margin-left:25px}.finished-list[_ngcontent-%COMP%]{box-shadow:none!important;margin-bottom:15px}.finished-list[_ngcontent-%COMP%]   .mat-list-item[_ngcontent-%COMP%]{height:auto;margin-bottom:10px}.finished-list[_ngcontent-%COMP%]   .finished-speaker-grid[_ngcontent-%COMP%]{display:grid;width:100%;grid-gap:5px;grid-template-areas:"number name controls" "number time controls";grid-template-columns:30px 1fr -webkit-min-content;grid-template-columns:30px 1fr min-content}@media (min-width:960px){.finished-list[_ngcontent-%COMP%]   .finished-speaker-grid[_ngcontent-%COMP%]{grid-template-areas:"number name time controls";grid-template-columns:30px 1fr -webkit-min-content -webkit-min-content;grid-template-columns:30px 1fr min-content min-content}}.finished-list[_ngcontent-%COMP%]   .number[_ngcontent-%COMP%]{grid-area:number;margin:0}.finished-list[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{grid-area:name;margin:0}.finished-list[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{grid-area:time;margin:0;white-space:nowrap;font-size:80%}.finished-list[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{grid-area:controls;margin:0;opacity:.7}.finished-list[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]{height:20px;line-height:1}.finished-list[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]   .mat-icon-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{line-height:19px}.current-speaker[_ngcontent-%COMP%]{display:table;width:-webkit-fill-available;height:50px;margin:50px 25px 20px;box-shadow:0 3px 10px 0 rgba(0,0,0,.25)}.current-speaker[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%]{display:table-cell;padding:0 15px;vertical-align:middle}.current-speaker[_ngcontent-%COMP%]   .prefix[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{vertical-align:middle}.current-speaker[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;font-weight:700;padding-left:10px;width:100%}.current-speaker[_ngcontent-%COMP%]   .suffix[_ngcontent-%COMP%]{display:table-cell;vertical-align:middle;white-space:nowrap;padding-right:10px}.waiting-list[_ngcontent-%COMP%]{padding:10px 25px 0}form[_ngcontent-%COMP%]{padding:15px 25px 10px;width:auto}form[_ngcontent-%COMP%]   .search-users-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .search-users-field[_ngcontent-%COMP%]   .search-users[_ngcontent-%COMP%]{display:grid}form[_ngcontent-%COMP%]   .search-users-field[_ngcontent-%COMP%]   .search-users[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}.add-self-buttons[_ngcontent-%COMP%]{padding:15px 0 20px 25px}.speaker-warning[_ngcontent-%COMP%]{margin-right:5px}'],changeDetection:0}),t})();const wn=[{path:"",component:Dt,pathMatch:"full"},{path:"import",component:Pe,data:{basePerm:v.b.agendaCanManage}},{path:"sort-agenda",component:$t,canDeactivate:[zt.a],data:{basePerm:v.b.agendaCanManage}},{path:"speakers",component:Cn,data:{basePerm:v.b.agendaCanSeeListOfSpeakers}},{path:"speakers/:id",component:Cn,data:{basePerm:v.b.agendaCanSeeListOfSpeakers}}];let Gn=(()=>{class t{}return t.\u0275mod=r.Rb({type:t}),t.\u0275inj=r.Qb({factory:function(e){return new(e||t)},imports:[[c.j.forChild(wn)],c.j]}),t})();var _n=n("PCNd");let In=(()=>{class t{}return t.\u0275mod=r.Rb({type:t}),t.\u0275inj=r.Qb({factory:function(e){return new(e||t)},imports:[[i.c,Gn,_n.a]]}),t})()},wL0i:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("mV3u");class c extends i.a{constructor(t,e,n,i){super(t,e,n),this.storage=i,this.canMultiSelect=!1,this._multiSelectMode=!1,this.singleButtonWidth="40px",this.badgeButtonWidth="45px",this.selectedRows=[]}onDataSourceChange(t){this.dataSource=t}toggleMultiSelect(){!this.canMultiSelect||this.isMultiSelect?(this._multiSelectMode=!1,this.deselectAll()):this._multiSelectMode=!0}selectAll(){this.dataSource.selection.select(...this.dataSource.filteredData)}deselectAll(){this.dataSource&&this.dataSource.selection.clear()}get isMultiSelect(){return this._multiSelectMode}}}}]);