(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{AP8A:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),o=n("xTJg"),c=n("Hila"),a=n("OwvW"),s=n("/iaR"),r=n("fXoL");let l=(()=>{class t{constructor(t,e,n){this.operator=t,this.DS=e,this.http=n,t.getUserObservable().subscribe(()=>this.updatePersonalNoteObject()),this.DS.getChangeObservable(s.a).subscribe(t=>{this.updatePersonalNoteObject()})}updatePersonalNoteObject(){if(this.operator.isAnonymous)return void(this.personalNoteObject=null);const t=this.operator.user.id,e=this.DS.filter(s.a,e=>e.user_id===t);this.personalNoteObject=0===e.length?null:e[0]}savePersonalNote(t,e){return Object(i.a)(this,void 0,void 0,(function*(){yield this.savePersonalNoteObject([{collection:t.collectionString,id:t.id,content:e}])}))}bulkSetStar(t,e){return Object(i.a)(this,void 0,void 0,(function*(){if(!t.length)return;const n=this.personalNoteObject||{};n.notes||(n.notes={});const i=t.map(t=>(n.notes[t.collectionString]||(n.notes[t.collectionString]={}),n.notes[t.collectionString][t.id]?n.notes[t.collectionString][t.id].star=e:n.notes[t.collectionString][t.id]={star:e,note:""},{collection:t.collectionString,id:t.id,content:n.notes[t.collectionString][t.id]}));yield this.savePersonalNoteObject(i)}))}savePersonalNoteObject(t){return Object(i.a)(this,void 0,void 0,(function*(){yield this.http.post("/rest/users/personal-note/create_or_update/",t)}))}}return t.\u0275fac=function(e){return new(e||t)(r.dc(a.a),r.dc(o.a),r.dc(c.a))},t.\u0275prov=r.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},Q5D0:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("D/ll"),o=n("OwvW"),c=n("AqIO"),a=n("iTQr"),s=n("D5Qf"),r=n("+B0n"),l=n("s3dr"),m=n("lv9T"),b=n("+8Rz"),d=n("+KbT"),h=n("gtli"),g=n("3Y4h"),u=n("fXoL"),p=n("sYmb");let f=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a,s,r,l){super(t,e),this.workflowRepo=a,this.translate=s,this.operator=r,this.config=l,this.storageKey="MotionList",this.enabledWorkflows={statuteEnabled:!1,statute:null,motion:null},this.stateFilterOptions={property:"state_id",label:"State",options:[]},this.categoryFilterOptions={property:"category_id",label:"Category",options:[]},this.motionBlockFilterOptions={property:"motion_block_id",label:"Motion block",options:[]},this.motionCommentFilterOptions={property:"commentSectionIds",label:"Comment",options:[]},this.recommendationFilterOptions={property:"recommendation_id",label:"Recommendation",options:[]},this.tagFilterOptions={property:"tags_id",label:"Tags",options:[]},this.hasSpeakerOptions={property:"hasSpeakers",label:"Speakers",options:[{condition:!0,label:this.translate.instant("Has speakers")},{condition:!1,label:this.translate.instant("Has no speakers")}]},this.AmendmentFilterOption={property:"amendmentType",label:"Amendment",options:[{condition:g.a.Amendment,label:this.translate.instant("Is amendment")},{condition:g.a.Parent,label:this.translate.instant("Has amendments")},{condition:g.a.Lead,label:this.translate.instant("Is no amendment and has no amendments")}]},this.personalNoteFilterOptions=[{property:"star",label:this.translate.instant("Favorites"),options:[{condition:!0,label:this.translate.instant("Is favorite")},{condition:!1,label:this.translate.instant("Is not favorite")}]},{property:"hasNotes",label:this.translate.instant("Personal notes"),options:[{condition:!0,label:this.translate.instant("Has notes")},{condition:!1,label:this.translate.instant("Does not have notes")}]}],this.getWorkflowConfig(),this.getShowAmendmentConfig(),this.updateFilterForRepo(n,this.categoryFilterOptions,this.translate.instant("No category set")),this.updateFilterForRepo(i,this.motionBlockFilterOptions,this.translate.instant("No motion block set")),this.updateFilterForRepo(o,this.motionCommentFilterOptions,this.translate.instant("No comment")),this.updateFilterForRepo(c,this.tagFilterOptions,this.translate.instant("No tags")),this.subscribeWorkflows(),this.operator.getUserObservable().subscribe(()=>{this.setFilterDefinitions()})}preFilter(t){if(!this.showAmendmentsInMainTable)return t.filter(t=>!t.parent_id)}getShowAmendmentConfig(){this.config.get("motions_amendments_main_table").subscribe(t=>{this.showAmendmentsInMainTable=t})}getWorkflowConfig(){this.config.get("motions_statute_amendments_workflow").subscribe(t=>{this.enabledWorkflows.statute=+t}),this.config.get("motions_workflow").subscribe(t=>{this.enabledWorkflows.motion=+t}),this.config.get("motions_statutes_enabled").subscribe(t=>{this.enabledWorkflows.statuteEnabled=t})}getFilterDefinitions(){let t=[this.stateFilterOptions,this.categoryFilterOptions,this.motionBlockFilterOptions,this.recommendationFilterOptions,this.motionCommentFilterOptions,this.tagFilterOptions];return this.operator.hasPerms(o.b.agendaCanSeeListOfSpeakers)&&t.push(this.hasSpeakerOptions),this.showAmendmentsInMainTable&&t.push(this.AmendmentFilterOption),this.operator.isAnonymous||(t=t.concat(this.personalNoteFilterOptions)),t}subscribeWorkflows(){this.workflowRepo.getViewModelListObservable().subscribe(t=>{if(t&&t.length){const e=[],n=[],i=[],o=[];for(const c of t)if(this.isWorkflowEnabled(c.id)){e.push({name:c.name,filter:[]}),n.push({name:c.name,filter:[]});for(const t of c.states){const c=t.restriction.filter(t=>t!==h.b.motionsIsSubmitter);c.length&&!this.operator.hasPerms(...c)||(t.isFinalState?i.push(t.id):o.push(t.id),e[e.length-1].filter.push({condition:t.id,label:t.name}),t.recommendation_label&&n[e.length-1].filter.push({condition:t.id,label:t.recommendation_label}))}}if(e&&e.length){let t=[];t.push({label:"Done",condition:i}),t.push({label:this.translate.instant("Undone"),condition:o}),t.push("-");for(const n of e)t.push(n.name),t=t.concat(n.filter);this.stateFilterOptions.options=t}if(n&&n.length){let t=[];for(const e of n)t.push(e.name),t=t.concat(e.filter);t.push("-"),t.push({label:this.translate.instant("No recommendation"),condition:null}),this.recommendationFilterOptions.options=t}this.setFilterDefinitions()}})}isWorkflowEnabled(t){return t===this.enabledWorkflows.motion||this.enabledWorkflows.statuteEnabled&&t===this.enabledWorkflows.statute}}return t.\u0275fac=function(e){return new(e||t)(u.dc(c.a),u.dc(i.a),u.dc(a.a),u.dc(s.a),u.dc(r.a),u.dc(m.a),u.dc(l.a),u.dc(p.k),u.dc(o.a),u.dc(d.a))},t.\u0275prov=u.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},QDTn:function(t,e,n){"use strict";n.r(e),n.d(e,"MotionDetailModule",(function(){return Ta}));var i=n("ofXK"),o=n("PCNd"),c=n("tyNb"),a=n("mrSG"),s=n("3Pt+"),r=n("dOok"),l=n("+KbT"),m=n("F48D"),b=n("mV3u"),d=n("VaoK"),h=n("fXoL"),g=n("jhN1"),u=n("sYmb"),p=n("dNgK"),f=n("mksl"),v=n("xHqg"),M=n("fB2i"),I=n("bTqV"),S=n("bSwM"),C=n("QibW"),T=n("7jBc");function G(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",15),h.hc("click",(function(){return h.Ic(t),h.lc(),h.Ec(10).next()})),h.Zb(2,"span",16),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc();h.Gb(1),h.tc("disabled",0===t.contentForm.value.selectedParagraphs.length),h.Gb(2),h.Tc(h.nc(4,2,"Next"))}}function _(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",17),h.hc("click",(function(){return h.Ic(t),h.lc(),h.Ec(10).previous()})),h.Zb(2,"span",16),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Yb(),h.Yb()}2&t&&(h.Gb(3),h.Tc(h.nc(4,1,"Previous")))}function Y(t,e){1&t&&(h.Sc(0),h.mc(1,"translate")),2&t&&h.Tc(h.nc(1,1,"Select paragraphs"))}function w(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-checkbox",22),h.hc("click",(function(e){return h.Ic(t),h.lc(2).checkboxClicked(e)})),h.Yb()}if(2&t){const t=h.lc().$implicit,e=h.lc();h.tc("checked",e.isParagraphSelected(t))}}function Z(t,e){if(1&t&&h.Ub(0,"mat-radio-button",23),2&t){const t=h.lc().$implicit,e=h.lc();h.tc("checked",e.isParagraphSelected(t))}}function x(t,e){if(1&t){const t=h.ac();h.Zb(0,"section",18),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc().onParagraphClicked(n)})),h.Qc(1,w,1,1,"mat-checkbox",19),h.Qc(2,Z,1,1,"mat-radio-button",20),h.Ub(3,"div",21),h.mc(4,"trust"),h.Yb()}if(2&t){const t=e.$implicit,n=e.index,i=h.lc();h.Kb("active",i.isParagraphSelected(t)),h.Gb(1),h.tc("ngIf",i.multipleParagraphsAllowed),h.Gb(1),h.tc("ngIf",!i.multipleParagraphsAllowed),h.Gb(1),h.tc("innerHTML",h.oc(4,5,i.getParagraphPreview(n),"html"),h.Jc)}}function O(t,e){1&t&&(h.Sc(0),h.mc(1,"translate")),2&t&&h.Tc(h.nc(1,1,"Change paragraph"))}function k(t,e){if(1&t&&(h.Zb(0,"span",26),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Vc(" ",h.nc(2,2,"Line")," ",t.lineFrom,":")}}function y(t,e){if(1&t&&(h.Zb(0,"span",26),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Wc(" ",h.nc(2,3,"Line")," ",t.lineFrom," - ",t.lineTo-1,":")}}function R(t,e){if(1&t&&(h.Zb(0,"section"),h.Zb(1,"h4"),h.Qc(2,k,3,4,"span",24),h.Qc(3,y,3,5,"span",24),h.Yb(),h.Ub(4,"editor",25),h.Yb()),2&t){const t=e.$implicit,n=h.lc();h.Gb(2),h.tc("ngIf",t.lineFrom>=t.lineTo-1),h.Gb(1),h.tc("ngIf",t.lineFrom<t.lineTo-1),h.Gb(1),h.tc("formControlName","text_"+t.paragraphNo)("init",n.tinyMceSettings)}}function F(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"*"),h.Yb())}function P(t,e){1&t&&(h.Zb(0,"div",27),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"This field is required.")," "))}let N=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a,s,r){super(t,e,r),this.translate=e,this.configService=n,this.formBuilder=i,this.repo=o,this.route=c,this.router=a,this.promptService=s,this.createForm()}ngOnInit(){this.configService.get("motions_line_length").subscribe(t=>{this.lineLength=t,this.getMotionByUrl()}),this.configService.get("motions_reason_required").subscribe(t=>{this.reasonRequired=t}),this.configService.get("motions_amendments_multiple_paragraphs").subscribe(t=>{this.multipleParagraphsAllowed=t})}getMotionByUrl(){this.route.params.subscribe(t=>{this.repo.getViewModelObservable(t.id).subscribe(t=>{t&&(this.paragraphs=this.repo.getParagraphsToChoose(t,this.lineLength),t.hasParent?(this.isAmendmentOfAmendment=!0,this.motion=t.parent,this.diffedParagraphs=this.repo.getDiffedParagraphToChoose(t,this.lineLength)):(this.isAmendmentOfAmendment=!1,this.motion=t))})})}getParagraphPreview(t){return this.isAmendmentOfAmendment?this.diffedParagraphs[t].html:this.paragraphs[t].html}cancelCreation(){return Object(a.a)(this,void 0,void 0,(function*(){if(this.contentForm.dirty||this.contentForm.value.selectedParagraphs.length>0){const t=this.translate.instant("Are you sure you want to discard this amendment?");(yield this.promptService.open(t))&&this.router.navigate([".."],{relativeTo:this.route})}else this.router.navigate([".."],{relativeTo:this.route})}))}createForm(){this.contentForm=this.formBuilder.group({selectedParagraphs:[[],s.G.required],reason:["",s.G.required]})}isParagraphSelected(t){return!!this.contentForm.value.selectedParagraphs.find(e=>e.paragraphNo===t.paragraphNo)}checkboxClicked(t){t.preventDefault()}setParagraph(t){this.contentForm.value.selectedParagraphs.forEach(t=>{this.contentForm.removeControl("text_"+t.paragraphNo)}),this.contentForm.addControl("text_"+t.paragraphNo,new s.g(t.html,s.G.required)),this.contentForm.patchValue({selectedParagraphs:[t]})}toggleParagraph(t){let e;const n=this.contentForm.value.selectedParagraphs;this.isParagraphSelected(t)?(e=n.filter(e=>e.paragraphNo!==t.paragraphNo),this.contentForm.patchValue({selectedParagraphs:e}),this.contentForm.removeControl("text_"+t.paragraphNo)):(e=Object.assign([],n),e.push(t),e.sort((t,e)=>t.paragraphNo<e.paragraphNo?-1:t.paragraphNo>e.paragraphNo?1:0),this.contentForm.addControl("text_"+t.paragraphNo,new s.g(t.html,s.G.required)),this.contentForm.patchValue({selectedParagraphs:e}))}onParagraphClicked(t){this.multipleParagraphsAllowed?this.toggleParagraph(t):this.setParagraph(t)}saveAmendment(){return Object(a.a)(this,void 0,void 0,(function*(){let t="";const e=this.paragraphs.map((e,n)=>this.contentForm.value.selectedParagraphs.find(t=>t.paragraphNo===n)?(t=this.contentForm.value["text_"+n],this.contentForm.value["text_"+n]):null),n=Object.assign(Object.assign({},this.contentForm.value),{title:this.translate.instant("Amendment to")+" "+this.motion.getIdentifierOrTitle(),text:t,parent_id:this.motion.id,category_id:this.motion.category_id,tags_id:this.motion.tags_id,motion_block_id:this.motion.motion_block_id,amendment_paragraphs:e}),i=new d.a;i.deserialize(n);const o=yield this.repo.create(i);this.router.navigate(["./motions/"+o.id])}))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(l.a),h.Tb(s.f),h.Tb(r.a),h.Tb(c.a),h.Tb(c.f),h.Tb(m.a),h.Tb(p.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-amendment-create-wizard"]],features:[h.Db],decls:30,vars:22,consts:[["saveText","Create",3,"nav","editMode","isSaveButtonEnabled","saveEvent","cancelEditEvent"],[1,"title-slot"],[1,"extra-controls-slot"],[4,"ngIf"],[3,"formGroup","ngSubmit"],["linear",""],["matStepper",""],[3,"completed"],["matStepLabel",""],[1,"amendment-create-wizard-wrapper"],["class","paragraph-row",3,"active","click",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[3,"ngClass"],["formControlName","reason","required","",3,"init"],["class","red-warning-text",4,"ngIf"],["mat-button","",3,"disabled","click"],[1,"upper"],["type","button","mat-button","",3,"click"],[1,"paragraph-row",3,"click"],["class","paragraph-select",3,"checked","click",4,"ngIf"],["class","paragraph-select",3,"checked",4,"ngIf"],[1,"paragraph-text","motion-text",3,"innerHTML"],[1,"paragraph-select",3,"checked","click"],[1,"paragraph-select",3,"checked"],["class","line-number",4,"ngIf"],[3,"formControlName","init"],[1,"line-number"],[1,"red-warning-text"]],template:function(t,e){if(1&t&&(h.Zb(0,"os-head-bar",0),h.hc("saveEvent",(function(){return e.saveAmendment()}))("cancelEditEvent",(function(){return e.cancelCreation()})),h.Zb(1,"div",1),h.Zb(2,"h2"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Yb(),h.Zb(5,"div",2),h.Qc(6,G,5,4,"div",3),h.Qc(7,_,5,3,"div",3),h.Yb(),h.Yb(),h.Zb(8,"form",4),h.hc("ngSubmit",(function(){return e.saveAmendment()})),h.Zb(9,"mat-horizontal-stepper",5,6),h.Zb(11,"mat-step",7),h.Qc(12,Y,2,3,"ng-template",8),h.Zb(13,"div",9),h.Qc(14,x,5,8,"section",10),h.Yb(),h.Yb(),h.Zb(15,"mat-step"),h.Qc(16,O,2,3,"ng-template",8),h.Zb(17,"h3"),h.Zb(18,"span"),h.Sc(19),h.mc(20,"translate"),h.Yb(),h.Yb(),h.Qc(21,R,5,4,"section",11),h.Zb(22,"h3",12),h.Zb(23,"span"),h.Sc(24),h.mc(25,"translate"),h.Yb(),h.Sc(26,"\xa0"),h.Qc(27,F,2,0,"span",3),h.Yb(),h.Ub(28,"editor",13),h.Qc(29,P,3,3,"div",14),h.Yb(),h.Yb(),h.Yb()),2&t){const t=h.Ec(10);h.tc("nav",!1)("editMode",!0)("isSaveButtonEnabled",1===t.selectedIndex),h.Gb(3),h.Tc(h.nc(4,16,"New amendment")),h.Gb(3),h.tc("ngIf",0===t.selectedIndex),h.Gb(1),h.tc("ngIf",1===t.selectedIndex),h.Gb(1),h.tc("formGroup",e.contentForm),h.Gb(3),h.tc("completed",e.contentForm.value.selectedParagraphs.length>0),h.Gb(3),h.tc("ngForOf",e.paragraphs),h.Gb(5),h.Tc(h.nc(20,18,"Amendment text")),h.Gb(2),h.tc("ngForOf",e.contentForm.value.selectedParagraphs),h.Gb(1),h.tc("ngClass",e.reasonRequired&&e.contentForm.get("reason").invalid&&(e.contentForm.get("reason").dirty||e.contentForm.get("reason").touched)?"red-warning-text":""),h.Gb(2),h.Tc(h.nc(25,20,"Reason")),h.Gb(3),h.tc("ngIf",e.reasonRequired),h.Gb(1),h.tc("init",e.tinyMceSettings),h.Gb(1),h.tc("ngIf",e.reasonRequired&&e.contentForm.get("reason").invalid&&(e.contentForm.get("reason").dirty||e.contentForm.get("reason").touched))}},directives:[f.a,i.t,s.I,s.t,s.k,v.a,v.b,v.d,i.s,i.q,M.a,s.s,s.i,s.D,I.b,S.a,C.a],pipes:[u.j,T.a],styles:[".amendment-create-wizard-wrapper .paragraph-row{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;cursor:pointer;padding:20px 0}.amendment-create-wizard-wrapper .paragraph-row.active{cursor:default}.amendment-create-wizard-wrapper .paragraph-row .paragraph-select{-ms-flex-preferred-size:50px;flex-basis:50px;-ms-flex-positive:0;flex-grow:0;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}.amendment-create-wizard-wrapper .paragraph-row .paragraph-text{-ms-flex:1;flex:1}.amendment-create-wizard-wrapper .motion-text{padding-left:40px;position:relative}.amendment-create-wizard-wrapper .motion-text blockquote,.amendment-create-wizard-wrapper .motion-text li,.amendment-create-wizard-wrapper .motion-text ol,.amendment-create-wizard-wrapper .motion-text p,.amendment-create-wizard-wrapper .motion-text ul{margin-top:0;margin-bottom:0}.amendment-create-wizard-wrapper .motion-text li{padding-bottom:10px}.amendment-create-wizard-wrapper .motion-text ol,.amendment-create-wizard-wrapper .motion-text ul{margin-left:15px;margin-bottom:0}.amendment-create-wizard-wrapper .motion-text .os-line-number{display:inline-block;font-size:0;line-height:0;width:22px;height:22px;position:absolute;left:0;padding-right:55px}.amendment-create-wizard-wrapper .motion-text .os-line-number:after{content:attr(data-line-number);position:absolute;top:13px;vertical-align:top;color:grey;font-size:12px;font-weight:400}"],encapsulation:2}),t})();var L=n("iDj2"),E=n("OwvW"),Q=n("InfO"),A=n("iTQr"),U=n("pSLD"),j=n("D5Qf"),V=n("Mluu"),D=n("s3dr"),B=n("lv9T"),$=n("ZDbo"),q=n("a9XT"),z=n("AP8A"),W=n("KL36"),H=n("iu6c"),X=n("Izkr"),K=n("jcOe");class J extends K.a{constructor(t){super(t),this.getVerboseName=()=>{throw new Error("This should not be used")}}get motion(){return this._model}get submittersAsUsers(){return this._submitterUsers}set submittersAsUsers(t){this._submitterUsers=t,this._model.submitters_id=t.map(t=>t.id)}}var tt=n("2ErA"),et=n("3Y4h"),nt=n("VVsa"),it=n("AOla"),ot=n("f3I0"),ct=n("Q5D0"),at=n("y50V"),st=n("SHqy"),rt=n("ykax"),lt=n("T9hM"),mt=n("0IaG"),bt=n("4X/P");function dt(t,e){if(1&t&&(h.Zb(0,"mat-radio-button",12),h.Sc(1),h.Yb()),2&t){const t=e.$implicit;h.tc("value",t.value),h.Gb(1),h.Tc(t.title)}}function ht(t,e){if(1&t&&(h.Zb(0,"h4"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Sc(4),h.Yb()),2&t){const t=h.lc();h.Gb(2),h.Tc(h.nc(3,2,"Changed version in line")),h.Gb(2),h.Uc(" ",t.lineRange.from,": ")}}function gt(t,e){if(1&t&&(h.Zb(0,"h4"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Sc(4),h.Zb(5,"span"),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Sc(8),h.Yb()),2&t){const t=h.lc();h.Gb(2),h.Tc(h.nc(3,4,"Changed version in line")),h.Gb(2),h.Uc(" ",t.lineRange.from," "),h.Gb(2),h.Tc(h.nc(7,6,"to")),h.Gb(2),h.Uc(" ",t.lineRange.to-1,": ")}}let ut=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a){super(e,n,i),this.data=t,this.translate=n,this.formBuilder=o,this.repo=c,this.dialogRef=a,this.editReco=!1,this.newReco=!1,this.replacementTypes=[{value:bt.b.TYPE_REPLACEMENT,title:this.translate.instant("Replacement")},{value:bt.b.TYPE_INSERTION,title:this.translate.instant("Insertion")},{value:bt.b.TYPE_DELETION,title:this.translate.instant("Deletion")}],this.editReco=t.editChangeRecommendation,this.newReco=t.newChangeRecommendation,this.changeReco=t.changeRecommendation,this.lineRange=t.lineRange,this.tinyMceSettings.toolbar="undo redo | bold italic underline strikethrough\n            | removeformat | bullist numlist | outdent indent | link charmap code",this.createForm()}createForm(){this.contentForm=this.formBuilder.group({text:[this.changeReco.text,s.G.required],diffType:[this.changeReco.type,s.G.required],public:[!this.changeReco.internal]})}saveChangeRecommendation(){return Object(a.a)(this,void 0,void 0,(function*(){this.changeReco.updateChangeReco(this.contentForm.controls.diffType.value,this.contentForm.controls.text.value,!this.contentForm.controls.public.value);try{this.newReco?(yield this.repo.createByViewModel(this.changeReco),this.dialogRef.close()):(yield this.repo.update(this.changeReco.changeRecommendation,this.changeReco),this.dialogRef.close())}catch(t){this.raiseError(t)}}))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(mt.a),h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(s.f),h.Tb(U.a),h.Tb(mt.h))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-change-recommendation"]],features:[h.Db],decls:24,vars:17,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"motion-content",3,"formGroup","ngSubmit"],["formControlName","diffType"],["rGroup",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","text",3,"init"],["formControlName","public"],["mat-dialog-actions",""],["mat-button","",3,"click"],["mat-button","","mat-dialog-close",""],[3,"value"]],template:function(t,e){1&t&&(h.Zb(0,"h1",0),h.Sc(1),h.mc(2,"translate"),h.Yb(),h.Zb(3,"div",1),h.Zb(4,"form",2),h.hc("ngSubmit",(function(){return e.saveChangeRecommendation()})),h.Zb(5,"mat-radio-group",3,4),h.Qc(7,dt,2,2,"mat-radio-button",5),h.Yb(),h.Qc(8,ht,5,4,"h4",6),h.Qc(9,gt,9,8,"h4",6),h.Zb(10,"div"),h.Ub(11,"editor",7),h.Yb(),h.Zb(12,"mat-checkbox",8),h.Sc(13),h.mc(14,"translate"),h.Yb(),h.Yb(),h.Yb(),h.Zb(15,"div",9),h.Zb(16,"button",10),h.hc("click",(function(){return e.saveChangeRecommendation()})),h.Zb(17,"span"),h.Sc(18),h.mc(19,"translate"),h.Yb(),h.Yb(),h.Zb(20,"button",11),h.Zb(21,"span"),h.Sc(22),h.mc(23,"translate"),h.Yb(),h.Yb(),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,9,"New change recommendation")),h.Gb(3),h.tc("formGroup",e.contentForm),h.Gb(3),h.tc("ngForOf",e.replacementTypes),h.Gb(1),h.tc("ngIf",e.lineRange.to==e.lineRange.from+1),h.Gb(1),h.tc("ngIf",e.lineRange.to!=e.lineRange.from+1),h.Gb(2),h.tc("init",e.tinyMceSettings),h.Gb(2),h.Tc(h.nc(14,11,"Public")),h.Gb(5),h.Tc(h.nc(19,13,"Save")),h.Gb(4),h.Tc(h.nc(23,15,"Cancel")))},directives:[mt.i,mt.f,s.I,s.t,s.k,C.b,s.s,s.i,i.s,i.t,M.a,S.a,mt.c,I.b,mt.d,C.a],pipes:[u.j],styles:[""]}),t})();var pt=n("kmnG"),ft=n("qFsG");let vt=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a){super(e,n,i),this.data=t,this.translate=n,this.formBuilder=o,this.repo=c,this.dialogRef=a,this.editReco=!1,this.newReco=!1,this.editReco=t.editChangeRecommendation,this.newReco=t.newChangeRecommendation,this.changeReco=t.changeRecommendation,this.createForm()}createForm(){this.contentForm=this.formBuilder.group({title:[this.changeReco.text,s.G.required],public:[!this.changeReco.internal]})}saveChangeRecommendation(){return Object(a.a)(this,void 0,void 0,(function*(){this.changeReco.updateChangeReco(bt.b.TYPE_REPLACEMENT,this.contentForm.controls.title.value,!this.contentForm.controls.public.value);try{this.newReco?(yield this.repo.createByViewModel(this.changeReco),this.dialogRef.close()):(yield this.repo.update(this.changeReco.changeRecommendation,this.changeReco),this.dialogRef.close())}catch(t){this.raiseError(t)}}))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(mt.a),h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(s.f),h.Tb(U.a),h.Tb(mt.h))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-title-motion-change-recommendation-dialog"]],features:[h.Db],decls:20,vars:16,consts:[["mat-dialog-title",""],[1,"motion-content",3,"formGroup","ngSubmit"],["matInput","","formControlName","title",3,"placeholder"],["formControlName","public"],["mat-button","",3,"click"],["mat-button","","mat-dialog-close",""]],template:function(t,e){1&t&&(h.Zb(0,"h1",0),h.Sc(1),h.mc(2,"translate"),h.Yb(),h.Zb(3,"mat-dialog-content"),h.Zb(4,"form",1),h.hc("ngSubmit",(function(){return e.saveChangeRecommendation()})),h.Zb(5,"mat-form-field"),h.Ub(6,"input",2),h.mc(7,"translate"),h.Yb(),h.Zb(8,"mat-checkbox",3),h.Sc(9),h.mc(10,"translate"),h.Yb(),h.Yb(),h.Yb(),h.Zb(11,"mat-dialog-actions"),h.Zb(12,"button",4),h.hc("click",(function(){return e.saveChangeRecommendation()})),h.Zb(13,"span"),h.Sc(14),h.mc(15,"translate"),h.Yb(),h.Yb(),h.Zb(16,"button",5),h.Zb(17,"span"),h.Sc(18),h.mc(19,"translate"),h.Yb(),h.Yb(),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,6,"New change recommendation")),h.Gb(3),h.tc("formGroup",e.contentForm),h.Gb(2),h.uc("placeholder",h.nc(7,8,"Changed title")),h.Gb(3),h.Tc(h.nc(10,10,"Public")),h.Gb(5),h.Tc(h.nc(15,12,"Save")),h.Gb(4),h.Tc(h.nc(19,14,"Cancel")))},directives:[mt.i,mt.f,s.I,s.t,s.k,pt.c,ft.b,s.c,s.s,s.i,S.a,mt.c,I.b,mt.d],pipes:[u.j],styles:[".motion-content .mat-form-field{width:100%}.mat-dialog-content{overflow:hidden}"],encapsulation:2}),t})();var Mt=n("STbY"),It=n("NFeN"),St=n("vYAO"),Ct=n("40uZ"),Tt=n("3Xi6"),Gt=n("f0Cb"),_t=n("Tp2j"),Yt=n("Qu3c"),wt=n("Wp6s"),Zt=n("+B0n"),xt=n("5N+Y");function Ot(t,e){if(1&t&&(h.Ub(0,"div",13),h.mc(1,"trust")),2&t){const t=h.lc(3).$implicit,e=h.lc();h.tc("innerHTML",h.oc(1,1,e.comments[t.id].comment,"html"),h.Jc)}}function kt(t,e){1&t&&(h.Zb(0,"div",14),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"No comment")," "))}function yt(t,e){if(1&t&&(h.Xb(0),h.Qc(1,Ot,2,4,"div",11),h.Qc(2,kt,3,3,"div",12),h.Wb()),2&t){const t=h.lc(2).$implicit,e=h.lc();h.Gb(1),h.tc("ngIf",e.comments[t.id]),h.Gb(1),h.tc("ngIf",!e.comments[t.id]||!e.comments[t.id].comment)}}function Rt(t,e){if(1&t){const t=h.ac();h.Zb(0,"form",15),h.Zb(1,"editor",16),h.hc("onInit",(function(e){return h.Ic(t),h.lc(3).onInitTinyMce(e)}))("onRemove",(function(e){return h.Ic(t),h.lc(3).onLeaveTinyMce(e)})),h.Yb(),h.Yb()}if(2&t){const t=h.lc(2).$implicit,e=h.lc();h.tc("formGroup",e.commentForms[t.id]),h.Gb(1),h.tc("id",t.id)("init",e.tinyMceSettings)}}function Ft(t,e){1&t&&(h.Zb(0,"div"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Ub(4,"br"),h.Zb(5,"span",17),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,2,"Touch the book icon to enter text")),h.Gb(4),h.Tc(h.nc(7,4,"Do not forget to save your changes!")))}function Pt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",18),h.hc("click",(function(){h.Ic(t);const e=h.lc(2).$implicit;return h.lc().editComment(e)})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"edit"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Edit"))}function Nt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",18),h.hc("click",(function(){h.Ic(t);const e=h.lc(2).$implicit;return h.lc().pdfExportSection(e)})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"picture_as_pdf"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Export comment"))}function Lt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",19),h.hc("click",(function(){h.Ic(t);const e=h.lc(2).$implicit;return h.lc().saveComment(e)})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"save"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Save"))}function Et(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",18),h.hc("click",(function(){h.Ic(t);const e=h.lc(2).$implicit;return h.lc().cancelEditing(e)})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"close"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Cancel edit"))}function Qt(t,e){if(1&t&&(h.Zb(0,"os-meta-text-block",3),h.Xb(1,4),h.Zb(2,"span"),h.Sc(3),h.Yb(),h.Wb(),h.Xb(4,5),h.Qc(5,yt,3,2,"ng-container",6),h.Qc(6,Rt,2,3,"form",7),h.Qc(7,Ft,8,6,"div",6),h.Wb(),h.Xb(8,8),h.Qc(9,Pt,4,3,"button",9),h.Qc(10,Nt,4,3,"button",9),h.Qc(11,Lt,4,3,"button",10),h.Qc(12,Et,4,3,"button",9),h.Wb(),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc();h.tc("showActionRow",e.canEditSection(t)||e.comments[t.id].comment)("disableExpandControl",e.isCommentEdited(t)),h.Gb(3),h.Tc(t.getTitle()),h.Gb(2),h.tc("ngIf",!e.isCommentEdited(t)),h.Gb(1),h.tc("ngIf",e.isCommentEdited(t)),h.Gb(1),h.tc("ngIf",e.saveHint),h.Gb(2),h.tc("ngIf",!e.isCommentEdited(t)&&e.canEditSection(t)),h.Gb(1),h.tc("ngIf",!e.commentForms[t.id]&&(null==e.comments[t.id]?null:e.comments[t.id].comment)),h.Gb(1),h.tc("ngIf",e.isCommentEdited(t)),h.Gb(1),h.tc("ngIf",e.isCommentEdited(t))}}function At(t,e){if(1&t&&(h.Zb(0,"div",1),h.Qc(1,Qt,13,10,"os-meta-text-block",2),h.Yb()),2&t){const t=e.$implicit,n=h.lc();h.Gb(1),h.tc("ngIf",n.sectionVisible(t))}}let Ut=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a){super(o,c,a),this.commentRepo=t,this.formBuilder=e,this.operator=n,this.pdfService=i,this.sections=[],this.commentForms={},this.comments={},this.error=!1}set motion(t){this._motion=t,this.updateComments()}get motion(){return this._motion}ngOnInit(){this.subscriptions.push(this.commentRepo.getViewModelListObservable().subscribe(t=>{t&&t.length&&(this.sections=t,this.filterSections())}))}filterSections(){this.sections&&this.sections.length&&(this.sections=this.sections.filter(t=>this.operator.isInGroupIds(...t.read_groups_id)),this.updateComments())}canEditSection(t){return this.operator.isInGroupIds(...t.write_groups_id)}updateComments(){this.comments={},this.motion&&this.sections&&this.sections.forEach(t=>{this.comments[t.id]=this.motion.getCommentForSection(t)})}editComment(t){const e=this.comments[t.id],n=this.formBuilder.group({comment:[e?e.comment:""]});this.commentForms[t.id]=n}saveComment(t){const e=this.commentForms[t.id].get("comment").value;this.commentRepo.saveComment(this.motion,t,e).then(()=>{this.cancelEditing(t)},e=>{this.error=!0,this.raiseError(`${e} :"${t.name}"`)})}cancelEditing(t){delete this.commentForms[t.id]}sectionVisible(t){return!!(this.canEditSection(t)||this.comments[t.id]&&this.comments[t.id].comment)}isCommentEdited(t){return Object.keys(this.commentForms).includes(""+t.id)}pdfExportSection(t){this.pdfService.exportComment(t,this.motion)}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(Zt.a),h.Tb(s.f),h.Tb(E.a),h.Tb(at.a),h.Tb(g.d),h.Tb(u.k),h.Tb(p.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-comments"]],inputs:{motion:"motion"},features:[h.Db],decls:1,vars:1,consts:[["class","text-warning",4,"ngFor","ngForOf"],[1,"text-warning"],["icon","comment",3,"showActionRow","disableExpandControl",4,"ngIf"],["icon","comment",3,"showActionRow","disableExpandControl"],[1,"meta-text-block-title"],[1,"meta-text-block-content"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],[1,"meta-text-block-action-row"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","click",4,"ngIf"],[3,"innerHTML",4,"ngIf"],["class","no-content",4,"ngIf"],[3,"innerHTML"],[1,"no-content"],[3,"formGroup"],["formControlName","comment",3,"id","init","onInit","onRemove"],[1,"red-warning-text"],["mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"]],template:function(t,e){1&t&&h.Qc(0,At,2,1,"div",0),2&t&&h.tc("ngForOf",e.sections)},directives:[i.s,i.t,xt.a,s.I,s.t,s.k,M.a,s.s,s.i,I.b,Yt.c,It.a],pipes:[T.a,u.j],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();function jt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",8),h.hc("click",(function(){return h.Ic(t),h.lc().editPersonalNote()})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"edit"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Edit"))}function Vt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",8),h.hc("click",(function(){return h.Ic(t),h.lc().printPersonalNote()})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"picture_as_pdf"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Export personal note only"))}function Dt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",9),h.hc("click",(function(){return h.Ic(t),h.lc().savePersonalNote()})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"save"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Save"))}function Bt(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",8),h.hc("click",(function(){return h.Ic(t),h.lc().isEditMode=!1})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"close"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Cancel edit"))}function $t(t,e){if(1&t&&(h.Ub(0,"div",12),h.mc(1,"trust")),2&t){const t=h.lc(2);h.tc("innerHTML",h.oc(1,1,t.personalNoteText,"html"),h.Jc)}}function qt(t,e){1&t&&(h.Zb(0,"div",13),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"No personal note")," "))}function zt(t,e){if(1&t&&(h.Xb(0),h.Qc(1,$t,2,4,"div",10),h.Qc(2,qt,3,3,"div",11),h.Wb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.motion&&t.motion.personalNote),h.Gb(1),h.tc("ngIf",!t.motion||!t.motion.hasNotes)}}function Wt(t,e){if(1&t){const t=h.ac();h.Zb(0,"form",14),h.Zb(1,"editor",15),h.hc("onInit",(function(e){return h.Ic(t),h.lc().onInitTinyMce(e)}))("onRemove",(function(e){return h.Ic(t),h.lc().onLeaveTinyMce(e)})),h.Yb(),h.Yb()}if(2&t){const t=h.lc();h.tc("formGroup",t.personalNoteForm),h.Gb(1),h.tc("init",t.tinyMceSettings)}}function Ht(t,e){1&t&&(h.Zb(0,"div"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Ub(4,"br"),h.Zb(5,"span",16),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,2,"Touch the book icon to enter text")),h.Gb(4),h.Tc(h.nc(7,4,"Do not forget to save your changes!")))}let Xt=(()=>{class t extends b.a{constructor(t,e,n,i,o,c){super(t,e,n),this.personalNoteService=i,this.pdfService=c,this.isEditMode=!1,this.personalNoteForm=o.group({note:[""]})}get personalNoteText(){return this.motion.personalNoteText}editPersonalNote(){this.personalNoteForm.reset(),this.personalNoteForm.patchValue({note:this.motion.personalNote?this.motion.personalNote.note:""}),this.isEditMode=!0}savePersonalNote(){return Object(a.a)(this,void 0,void 0,(function*(){let t;this.motion.personalNote?(t=Object.assign({},this.motion.personalNote),t.note=this.personalNoteForm.get("note").value):t={note:this.personalNoteForm.get("note").value,star:!1};try{yield this.personalNoteService.savePersonalNote(this.motion.motion,t),this.isEditMode=!1}catch(e){this.raiseError(e)}}))}printPersonalNote(){this.pdfService.exportPersonalNote(this.motion.personalNote,this.motion)}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(z.a),h.Tb(s.f),h.Tb(at.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-personal-note"]],inputs:{motion:"motion"},features:[h.Db],decls:14,vars:11,consts:[["showActionRow","true","icon","speaker_notes",3,"disableExpandControl"],[1,"meta-text-block-title"],[1,"meta-text-block-action-row"],["mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["mat-icon-button","","color","warn",3,"matTooltip","click",4,"ngIf"],[1,"meta-text-block-content"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],["mat-icon-button","",3,"matTooltip","click"],["mat-icon-button","","color","warn",3,"matTooltip","click"],[3,"innerHTML",4,"ngIf"],["class","no-content",4,"ngIf"],[3,"innerHTML"],[1,"no-content"],[3,"formGroup"],["formControlName","note",3,"init","onInit","onRemove"],[1,"red-warning-text"]],template:function(t,e){1&t&&(h.Zb(0,"os-meta-text-block",0),h.Xb(1,1),h.Zb(2,"span"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Wb(),h.Xb(5,2),h.Qc(6,jt,4,3,"button",3),h.Qc(7,Vt,4,3,"button",3),h.Qc(8,Dt,4,3,"button",4),h.Qc(9,Bt,4,3,"button",3),h.Wb(),h.Xb(10,5),h.Qc(11,zt,3,2,"ng-container",6),h.Qc(12,Wt,2,2,"form",7),h.Qc(13,Ht,8,6,"div",6),h.Wb(),h.Yb()),2&t&&(h.tc("disableExpandControl",!0),h.Gb(3),h.Tc(h.nc(4,9,"Personal note")),h.Gb(3),h.tc("ngIf",!e.isEditMode),h.Gb(1),h.tc("ngIf",!e.isEditMode&&e.motion&&e.motion.personalNote&&e.motion.personalNote.note),h.Gb(1),h.tc("ngIf",e.isEditMode),h.Gb(1),h.tc("ngIf",e.isEditMode),h.Gb(2),h.tc("ngIf",!e.isEditMode),h.Gb(1),h.tc("ngIf",e.isEditMode),h.Gb(1),h.tc("ngIf",e.saveHint))},directives:[xt.a,i.t,I.b,Yt.c,It.a,s.I,s.t,s.k,M.a,s.s,s.i],pipes:[u.j,T.a],styles:["mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),t})();var Kt=n("2Vo4"),Jt=n("oJo9"),te=n("8adq"),ee=n("A5z7"),ne=n("IBZR"),ie=n("oqD5");function oe(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",3),h.hc("click",(function(){return h.Ic(t),h.lc().onEdit()})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Yb()}}function ce(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",7),h.Sc(1),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Tc(t.getTitle())}}function ae(t,e){if(1&t&&(h.Zb(0,"mat-chip-list",5),h.Qc(1,ce,2,1,"mat-basic-chip",6),h.Yb()),2&t){const t=e.$implicit;h.Gb(1),h.tc("ngIf",t)}}function se(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ae,2,1,"mat-chip-list",4),h.Yb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngForOf",t.motion.submittersAsUsers)}}function re(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",11),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(2).onRemove(n)})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"close"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Remove"))}function le(t,e){if(1&t&&(h.Zb(0,"form",12),h.Zb(1,"mat-form-field"),h.Ub(2,"os-search-value-selector",13),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.tc("formGroup",t.addSubmitterForm),h.Gb(2),h.uc("placeholder",h.nc(3,3,"Select or search new submitter ...")),h.tc("inputListValues",t.users)}}function me(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"os-sorting-list",8),h.hc("sortEvent",(function(e){return h.Ic(t),h.lc().onSortingChange(e)})),h.Qc(2,re,4,3,"ng-template"),h.Yb(),h.Qc(3,le,4,5,"form",9),h.Zb(4,"p"),h.Zb(5,"button",10),h.hc("click",(function(){return h.Ic(t),h.lc().onSave()})),h.Zb(6,"span"),h.Sc(7),h.mc(8,"translate"),h.Yb(),h.Yb(),h.Zb(9,"button",10),h.hc("click",(function(){return h.Ic(t),h.lc().onCancel()})),h.Zb(10,"span"),h.Sc(11),h.mc(12,"translate"),h.Yb(),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc();h.Gb(1),h.tc("input",t.editSubmitterObservable)("live",!0)("count",!1),h.Gb(2),h.tc("ngIf",t.users&&t.users.value.length>0),h.Gb(4),h.Tc(h.nc(8,6,"Save")),h.Gb(4),h.Tc(h.nc(12,8,"Cancel"))}}let be=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a){super(t,e,n),this.viewModelStore=i,this.motionRepository=o,this.userRepository=c,this.perms=a,this.editSubmitterSubject=new Kt.a([]),this.isEditMode=!1,this.addSubmitterForm=new s.j({userId:new s.g([])}),this.editSubmitterObservable=this.editSubmitterSubject.asObservable(),this.addSubmitterForm.valueChanges.subscribe(t=>{t&&t.userId&&this.addNewSubmitter(t.userId)})}onEdit(){this.isEditMode=!0,this.editSubmitterSubject.next(this.motion.submittersAsUsers),this.addSubmitterForm.reset(),this.users=this.userRepository.getViewModelListBehaviorSubject()}onSave(){this.motionRepository.setSubmitters(this.motion,this.editSubmitterSubject.getValue()).then(()=>this.isEditMode=!1,this.raiseError)}onCancel(){this.isEditMode=!1}addNewSubmitter(t){const e=this.editSubmitterSubject.getValue();e.map(t=>t.id).includes(t)||(e.push(this.viewModelStore.get(te.a,t)),this.editSubmitterSubject.next(e)),this.addSubmitterForm.reset()}onSortingChange(t){this.editSubmitterSubject.next(t)}onRemove(t){const e=this.editSubmitterSubject.getValue();this.editSubmitterSubject.next(e.filter(e=>e.id!==t.id))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(Jt.a),h.Tb(r.a),h.Tb($.a),h.Tb(ot.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-manage-submitters"]],inputs:{motion:"motion"},features:[h.Db],decls:7,vars:6,consts:[[1,"title-font"],["class","small-button","type","button","mat-icon-button","","disableRipple","",3,"click",4,"ngIf"],[4,"ngIf"],["type","button","mat-icon-button","","disableRipple","",1,"small-button",3,"click"],["class","user",4,"ngFor","ngForOf"],[1,"user"],["disableRipple","",4,"ngIf"],["disableRipple",""],[3,"input","live","count","sortEvent"],[3,"formGroup",4,"ngIf"],["type","button","mat-button","",3,"click"],["type","button","mat-icon-button","",3,"matTooltip","click"],[3,"formGroup"],["formControlName","userId",1,"search-users",3,"placeholder","inputListValues"]],template:function(t,e){1&t&&(h.Zb(0,"h4"),h.Zb(1,"span",0),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Qc(4,oe,3,0,"button",1),h.Yb(),h.Qc(5,se,2,1,"div",2),h.Qc(6,me,13,10,"div",2)),2&t&&(h.Gb(2),h.Tc(h.nc(3,4,"Submitters")),h.Gb(2),h.tc("ngIf",!e.isEditMode&&e.perms.isAllowed("change_metadata")),h.Gb(1),h.tc("ngIf",!e.isEditMode||!e.perms.isAllowed("change_metadata")),h.Gb(1),h.tc("ngIf",e.isEditMode&&e.perms.isAllowed("change_metadata")))},directives:[i.t,I.b,It.a,i.s,ee.d,ee.a,ne.a,Yt.c,s.I,s.t,s.k,pt.c,ie.a,s.s,s.i],pipes:[u.j],styles:[".search-users[_ngcontent-%COMP%]{display:grid}.search-users[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:100%}h4[_ngcontent-%COMP%]{margin:0}.small-button[_ngcontent-%COMP%]{width:20px;height:20px;line-height:inherit}.small-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:100%}.user[_ngcontent-%COMP%]   .mat-chip[_ngcontent-%COMP%]{border-radius:16px!important;padding:5px 15px!important;margin:5px 0;border:1px solid #ddd;height:auto}"]}),t})();var de=n("+KR1"),he=n("acQf"),ge=n("owL4"),ue=n("EHvM"),pe=n("a9GI");let fe=(()=>{class t extends ue.a{constructor(t,e,n,i,o){super(n,i),this.translate=t,this.motionRepo=e,this.pdfService=o,this.configService.get("motions_pdf_ballot_papers_number").subscribe(t=>this.ballotCustomCount=t),this.configService.get("motions_pdf_ballot_papers_selection").subscribe(t=>this.ballotCountSelection=t)}printBallots(t,e,n){const i=this.motionRepo.getViewModel(t.motion_id),o=`${this.translate.instant("Motion")} - ${i.identifier} - ${this.translate.instant("ballot-paper")}`;e||(e=`${this.translate.instant("Motion")} - ${i.identifier}`,i.polls.length>1&&(e+=` (${this.translate.instant("Vote")} ${i.polls.length})`)),n||(n=i.title),n.length>90&&(n=n.substring(0,90)+"..."),this.pdfService.downloadWithBallotPaper(this.getPages(4,{sheetend:40,title:e,subtitle:n}),o,this.logo)}createBallot(t){return{stack:[this.getHeader(),this.getTitle(t.title),this.getSubtitle(t.subtitle),this.createBallotOption(this.translate.instant("Yes")),this.createBallotOption(this.translate.instant("No")),this.createBallotOption(this.translate.instant("Abstain"))],margin:[0,0,0,t.sheetend]}}}return t.\u0275fac=function(e){return new(e||t)(h.dc(u.k),h.dc(r.a),h.dc(l.a),h.dc($.a),h.dc(pe.b))},t.\u0275prov=h.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var ve=n("c3p6"),Me=n("M0z7"),Ie=n("Xqcw"),Se=n("pA48"),Ce=n("Xa2L");function Te(t,e){if(1&t&&(h.Zb(0,"div"),h.Ub(1,"os-poll-progress",3),h.Yb()),2&t){const t=h.lc();h.Gb(1),h.tc("poll",t.poll)}}function Ge(t,e){if(1&t){const t=h.ac();h.Zb(0,"div",8),h.Zb(1,"button",9),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(3).saveVote(n.vote)})),h.Zb(2,"mat-icon"),h.Sc(3),h.Yb(),h.Yb(),h.Zb(4,"span",10),h.Sc(5),h.mc(6,"translate"),h.Yb(),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(3);h.Gb(1),h.tc("ngClass",n.currentVote&&n.currentVote.vote===t.vote?t.css:"")("disabled",n.deliveringVote),h.Gb(2),h.Uc(" ",t.icon,""),h.Gb(2),h.Uc(" ",h.nc(6,4,t.label)," ")}}function _e(t,e){if(1&t&&(h.Zb(0,"div",6),h.Qc(1,Ge,7,6,"div",7),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngForOf",t.voteOptions)}}function Ye(t,e){1&t&&(h.Zb(0,"div",11),h.Ub(1,"mat-spinner",12),h.Ub(2,"br"),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Delivering vote... Please wait!")))}function we(t,e){if(1&t&&(h.Xb(0),h.Qc(1,_e,2,1,"div",4),h.Qc(2,Ye,6,3,"div",5),h.Wb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.vmanager.canVote(t.poll)&&!t.deliveringVote),h.Gb(1),h.tc("ngIf",t.deliveringVote)}}function Ze(t,e){1&t&&(h.Zb(0,"div",13),h.Zb(1,"div"),h.Zb(2,"mat-icon",14),h.Sc(3," check_circle "),h.Yb(),h.Ub(4,"br"),h.Zb(5,"span"),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Yb(),h.Yb()),2&t&&(h.Gb(6),h.Tc(h.nc(7,1,"Voting successful.")))}let xe=(()=>{class t extends Ie.a{constructor(t,e,n,i,o,c,a,s){super(t,e,n,i),this.vmanager=o,this.pollRepo=c,this.promptService=a,this.cd=s,this.currentVote={},this.voteOptions=[{vote:"Y",css:"voted-yes",icon:"thumb_up",label:"Yes"},{vote:"N",css:"voted-no",icon:"thumb_down",label:"No"},{vote:"A",css:"voted-abstain",icon:"trip_origin",label:"Abstain"}]}saveVote(t){return Object(a.a)(this,void 0,void 0,(function*(){this.currentVote.vote=t;const e=this.translate.instant("Submit selection now?"),n=this.translate.instant("Your decision cannot be changed afterwards.");(yield this.promptService.open(e,n))&&(this.deliveringVote=!0,this.cd.markForCheck(),this.pollRepo.vote(t,this.poll.id).catch(this.raiseError).finally(()=>{this.deliveringVote=!1}))}))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(E.a),h.Tb(Me.b),h.Tb(he.a),h.Tb(m.a),h.Tb(h.h))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-poll-vote"]],features:[h.Db],decls:4,vars:4,consts:[[4,"osPerms","osPermsAnd"],[4,"ngIf","ngIfElse"],["userHasVotes",""],[3,"poll"],["class","vote-button-grid",4,"ngIf"],["class","submit-vote-indicator",4,"ngIf"],[1,"vote-button-grid"],["class","vote-button",4,"ngFor","ngForOf"],[1,"vote-button"],["mat-raised-button","",3,"ngClass","disabled","click"],[1,"vote-label"],[1,"submit-vote-indicator"],[1,"small-spinner"],[1,"user-has-voted"],[1,"vote-submitted"]],template:function(t,e){if(1&t&&(h.Qc(0,Te,2,1,"div",0),h.Qc(1,we,3,2,"ng-container",1),h.Qc(2,Ze,8,3,"ng-template",null,2,h.Rc)),2&t){const t=h.Ec(3);h.tc("osPerms","motions.can_manage_polls")("osPermsAnd",e.poll&&e.poll.isStarted),h.Gb(1),h.tc("ngIf",e.poll&&!e.poll.user_has_voted)("ngIfElse",t)}},directives:[Tt.a,i.t,Se.a,i.s,I.b,i.q,It.a,Ce.c],pipes:[u.j],styles:[".yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.vote-button-grid[_ngcontent-%COMP%]{display:grid;grid-gap:20px;margin-top:2em;grid-template-columns:repeat(auto-fit,minmax(100px,1fr))}.submit-vote-indicator[_ngcontent-%COMP%]{margin-top:1em;text-align:center}.submit-vote-indicator[_ngcontent-%COMP%]   .mat-spinner[_ngcontent-%COMP%]{margin:auto}.vote-button[_ngcontent-%COMP%]{display:inline-grid;grid-gap:1em;margin:auto}.user-has-voted[_ngcontent-%COMP%], .vote-button[_ngcontent-%COMP%]   .vote-label[_ngcontent-%COMP%]{text-align:center}.user-has-voted[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex}.user-has-voted[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{margin-top:1em;margin-left:auto;margin-right:auto}.user-has-voted[_ngcontent-%COMP%]   .vote-submitted[_ngcontent-%COMP%]{color:#4caf50;font-size:200%}"],changeDetection:0}),t})();var Oe=n("iCsr"),ke=n("j7f2"),ye=n("QUb3");function Re(t,e){if(1&t&&(h.Zb(0,"span",21),h.Zb(1,"button",22),h.Zb(2,"mat-icon",23),h.Sc(3,"more_horiz"),h.Yb(),h.Yb(),h.Yb()),2&t){h.lc(2);const t=h.Ec(8);h.Gb(1),h.tc("matMenuTriggerFor",t)}}function Fe(t,e){if(1&t){const t=h.ac();h.Zb(0,"span"),h.Zb(1,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(2).openVotingWarning()})),h.Zb(2,"mat-icon"),h.Sc(3," warning "),h.Yb(),h.Yb(),h.Yb()}}function Pe(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.Uc(" ",h.nc(2,1,t.poll.typeVerbose)," \xb7 ")}}function Ne(t,e){if(1&t&&(h.Xb(0),h.Sc(1),h.mc(2,"translate"),h.Wb()),2&t){const t=h.lc(3);h.Gb(1),h.Uc(" ",h.nc(2,1,t.poll.nextStateActionVerbose)," ")}}function Le(t,e){1&t&&(h.Xb(0),h.Sc(1),h.mc(2,"translate"),h.Wb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"In progress, please wait...")," "))}function Ee(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",25),h.hc("click",(function(){h.Ic(t);const e=h.lc(2);return e.changeState(e.poll.nextState)})),h.Zb(2,"mat-icon"),h.Sc(3),h.Yb(),h.Zb(4,"span",26),h.Qc(5,Ne,3,3,"ng-container",17),h.Qc(6,Le,3,3,"ng-container",17),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(1),h.tc("ngClass",t.pollStateActions[t.poll.state].css)("disabled",t.stateChangePending),h.Gb(2),h.Uc(" ",t.pollStateActions[t.poll.state].icon,""),h.Gb(2),h.tc("ngIf",!t.stateChangePending),h.Gb(1),h.tc("ngIf",t.stateChangePending)}}function Qe(t,e){if(1&t&&(h.Xb(0),h.Ub(1,"os-motion-poll-vote",27),h.Wb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("poll",t.poll)}}function Ae(t,e){if(1&t&&(h.Zb(0,"a",28),h.mc(1,"translate"),h.Zb(2,"mat-icon",23),h.Sc(3," visibility "),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.uc("matTooltip",h.nc(1,2,"More")),h.tc("routerLink",t.pollLink)}}function Ue(t,e){if(1&t&&(h.Zb(0,"mat-card",9),h.Zb(1,"div",10),h.Zb(2,"div",11),h.Zb(3,"span",12),h.Zb(4,"a",13),h.Sc(5),h.mc(6,"translate"),h.Yb(),h.Yb(),h.Yb(),h.Qc(7,Re,4,1,"span",14),h.Yb(),h.Zb(8,"div",15),h.Qc(9,Fe,4,0,"span",16),h.Qc(10,Pe,3,3,"span",17),h.Zb(11,"span"),h.Sc(12),h.mc(13,"translate"),h.Yb(),h.Yb(),h.Qc(14,Ee,7,5,"div",16),h.Qc(15,Qe,2,1,"ng-container",18),h.Zb(16,"div",19),h.Qc(17,Ae,4,4,"a",20),h.Yb(),h.Yb()),2&t){const t=h.lc(),e=h.Ec(2);h.Gb(4),h.tc("routerLink",t.pollLink),h.Gb(1),h.Uc(" ",h.nc(6,12,t.poll.title)," "),h.Gb(2),h.tc("osPerms","motions.can_manage_polls"),h.Gb(2),h.tc("osPerms","motions.can_manage_polls")("osPermsAnd","pseudoanonymous"===t.poll.type),h.Gb(1),h.tc("ngIf",t.pollService.isElectronicVotingEnabled&&"analog"!==t.poll.type),h.Gb(2),h.Uc(" ",h.nc(13,14,t.poll.stateVerbose)," "),h.Gb(2),h.tc("osPerms","motions.can_manage_polls")("osPermsAnd",!t.hideChangeState),h.Gb(1),h.tc("ngIf",t.poll&&!t.poll.stateHasVotes&&"analog"!==t.poll.type)("ngIfElse",e),h.Gb(2),h.tc("ngIf",t.poll.isPublished)}}function je(t,e){if(1&t&&(h.Zb(0,"div",29),h.Vb(1,30),h.Yb()),2&t){const t=h.lc(),e=h.Ec(4),n=h.Ec(6);h.Gb(1),h.tc("ngTemplateOutlet",t.poll.hasVotes&&t.poll.stateHasVotes?e:n)}}function Ve(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"pollPercentBase"),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc(3);h.Gb(1),h.Uc(" ",h.oc(2,1,t.value[0].amount,e.poll)," ")}}function De(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"os-icon-container",38),h.Sc(2),h.mc(3,"parsePollNumber"),h.Qc(4,Ve,3,4,"span",17),h.Yb(),h.Yb()),2&t){const t=e.$implicit;h.Ib(t.votingOption),h.Gb(1),h.tc("icon",t.value[0].icon),h.Gb(1),h.Uc(" ",h.nc(3,5,t.value[0].amount)," "),h.Gb(2),h.tc("ngIf",t.value[0].showPercent)}}function Be(t,e){if(1&t&&(h.Ub(0,"os-charts",39),h.mc(1,"async")),2&t){const t=h.lc(3);h.tc("data",h.nc(1,1,t.chartDataSubject))}}function $e(t,e){if(1&t&&(h.Zb(0,"div",33),h.Zb(1,"div",34),h.Qc(2,De,5,7,"div",35),h.Yb(),h.Zb(3,"div",36),h.Qc(4,Be,2,3,"os-charts",37),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("routerLink",t.pollLink),h.Gb(1),h.tc("ngForOf",t.reducedPollTableData)("ngForTrackBy",t.trackByIndex),h.Gb(1),h.tc("routerLink",t.pollLink),h.Gb(1),h.tc("ngIf",t.showChart)}}function qe(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"Counting of votes is in progress ...")," "))}function ze(t,e){if(1&t&&(h.Zb(0,"div",40),h.Qc(1,qe,3,3,"span",17),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.poll.isFinished)}}function We(t,e){if(1&t&&(h.Qc(0,$e,5,5,"div",31),h.Qc(1,ze,2,1,"div",32)),2&t){const t=h.lc();h.tc("osPerms","motions.can_manage_polls")("osPermsOr",t.poll.isPublished),h.Gb(1),h.tc("osPerms","motions.can_manage_polls")("osPermsComplement",!0)}}function He(t,e){1&t&&(h.Zb(0,"div"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"Edit to enter votes.")," "))}function Xe(t,e){if(1&t&&h.Qc(0,He,3,3,"div",16),2&t){const t=h.lc();h.tc("osPerms","motions.can_manage_polls")("osPermsAnd","analog"===t.poll.type)}}function Ke(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",7),h.hc("click",(function(){return h.Ic(t),h.lc().openDialog()})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Edit")))}function Je(t,e){if(1&t&&h.Ub(0,"os-projector-button",41),2&t){const t=h.lc();h.tc("menuItem",!0)("object",t.poll)}}function tn(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Ub(1,"mat-divider"),h.Zb(2,"button",7),h.hc("click",(function(){return h.Ic(t),h.lc().refreshPoll()})),h.Zb(3,"mat-icon"),h.Sc(4,"refresh"),h.Yb(),h.Zb(5,"span"),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Yb(),h.Zb(8,"button",7),h.hc("click",(function(){return h.Ic(t),h.lc().resetState()})),h.Zb(9,"mat-icon",42),h.Sc(10,"replay"),h.Yb(),h.Zb(11,"span"),h.Sc(12),h.mc(13,"translate"),h.Yb(),h.Yb(),h.Zb(14,"button",7),h.hc("click",(function(){return h.Ic(t),h.lc().deletePoll()})),h.Zb(15,"mat-icon",42),h.Sc(16,"delete"),h.Yb(),h.Zb(17,"span"),h.Sc(18),h.mc(19,"translate"),h.Yb(),h.Yb(),h.Yb()}2&t&&(h.Gb(6),h.Tc(h.nc(7,3,"Refresh")),h.Gb(6),h.Tc(h.nc(13,5,"Reset state")),h.Gb(6),h.Tc(h.nc(19,7,"Delete")))}let en=(()=>{class t extends ve.a{constructor(t,e,n,i,o,c,a,s,r,l){super(t,e,a,o,n,c,i),this.dialog=o,this.pollRepo=c,this.translate=a,this.pollService=s,this.pdfService=r,this.operator=l}set poll(t){this.initPoll(t);const e=this.pollService.generateChartData(t);this.chartDataSubject.next(e)}get poll(){return this._poll}get pollLink(){return"/motions/polls/"+this.poll.id}get showChart(){return this.pollService.showChart(this.poll)}get reducedPollTableData(){return this.pollService.generateTableData(this.poll).filter(t=>["yes","no","abstain","votesinvalid"].includes(t.votingOption))}get showPoll(){return!(!this.poll||!(this.operator.hasPerms(E.b.motionsCanManagePolls)||this.poll.isPublished||this.poll.isEVoting&&!this.poll.isCreated))}get isEVotingEnabled(){return this.pollService.isElectronicVotingEnabled}openVotingWarning(){this.dialog.open(ge.a,X.a)}downloadPdf(){this.pdfService.printBallots(this.poll)}deletePoll(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete this vote?"),e=this.poll.getTitle();(yield this.promptService.open(t,e))&&this.repo.delete(this.poll).catch(this.raiseError)}))}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(p.a),h.Tb(m.a),h.Tb(st.a),h.Tb(mt.b),h.Tb(he.a),h.Tb(u.k),h.Tb(rt.a),h.Tb(fe),h.Tb(E.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-poll"]],inputs:{poll:"poll"},features:[h.Db],decls:18,vars:7,consts:[["class","motion-poll-wrapper",4,"ngIf"],["votingResult",""],["viewTemplate",""],["emptyTemplate",""],["pollDetailMenu","matMenu"],["mat-menu-item","",3,"click",4,"osPerms"],[3,"menuItem","object",4,"osPerms"],["mat-menu-item","",3,"click"],[4,"osPerms"],[1,"motion-poll-wrapper"],[1,"poll-title-wrapper"],[1,"poll-title-area"],[1,"poll-title"],[3,"routerLink"],["class","poll-actions",4,"osPerms"],[1,"italic","spacer-bottom-20"],[4,"osPerms","osPermsAnd"],[4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"poll-detail-button-wrapper"],["mat-icon-button","",3,"routerLink","matTooltip",4,"ngIf"],[1,"poll-actions"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"small-icon"],["mat-icon-button","","color","warn",3,"click"],["mat-stroked-button","",3,"ngClass","disabled","click"],[1,"next-state-label"],[3,"poll"],["mat-icon-button","",3,"routerLink","matTooltip"],[1,"poll-link-wrapper"],[3,"ngTemplateOutlet"],["class","poll-chart-wrapper",4,"osPerms","osPermsOr"],["class","motion-couting-in-progress-hint",4,"osPerms","osPermsComplement"],[1,"poll-chart-wrapper"],[1,"vote-legend",3,"routerLink"],[3,"class",4,"ngFor","ngForOf","ngForTrackBy"],[1,"doughnut-chart",3,"routerLink"],["type","doughnut",3,"data",4,"ngIf"],["size","large",3,"icon"],["type","doughnut",3,"data"],[1,"motion-couting-in-progress-hint"],[3,"menuItem","object"],["color","warn"]],template:function(t,e){1&t&&(h.Qc(0,Ue,18,16,"mat-card",0),h.Qc(1,je,2,1,"ng-template",null,1,h.Rc),h.Qc(3,We,2,4,"ng-template",null,2,h.Rc),h.Qc(5,Xe,1,2,"ng-template",null,3,h.Rc),h.Zb(7,"mat-menu",null,4),h.Qc(9,Ke,6,3,"button",5),h.Qc(10,Je,1,2,"os-projector-button",6),h.Zb(11,"button",7),h.hc("click",(function(){return e.downloadPdf()})),h.Zb(12,"mat-icon"),h.Sc(13,"picture_as_pdf"),h.Yb(),h.Zb(14,"span"),h.Sc(15),h.mc(16,"translate"),h.Yb(),h.Yb(),h.Qc(17,tn,20,9,"div",8),h.Yb()),2&t&&(h.tc("ngIf",e.showPoll),h.Gb(9),h.tc("osPerms","motions.can_manage_polls"),h.Gb(1),h.tc("osPerms","core.can_manage_projector"),h.Gb(5),h.Tc(h.nc(16,5,"Ballot papers")),h.Gb(2),h.tc("osPerms","motions.can_manage_polls"))},directives:[i.t,Mt.f,Tt.a,Mt.c,It.a,wt.a,c.i,I.b,Mt.e,i.q,xe,I.a,Yt.c,i.A,c.g,i.s,St.a,Oe.a,_t.a,Gt.a],pipes:[u.j,ke.a,ye.a,i.b],styles:['.yes[_ngcontent-%COMP%]{color:#4caf50}.no[_ngcontent-%COMP%]{color:#cc6c5b}.abstain[_ngcontent-%COMP%]{color:#a6a6a6}.voted-yes[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.voted-no[_ngcontent-%COMP%]{background-color:#cc6c5b;color:#fff}.voted-abstain[_ngcontent-%COMP%]{background-color:#a6a6a6;color:#fff}.start-poll-button[_ngcontent-%COMP%]{color:#4caf50}.stop-poll-button[_ngcontent-%COMP%]{color:#ff5252}.publish-poll-button[_ngcontent-%COMP%]{color:#e6b100}.poll-link-wrapper[_ngcontent-%COMP%]{outline:none}.motion-poll-wrapper[_ngcontent-%COMP%]{margin-bottom:30px}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]{display:grid;grid-gap:10px;grid-template-areas:"title actions";grid-template-columns:auto -webkit-min-content;grid-template-columns:auto min-content}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-title-area[_ngcontent-%COMP%]{grid-area:title;margin-top:1em}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-title-area[_ngcontent-%COMP%]   .poll-title[_ngcontent-%COMP%]{font-size:125%}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-title-wrapper[_ngcontent-%COMP%]   .poll-actions[_ngcontent-%COMP%]{grid-area:actions}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]{cursor:pointer;display:grid;grid-gap:20px;margin:2em;grid-template-columns:repeat(auto-fit,minmax(120px,1fr))}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]   .doughnut-chart[_ngcontent-%COMP%]{display:block;max-width:200px;margin-top:auto;margin-bottom:auto}.motion-poll-wrapper[_ngcontent-%COMP%]   .poll-chart-wrapper[_ngcontent-%COMP%]   .vote-legend[_ngcontent-%COMP%]   div[_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{margin-top:20px}.poll-detail-button-wrapper[_ngcontent-%COMP%]{display:-ms-flexbox;display:flex;margin:auto 0}.poll-detail-button-wrapper[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{margin-left:auto}.next-state-label[_ngcontent-%COMP%]{margin-top:auto;margin-bottom:auto}.motion-couting-in-progress-hint[_ngcontent-%COMP%]{margin-top:1em;font-style:italic}']}),t})();var nn=n("IZUe"),on=n("d3UM"),cn=n("FKr1");function an(t,e){if(1&t){const t=h.ac();h.Zb(0,"li",4),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(2).gotoReco(n)})),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(2);h.Pc("top",n.calcRecoTop(t))("height",n.calcRecoHeight(t)),h.Kb("delete",n.recoIsDeletion(t))("insert",n.recoIsInsertion(t))("replace",n.recoIsReplacement(t)),h.tc("title",t.getTitle())}}function sn(t,e){if(1&t&&(h.Zb(0,"ul",2),h.Qc(1,an,1,11,"li",3),h.Yb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngForOf",t.getTextChangeRecommendations())}}let rn=(()=>{class t{constructor(t,e,n,i){this.renderer=t,this.el=e,this.cd=n,this.operator=i,this.selectedFrom=null,this.createChangeRecommendation=new h.p,this.gotoChangeRecommendation=new h.p,this.showChangeRecommendations=!1,this.can_manage=!1,this.minLineNo=null,this.maxLineNo=null,this.operator.getUserObservable().subscribe(this.onPermissionsChanged.bind(this))}update(){this.element&&(this.element.innerHTML=this.html,this.startCreating())}onPermissionsChanged(){this.operator.hasPerms(E.b.motionsCanManage)?(this.can_manage=!0,null===this.selectedFrom&&this.startCreating()):(this.can_manage=!1,this.selectedFrom=null,this.element&&Array.from(this.element.querySelectorAll(".os-line-number")).forEach(t=>{t.classList.remove("selectable"),t.classList.remove("selected")}))}getTextChangeRecommendations(){return this.changeRecommendations.filter(t=>!t.isTitleChange()).filter(t=>t.line_from>=this.minLineNo&&t.line_from<=this.maxLineNo)}setLineNumberCache(){Array.from(this.element.querySelectorAll(".os-line-number")).forEach(t=>{const e=parseInt(t.getAttribute("data-line-number"),10);(null===this.minLineNo||e<this.minLineNo)&&(this.minLineNo=e),(null===this.maxLineNo||e>this.maxLineNo)&&(this.maxLineNo=e)})}getAffectedLineNumbers(){const t=[];return this.changeRecommendations.forEach(e=>{if(!e.isTitleChange())for(let n=e.line_from;n<e.line_to;n++)t.push(n)}),t}startCreating(){if(!this.can_manage||!this.element)return;const t=this.getAffectedLineNumbers();Array.from(this.element.querySelectorAll(".os-line-number")).forEach(e=>{e.classList.remove("selected"),-1===t.indexOf(parseInt(e.getAttribute("data-line-number"),10))?e.classList.add("selectable"):e.classList.remove("selectable")})}clickedLineNumber(t){null===this.selectedFrom?this.selectedFrom=t:(this.createChangeRecommendation.emit(t>this.selectedFrom?{from:this.selectedFrom,to:t+1}:{from:t,to:this.selectedFrom+1}),this.selectedFrom=null,this.startCreating())}hoverLineNumber(t){null!==this.selectedFrom&&Array.from(this.element.querySelectorAll(".os-line-number")).forEach(e=>{const n=parseInt(e.getAttribute("data-line-number"),10);n>=this.selectedFrom&&n<=t||n>=t&&n<=this.selectedFrom?e.classList.add("selected"):e.classList.remove("selected")})}calcRecoTop(t){return this.element.querySelector(".os-line-number.line-number-"+t.line_from.toString(10)).offsetTop.toString()+"px"}calcRecoHeight(t){const e=this.element.querySelector(".os-line-number.line-number-"+t.line_from.toString(10)),n=this.element.querySelector(".os-line-number.line-number-"+t.line_to.toString(10));return n?(n.offsetTop-e.offsetTop).toString()+"px":"20px"}recoIsInsertion(t){return t.type===bt.b.TYPE_INSERTION}recoIsDeletion(t){return t.type===bt.b.TYPE_DELETION}recoIsReplacement(t){return t.type===bt.b.TYPE_REPLACEMENT}gotoReco(t){this.gotoChangeRecommendation.emit(t)}ngOnInit(){this.element=this.el.nativeElement.querySelector(".text"),this.renderer.listen(this.el.nativeElement,"click",t=>{const e=t.target;e.classList.contains("os-line-number")&&e.classList.contains("selectable")&&this.clickedLineNumber(parseInt(e.getAttribute("data-line-number"),10))}),this.renderer.listen(this.el.nativeElement,"mouseover",t=>{const e=t.target;e.classList.contains("os-line-number")&&e.classList.contains("selectable")&&this.hoverLineNumber(parseInt(e.getAttribute("data-line-number"),10))}),this.update(),window.setTimeout(()=>{this.setLineNumberCache(),this.showChangeRecommendations=!0,this.cd.detectChanges()},1)}ngOnChanges(t){this.update()}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(h.I),h.Tb(h.m),h.Tb(h.h),h.Tb(E.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-detail-original-change-recommendations"]],inputs:{html:"html",changeRecommendations:"changeRecommendations"},outputs:{createChangeRecommendation:"createChangeRecommendation",gotoChangeRecommendation:"gotoChangeRecommendation"},features:[h.Eb],decls:2,vars:1,consts:[[1,"text"],["class","change-recommendation-list",4,"ngIf"],[1,"change-recommendation-list"],[3,"title","top","height","delete","insert","replace","click",4,"ngFor","ngForOf"],[3,"title","click"]],template:function(t,e){1&t&&(h.Ub(0,"div",0),h.Qc(1,sn,2,1,"ul",1)),2&t&&(h.Gb(1),h.tc("ngIf",e.showChangeRecommendations))},directives:[i.t,i.s],styles:[".change-recommendation-list[_ngcontent-%COMP%]{position:absolute;top:0;left:-10px;width:4px;list-style-type:none;padding:0;margin:0}.change-recommendation-list[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:absolute;width:4px;left:0;cursor:pointer;padding:0;margin:0}.change-recommendation-list[_ngcontent-%COMP%] > li.insert[_ngcontent-%COMP%]{background-color:#0a0}.change-recommendation-list[_ngcontent-%COMP%] > li.delete[_ngcontent-%COMP%]{background-color:#a00}.change-recommendation-list[_ngcontent-%COMP%] > li.replace[_ngcontent-%COMP%]{background-color:#0333ff}.change-recommendation-list[_ngcontent-%COMP%] > li.other[_ngcontent-%COMP%]{background-color:#777}.change-recommendation-list[_ngcontent-%COMP%]   .tooltip[_ngcontent-%COMP%]{display:none}"]}),t})();var ln=n("GEzB"),mn=n("30jZ");function bn(t,e){if(1&t&&(h.Zb(0,"span",16),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc(2);h.Gb(1),h.Vc(" ",h.nc(2,2,"Line")," ",e.formatLineRange(t)," ")}}function dn(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Title")))}function hn(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" (",h.nc(2,1,"Change recommendation"),")"))}function gn(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Vc(" (",h.nc(2,2,"Amendment")," ",t.getIdentifier(),")")}}function un(t,e){if(1&t&&(h.Zb(0,"span",17),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc(2);h.Gb(1),h.Uc(" \u2013 ",h.nc(2,1,e.getRecommendationTypeName(t))," ")}}function pn(t,e){1&t&&(h.Xb(0),h.Sc(1," \u2013 "),h.Zb(2,"span"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Wb()),2&t&&(h.Gb(3),h.Tc(h.nc(4,1,"Rejected")))}function fn(t,e){if(1&t&&(h.Xb(0),h.Sc(1),h.mc(2,"translate"),h.Wb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Uc(" \u2013 ",h.nc(2,1,t.stateName),"")}}function vn(t,e){if(1&t){const t=h.ac();h.Zb(0,"li"),h.Zb(1,"a",12),h.hc("click",(function(n){h.Ic(t);const i=e.$implicit;return h.lc(2).scrollToChangeClicked(i,n)})),h.Qc(2,bn,3,4,"span",13),h.Qc(3,dn,3,3,"span",3),h.Qc(4,hn,3,3,"span",3),h.Qc(5,gn,3,4,"span",3),h.Qc(6,un,3,3,"span",14),h.Zb(7,"span",15),h.Qc(8,pn,5,3,"ng-container",3),h.Qc(9,fn,3,3,"ng-container",3),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(2);h.Gb(1),h.Kb("amendment",n.isAmendment(t))("recommendation",n.isChangeRecommendation(t)),h.Gb(1),h.tc("ngIf",!t.isTitleChange()),h.Gb(1),h.tc("ngIf",t.isTitleChange()),h.Gb(1),h.tc("ngIf",n.isChangeRecommendation(t)),h.Gb(1),h.tc("ngIf",n.isAmendment(t)),h.Gb(1),h.tc("ngIf",n.isChangeRecommendation(t)),h.Gb(2),h.tc("ngIf",t.isRejected()&&!n.isAmendment(t)),h.Gb(1),h.tc("ngIf",(t.isAccepted()||n.isAmendment(t))&&t.stateName)}}function Mn(t,e){1&t&&(h.Zb(0,"div",18),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"No change recommendations yet")))}function In(t,e){if(1&t&&(h.Zb(0,"section",10),h.Zb(1,"strong"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Zb(4,"ul"),h.Qc(5,vn,10,11,"li",4),h.Yb(),h.Qc(6,Mn,3,3,"div",11),h.Yb()),2&t){const t=h.lc();h.Gb(2),h.Uc(" ",h.nc(3,3,"Summary of changes"),": "),h.Gb(3),h.tc("ngForOf",t.changes),h.Gb(1),h.tc("ngIf",0===t.changes.length)}}const Sn=function(t){return{change:t}};function Cn(t,e){if(1&t&&(h.Zb(0,"button",26),h.Zb(1,"mat-icon"),h.Sc(2,"more_horiz"),h.Yb(),h.Yb()),2&t){const t=h.lc(2).ngIf;h.lc();const e=h.Ec(13);h.tc("matMenuTriggerFor",e)("matMenuTriggerData",h.zc(2,Sn,t))}}function Tn(t,e){if(1&t&&(h.Zb(0,"div",24),h.Qc(1,Cn,3,4,"button",25),h.Yb()),2&t){const t=h.lc().ngIf,e=h.lc();h.Gb(1),h.tc("ngIf",e.isRecommendation(t))}}function Gn(t,e){1&t&&(h.Zb(0,"div",27),h.Zb(1,"i",28),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"Rejected")))}function _n(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"div"),h.Qc(2,Tn,2,1,"div",19),h.Qc(3,Gn,4,3,"div",20),h.Zb(4,"div",21),h.Zb(5,"div",22),h.Sc(6),h.mc(7,"translate"),h.Yb(),h.Ub(8,"div",23),h.mc(9,"trust"),h.Yb(),h.Yb(),h.Yb()),2&t){const t=e.ngIf,n=h.lc();h.Gb(1),h.Jb("diff-box diff-box-",t.getChangeId()," clearfix"),h.Gb(1),h.tc("osPerms","motions.can_manage"),h.Gb(1),h.tc("ngIf",t.isRejected()),h.Gb(1),h.Kb("line-numbers-none",n.isLineNumberingNone())("line-numbers-inline",n.isLineNumberingInline())("line-numbers-outside",n.isLineNumberingOutside()),h.Hb("data-change-id",t.getChangeId()),h.Gb(2),h.Uc("",h.nc(7,14,"Changed title"),":"),h.Gb(2),h.tc("innerHTML",h.oc(9,16,n.getFormattedTitleDiff(),"html"),h.Jc)}}function Yn(t,e){1&t&&(h.Zb(0,"div",31),h.Zb(1,"mat-icon",32),h.mc(2,"translate"),h.Sc(3,"warning"),h.Yb(),h.Yb()),2&t&&(h.Gb(1),h.uc("matTooltip",h.nc(2,1,"This change collides with another one.")))}function wn(t,e){if(1&t&&(h.Zb(0,"button",26),h.Zb(1,"mat-icon"),h.Sc(2,"more_horiz"),h.Yb(),h.Yb()),2&t){const t=h.lc(2).$implicit;h.lc();const e=h.Ec(13);h.tc("matMenuTriggerFor",e)("matMenuTriggerData",h.zc(2,Sn,t))}}function Zn(t,e){if(1&t&&(h.Zb(0,"button",26),h.Zb(1,"mat-icon"),h.Sc(2,"more_horiz"),h.Yb(),h.Yb()),2&t){const t=h.lc(2).$implicit;h.lc();const e=h.Ec(10);h.tc("matMenuTriggerFor",e)("matMenuTriggerData",h.zc(2,Sn,t))}}function xn(t,e){if(1&t&&(h.Zb(0,"div",24),h.Qc(1,wn,3,4,"button",25),h.Qc(2,Zn,3,4,"button",25),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc();h.Gb(1),h.tc("ngIf",e.isRecommendation(t)),h.Gb(1),h.tc("ngIf",e.isAmendment(t))}}function On(t,e){1&t&&(h.Zb(0,"div",27),h.Zb(1,"i",28),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"Rejected")))}function kn(t,e){if(1&t&&(h.Zb(0,"div",27),h.Zb(1,"i",28),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(2),h.Vc("",t.amendment.identifier," - ",h.nc(3,2,t.amendment.state.name),"")}}const yn=function(){return[]};function Rn(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"div",5),h.Zb(2,"os-motion-detail-original-change-recommendations",6),h.hc("createChangeRecommendation",(function(e){return h.Ic(t),h.lc().onCreateChangeRecommendation(e)})),h.Yb(),h.Yb(),h.Zb(3,"div"),h.Qc(4,Yn,4,3,"div",29),h.Qc(5,xn,3,2,"div",19),h.Qc(6,On,4,3,"div",20),h.Qc(7,kn,4,4,"div",20),h.Ub(8,"div",30),h.mc(9,"trust"),h.Yb(),h.Yb()}if(2&t){const t=e.$implicit,n=e.index,i=h.lc();h.Gb(1),h.Kb("line-numbers-none",i.isLineNumberingNone())("line-numbers-inline",i.isLineNumberingInline())("line-numbers-outside",i.isLineNumberingOutside()),h.Gb(1),h.tc("html",i.getTextBetweenChanges(i.getAllTextChangingObjects()[n-1],t))("changeRecommendations",h.yc(28,yn)),h.Gb(1),h.Jb("diff-box diff-box-",t.getChangeId()," clearfix"),h.Kb("collides",i.hasCollissions(t,i.getAllTextChangingObjects())),h.Gb(1),h.tc("ngIf",i.hasCollissions(t,i.getAllTextChangingObjects())),h.Gb(1),h.tc("osPerms","motions.can_manage"),h.Gb(1),h.tc("ngIf",i.isChangeRecommendation(t)&&t.isRejected()),h.Gb(1),h.tc("ngIf",i.isAmendment(t)&&i.showAllAmendments),h.Gb(1),h.Kb("line-numbers-none",i.isLineNumberingNone())("line-numbers-inline",i.isLineNumberingInline())("line-numbers-outside",i.isLineNumberingOutside()),h.tc("innerHTML",h.oc(9,25,i.getDiff(t),"html"),h.Jc),h.Hb("data-change-id",t.getChangeId())}}function Fn(t,e){1&t&&h.Ub(0,"mat-divider")}function Pn(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xa0..."),h.Yb())}function Nn(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",35),h.hc("click",(function(){h.Ic(t);const n=e.$implicit,i=h.lc().change;return h.lc().setAmendmentState(i,n.id)})),h.Sc(1),h.mc(2,"translate"),h.Qc(3,Pn,2,0,"span",3),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(1),h.Uc(" ",h.nc(2,2,t.name)," "),h.Gb(2),h.tc("ngIf",t.show_state_extension_field)}}function Ln(t,e){1&t&&h.Ub(0,"mat-divider")}function En(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xa0..."),h.Yb())}function Qn(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",35),h.hc("click",(function(){h.Ic(t);const n=e.$implicit,i=h.lc().change;return h.lc().setAmendmentState(i,n.id)})),h.Zb(1,"mat-icon"),h.Sc(2,"arrow_back"),h.Yb(),h.Sc(3),h.mc(4,"translate"),h.Qc(5,En,2,0,"span",3),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(3),h.Uc(" ",h.nc(4,2,t.name)," "),h.Gb(2),h.tc("ngIf",t.show_state_extension_field)}}const An=function(){return{back:"true"}};function Un(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",33),h.Zb(1,"mat-icon"),h.Sc(2,"visibility_on"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb(),h.Qc(6,Fn,1,0,"mat-divider",3),h.Qc(7,Nn,4,4,"button",34),h.Qc(8,Ln,1,0,"mat-divider",3),h.Qc(9,Qn,6,4,"button",34),h.Zb(10,"button",35),h.hc("click",(function(){h.Ic(t);const n=e.change;return h.lc().setAmendmentState(n,null)})),h.Zb(11,"mat-icon"),h.Sc(12,"replay"),h.Yb(),h.Sc(13),h.mc(14,"translate"),h.Yb()}if(2&t){const t=e.change;h.tc("routerLink",t.amendment.getDetailStateURL())("state",h.yc(12,An)),h.Gb(4),h.Tc(h.nc(5,8,"Show amendment")),h.Gb(2),h.tc("ngIf",t.amendment.state.next_states.length>0),h.Gb(1),h.tc("ngForOf",t.amendment.state.next_states),h.Gb(1),h.tc("ngIf",t.amendment.state.next_states.length>0),h.Gb(1),h.tc("ngForOf",t.amendment.state.previous_states),h.Gb(4),h.Uc(" ",h.nc(14,10,"Reset state")," ")}}function jn(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",36),h.hc("click",(function(e){h.Ic(t);const n=h.lc().change;return h.lc().editChangeRecommendation(n,e)})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Edit")))}function Vn(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",36),h.hc("click",(function(e){h.Ic(t);const n=h.lc().change;return h.lc().editTitleChangeRecommendation(n,e)})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Edit")))}function Dn(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",36),h.hc("click",(function(){h.Ic(t);const n=e.change;return h.lc().setAcceptanceValue(n,"accepted")})),h.Zb(1,"mat-icon"),h.Sc(2,"thumb_up"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Zb(6,"mat-icon",37),h.Sc(7),h.Yb(),h.Yb(),h.Zb(8,"button",36),h.hc("click",(function(){h.Ic(t);const n=e.change;return h.lc().setAcceptanceValue(n,"rejected")})),h.Zb(9,"mat-icon"),h.Sc(10,"thumb_down"),h.Yb(),h.Zb(11,"span"),h.Sc(12),h.mc(13,"translate"),h.Yb(),h.Zb(14,"mat-icon",37),h.Sc(15),h.Yb(),h.Yb(),h.Zb(16,"button",36),h.hc("click",(function(){h.Ic(t);const n=e.change;return h.lc().setInternal(n,!n.internal)})),h.Zb(17,"mat-icon"),h.Sc(18),h.Yb(),h.Zb(19,"span"),h.Sc(20),h.mc(21,"translate"),h.Yb(),h.Yb(),h.Zb(22,"button",36),h.hc("click",(function(n){h.Ic(t);const i=e.change;return h.lc().deleteChangeRecommendation(i,n)})),h.Zb(23,"mat-icon"),h.Sc(24,"delete"),h.Yb(),h.Zb(25,"span"),h.Sc(26),h.mc(27,"translate"),h.Yb(),h.Yb(),h.Qc(28,jn,6,3,"button",38),h.Qc(29,Vn,6,3,"button",38)}if(2&t){const t=e.change;h.Gb(4),h.Tc(h.nc(5,9,"Accept")),h.Gb(3),h.Tc(t.isAccepted()?"done":""),h.Gb(5),h.Tc(h.nc(13,11,"Reject")),h.Gb(3),h.Tc(t.isRejected()?"done":""),h.Gb(3),h.Tc(t.internal?"check_box_outline_blank":"check_box"),h.Gb(2),h.Tc(h.nc(21,13,"Public")),h.Gb(6),h.Tc(h.nc(27,15,"Delete")),h.Gb(2),h.tc("ngIf",!t.isTitleChange()),h.Gb(1),h.tc("ngIf",t.isTitleChange())}}let Bn=(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a,s,r,l,m){super(t,e,n),this.translate=e,this.diff=i,this.lineNumbering=o,this.recoRepo=c,this.motionRepo=a,this.dialogService=s,this.configService=r,this.el=l,this.promptService=m,this.getRecommendationTypeName=mn.a,this.createChangeRecommendation=new h.p,this.configService.get("motions_line_length").subscribe(t=>this.lineLength=t),this.configService.get("motions_preamble").subscribe(t=>this.preamble=t)}getTextBetweenChanges(t,e){const n={from:t?t.getLineTo():1,to:e?e.getLineFrom():null};if(n.from>=n.to)return"";let i;return i=this.motion.isParagraphBasedAmendment()?this.motionRepo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!0).join("\n"):this.lineNumbering.insertLineNumbers(this.motion.text,this.lineLength),this.diff.extractMotionLineRange(i,n,!0,this.lineLength,this.highlightedLine)}hasCollissions(t,e){return e.filter(e=>e.getChangeId()!==t.getChangeId()&&(e.getLineFrom()>=t.getLineFrom()&&e.getLineFrom()<t.getLineTo()||e.getLineTo()>t.getLineFrom()&&e.getLineTo()<=t.getLineTo()||e.getLineFrom()<t.getLineFrom()&&e.getLineTo()>t.getLineTo())).length>0}getDiff(t){let e;e=this.motion.isParagraphBasedAmendment()?this.motionRepo.getViewModel(this.motion.parent_id).text:this.motion.text;const n=this.lineNumbering.insertLineNumbers(e,this.lineLength);return this.diff.getChangeDiff(n,t,this.lineLength,this.highlightedLine)}getTextRemainderAfterLastChange(){if(!this.lineLength)return"";let t;return t=this.motion.isParagraphBasedAmendment()?this.motionRepo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!0).join("\n"):this.lineNumbering.insertLineNumbers(this.motion.text,this.lineLength),this.diff.getTextRemainderAfterLastChange(t,this.changes,this.lineLength,this.highlightedLine)}formatLineRange(t){return t.getLineFrom()<t.getLineTo()-1?t.getLineFrom().toString(10)+" - "+(t.getLineTo()-1).toString(10):t.getLineFrom().toString(10)}isRecommendation(t){return t.getChangeType()===ln.a.TYPE_CHANGE_RECOMMENDATION}isLineNumberingNone(){return this.lineNumberingMode===et.d.None}isLineNumberingInline(){return this.lineNumberingMode===et.d.Inside}isLineNumberingOutside(){return this.lineNumberingMode===et.d.Outside}isAmendment(t){return t.getChangeType()===ln.a.TYPE_AMENDMENT}isChangeRecommendation(t){return t.getChangeType()===ln.a.TYPE_CHANGE_RECOMMENDATION}getAllTextChangingObjects(){return this.changes.filter(t=>!t.isTitleChange())}getTitleChangingObject(){return this.changes.find(t=>t.isTitleChange())}getFormattedTitleDiff(){const t=this.getTitleChangingObject();return this.recoRepo.getTitleChangesAsDiff(this.motion.title,t)}setAcceptanceValue(t,e){return Object(a.a)(this,void 0,void 0,(function*(){try{"accepted"===e&&(yield this.recoRepo.setAccepted(t)),"rejected"===e&&(yield this.recoRepo.setRejected(t))}catch(n){this.raiseError(n)}}))}setInternal(t,e){this.recoRepo.setInternal(t,e).catch(this.raiseError)}deleteChangeRecommendation(t,e){return Object(a.a)(this,void 0,void 0,(function*(){e.stopPropagation(),e.preventDefault();const n=this.translate.instant("Are you sure you want to delete this change recommendation?");(yield this.promptService.open(n))&&this.recoRepo.delete(t).catch(this.raiseError)}))}editChangeRecommendation(t,e){e.stopPropagation(),e.preventDefault();const n={editChangeRecommendation:!0,newChangeRecommendation:!1,lineRange:{from:t.getLineFrom(),to:t.getLineTo()},changeRecommendation:t};this.dialogService.open(ut,Object.assign(Object.assign({},X.c),{data:n}))}editTitleChangeRecommendation(t,e){e.stopPropagation(),e.preventDefault();const n={editChangeRecommendation:!0,newChangeRecommendation:!1,changeRecommendation:t};this.dialogService.open(vt,Object.assign(Object.assign({},X.c),{data:n}))}setAmendmentState(t,e){this.motionRepo.setState(t.amendment,e).catch(this.raiseError)}scrollToChangeElement(t){this.el.nativeElement.querySelector('[data-change-id="'+t.getChangeId()+'"]').scrollIntoView({behavior:"smooth"})}scrollToChangeClicked(t,e){e.preventDefault(),e.stopPropagation(),this.scrollToChangeElement(t)}onCreateChangeRecommendation(t){this.createChangeRecommendation.emit(t)}ngAfterViewInit(){this.scrollToChange&&window.setTimeout(()=>{this.scrollToChangeElement(this.scrollToChange)},50)}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(bt.a),h.Tb(q.a),h.Tb(U.a),h.Tb(r.a),h.Tb(mt.b),h.Tb(l.a),h.Tb(h.m),h.Tb(m.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-detail-diff"]],inputs:{motion:"motion",changes:"changes",scrollToChange:"scrollToChange",highlightedLine:"highlightedLine",lineNumberingMode:"lineNumberingMode",showAllAmendments:"showAllAmendments"},outputs:{createChangeRecommendation:"createChangeRecommendation"},features:[h.Db],decls:15,vars:15,consts:[["class","change-recommendation-overview",4,"ngIf"],[1,"text-prefix-label"],[1,"motion-text-with-diffs"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"motion-text"],[3,"html","changeRecommendations","createChangeRecommendation"],["amendmentMenu","matMenu"],["matMenuContent",""],["changeRecommendationMenu","matMenu"],[1,"change-recommendation-overview"],["class","no-changes",4,"ngIf"],["href","",3,"click"],["class","line-number",4,"ngIf"],["class","operation",4,"ngIf"],[1,"status"],[1,"line-number"],[1,"operation"],[1,"no-changes"],["class","action-row",4,"osPerms"],["class","status-row",4,"ngIf"],[1,"motion-text","motion-text-diff"],[1,"bold"],[3,"innerHTML"],[1,"action-row"],["mat-icon-button","","type","button",3,"matMenuTriggerFor","matMenuTriggerData",4,"ngIf"],["mat-icon-button","","type","button",3,"matMenuTriggerFor","matMenuTriggerData"],[1,"status-row"],[1,"grey"],["class","collission-hint",4,"ngIf"],[1,"motion-text","motion-text-diff",3,"innerHTML"],[1,"collission-hint"],[3,"matTooltip"],["type","button","mat-menu-item","",3,"routerLink","state"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["mat-menu-item","",3,"click"],["type","button","mat-menu-item","",3,"click"],[1,"active-indicator"],["type","button","mat-menu-item","",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(h.Qc(0,In,7,5,"section",0),h.Zb(1,"span",1),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Zb(4,"div",2),h.Qc(5,_n,10,19,"div",3),h.Qc(6,Rn,10,29,"div",4),h.Zb(7,"div",5),h.Zb(8,"os-motion-detail-original-change-recommendations",6),h.hc("createChangeRecommendation",(function(t){return e.onCreateChangeRecommendation(t)})),h.Yb(),h.Yb(),h.Yb(),h.Zb(9,"mat-menu",null,7),h.Qc(11,Un,15,13,"ng-template",8),h.Yb(),h.Zb(12,"mat-menu",null,9),h.Qc(14,Dn,30,17,"ng-template",8),h.Yb()),2&t&&(h.tc("ngIf",e.changes.length>0),h.Gb(2),h.Tc(h.nc(3,12,e.preamble)),h.Gb(3),h.tc("ngIf",e.getTitleChangingObject()),h.Gb(1),h.tc("ngForOf",e.getAllTextChangingObjects()),h.Gb(1),h.Kb("line-numbers-none",e.isLineNumberingNone())("line-numbers-inline",e.isLineNumberingInline())("line-numbers-outside",e.isLineNumberingOutside()),h.Gb(1),h.tc("html",e.getTextRemainderAfterLastChange())("changeRecommendations",h.yc(14,yn)))},directives:[i.t,i.s,rn,Mt.f,Mt.b,Tt.a,I.b,Mt.e,It.a,Yt.c,Mt.c,c.g,Gt.a],pipes:[u.j,T.a],styles:['.diff-box[_ngcontent-%COMP%]{position:relative;border-radius:3px;margin-bottom:0;padding-top:0;padding-right:40px}.diff-box[_ngcontent-%COMP%]:hover   .action-row[_ngcontent-%COMP%]{opacity:1}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]{position:absolute;right:0;font-size:.8em;opacity:.5;overflow:hidden}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-delete[_ngcontent-%COMP%]{margin-left:5px;color:red}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-edit[_ngcontent-%COMP%]{margin-left:5px}.diff-box[_ngcontent-%COMP%]   .action-row[_ngcontent-%COMP%]   .btn-amend-info[_ngcontent-%COMP%]{margin-left:5px;min-width:68px}.diff-box[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%]{font-style:italic;color:grey}.diff-box[_ngcontent-%COMP%]   .status-row[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:after{content:":"}.change-recommendation-overview[_ngcontent-%COMP%]{border-radius:3px;margin-bottom:15px;padding:5px 10px}.change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, .change-recommendation-overview[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:link{text-decoration:none}.change-recommendation-overview[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:10px}.change-recommendation-overview[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;display:table}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:table-row;cursor:pointer}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{text-decoration:underline}.change-recommendation-overview[_ngcontent-%COMP%]   li[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:table-cell;padding:1px}.change-recommendation-overview[_ngcontent-%COMP%]   .no-changes[_ngcontent-%COMP%], .change-recommendation-overview[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{color:grey;font-style:italic}.active-indicator[_ngcontent-%COMP%]{font-size:18px;margin-left:10px;margin-right:0;margin-top:3px}']}),t})();var $n=n("MutI"),qn=n("JAMN"),zn=n("6Ehv");function Wn(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.Tc(t.motion.identifier)}}function Hn(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.Tc(t.contentForm.get("identifier").value)}}function Xn(t,e){if(1&t&&(h.Zb(0,"h2"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Zb(4,"span"),h.Sc(5,"\xa0"),h.Yb(),h.Qc(6,Wn,2,1,"span",2),h.Qc(7,Hn,2,1,"span",2),h.Yb()),2&t){const t=h.lc();h.Gb(2),h.Tc(h.nc(3,3,"Motion")),h.Gb(4),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("ngIf",t.editMotion)}}function Kn(t,e){1&t&&(h.Zb(0,"h2"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"New motion")))}function Jn(t,e){1&t&&(h.Zb(0,"h2"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"New amendment")))}function ti(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",20),h.hc("click",(function(){h.Ic(t);const e=h.lc(2);return e.navigateToMotion(e.previousMotion)})),h.Zb(2,"os-icon-container",21),h.Sc(3),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(3),h.Uc(" ",t.previousMotion.identifier," ")}}function ei(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",20),h.hc("click",(function(){h.Ic(t);const e=h.lc(2);return e.navigateToMotion(e.nextMotion)})),h.Zb(2,"os-icon-container",22),h.Sc(3),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(2),h.tc("swap",!0),h.Gb(1),h.Uc(" ",t.nextMotion.identifier," ")}}function ni(t,e){if(1&t&&(h.Zb(0,"div",19),h.Qc(1,ti,4,1,"div",2),h.Qc(2,ei,4,2,"div",2),h.Yb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.previousMotion),h.Gb(1),h.tc("ngIf",t.nextMotion)}}function ii(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const e=h.lc(3);return e.navigateToMotion(e.previousMotion)})),h.Zb(1,"mat-icon"),h.Sc(2,"chevron_left"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(4),h.Vc("",h.nc(5,2,"Motion")," ",t.previousMotion.identifier,"")}}function oi(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const e=h.lc(3);return e.navigateToMotion(e.nextMotion)})),h.Zb(1,"mat-icon"),h.Sc(2,"chevron_right"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(4),h.Vc("",h.nc(5,2,"Motion")," ",t.nextMotion.identifier,"")}}function ci(t,e){1&t&&h.Ub(0,"mat-divider")}function ai(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ii,6,4,"button",28),h.Qc(2,oi,6,4,"button",28),h.Qc(3,ci,1,0,"mat-divider",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.previousMotion),h.Gb(1),h.tc("ngIf",t.nextMotion),h.Gb(1),h.tc("ngIf",t.previousMotion||t.nextMotion)}}function si(t,e){1&t&&h.Ub(0,"mat-divider")}function ri(t,e){if(1&t&&h.Ub(0,"os-projector-button",23),2&t){const t=h.lc(2);h.tc("object",t.motion)("menuItem",!0)}}function li(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(3).addToAgenda()})),h.Zb(1,"mat-icon"),h.Sc(2,"add"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Add to agenda")))}function mi(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(3).removeFromAgenda()})),h.Zb(1,"mat-icon"),h.Sc(2,"remove"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Remove from agenda")))}function bi(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,li,6,3,"button",28),h.Qc(2,mi,6,3,"button",28),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.motion&&!t.motion.item),h.Gb(1),h.tc("ngIf",t.motion&&t.motion.item)}}const di=function(){return["/history"]},hi=function(t){return{element:t}};function gi(t,e){if(1&t&&(h.Zb(0,"button",30),h.Zb(1,"mat-icon"),h.Sc(2,"history"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.tc("routerLink",h.yc(5,di))("queryParams",h.zc(6,hi,t.motion.elementId)),h.Gb(4),h.Uc(" ",h.nc(5,3,"History")," ")}}function ui(t,e){1&t&&h.Ub(0,"mat-divider")}function pi(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(2).setEditMode(!0)})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Edit")))}function fi(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",31),h.hc("click",(function(){return h.Ic(t),h.lc(2).deleteMotionButton()})),h.Zb(1,"mat-icon"),h.Sc(2,"delete"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Delete")))}const vi=function(){return["core.can_manage_projector","agenda.can_manage","core.can_see_history"]};function Mi(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Qc(1,ai,4,3,"div",2),h.Ub(2,"os-speaker-button",23),h.Zb(3,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc().onDownloadPdf()})),h.Zb(4,"mat-icon"),h.Sc(5,"picture_as_pdf"),h.Yb(),h.Zb(6,"span"),h.Sc(7),h.mc(8,"translate"),h.Yb(),h.Yb(),h.Qc(9,si,1,0,"mat-divider",25),h.Qc(10,ri,1,2,"os-projector-button",26),h.Qc(11,bi,3,2,"div",25),h.Qc(12,gi,6,8,"button",27),h.Qc(13,ui,1,0,"mat-divider",2),h.Qc(14,pi,6,3,"button",28),h.Qc(15,fi,6,3,"button",29),h.Yb()}if(2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.vp.isMobile),h.Gb(1),h.tc("object",t.motion)("menuItem",!0),h.Gb(5),h.Tc(h.nc(8,11,"PDF")),h.Gb(2),h.tc("osPerms",h.yc(13,vi)),h.Gb(1),h.tc("osPerms","core.can_manage_projector"),h.Gb(1),h.tc("osPerms","agenda.can_manage"),h.Gb(1),h.tc("osPerms","core.can_see_history"),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("update",t.motion)||t.perms.isAllowed("manage")),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("update",t.motion)),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("manage"))}}function Ii(t,e){if(1&t){const t=h.ac();h.Zb(0,"span",39),h.hc("click",(function(){h.Ic(t);const e=h.lc(3);return e.gotoChangeRecommendation(e.getTitleChangingObject())})),h.Yb()}}function Si(t,e){if(1&t){const t=h.ac();h.Zb(0,"span",40),h.hc("click",(function(){return h.Ic(t),h.lc(3).createTitleChangeRecommendation()})),h.Yb()}}function Ci(t,e){if(1&t&&(h.Zb(0,"span"),h.Qc(1,Ii,1,0,"span",37),h.Qc(2,Si,1,0,"span",38),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.getTitleChangingObject()),h.Gb(1),h.tc("osPerms","motions.can_manage")("osPermsAnd",!t.getTitleChangingObject())}}function Ti(t,e){if(1&t&&(h.Zb(0,"span"),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Sc(4),h.Yb()),2&t){const t=h.lc(2);h.Gb(2),h.Tc(h.nc(3,2,"Sequential number")),h.Gb(2),h.Uc("\xa0",t.motion.id," ")}}function Gi(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xb7\xa0"),h.Yb())}const _i=function(){return{back:"true"}};function Yi(t,e){if(1&t&&(h.Zb(0,"span"),h.Zb(1,"span"),h.Zb(2,"span"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Sc(5,"\xa0"),h.Zb(6,"a",41),h.Sc(7),h.Yb(),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.Gb(3),h.Tc(h.nc(4,4,"Amendment to")),h.Gb(3),h.tc("routerLink",t.motion.parent.getDetailStateURL())("state",h.yc(6,_i)),h.Gb(1),h.Uc(" ",t.motion.parent.identifier||t.motion.parent.title," ")}}function wi(t,e){if(1&t){const t=h.ac();h.Zb(0,"div",32),h.Zb(1,"div",33),h.Zb(2,"h1",34),h.Qc(3,Ci,3,3,"span",2),h.Sc(4),h.Yb(),h.Zb(5,"button",35),h.hc("click",(function(){return h.Ic(t),h.lc().toggleFavorite()})),h.mc(6,"translate"),h.Zb(7,"mat-icon"),h.Sc(8),h.Yb(),h.Yb(),h.Yb(),h.Zb(9,"span",36),h.Qc(10,Ti,5,4,"span",2),h.Qc(11,Gi,2,0,"span",2),h.Qc(12,Yi,8,7,"span",2),h.Yb(),h.Yb()}if(2&t){const t=h.lc();h.Gb(3),h.tc("ngIf",t.titleCanBeChanged()),h.Gb(1),h.Uc(" ",t.getTitleWithChanges()," "),h.Gb(1),h.uc("matTooltip",h.nc(6,7,"Mark as personal favorite")),h.Gb(3),h.Tc(t.motion.star?"star":"star_border"),h.Gb(2),h.tc("ngIf",t.showSequential),h.Gb(1),h.tc("ngIf",t.showSequential&&t.motion.parent_id),h.Gb(1),h.tc("ngIf",t.motion.parent_id)}}function Zi(t,e){1&t&&h.Vb(0)}function xi(t,e){1&t&&h.Vb(0)}function Oi(t,e){1&t&&h.Vb(0)}function ki(t,e){if(1&t&&h.Ub(0,"os-motion-comments",47),2&t){const t=h.lc(3);h.tc("motion",t.motion)}}function yi(t,e){if(1&t&&h.Ub(0,"os-personal-note",47),2&t){const t=h.lc(3);h.tc("motion",t.motion)}}function Ri(t,e){if(1&t&&(h.Zb(0,"div",43),h.Zb(1,"div"),h.Qc(2,xi,1,0,"ng-container",44),h.Yb(),h.Zb(3,"mat-card",45),h.Qc(4,Oi,1,0,"ng-container",44),h.Yb(),h.Qc(5,ki,1,1,"os-motion-comments",46),h.Qc(6,yi,1,1,"os-personal-note",46),h.Yb()),2&t){const t=h.lc(2),e=h.Ec(21),n=h.Ec(23);h.Gb(2),h.tc("ngTemplateOutlet",e),h.Gb(1),h.tc("ngClass",t.editMotion?"os-form-card-mobile":"os-card"),h.Gb(1),h.tc("ngTemplateOutlet",n),h.Gb(1),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("ngIf",!t.editMotion&&!t.operator.isAnonymous)}}function Fi(t,e){if(1&t&&h.Qc(0,Ri,7,5,"div",42),2&t){const t=h.lc();h.tc("ngIf",t.motion)}}function Pi(t,e){1&t&&h.Vb(0)}function Ni(t,e){if(1&t&&h.Ub(0,"os-motion-comments",47),2&t){const t=h.lc(3);h.tc("motion",t.motion)}}function Li(t,e){if(1&t&&h.Ub(0,"os-personal-note",47),2&t){const t=h.lc(3);h.tc("motion",t.motion)}}function Ei(t,e){1&t&&h.Vb(0)}function Qi(t,e){if(1&t&&(h.Zb(0,"div",49),h.Zb(1,"div",50),h.Zb(2,"div"),h.Qc(3,Pi,1,0,"ng-container",44),h.Yb(),h.Qc(4,Ni,1,1,"os-motion-comments",46),h.Qc(5,Li,1,1,"os-personal-note",46),h.Yb(),h.Zb(6,"div",51),h.Zb(7,"mat-card",45),h.Qc(8,Ei,1,0,"ng-container",44),h.Yb(),h.Yb(),h.Yb()),2&t){const t=h.lc(2),e=h.Ec(21),n=h.Ec(23);h.Gb(3),h.tc("ngTemplateOutlet",e),h.Gb(1),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("ngIf",!t.editMotion&&!t.operator.isAnonymous),h.Gb(2),h.tc("ngClass",t.editMotion?"os-form-card":"os-card"),h.Gb(1),h.tc("ngTemplateOutlet",n)}}function Ai(t,e){if(1&t&&h.Qc(0,Qi,9,5,"div",48),2&t){const t=h.lc();h.tc("ngIf",t.motion)}}function Ui(t,e){if(1&t&&(h.Zb(0,"div"),h.Ub(1,"os-manage-submitters",47),h.Yb()),2&t){const t=h.lc(3);h.Gb(1),h.tc("motion",t.motion)}}function ji(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,Ui,2,1,"div",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",!t.editMotion)}}function Vi(t,e){1&t&&(h.Zb(0,"h4"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Supporters")))}function Di(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",56),h.hc("click",(function(){return h.Ic(t),h.lc(3).support()})),h.Zb(1,"mat-icon"),h.Sc(2,"thumb_up"),h.Yb(),h.Sc(3),h.mc(4,"translate"),h.Yb()}2&t&&(h.Gb(3),h.Uc(" ",h.nc(4,1,"Support")," "))}function Bi(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",56),h.hc("click",(function(){return h.Ic(t),h.lc(3).unsupport()})),h.Zb(1,"mat-icon"),h.Sc(2,"thumb_down"),h.Yb(),h.Sc(3),h.mc(4,"translate"),h.Yb()}2&t&&(h.Gb(3),h.Uc(" ",h.nc(4,1,"Unsupport")," "))}function $i(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",57),h.hc("click",(function(){return h.Ic(t),h.lc(3).openSupportersDialog()})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(1),h.Vc(" ",t.motion.supporters.length," ",h.nc(2,2,"supporters")," ")}}function qi(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,", "),h.Yb())}function zi(t,e){if(1&t&&(h.Zb(0,"span"),h.Sc(1),h.Qc(2,qi,2,0,"span",2),h.Yb()),2&t){const t=e.$implicit,n=e.last;h.Gb(1),h.Uc(" ",t.full_name,""),h.Gb(1),h.tc("ngIf",!n)}}function Wi(t,e){if(1&t&&(h.Zb(0,"p",58),h.Qc(1,zi,3,2,"span",59),h.Yb()),2&t){const t=h.lc(3);h.Gb(1),h.tc("ngForOf",t.motion.supporters)}}function Hi(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,Vi,3,3,"h4",2),h.Qc(2,Di,5,3,"button",53),h.Qc(3,Bi,5,3,"button",53),h.Qc(4,$i,3,4,"button",54),h.Qc(5,Wi,2,1,"p",55),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("support",t.motion)||t.motion.hasSupporters()),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("support",t.motion)),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("unsupport",t.motion)),h.Gb(1),h.tc("ngIf",t.motion.hasSupporters()),h.Gb(1),h.tc("ngIf",t.showSupporters)}}function Xi(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xa0..."),h.Yb())}function Ki(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(4).setState(n.id)})),h.Sc(1),h.mc(2,"translate"),h.Qc(3,Xi,2,0,"span",2),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(1),h.Uc(" ",h.nc(2,2,t.name)," "),h.Gb(2),h.tc("ngIf",t.show_state_extension_field)}}function Ji(t,e){1&t&&h.Ub(0,"mat-divider")}function to(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xa0..."),h.Yb())}function eo(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(4).setState(n.id)})),h.Zb(1,"mat-icon"),h.Sc(2,"arrow_back"),h.Yb(),h.Sc(3),h.mc(4,"translate"),h.Qc(5,to,2,0,"span",2),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(3),h.Uc(" ",h.nc(4,2,t.name)," "),h.Gb(2),h.tc("ngIf",t.show_state_extension_field)}}function no(t,e){if(1&t){const t=h.ac();h.Zb(0,"span",62),h.Qc(1,Ki,4,4,"button",63),h.Zb(2,"div"),h.Qc(3,Ji,1,0,"mat-divider",2),h.Qc(4,eo,6,4,"button",63),h.Zb(5,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(3).setState(null)})),h.Zb(6,"mat-icon"),h.Sc(7,"replay"),h.Yb(),h.Sc(8),h.mc(9,"translate"),h.Yb(),h.Yb(),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(1),h.tc("ngForOf",t.motion.state.next_states),h.Gb(2),h.tc("ngIf",t.motion.state.next_states.length>0),h.Gb(1),h.tc("ngForOf",t.motion.state.previous_states),h.Gb(4),h.Uc(" ",h.nc(9,4,"Reset state")," ")}}function io(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"os-extension-field",60),h.hc("success",(function(e){return h.Ic(t),h.lc(2).setStateExtension(e)})),h.mc(2,"translate"),h.mc(3,"translate"),h.Qc(4,no,10,6,"span",61),h.Yb(),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(1),h.uc("title",h.nc(2,8,"State")),h.uc("extensionLabel",h.nc(3,10,"Extension")),h.tc("canBeEdited",t.perms.isAllowed("change_state",t.motion))("hasExtension",t.motion.state&&t.motion.state.show_state_extension_field)("chipValue",t.stateLabel)("inputValue",t.newStateExtension)("classes",t.motion.stateCssColor),h.Gb(3),h.tc("ngIf",t.motion.state)}}function oo(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"\xa0..."),h.Yb())}function co(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(3).setRecommendation(n.id)})),h.Sc(1),h.mc(2,"translate"),h.Qc(3,oo,2,0,"span",2),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(1),h.Uc(" ",h.nc(2,2,t.recommendation_label)," "),h.Gb(2),h.tc("ngIf",t.show_recommendation_extension_field)}}function ao(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",66),h.hc("click",(function(){return h.Ic(t),h.lc(3).onFollowRecButton()})),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"Follow recommendation")))}function so(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"os-extension-field",64),h.hc("success",(function(e){return h.Ic(t),h.lc(2).setRecommendationExtension(e)})),h.mc(2,"translate"),h.mc(3,"translate"),h.Zb(4,"span",62),h.Qc(5,co,4,4,"button",63),h.Ub(6,"mat-divider"),h.Zb(7,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(2).setRecommendation(null)})),h.Zb(8,"mat-icon"),h.Sc(9,"replay"),h.Yb(),h.Sc(10),h.mc(11,"translate"),h.Yb(),h.Yb(),h.Yb(),h.Qc(12,ao,4,3,"button",65),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(1),h.uc("title",t.recommender),h.uc("extensionLabel",h.nc(2,11,"Extension")),h.uc("searchListLabel",h.nc(3,13,"Motions")),h.tc("inputValue",t.recommendationStateExtension)("canBeEdited",t.perms.isAllowed("change_metadata",t.motion))("chipValue",t.recommendationLabel)("hasExtension",t.motion.recommendation&&t.motion.recommendation.show_recommendation_extension_field)("searchList",t.motionObserver),h.Gb(4),h.tc("ngForOf",t.motion.possibleRecommendations),h.Gb(5),h.Uc(" ",h.nc(11,15,"Reset recommendation")," "),h.Gb(2),h.tc("ngIf",t.canFollowRecommendation())}}function ro(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1," \xb7 "),h.Yb())}function lo(t,e){if(1&t&&(h.Zb(0,"span"),h.Zb(1,"a",67),h.Sc(2),h.Yb(),h.Qc(3,ro,2,0,"span",2),h.Yb()),2&t){const t=e.$implicit,n=e.last;h.Gb(1),h.tc("routerLink",t.getDetailStateURL()),h.Gb(1),h.Tc(t.identifierOrTitle),h.Gb(1),h.tc("ngIf",!n)}}function mo(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"h4"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Qc(4,lo,4,3,"span",59),h.Yb()),2&t){const t=h.lc(2);h.Gb(2),h.Tc(h.nc(3,2,"Referring motions")),h.Gb(2),h.tc("ngForOf",t.recommendationReferencingMotions)}}function bo(t,e){1&t&&(h.Zb(0,"h4"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Category")))}function ho(t,e){1&t&&(h.Zb(0,"mat-icon"),h.Sc(1,"check"),h.Yb())}function go(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(3).setCategory(n.id)})),h.Qc(1,ho,2,0,"mat-icon",2),h.Sc(2),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(3);h.Gb(1),h.tc("ngIf",n.motion.category_id===t.id),h.Gb(1),h.Uc(" ",t.prefixedNameWithParents," ")}}function uo(t,e){if(1&t&&(h.Zb(0,"div"),h.Sc(1),h.Yb()),2&t){const t=h.lc(5);h.Gb(1),h.Uc(" ",t.motion.category.parent," ")}}function po(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc("",h.nc(2,1,"Subcategory"),":"))}function fo(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,uo,2,1,"div",2),h.Qc(2,po,3,3,"span",2),h.Sc(3),h.Yb()),2&t){const t=h.lc(4);h.Gb(1),h.tc("ngIf",t.motion.category.parent),h.Gb(1),h.tc("ngIf",t.motion.category.parent),h.Gb(1),h.Uc(" ",t.motion.category," ")}}function vo(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"-"),h.Yb())}function Mo(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",71),h.Qc(1,fo,4,3,"div",2),h.Qc(2,vo,2,0,"span",2),h.Yb()),2&t){h.lc();const t=h.Ec(3),e=h.lc(2);h.tc("matMenuTriggerFor",t),h.Gb(1),h.tc("ngIf",e.motion.category),h.Gb(1),h.tc("ngIf",!e.motion.category)}}function Io(t,e){if(1&t&&(h.Zb(0,"div"),h.Sc(1),h.Yb()),2&t){const t=h.lc(5);h.Gb(1),h.Uc(" ",t.motion.category.parent," ")}}function So(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc("",h.nc(2,1,"Subcategory"),":"))}function Co(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,Io,2,1,"div",2),h.Qc(2,So,3,3,"span",2),h.Sc(3),h.Yb()),2&t){const t=h.lc(4);h.Gb(1),h.tc("ngIf",t.motion.category.parent),h.Gb(1),h.tc("ngIf",t.motion.category.parent),h.Gb(1),h.Uc(" ",t.motion.category," ")}}function To(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",72),h.Qc(1,Co,4,3,"div",2),h.Yb()),2&t){const t=h.lc(3);h.Gb(1),h.tc("ngIf",t.motion.category)}}function Go(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,bo,3,3,"h4",2),h.Zb(2,"mat-menu",null,68),h.Qc(4,go,3,2,"button",63),h.Yb(),h.Qc(5,Mo,3,3,"mat-basic-chip",69),h.Qc(6,To,2,1,"mat-basic-chip",70),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)||t.motion.category),h.Gb(3),h.tc("ngForOf",t.categoryObserver.value),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)),h.Gb(1),h.tc("ngIf",!t.perms.isAllowed("change_metadata",t.motion)&&t.motion.category)}}function _o(t,e){1&t&&(h.Zb(0,"h4"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Tags")))}function Yo(t,e){1&t&&(h.Zb(0,"mat-icon"),h.Sc(1,"check"),h.Yb())}function wo(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(n){h.Ic(t);const i=e.$implicit;return h.lc(4).setTag(n,i.id)})),h.Qc(1,Yo,2,0,"mat-icon",2),h.Sc(2),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(4);h.Gb(1),h.tc("ngIf",n.motion.tags.includes(t)),h.Gb(1),h.Uc(" ",t," ")}}function Zo(t,e){1&t&&(h.Zb(0,"mat-basic-chip",78),h.Sc(1),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ","\u2013"," "))}function xo(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",78),h.Sc(1),h.Yb()),2&t){const t=e.$implicit;h.Gb(1),h.Uc(" ",t," ")}}function Oo(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"mat-menu",null,73),h.Qc(3,wo,3,2,"button",63),h.Yb(),h.Zb(4,"div",74),h.Qc(5,Zo,2,1,"mat-basic-chip",75),h.Zb(6,"mat-chip-list",76),h.Qc(7,xo,2,1,"mat-basic-chip",77),h.Yb(),h.Yb(),h.Yb()),2&t){const t=h.Ec(2),e=h.lc(3);h.Gb(3),h.tc("ngForOf",e.tagObserver.value),h.Gb(1),h.tc("matMenuTriggerFor",t),h.Gb(1),h.tc("ngIf",!e.motion.hasTags()),h.Gb(2),h.tc("ngForOf",e.motion.tags)}}function ko(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",72),h.Sc(1),h.Yb()),2&t){const t=e.$implicit;h.Gb(1),h.Uc(" ",t," ")}}function yo(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"mat-chip-list",76),h.Qc(2,ko,2,1,"mat-basic-chip",79),h.Yb(),h.Yb()),2&t){const t=h.lc(3);h.Gb(2),h.tc("ngForOf",t.motion.tags)}}function Ro(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,_o,3,3,"h4",2),h.Qc(2,Oo,8,4,"div",2),h.Qc(3,yo,3,1,"div",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)||t.motion.hasTags()),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)),h.Gb(1),h.tc("ngIf",!t.perms.isAllowed("change_metadata",t.motion))}}function Fo(t,e){1&t&&(h.Zb(0,"h4"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"Motion block")," "))}function Po(t,e){1&t&&(h.Zb(0,"mat-icon"),h.Sc(1,"check"),h.Yb())}function No(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(3).setBlock(n.id)})),h.Qc(1,Po,2,0,"mat-icon",2),h.Sc(2),h.Yb()}if(2&t){const t=e.$implicit,n=h.lc(3);h.Gb(1),h.tc("ngIf",n.motion.motion_block_id===t.id),h.Gb(1),h.Uc(" ",t," ")}}function Lo(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",82),h.Sc(1),h.Yb()),2&t){h.lc();const t=h.Ec(3),e=h.lc(2);h.tc("matMenuTriggerFor",t),h.Gb(1),h.Uc(" ",e.motion.motion_block||"\u2013"," ")}}function Eo(t,e){if(1&t&&(h.Zb(0,"mat-basic-chip",72),h.Sc(1),h.Yb()),2&t){const t=h.lc(3);h.Gb(1),h.Uc(" ",t.motion.motion_block," ")}}function Qo(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,Fo,3,3,"h4",2),h.Zb(2,"mat-menu",null,80),h.Qc(4,No,3,2,"button",63),h.Yb(),h.Qc(5,Lo,2,2,"mat-basic-chip",81),h.Qc(6,Eo,2,1,"mat-basic-chip",70),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)||t.motion.motion_block),h.Gb(3),h.tc("ngForOf",t.blockObserver.value),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion)),h.Gb(1),h.tc("ngIf",!t.perms.isAllowed("change_metadata",t.motion)&&t.motion.motion_block)}}function Ao(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"h4"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Sc(4),h.Yb()),2&t){const t=h.lc(2);h.Gb(2),h.Tc(h.nc(3,2,"Origin")),h.Gb(2),h.Uc(" ",t.motion.origin," ")}}function Uo(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Amendment")))}function jo(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Amendments")))}function Vo(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-checkbox",84),h.hc("ngModelChange",(function(e){return h.Ic(t),h.lc(3).showAllAmendments=e})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc(3);h.tc("ngModel",t.showAllAmendments),h.Gb(1),h.Uc(" ",h.nc(2,2,"Show all changes")," ")}}const Do=function(t){return["/motions/amendments",t]};function Bo(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"h4"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Zb(4,"a",41),h.Sc(5),h.Qc(6,Uo,3,3,"span",2),h.Qc(7,jo,3,3,"span",2),h.Yb(),h.Ub(8,"br"),h.Qc(9,Vo,3,4,"mat-checkbox",83),h.Yb()),2&t){const t=h.lc(2);h.Gb(2),h.Tc(h.nc(3,7,"Amendments")),h.Gb(2),h.tc("routerLink",h.zc(9,Do,t.motion.id))("state",h.yc(11,_i)),h.Gb(1),h.Uc(" ",t.amendments.length," "),h.Gb(1),h.tc("ngIf",1===t.amendments.length),h.Gb(1),h.tc("ngIf",t.amendments.length>1),h.Gb(2),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.Diff))}}function $o(t,e){1&t&&h.Ub(0,"os-motion-poll",88),2&t&&h.tc("poll",e.$implicit)}function qo(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",89),h.hc("click",(function(){return h.Ic(t),h.lc(3).openDialog()})),h.Zb(1,"mat-icon",90),h.Sc(2,"add"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"New vote")))}function zo(t,e){if(1&t&&(h.Zb(0,"div",85),h.Qc(1,$o,1,1,"os-motion-poll",86),h.Qc(2,qo,6,3,"button",87),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngForOf",t.motion.polls)("ngForTrackBy",t.trackByIndex),h.Gb(1),h.tc("ngIf",t.perms.isAllowed("createpoll",t.motion))}}function Wo(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ji,2,1,"div",2),h.Qc(2,Hi,6,5,"div",2),h.Qc(3,io,5,12,"div",2),h.Qc(4,so,13,17,"div",2),h.Qc(5,mo,5,4,"div",2),h.Qc(6,Go,7,4,"div",2),h.Qc(7,Ro,4,3,"div",2),h.Qc(8,Qo,7,4,"div",2),h.Qc(9,Ao,5,4,"div",2),h.Qc(10,Bo,10,12,"div",2),h.Qc(11,zo,3,3,"div",52),h.Yb()),2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.motion.submitters||t.newMotion),h.Gb(1),h.tc("ngIf",t.minSupporters&&!t.editMotion),h.Gb(1),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("ngIf",(t.perms.isAllowed("change_metadata")||t.motion.recommendation)&&t.recommender&&t.motion.possibleRecommendations.length&&!t.editMotion),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.recommendationReferencingMotions.length>0&&t.showReferringMotions),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.categoryObserver.value.length),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.tagObserver.value.length>0),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.blockObserver.value.length>0),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.motion.origin),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.amendments&&t.amendments.length>0),h.Gb(1),h.tc("ngIf",!t.editMotion)}}function Ho(t,e){1&t&&(h.Zb(0,"mat-error"),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Tc(h.nc(2,1,"Invalid line number")))}function Xo(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",110),h.hc("click",(function(){h.Ic(t);const e=h.lc(4);return e.gotoHighlightedLine(e.highlightedLineTyping),e.highlightedLineTyping=""})),h.Zb(1,"mat-icon"),h.Sc(2,"redo"),h.Yb(),h.Yb()}}const Ko=function(){return{standalone:!0}};function Jo(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-form-field",107),h.Zb(1,"input",108),h.hc("ngModelChange",(function(e){return h.Ic(t),h.lc(3).highlightedLineTyping=e})),h.mc(2,"translate"),h.Yb(),h.Qc(3,Ho,3,3,"mat-error",2),h.Qc(4,Xo,3,0,"button",109),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(1),h.uc("placeholder",h.nc(2,6,"Go to line")),h.tc("ngModel",t.highlightedLineTyping)("ngModelOptions",h.yc(8,Ko))("errorStateMatcher",t.highlightedLineMatcher),h.Gb(2),h.tc("ngIf",t.highlightedLineTyping>10),h.Gb(1),h.tc("ngIf",t.highlightedLineTyping)}}function tc(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",111),h.hc("click",(function(){return h.Ic(t),h.lc(3).highlightedLineOpened=!1})),h.Zb(1,"mat-icon"),h.Sc(2,"cancel"),h.Yb(),h.Yb()}}function ec(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1," \xa0("),h.Zb(2,"span"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Sc(5,") "),h.Yb()),2&t&&(h.Gb(3),h.Tc(h.nc(4,1,"none")))}function nc(t,e){if(1&t&&(h.Zb(0,"button",105),h.Zb(1,"mat-icon"),h.Sc(2,"rate_review"),h.Yb(),h.Sc(3," \xa0"),h.Zb(4,"span"),h.Sc(5),h.mc(6,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(3),e=h.Ec(30);h.tc("matMenuTriggerFor",e),h.Gb(5),h.Tc(h.nc(6,2,t.verboseChangeRecoMode[t.crMode]))}}function ic(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",116),h.hc("click",(function(){return h.Ic(t),h.lc(4).createModifiedFinalVersion()})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"file_copy"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Create final print template"))}function oc(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",117),h.hc("click",(function(){return h.Ic(t),h.lc(4).editModifiedFinal()})),h.Zb(1,"mat-icon"),h.Sc(2,"edit"),h.Yb(),h.Yb()}}function cc(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",118),h.hc("click",(function(){return h.Ic(t),h.lc(4).onSubmitFinalVersion()})),h.Zb(1,"mat-icon"),h.Sc(2,"save"),h.Yb(),h.Yb()}if(2&t){const t=h.lc(4);h.tc("disabled",!t.finalVersionEdited)}}function ac(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",117),h.hc("click",(function(){return h.Ic(t),h.lc(4).cancelFinalVersionEdit()})),h.Zb(1,"mat-icon"),h.Sc(2,"close"),h.Yb(),h.Yb()}}function sc(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",119),h.hc("click",(function(){return h.Ic(t),h.lc(4).deleteModifiedFinalVersion()})),h.mc(1,"translate"),h.Zb(2,"mat-icon"),h.Sc(3,"delete"),h.Yb(),h.Yb()}2&t&&h.uc("matTooltip",h.nc(1,1,"Delete final print template"))}function rc(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ic,4,3,"button",112),h.Qc(2,oc,3,0,"button",113),h.Qc(3,cc,3,1,"button",114),h.Qc(4,ac,3,0,"button",113),h.Qc(5,sc,4,3,"button",115),h.Yb()),2&t){const t=h.lc(3);h.Gb(1),h.tc("ngIf",t.motion.state.isFinalState&&!t.motion.modified_final_version),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.ModifiedFinal)&&!t.isFinalEdit),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.ModifiedFinal)&&t.isFinalEdit),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.ModifiedFinal)&&t.isFinalEdit),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.ModifiedFinal)&&!t.isFinalEdit)}}function lc(t,e){if(1&t&&(h.Zb(0,"div",101),h.Zb(1,"div",102),h.Qc(2,Jo,5,9,"mat-form-field",103),h.Qc(3,tc,3,0,"button",104),h.Zb(4,"button",105),h.Zb(5,"mat-icon"),h.Sc(6,"format_list_numbered"),h.Yb(),h.Sc(7," \xa0"),h.Zb(8,"span"),h.Sc(9),h.mc(10,"translate"),h.Yb(),h.Qc(11,ec,6,3,"span",2),h.Yb(),h.Qc(12,nc,7,4,"button",106),h.Yb(),h.Qc(13,rc,6,5,"div",25),h.Yb()),2&t){const t=h.lc(2),e=h.Ec(27);h.Gb(2),h.tc("ngIf",t.highlightedLineOpened),h.Gb(1),h.tc("ngIf",t.highlightedLineOpened),h.Gb(1),h.tc("matMenuTriggerFor",e),h.Gb(5),h.Tc(h.nc(10,7,"Line numbering")),h.Gb(2),h.tc("ngIf",t.lnMode===t.LineNumberingMode.None),h.Gb(1),h.tc("ngIf",t.motion&&(t.allChangingObjects&&t.allChangingObjects.length||t.motion.modified_final_version)),h.Gb(1),h.tc("osPerms","motions.can_manage")}}function mc(t,e){if(1&t&&(h.Zb(0,"mat-option",124),h.Sc(1),h.Yb()),2&t){const t=e.$implicit;h.tc("value",t.id),h.Gb(1),h.Uc(" ",t.title," ")}}function bc(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-form-field"),h.Zb(1,"mat-select",122),h.hc("valueChange",(function(e){return h.Ic(t),h.lc(3).onStatuteParagraphChange(e)})),h.mc(2,"translate"),h.Qc(3,mc,2,2,"mat-option",123),h.Yb(),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(1),h.tc("placeholder",h.nc(2,2,"Statute paragraph")),h.Gb(2),h.tc("ngForOf",t.statuteParagraphs)}}function dc(t,e){if(1&t){const t=h.ac();h.Zb(0,"div",120),h.Zb(1,"mat-checkbox",121),h.hc("change",(function(e){return h.Ic(t),h.lc(2).onStatuteAmendmentChange(e)})),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Qc(4,bc,4,4,"mat-form-field",2),h.Yb()}if(2&t){const t=h.lc(2);h.Gb(2),h.Uc(" ",h.nc(3,2,"Statute amendment")," "),h.Gb(2),h.tc("ngIf",t.contentForm.value.statute_amendment)}}function hc(t,e){if(1&t&&(h.Xb(0),h.Zb(1,"mat-form-field"),h.Ub(2,"os-search-value-selector",126),h.mc(3,"translate"),h.Yb(),h.Wb()),2&t){const t=h.lc(3);h.Gb(2),h.uc("placeholder",h.nc(3,3,"Submitters")),h.tc("multiple",!0)("inputListValues",t.submitterObserver)}}function gc(t,e){if(1&t&&(h.Zb(0,"div",125),h.Qc(1,hc,4,5,"ng-container",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion))}}function uc(t,e){1&t&&(h.Zb(0,"mat-form-field"),h.Ub(1,"input",128),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.uc("placeholder",h.nc(2,1,"Identifier")))}function pc(t,e){if(1&t&&(h.Zb(0,"div",127),h.Qc(1,uc,3,3,"mat-form-field",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.editMotion)}}function fc(t,e){1&t&&(h.Zb(0,"mat-form-field"),h.Ub(1,"input",130),h.mc(2,"translate"),h.Zb(3,"mat-error"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(1),h.uc("placeholder",h.nc(2,2,"Title")),h.Gb(3),h.Tc(h.nc(5,4,"The title is required")))}function vc(t,e){if(1&t&&(h.Zb(0,"div",129),h.Qc(1,fc,6,6,"mat-form-field",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.editMotion)}}function Mc(t,e){if(1&t&&(h.Zb(0,"span",131),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.Tc(h.nc(2,1,t.preamble))}}function Ic(t,e){if(1&t){const t=h.ac();h.Zb(0,"os-motion-detail-original-change-recommendations",137),h.hc("createChangeRecommendation",(function(e){return h.Ic(t),h.lc(4).createChangeRecommendation(e)}))("gotoChangeRecommendation",(function(e){return h.Ic(t),h.lc(4).gotoChangeRecommendation(e)})),h.Yb()}if(2&t){const t=h.lc(4);h.tc("html",t.getFormattedTextPlain())("changeRecommendations",t.changeRecommendations)}}function Sc(t,e){if(1&t&&(h.Ub(0,"div",138),h.mc(1,"trust")),2&t){const t=h.lc(4);h.tc("innerHTML",h.oc(1,1,t.getFormattedTextPlain(),"html"),h.Jc)}}function Cc(t,e){if(1&t&&(h.Zb(0,"div",134),h.Qc(1,Ic,1,2,"os-motion-detail-original-change-recommendations",135),h.Qc(2,Sc,2,4,"div",136),h.Yb()),2&t){const t=h.lc(3);h.Kb("line-numbers-none",t.isLineNumberingNone())("line-numbers-inline",t.isLineNumberingInline())("line-numbers-outside",t.isLineNumberingOutside()),h.Gb(1),h.tc("ngIf",t.isLineNumberingOutside()&&t.isRecoMode(t.ChangeRecoMode.Original)),h.Gb(1),h.tc("ngIf",!t.isLineNumberingOutside()||!t.isRecoMode(t.ChangeRecoMode.Original))}}function Tc(t,e){if(1&t){const t=h.ac();h.Zb(0,"os-motion-detail-diff",139),h.hc("createChangeRecommendation",(function(e){return h.Ic(t),h.lc(3).createChangeRecommendation(e)})),h.Yb()}if(2&t){const t=h.lc(3);h.tc("motion",t.motion)("changes",t.getChangesForDiffMode())("scrollToChange",t.scrollToChange)("highlightedLine",t.highlightedLine)("showAllAmendments",t.showAllAmendments)("lineNumberingMode",t.lnMode)}}function Gc(t,e){1&t&&(h.Zb(0,"div",142),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"This field is required.")," "))}function _c(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"editor",140),h.hc("onChange",(function(){return h.Ic(t),h.lc(3).detectChanges()})),h.Yb(),h.Qc(2,Gc,3,3,"div",141),h.Yb()}if(2&t){const t=h.lc(3);h.Gb(1),h.tc("hidden",!t.isFinalEdit)("init",t.tinyMceSettings),h.Gb(1),h.tc("ngIf",t.contentForm.get("modified_final_version").invalid&&(t.contentForm.get("modified_final_version").dirty||t.contentForm.get("modified_final_version").touched))}}function Yc(t,e){if(1&t&&(h.Xb(0),h.Qc(1,Cc,3,8,"div",132),h.Qc(2,Tc,1,6,"os-motion-detail-diff",133),h.Qc(3,_c,3,3,"div",2),h.Wb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",!t.isRecoMode(t.ChangeRecoMode.Diff)&&!t.isFinalEdit),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.Diff)),h.Gb(1),h.tc("ngIf",t.isFinalEdit)}}function wc(t,e){if(1&t&&(h.Ub(0,"div",143),h.mc(1,"trust")),2&t){const t=h.lc(2);h.tc("innerHTML",h.oc(1,1,t.getFormattedStatuteAmendment(),"html"),h.Jc)}}function Zc(t,e){1&t&&(h.Zb(0,"div",142),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"This field is required.")," "))}function xc(t,e){if(1&t){const t=h.ac();h.Xb(0),h.Zb(1,"editor",144),h.hc("ngModelChange",(function(){return h.Ic(t),h.lc(2).detectChanges()})),h.Yb(),h.Qc(2,Zc,3,3,"div",141),h.Wb()}if(2&t){const t=h.lc(2);h.Gb(1),h.tc("init",t.tinyMceSettings),h.Gb(1),h.tc("ngIf",t.contentForm.get("text").invalid&&(t.contentForm.get("text").dirty||t.contentForm.get("text").touched))}}function Oc(t,e){if(1&t&&(h.Zb(0,"span",147),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Vc(" ",h.nc(2,2,"Line")," ",t.lineFrom," ")}}function kc(t,e){if(1&t&&(h.Zb(0,"span",147),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t){const t=h.lc().$implicit;h.Gb(1),h.Wc(" ",h.nc(2,3,"Line")," ",t.lineFrom," - ",t.lineTo-1," ")}}function yc(t,e){1&t&&(h.Zb(0,"div",142),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"This field is required.")," "))}function Rc(t,e){if(1&t&&(h.Zb(0,"section"),h.Zb(1,"h3"),h.Qc(2,Oc,3,4,"span",145),h.Qc(3,kc,3,5,"span",145),h.Yb(),h.Ub(4,"editor",146),h.Qc(5,yc,3,3,"div",141),h.Yb()),2&t){const t=e.$implicit,n=h.lc(3);h.Gb(2),h.tc("ngIf",t.lineFrom>=t.lineTo-1),h.Gb(1),h.tc("ngIf",t.lineFrom<t.lineTo-1),h.Gb(1),h.tc("formControlName","text_"+t.paragraphNo)("init",n.tinyMceSettings),h.Gb(1),h.tc("ngIf",n.contentForm.get("text_"+t.paragraphNo).invalid&&(n.contentForm.get("text_"+t.paragraphNo).dirty||n.contentForm.get("text_"+t.paragraphNo).touched))}}function Fc(t,e){if(1&t&&(h.Xb(0),h.Qc(1,Rc,6,5,"section",59),h.Wb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngForOf",t.contentForm.value.selected_paragraphs)}}function Pc(t,e){1&t&&h.Vb(0)}function Nc(t,e){if(1&t&&(h.Xb(0),h.Qc(1,Pc,1,0,"ng-container",44),h.Wb()),2&t){h.lc(2);const t=h.Ec(25);h.Gb(1),h.tc("ngTemplateOutlet",t)}}function Lc(t,e){1&t&&(h.Zb(0,"span"),h.Sc(1,"*"),h.Yb())}function Ec(t,e){if(1&t&&(h.Ub(0,"div",150),h.mc(1,"trust")),2&t){const t=h.lc(3);h.tc("innerHtml",h.oc(1,1,t.motion.reason,"html"),h.Jc)}}function Qc(t,e){if(1&t&&h.Ub(0,"editor",151),2&t){const t=h.lc(3);h.tc("init",t.tinyMceSettings)("required",t.reasonRequired)}}function Ac(t,e){1&t&&(h.Zb(0,"div",142),h.Sc(1),h.mc(2,"translate"),h.Yb()),2&t&&(h.Gb(1),h.Uc(" ",h.nc(2,1,"This field is required.")," "))}function Uc(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"h3",45),h.Zb(2,"span"),h.Sc(3),h.mc(4,"translate"),h.Yb(),h.Sc(5,"\xa0"),h.Qc(6,Lc,2,0,"span",2),h.Yb(),h.Qc(7,Ec,2,4,"div",148),h.Qc(8,Qc,1,2,"editor",149),h.Qc(9,Ac,3,3,"div",141),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngClass",t.reasonRequired&&t.contentForm.get("reason").invalid&&(t.contentForm.get("reason").dirty||t.contentForm.get("reason").touched)?"red-warning-text":""),h.Gb(2),h.Tc(h.nc(4,6,"Reason")),h.Gb(3),h.tc("ngIf",t.reasonRequired&&t.editMotion),h.Gb(1),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("ngIf",t.editMotion),h.Gb(1),h.tc("ngIf",t.reasonRequired&&t.contentForm.get("reason").invalid&&(t.contentForm.get("reason").dirty||t.contentForm.get("reason").touched))}}function jc(t,e){if(1&t&&(h.Zb(0,"div",125),h.Zb(1,"mat-form-field"),h.Ub(2,"os-search-value-selector",152),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(2);h.Gb(2),h.uc("placeholder",h.nc(3,3,"Category")),h.tc("includeNone",!0)("inputListValues",t.categoryObserver)}}function Vc(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-list-item"),h.Zb(1,"a",155),h.hc("click",(function(){h.Ic(t);const n=e.$implicit;return h.lc(4).onClickAttachment(n)})),h.Sc(2),h.Yb(),h.Yb()}if(2&t){const t=e.$implicit;h.Gb(2),h.Tc(t.title)}}function Dc(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"h3"),h.Sc(2),h.mc(3,"translate"),h.Zb(4,"mat-icon"),h.Sc(5,"attach_file"),h.Yb(),h.Yb(),h.Zb(6,"mat-list",154),h.Qc(7,Vc,3,1,"mat-list-item",59),h.Yb(),h.Yb()),2&t){const t=h.lc(3);h.Gb(2),h.Tc(h.nc(3,2,"Attachments")),h.Gb(5),h.tc("ngForOf",t.motion.attachments)}}function Bc(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"os-attachment-control",156),h.hc("errorHandler",(function(e){return h.Ic(t),h.lc(3).showUploadError(e)})),h.Yb(),h.Yb()}}function $c(t,e){if(1&t&&(h.Zb(0,"div",125),h.Qc(1,Dc,8,4,"div",2),h.Qc(2,Bc,2,0,"div",153),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",!t.editMotion),h.Gb(1),h.tc("osPerms","motions.can_manage")("osPermsAnd",t.editMotion)}}function qc(t,e){if(1&t&&(h.Zb(0,"div"),h.Ub(1,"os-agenda-content-object-form",157),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("form",t.contentForm)}}function zc(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"mat-form-field"),h.Ub(2,"os-search-value-selector",158),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(3);h.Gb(2),h.uc("placeholder",h.nc(3,3,"Supporters")),h.tc("multiple",!0)("inputListValues",t.supporterObserver)}}function Wc(t,e){if(1&t&&(h.Zb(0,"div",125),h.Qc(1,zc,4,5,"div",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion))}}function Hc(t,e){if(1&t&&(h.Zb(0,"div"),h.Zb(1,"mat-form-field"),h.Ub(2,"os-search-value-selector",159),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t){const t=h.lc(3);h.Gb(2),h.uc("placeholder",h.nc(3,2,"Workflow")),h.tc("inputListValues",t.workflowObserver)}}function Xc(t,e){if(1&t&&(h.Zb(0,"div",125),h.Qc(1,Hc,4,4,"div",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion))}}function Kc(t,e){1&t&&(h.Zb(0,"div"),h.Zb(1,"mat-form-field"),h.Ub(2,"input",160),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.uc("placeholder",h.nc(3,1,"Origin")))}function Jc(t,e){if(1&t&&(h.Zb(0,"div",125),h.Qc(1,Kc,4,3,"div",2),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.perms.isAllowed("change_metadata",t.motion))}}function ta(t,e){if(1&t){const t=h.ac();h.Zb(0,"form",91),h.hc("keydown",(function(e){return h.Ic(t),h.lc().onKeyDown(e)})),h.Qc(1,lc,14,9,"div",92),h.Qc(2,dc,5,4,"div",93),h.Qc(3,gc,2,1,"div",94),h.Zb(4,"div",95),h.Qc(5,pc,2,1,"div",96),h.Qc(6,vc,2,1,"div",97),h.Yb(),h.Qc(7,Mc,3,3,"span",98),h.Qc(8,Yc,4,3,"ng-container",2),h.Qc(9,wc,2,4,"div",99),h.Qc(10,xc,3,2,"ng-container",2),h.Qc(11,Fc,2,1,"ng-container",2),h.Qc(12,Nc,2,1,"ng-container",2),h.Qc(13,Uc,10,8,"div",2),h.Qc(14,jc,4,5,"div",94),h.Zb(15,"div",100),h.Qc(16,$c,3,3,"div",94),h.Qc(17,qc,2,1,"div",2),h.Qc(18,Wc,2,1,"div",94),h.Qc(19,Xc,2,1,"div",94),h.Qc(20,Jc,2,1,"div",94),h.Yb(),h.Yb()}if(2&t){const t=h.lc();h.tc("formGroup",t.contentForm),h.Gb(1),h.tc("ngIf",!t.editMotion&&!t.motion.isStatuteAmendment()),h.Gb(1),h.tc("ngIf",t.newMotion&&t.statuteParagraphs.length>0&&t.statutesEnabled),h.Gb(1),h.tc("ngIf",t.newMotion),h.Gb(2),h.tc("ngIf",t.editMotion&&!t.newMotion&&t.perms.isAllowed("change_metadata",t.motion)),h.Gb(1),h.tc("ngIf",t.editMotion),h.Gb(1),h.tc("ngIf",!t.isRecoMode(t.ChangeRecoMode.Diff)),h.Gb(1),h.tc("ngIf",!t.editMotion&&!t.motion.isStatuteAmendment()&&!t.motion.isParagraphBasedAmendment()),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.motion.isStatuteAmendment()),h.Gb(1),h.tc("ngIf",t.motion&&t.editMotion&&!t.motion.isParagraphBasedAmendment()),h.Gb(1),h.tc("ngIf",t.motion&&t.editMotion&&t.motion.isParagraphBasedAmendment()),h.Gb(1),h.tc("ngIf",!t.editMotion&&t.motion.isParagraphBasedAmendment()),h.Gb(1),h.tc("ngIf",t.motion.reason||t.editMotion),h.Gb(1),h.tc("ngIf",t.newMotion&&t.categoryObserver.value.length>0),h.Gb(2),h.tc("ngIf",t.motion.hasAttachments()||t.editMotion),h.Gb(1),h.tc("ngIf",t.newMotion),h.Gb(1),h.tc("ngIf",t.editMotion&&t.minSupporters),h.Gb(1),h.tc("ngIf",t.editMotion&&t.workflowObserver.value.length>1),h.Gb(1),h.tc("ngIf",t.editMotion)}}function ea(t,e){1&t&&(h.Zb(0,"div",163),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"No changes at the text.")))}function na(t,e){if(1&t&&(h.Zb(0,"h3",168),h.Sc(1),h.Yb()),2&t){const t=h.lc().$implicit,e=h.lc(4);h.Gb(1),h.Uc(" ",e.getAmendmentParagraphLinesTitle(t)," ")}}function ia(t,e){if(1&t){const t=h.ac();h.Zb(0,"os-motion-detail-original-change-recommendations",137),h.hc("createChangeRecommendation",(function(e){return h.Ic(t),h.lc(5).createChangeRecommendation(e)}))("gotoChangeRecommendation",(function(e){return h.Ic(t),h.lc(5).gotoChangeRecommendation(e)})),h.Yb()}if(2&t){const t=h.lc().$implicit,e=h.lc(4);h.tc("html",e.getAmendmentDiffTextWithContext(t))("changeRecommendations",e.changeRecommendations)}}function oa(t,e){if(1&t&&(h.Ub(0,"div",169),h.mc(1,"trust")),2&t){const t=h.lc().$implicit,e=h.lc(4);h.tc("outerHTML",h.oc(1,1,e.getAmendmentDiffTextWithContext(t),"html"),h.Jc)}}function ca(t,e){if(1&t&&(h.Zb(0,"div",165),h.Qc(1,na,2,1,"h3",166),h.Qc(2,ia,1,2,"os-motion-detail-original-change-recommendations",135),h.Qc(3,oa,2,4,"div",167),h.Yb()),2&t){const t=h.lc(4);h.Kb("line-numbers-none",t.isLineNumberingNone())("line-numbers-inline",t.isLineNumberingInline())("line-numbers-outside",t.isLineNumberingOutside())("amendment-context",t.showAmendmentContext),h.Gb(1),h.tc("ngIf",!t.showAmendmentContext),h.Gb(1),h.tc("ngIf",t.isLineNumberingOutside()&&(t.isRecoMode(t.ChangeRecoMode.Original)||t.isRecoMode(t.ChangeRecoMode.Changed))),h.Gb(1),h.tc("ngIf",!t.isLineNumberingOutside()||!(t.isRecoMode(t.ChangeRecoMode.Original)||t.isRecoMode(t.ChangeRecoMode.Changed)))}}function aa(t,e){if(1&t&&(h.Xb(0),h.Qc(1,ca,4,11,"div",164),h.Wb()),2&t){const t=h.lc(3);h.Gb(1),h.tc("ngForOf",t.getAmendmentParagraphs())}}function sa(t,e){if(1&t){const t=h.ac();h.Zb(0,"os-motion-detail-diff",139),h.hc("createChangeRecommendation",(function(e){return h.Ic(t),h.lc(3).createChangeRecommendation(e)})),h.Yb()}if(2&t){const t=h.lc(3);h.tc("motion",t.motion)("changes",t.getChangesForDiffMode())("scrollToChange",t.scrollToChange)("highlightedLine",t.highlightedLine)("showAllAmendments",t.showAllAmendments)("lineNumberingMode",t.lnMode)}}function ra(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ea,4,3,"div",162),h.Qc(2,aa,2,1,"ng-container",2),h.Qc(3,sa,1,6,"os-motion-detail-diff",133),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",0===t.motion.diffLines.length),h.Gb(1),h.tc("ngIf",!t.isRecoMode(t.ChangeRecoMode.Diff)&&!t.isFinalEdit),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.Diff))}}function la(t,e){1&t&&(h.Zb(0,"div"),h.Zb(1,"span",142),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()),2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"There is an error with this amendment. Please edit it manually.")))}function ma(t,e){if(1&t){const t=h.ac();h.Zb(0,"mat-checkbox",171),h.hc("change",(function(){h.Ic(t);const e=h.lc(3);return e.showAmendmentContext=!e.showAmendmentContext})),h.Zb(1,"span"),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(2),h.Tc(h.nc(3,1,"Show entire motion text")))}function ba(t,e){if(1&t&&(h.Zb(0,"div"),h.Qc(1,ma,4,3,"mat-checkbox",170),h.Yb()),2&t){const t=h.lc(2);h.Gb(1),h.tc("ngIf",t.motion&&t.motion.isParagraphBasedAmendment())}}function da(t,e){if(1&t&&(h.Zb(0,"section",161),h.Qc(1,ra,4,3,"div",2),h.Qc(2,la,4,3,"div",2),h.Yb(),h.Qc(3,ba,2,1,"div",2)),2&t){const t=h.lc();h.Gb(1),h.tc("ngIf",t.motion.diffLines),h.Gb(1),h.tc("ngIf",!t.motion.diffLines),h.Gb(1),h.tc("ngIf",t.isRecoMode(t.ChangeRecoMode.Original)||t.isRecoMode(t.ChangeRecoMode.Changed))}}function ha(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",24),h.hc("click",(function(){return h.Ic(t),h.lc(2).highlightedLineOpened=!0})),h.Zb(1,"mat-icon"),h.Sc(2,"redo"),h.Yb(),h.Zb(3,"span"),h.Sc(4),h.mc(5,"translate"),h.Yb(),h.Yb()}2&t&&(h.Gb(4),h.Tc(h.nc(5,1,"Go to line")))}const ga=function(t){return{selected:t}};function ua(t,e){if(1&t){const t=h.ac();h.Zb(0,"div"),h.Zb(1,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setLineNumberingMode(e.LineNumberingMode.None)})),h.Sc(2),h.mc(3,"translate"),h.Yb(),h.Zb(4,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setLineNumberingMode(e.LineNumberingMode.Inside)})),h.Sc(5),h.mc(6,"translate"),h.Yb(),h.Zb(7,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setLineNumberingMode(e.LineNumberingMode.Outside)})),h.Sc(8),h.mc(9,"translate"),h.Yb(),h.Ub(10,"mat-divider"),h.Qc(11,ha,6,3,"button",28),h.Yb()}if(2&t){const t=h.lc();h.Gb(1),h.tc("ngClass",h.zc(13,ga,t.lnMode===t.LineNumberingMode.None)),h.Gb(1),h.Uc(" ",h.nc(3,7,"none")," "),h.Gb(2),h.tc("ngClass",h.zc(15,ga,t.lnMode===t.LineNumberingMode.Inside)),h.Gb(1),h.Uc(" ",h.nc(6,9,"inline")," "),h.Gb(2),h.tc("ngClass",h.zc(17,ga,t.lnMode===t.LineNumberingMode.Outside)),h.Gb(1),h.Uc(" ",h.nc(9,11,"outside")," "),h.Gb(3),h.tc("ngIf",!t.highlightedLineOpened)}}function pa(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setChangeRecoMode(e.ChangeRecoMode.Changed)})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc();h.tc("ngClass",h.zc(4,ga,t.crMode===t.ChangeRecoMode.Changed)),h.Gb(1),h.Uc(" ",h.nc(2,2,"Changed version")," ")}}function fa(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setChangeRecoMode(e.ChangeRecoMode.Diff)})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc();h.tc("ngClass",h.zc(4,ga,t.crMode===t.ChangeRecoMode.Diff)),h.Gb(1),h.Uc(" ",h.nc(2,2,"Diff version")," ")}}function va(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setChangeRecoMode(e.ChangeRecoMode.Final)})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc();h.tc("ngClass",h.zc(4,ga,t.crMode===t.ChangeRecoMode.Final)),h.Gb(1),h.Uc(" ",h.nc(2,2,"Final version")," ")}}function Ma(t,e){if(1&t){const t=h.ac();h.Zb(0,"button",17),h.hc("click",(function(){h.Ic(t);const e=h.lc();return e.setChangeRecoMode(e.ChangeRecoMode.ModifiedFinal)})),h.Sc(1),h.mc(2,"translate"),h.Yb()}if(2&t){const t=h.lc();h.tc("ngClass",h.zc(4,ga,t.crMode===t.ChangeRecoMode.ModifiedFinal)),h.Gb(1),h.Uc(" ",h.nc(2,2,"Final print template")," ")}}const Ia=[{path:"",component:(()=>{class t extends b.a{constructor(t,e,n,i,o,c,a,s,r,l,m,b,d,h,g,u,p,f,v,M,I,S,C,T,G,_,Y,w,Z,x,O,k,y){super(t,e,n),this.translate=e,this.vp=i,this.operator=o,this.perms=c,this.router=a,this.route=s,this.formBuilder=r,this.dialogService=l,this.el=m,this.repo=b,this.changeRecoRepo=d,this.statuteRepo=h,this.configService=g,this.promptService=u,this.pdfExport=p,this.personalNoteService=f,this.linenumberingService=v,this.categoryRepo=M,this.userRepo=I,this.notifyService=S,this.tagRepo=C,this.workflowRepo=T,this.blockRepo=G,this.itemRepo=_,this.motionSortService=Y,this.amendmentSortService=w,this.motionFilterService=Z,this.amendmentFilterService=x,this.cd=O,this.pollDialog=k,this.motionPollService=y,this.editMotion=!1,this.amendmentEdit=!1,this.newMotion=!1,this.motionLogExpanded=!1,this.finalEditMode=!1,this.amendmentChangeRecos={},this.amendmentChangeRecoSubscriptions={},this.allChangingObjects=[],this.statuteParagraphs=[],this.showSupporters=!1,this.scrollToChange=null,this.showAmendmentContext=!1,this.showAllAmendments=!1,this.ChangeRecoMode=et.b,this.verboseChangeRecoMode=et.k,this.LineNumberingMode=et.d,this.newStateExtension="",this.recommendationStateExtension="",this.NOTIFICATION_EDIT_MOTION="notifyEditMotion",this.otherWorkOnMotion=[],this.recommendationReferencingMotions=[]}set motion(t){this._motion=t,this.setupRecommender()}get motion(){return this._motion}get recommendationLabel(){return this.repo.getExtendedRecommendationLabel(this.motion)}get stateLabel(){return this.repo.getExtendedStateLabel(this.motion)}get isFinalEdit(){return this.finalEditMode}get finalVersionEdited(){return this.crMode===et.b.ModifiedFinal&&this.contentForm.get("modified_final_version").value!==this.motion.modified_final_version}ngOnInit(){this.tagObserver=this.tagRepo.getViewModelListBehaviorSubject(),this.workflowObserver=this.workflowRepo.getViewModelListBehaviorSubject(),this.blockObserver=this.blockRepo.getViewModelListBehaviorSubject(),this.motionObserver=this.repo.getViewModelListBehaviorSubject(),this.submitterObserver=this.userRepo.getViewModelListBehaviorSubject(),this.supporterObserver=this.userRepo.getViewModelListBehaviorSubject(),this.categoryObserver=this.categoryRepo.getViewModelListBehaviorSubject(),this.createForm(),this.observeRoute(),this.getMotionByUrl(),this.configService.get("motions_statutes_enabled").subscribe(t=>this.statutesEnabled=t),this.configService.get("motions_reason_required").subscribe(t=>this.reasonRequired=t),this.configService.get("motions_hide_referring_motions").subscribe(t=>this.showReferringMotions=!t),this.configService.get("motions_min_supporters").subscribe(t=>this.minSupporters=t),this.configService.get("motions_preamble").subscribe(t=>this.preamble=t),this.configService.get("motions_amendments_enabled").subscribe(t=>this.amendmentsEnabled=t),this.configService.get("motions_line_length").subscribe(t=>{this.lineLength=t,this.recalcUnifiedChanges()}),this.configService.get("motions_default_line_numbering").subscribe(t=>this.lnMode=t),this.configService.get("motions_recommendation_text_mode").subscribe(t=>{t&&(this.crMode=this.determineCrMode(t))}),this.configService.get("motions_show_sequential_numbers").subscribe(t=>this.showSequential=t),this.statuteRepo.getViewModelListObservable().subscribe(t=>{this.statuteParagraphs=t}),this.configService.instant("motions_amendments_main_table")?(this.motionFilterService.initFilters(this.motionObserver),this.motionSortService.initSorting(this.motionFilterService.outputObservable),this.sortedMotionsObservable=this.motionSortService.outputObservable):this.motion&&this.motion.parent_id?(this.amendmentFilterService.initFilters(this.repo.amendmentsTo(this.motion.parent_id)),this.amendmentSortService.initSorting(this.amendmentFilterService.outputObservable),this.sortedMotionsObservable=this.amendmentSortService.outputObservable):this.sortedMotions=[],this.sortedMotionsObservable&&this.subscriptions.push(this.sortedMotionsObservable.subscribe(t=>{t&&(this.sortedMotions=t,this.setSurroundingMotions())})),this.vp.isMobileSubject.subscribe(()=>{this.cd.markForCheck()})}ngOnDestroy(){this.unsubscribeEditNotifications(et.e.TYPE_CLOSING_EDITING_MOTION),this.navigationSubscription&&this.navigationSubscription.unsubscribe(),super.ngOnDestroy(),this.cd.detach()}observeRoute(){this.navigationSubscription=this.router.events.subscribe(t=>{t instanceof c.c&&(this.cleanSubjects(),this.getMotionByUrl())})}resetAmendmentChangeRecoListener(){this.amendments.forEach(t=>{void 0===this.amendmentChangeRecoSubscriptions[t.id]&&(this.amendmentChangeRecoSubscriptions[t.id]=this.changeRecoRepo.getChangeRecosOfMotionObservable(t.id).subscribe(e=>{this.amendmentChangeRecos[t.id]=e,this.recalcUnifiedChanges()}))})}recalcUnifiedChanges(){this.lineLength&&(this.allChangingObjects=[],this.changeRecommendations&&this.changeRecommendations.forEach(t=>{this.allChangingObjects.push(t)}),this.amendments&&this.amendments.filter(t=>t.isParagraphBasedAmendment()).forEach(t=>{const e=(this.amendmentChangeRecos[t.id]||[]).filter(t=>t.showInFinalView());this.repo.getAmendmentAmendedParagraphs(t,this.lineLength,e).forEach(t=>{this.allChangingObjects.push(t)})}),this.allChangingObjects.sort((t,e)=>t.getLineFrom()<e.getLineFrom()?-1:t.getLineFrom()>e.getLineFrom()?1:0),this.crMode&&(this.crMode=this.determineCrMode(this.crMode)),this.cd.markForCheck())}getMotionByUrl(){const t=this.route.snapshot.params;if(t&&t.id){const e=+t.id;this.subscriptions.push(this.repo.getViewModelObservable(e).subscribe(t=>{if(t){t.isParagraphBasedAmendment()&&(this.contentForm.get("text").clearValidators(),this.contentForm.get("text").updateValueAndValidity());const e=t.getTitle();super.setTitle(e),this.motion=t,this.newStateExtension=this.motion.stateExtension,this.recommendationStateExtension=this.motion.recommendationExtension,this.editMotion||this.patchForm(this.motion),this.cd.markForCheck()}}),this.repo.amendmentsTo(e).subscribe(t=>{this.amendments=t,this.resetAmendmentChangeRecoListener(),this.recalcUnifiedChanges()}),this.repo.getRecommendationReferencingMotions(e).subscribe(t=>this.recommendationReferencingMotions=t),this.changeRecoRepo.getChangeRecosOfMotionObservable(e).subscribe(t=>{this.changeRecommendations=t,this.recalcUnifiedChanges()}))}else{super.setTitle("New motion"),this.newMotion=!0,this.editMotion=!0;const t={};if(this.route.snapshot.queryParams.parent){this.amendmentEdit=!0;const e=this.repo.getViewModel(this.route.snapshot.queryParams.parent),n=`${this.translate.instant("Amendment to")} ${e.identifierOrTitle}`;t.title=n,t.parent_id=e.id,t.category_id=e.category_id,t.tags_id=e.tags_id,t.motion_block_id=e.motion_block_id,this.contentForm.patchValue({title:n,category_id:e.category_id,motion_block_id:e.motion_block_id,parent_id:e.id,tags_id:e.tags_id}),"fulltext"===this.configService.instant("motions_amendments_text_mode")&&(t.text=e.text,this.contentForm.patchValue({text:t.text}))}this.motion=new J(new d.a(t))}}patchForm(t){const e={};if(Object.keys(this.contentForm.controls).forEach(n=>{e[n]=t[n]}),t.isParagraphBasedAmendment()){e.selected_paragraphs=[];const n=this.repo.getViewModel(t.parent_id);n&&this.lineLength&&this.repo.getParagraphsToChoose(n,this.lineLength).forEach((n,i)=>{null!==t.amendment_paragraphs[i]&&(this.contentForm.addControl("text_"+i,new s.g("")),e.selected_paragraphs.push(n),e.text=t.amendment_paragraphs[i],e["text_"+i]=t.amendment_paragraphs[i])})}e.statute_amendment=t.isStatuteAmendment(),this.contentForm.patchValue(e)}createForm(){const t=[""];this.reasonRequired&&t.push(s.G.required),this.contentForm=this.formBuilder.group({identifier:[""],title:["",s.G.required],text:["",s.G.required],reason:t,category_id:[""],attachments_id:[[]],agenda_create:[""],agenda_parent_id:[],agenda_type:[""],submitters_id:[],supporters_id:[[]],workflow_id:[],tags_id:[],origin:[""],selected_paragraphs:[],statute_amendment:[""],statute_paragraph_id:[""],motion_block_id:[],parent_id:[],modified_final_version:[""]}),this.updateWorkflowIdForCreateForm();const e=this;this.highlightedLineMatcher=new class{isErrorState(t){const n=t&&t.value?t.value+"":"",i=e.repo.getLastLineNumber(e.motion,e.lineLength);return null!==n.match(/[^\d]/)||parseInt(n,10)>=i}}}onKeyDown(t){"Enter"===t.key&&t.shiftKey&&this.saveMotion()}onKeyNavigation(t){"ArrowLeft"===t.key&&t.altKey&&t.shiftKey&&this.navigateToMotion(this.previousMotion),"ArrowRight"===t.key&&t.altKey&&t.shiftKey&&this.navigateToMotion(this.nextMotion)}prepareMotionForSave(t,e){const n=new e;return this.motion.isParagraphBasedAmendment()&&(n.amendment_paragraphs=this.motion.amendment_paragraphs.map((e,n)=>null===e?null:t["text_"+n]),t.text=""),n.deserialize(t),n}createMotion(){return Object(a.a)(this,void 0,void 0,(function*(){const t=Object.assign({},this.contentForm.value);t.agenda_parent_id||delete t.agenda_parent_id;const e=this.prepareMotionForSave(t,d.a);try{const t=yield this.repo.create(e);this.router.navigate(["./motions/"+t.id])}catch(n){this.raiseError(this.translate.instant(n))}}))}updateMotionFromForm(){const t=Object.assign({},this.contentForm.value);this.updateMotion(t,this.motion).then(()=>{this.editMotion=!1,this.amendmentEdit=!1},this.raiseError)}updateMotion(t,e){return Object(a.a)(this,void 0,void 0,(function*(){const n=this.prepareMotionForSave(t,H.a);yield this.repo.update(n,e)}))}saveMotion(){this.newMotion?this.createMotion():(this.updateMotionFromForm(),this.unsubscribeEditNotifications(et.e.TYPE_SAVING_EDITING_MOTION))}getFormattedTextPlain(){const t=Object.assign([],this.getAllTextChangingObjects());return this.repo.formatMotion(this.motion.id,this.crMode,t,this.lineLength,this.highlightedLine)}getAmendmentDiffTextWithContext(t){return'<div class="paragraphcontext">'+t.textPre+"</div><div>"+t.text+'</div><div class="paragraphcontext">'+t.textPost+"</div>"}getAmendmentParagraphs(){return this.repo.getAmendmentParagraphLines(this.motion,this.lineLength,this.crMode,this.changeRecommendations,this.showAmendmentContext)}getAmendmentParagraphLinesTitle(t){return this.repo.getAmendmentParagraphLinesTitle(t)}getFormattedStatuteAmendment(){return this.repo.formatStatuteAmendment(this.statuteParagraphs,this.motion,this.lineLength)}getChangesForDiffMode(){return this.allChangingObjects.filter(t=>!!this.showAllAmendments||t.showInDiffView())}getChangesForFinalMode(){return this.allChangingObjects.filter(t=>t.showInFinalView())}getAllTextChangingObjects(){return this.allChangingObjects.filter(t=>!t.isTitleChange())}getTitleChangingObject(){return this.allChangingObjects.find(t=>t.isTitleChange())}getTitleWithChanges(){return this.changeRecoRepo.getTitleWithChanges(this.motion.title,this.getTitleChangingObject(),this.crMode)}deleteMotionButton(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete this motion?"),e=this.motion.getTitle();(yield this.promptService.open(t,e))&&(yield this.repo.delete(this.motion),this.router.navigate(["../motions/"]))}))}setLineNumberingMode(t){this.lnMode=t}isLineNumberingNone(){return this.lnMode===et.d.None}isLineNumberingInline(){return this.lnMode===et.d.Inside}isLineNumberingOutside(){return this.lnMode===et.d.Outside}setChangeRecoMode(t){this.crMode=t}isRecoMode(t){return this.crMode===t}gotoHighlightedLine(t){const e=this.repo.getLastLineNumber(this.motion,this.lineLength);t>=e||(this.highlightedLine=t,window.setTimeout(()=>{const e=this.el.nativeElement,n=e.querySelector(".os-line-number.line-number-"+t.toString(10)).getBoundingClientRect();if(n.top>=0&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight))return;let i;i=e.querySelector(t>4?".os-line-number.line-number-"+(t-4).toString(10):".title-line"),i.scrollIntoView({behavior:"smooth"})},1))}createChangeRecommendation(t){const e={editChangeRecommendation:!1,newChangeRecommendation:!0,lineRange:t,changeRecommendation:null};if(this.motion.isParagraphBasedAmendment()){const n=this.repo.getAllAmendmentParagraphsWithOriginalLineNumbers(this.motion,this.lineLength,!1);e.changeRecommendation=this.changeRecoRepo.createAmendmentChangeRecommendationTemplate(this.motion,n,t,this.lineLength)}else e.changeRecommendation=this.changeRecoRepo.createMotionChangeRecommendationTemplate(this.motion,t,this.lineLength);this.dialogService.open(ut,Object.assign(Object.assign({},X.c),{data:e}))}createTitleChangeRecommendation(){const t={editChangeRecommendation:!1,newChangeRecommendation:!0,changeRecommendation:this.changeRecoRepo.createTitleChangeRecommendationTemplate(this.motion,this.lineLength)};this.dialogService.open(vt,Object.assign(Object.assign({},X.a),{data:t}))}titleCanBeChanged(){return!this.editMotion&&!this.motion.isStatuteAmendment()&&!this.motion.isParagraphBasedAmendment()&&(this.isRecoMode(et.b.Original)||this.isRecoMode(et.b.Diff))}gotoChangeRecommendation(t){this.scrollToChange=t,this.setChangeRecoMode(et.b.Diff)}createAmendment(){"paragraph"===this.configService.instant("motions_amendments_text_mode")?this.router.navigate(["./create-amendment"],{relativeTo:this.route}):this.router.navigate(["./motions/new-amendment"],{relativeTo:this.route.snapshot.params.relativeTo,queryParams:{parent:this.motion.id||null}})}createModifiedFinalVersion(){return Object(a.a)(this,void 0,void 0,(function*(){const t=Object.assign([],this.getChangesForFinalMode());let e=this.repo.formatMotion(this.motion.id,et.b.Final,t,this.lineLength,this.highlightedLine);e=this.linenumberingService.stripLineNumbers(e);try{yield this.updateMotion({modified_final_version:e},this.motion)}catch(n){this.raiseError(n)}}))}deleteModifiedFinalVersion(){return Object(a.a)(this,void 0,void 0,(function*(){const t=this.translate.instant("Are you sure you want to delete the print template?");(yield this.promptService.open(t))&&(this.finalEditMode=!1,this.updateMotion({modified_final_version:""},this.motion).then(()=>this.setChangeRecoMode(et.b.Final),this.raiseError))}))}setEditMode(t){this.editMotion=t,t&&(this.patchForm(this.motion),this.editNotificationSubscription=this.listenToEditNotification(),this.sendEditNotification(et.e.TYPE_BEGIN_EDITING_MOTION)),!t&&this.newMotion&&this.router.navigate(["./motions/"]),t||this.newMotion||this.unsubscribeEditNotifications(et.e.TYPE_CLOSING_EDITING_MOTION)}updateWorkflowIdForCreateForm(t){const e=!!this.contentForm.get("statute_amendment").value&&!!t,n=this.configService.instant(e?"motions_statute_amendments_workflow":"motions_workflow");this.contentForm.patchValue({workflow_id:+n})}onStatuteAmendmentChange(t){this.contentForm.patchValue({statute_paragraph_id:null}),this.updateWorkflowIdForCreateForm()}onStatuteParagraphChange(t){const e=this.statuteParagraphs.find(e=>e.id===t);this.contentForm.patchValue({title:this.translate.instant("Statute amendment for")+" "+e.title,text:e.text}),this.updateWorkflowIdForCreateForm(t)}navigateToMotion(t){t&&(this.router.navigate(["../"+t.id],{relativeTo:this.route.parent}),this.motion=t,this.setSurroundingMotions())}setSurroundingMotions(){const t=this.sortedMotions.findIndex(t=>t===this.motion);this.previousMotion=t>0?this.sortedMotions[t-1]:null,this.nextMotion=t>-1&&t<this.sortedMotions.length-1?this.sortedMotions[t+1]:null,this.cd.markForCheck()}support(){this.repo.support(this.motion).catch(this.raiseError)}unsupport(){this.repo.unsupport(this.motion).catch(this.raiseError)}openSupportersDialog(){this.showSupporters=!this.showSupporters}setState(t){this.repo.setState(this.motion,t).catch(this.raiseError)}setStateExtension(t){this.repo.setStateExtension(this.motion,t)}setRecommendation(t){this.repo.setRecommendation(this.motion,t)}setRecommendationExtension(t){this.repo.setRecommendationExtension(this.motion,t)}setCategory(t){t===this.motion.category_id&&(t=null),this.repo.setCatetory(this.motion,t).catch(this.raiseError)}setTag(t,e){t.stopPropagation(),this.repo.setTag(this.motion,e).catch(this.raiseError)}setBlock(t){t===this.motion.motion_block_id&&(t=null),this.repo.setBlock(this.motion,t).catch(this.raiseError)}setupRecommender(){if(this.motion){const t=this.motion.isStatuteAmendment()?"motions_statute_recommendations_by":"motions_recommendations_by";this.recommenderSubscription&&this.recommenderSubscription.unsubscribe(),this.recommenderSubscription=this.configService.get(t).subscribe(t=>{this.recommender=t})}}onDownloadPdf(){this.pdfExport.exportSingleMotion(this.motion,{lnMode:this.lnMode===this.LineNumberingMode.Inside?this.LineNumberingMode.Outside:this.lnMode,crMode:this.crMode,comments:this.motion.commentSectionIds.concat([et.f])})}onClickAttachment(t){window.open(t.url)}canFollowRecommendation(){return!!(this.perms.isAllowed("createpoll",this.motion)&&this.motion.recommendation&&this.motion.recommendation.recommendation_label)}onFollowRecButton(){this.repo.followRecommendation(this.motion)}sendEditNotification(t,e){const n={motionId:this.motion.id,senderId:this.operator.viewUser.id,senderName:this.operator.viewUser.short_name,type:t};e?this.notifyService.sendToUsers(this.NOTIFICATION_EDIT_MOTION,n,e):this.notifyService.sendToAllUsers(this.NOTIFICATION_EDIT_MOTION,n)}determineCrMode(t){var e,n,i,o,c;if(t===et.b.Final){if(null===(e=this.motion)||void 0===e?void 0:e.modified_final_version)return et.b.ModifiedFinal;if(!(null===(n=this.allChangingObjects)||void 0===n?void 0:n.length))return et.b.Original}else{if(t===et.b.Changed&&!(null===(i=this.allChangingObjects)||void 0===i?void 0:i.length))return et.b.Original;if(t===et.b.Diff&&!(null===(o=this.changeRecommendations)||void 0===o?void 0:o.length)&&(null===(c=this.motion)||void 0===c?void 0:c.isParagraphBasedAmendment()))return et.b.Original}return t}listenToEditNotification(){return this.notifyService.getMessageObservable(this.NOTIFICATION_EDIT_MOTION).subscribe(t=>{const e=t.content;if(this.operator.viewUser.id!==e.senderId&&e.motionId===this.motion.id){let n="";switch(e.type){case et.e.TYPE_BEGIN_EDITING_MOTION:case et.e.TYPE_ALSO_EDITING_MOTION:this.otherWorkOnMotion.includes(e.senderName)||this.otherWorkOnMotion.push(e.senderName),n=`${this.translate.instant("Following users are currently editing this motion:")} ${this.otherWorkOnMotion}`,e.type===et.e.TYPE_BEGIN_EDITING_MOTION&&this.sendEditNotification(et.e.TYPE_ALSO_EDITING_MOTION,t.senderUserId);break;case et.e.TYPE_CLOSING_EDITING_MOTION:this.recognizeOtherWorkerOnMotion(e.senderName);break;case et.e.TYPE_SAVING_EDITING_MOTION:n=`${e.senderName} ${this.translate.instant("has saved his work on this motion.")}`,setTimeout(()=>this.recognizeOtherWorkerOnMotion(e.senderName),2e3)}""!==n&&this.raiseWarning(n)}})}recognizeOtherWorkerOnMotion(t){this.otherWorkOnMotion=this.otherWorkOnMotion.filter(e=>e!==t),0===this.otherWorkOnMotion.length&&this.closeSnackBar()}unsubscribeEditNotifications(t){this.editNotificationSubscription&&!this.editNotificationSubscription.closed&&(this.sendEditNotification(t),this.closeSnackBar(),this.editNotificationSubscription.unsubscribe())}onSubmitFinalVersion(){const t=this.contentForm.get("modified_final_version").value;this.updateMotion({modified_final_version:t},this.motion).then(()=>{this.finalEditMode=!1,this.contentForm.get("modified_final_version").markAsPristine()},this.raiseError)}cancelFinalVersionEdit(){this.finalEditMode=!1,this.contentForm.patchValue({modified_final_version:this.motion.modified_final_version})}toggleFavorite(){this.motion.personalNote?this.motion.personalNote.star=!this.motion.personalNote.star:this.motion.personalNote={note:"",star:!0},this.personalNoteService.savePersonalNote(this.motion,this.motion.personalNote).catch(this.raiseError)}showUploadError(t){this.raiseError(t)}stopClosing(t){this.editMotion&&(t.returnValue=null)}swipe(t,e){const n=[t.changedTouches[0].pageX,t.changedTouches[0].pageY],i=(new Date).getTime();if("start"===e)this.swipeCoord=n,this.swipeTime=i;else if("end"===e){const t=[n[0]-this.swipeCoord[0],n[1]-this.swipeCoord[1]];i-this.swipeTime<1e3&&Math.abs(t[0])>30&&Math.abs(t[0])>Math.abs(3*t[1])&&(t[0]>0&&this.navigateToMotion(this.previousMotion),t[0]<0&&this.navigateToMotion(this.nextMotion))}}editModifiedFinal(){this.finalEditMode=!0}addToAgenda(){this.itemRepo.addItemToAgenda(this.motion).catch(this.raiseError)}removeFromAgenda(){this.itemRepo.removeFromAgenda(this.motion.item).catch(this.raiseError)}detectChanges(){this.cd.markForCheck()}openDialog(){const t=Object.assign({collectionString:tt.a.COLLECTIONSTRING,motion_id:this.motion.id,motion:this.motion},this.motionPollService.getDefaultPollData(this.motion.id));this.pollDialog.openDialog(t)}}return t.\u0275fac=function(e){return new(e||t)(h.Tb(g.d),h.Tb(u.k),h.Tb(p.a),h.Tb(W.a),h.Tb(E.a),h.Tb(ot.a),h.Tb(c.f),h.Tb(c.a),h.Tb(s.f),h.Tb(mt.b),h.Tb(h.m),h.Tb(r.a),h.Tb(U.a),h.Tb(V.a),h.Tb(l.a),h.Tb(m.a),h.Tb(at.a),h.Tb(z.a),h.Tb(q.a),h.Tb(A.a),h.Tb($.a),h.Tb(L.a),h.Tb(B.a),h.Tb(D.a),h.Tb(j.a),h.Tb(Q.a),h.Tb(lt.a),h.Tb(it.a),h.Tb(ct.a),h.Tb(nt.a),h.Tb(h.h),h.Tb(st.a),h.Tb(rt.a))},t.\u0275cmp=h.Nb({type:t,selectors:[["os-motion-detail"]],hostBindings:function(t,e){1&t&&h.hc("keydown",(function(t){return e.onKeyNavigation(t)}),!1,h.Gc)("beforeunload",(function(t){return e.stopClosing(t)}),!1,h.Hc)},features:[h.Db],decls:38,vars:25,consts:[["mainActionTooltip","New amendment","prevUrl","../..",3,"hasMainButton","nav","editMode","isSaveButtonEnabled","mainEvent","cancelEditEvent","saveEvent"],[1,"title-slot"],[4,"ngIf"],["class","extra-controls-slot prev-next-motion-controls",4,"ngIf"],[1,"menu-slot"],["type","button","mat-icon-button","",3,"matMenuTriggerFor"],["motionExtraMenu","matMenu"],[1,"content-container","spacer-bottom-60",3,"touchstart","touchend"],["class","title",4,"ngIf"],[4,"ngIf","ngIfThen","ngIfElse"],["mobileView",""],["desktopView",""],["metaInfoTemplate",""],["contentTemplate",""],["paragraphBasedAmendment",""],["lineNumberingMenu","matMenu"],["changeRecoMenu","matMenu"],["mat-menu-item","",3,"ngClass","click"],["mat-menu-item","",3,"ngClass","click",4,"ngIf"],[1,"extra-controls-slot","prev-next-motion-controls"],["mat-button","",3,"click"],["icon","chevron_left"],["icon","chevron_right",3,"swap"],[3,"object","menuItem"],["mat-menu-item","",3,"click"],[4,"osPerms"],[3,"object","menuItem",4,"osPerms"],["mat-menu-item","",3,"routerLink","queryParams",4,"osPerms"],["mat-menu-item","",3,"click",4,"ngIf"],["mat-menu-item","","class","red-warning-text",3,"click",4,"ngIf"],["mat-menu-item","",3,"routerLink","queryParams"],["mat-menu-item","",1,"red-warning-text",3,"click"],[1,"title"],[1,"title-line"],[1,"motion-title"],["mat-icon-button","",1,"primary-accent-by-theme",3,"matTooltip","click"],[1,"main-nav-color","title-font"],["class","title-change-indicator",3,"click",4,"ngIf"],["class","change-title",3,"click",4,"osPerms","osPermsAnd"],[1,"title-change-indicator",3,"click"],[1,"change-title",3,"click"],[3,"routerLink","state"],["class","mobile-view",4,"ngIf"],[1,"mobile-view"],[4,"ngTemplateOutlet"],[3,"ngClass"],[3,"motion",4,"ngIf"],[3,"motion"],["class","desktop-view",4,"ngIf"],[1,"desktop-view"],[1,"desktop-left"],[1,"desktop-right"],["class","spacer-top-20 spacer-bottom-20",4,"ngIf"],["type","button","mat-stroked-button","","color","accent",3,"click",4,"ngIf"],["type","button","mat-button","",3,"click",4,"ngIf"],["class","supporters",4,"ngIf"],["type","button","mat-stroked-button","","color","accent",3,"click"],["type","button","mat-button","",3,"click"],[1,"supporters"],[4,"ngFor","ngForOf"],[3,"title","canBeEdited","hasExtension","chipValue","inputValue","classes","extensionLabel","success"],["class","trigger-menu",4,"ngIf"],[1,"trigger-menu"],["mat-menu-item","",3,"click",4,"ngFor","ngForOf"],["listValuePrefix","motion:",3,"title","inputValue","canBeEdited","chipValue","hasExtension","extensionLabel","searchList","searchListLabel","success"],["mat-stroked-button","","class","spacer-top-10",3,"click",4,"ngIf"],["mat-stroked-button","",1,"spacer-top-10",3,"click"],[1,"nowrap",3,"routerLink"],["categoryMenu","matMenu"],["class","grey multi-line-chip","disableRipple","",3,"matMenuTriggerFor",4,"ngIf"],["class","grey","disableRipple","",4,"ngIf"],["disableRipple","",1,"grey","multi-line-chip",3,"matMenuTriggerFor"],["disableRipple","",1,"grey"],["tagMenu","matMenu"],[3,"matMenuTriggerFor"],["class","grey","disabled","","disableRipple","",4,"ngIf"],[1,"mat-chip-list-stacked"],["class","grey","disabled","","disableRipple","",4,"ngFor","ngForOf"],["disabled","","disableRipple","",1,"grey"],["class","grey","disableRipple","",4,"ngFor","ngForOf"],["blockMenu","matMenu"],["class","grey","disableRipple","",3,"matMenuTriggerFor",4,"ngIf"],["disableRipple","",1,"grey",3,"matMenuTriggerFor"],[3,"ngModel","ngModelChange",4,"ngIf"],[3,"ngModel","ngModelChange"],[1,"spacer-top-20","spacer-bottom-20"],[3,"poll",4,"ngFor","ngForOf","ngForTrackBy"],["class","create-poll-button","create-poll-button","","mat-stroked-button","",3,"click",4,"ngIf"],[3,"poll"],["create-poll-button","","mat-stroked-button","",1,"create-poll-button",3,"click"],[1,"main-nav-color"],[1,"motion-content",3,"formGroup","keydown"],["class","motion-text-toolbar-wrapper",4,"ngIf"],["class","statute-amendment-selector",4,"ngIf"],["class","content-field",4,"ngIf"],[1,"form-id-title"],["class","content-field form-identifier",4,"ngIf"],["class","content-field form-title",4,"ngIf"],["class","text-prefix-label",4,"ngIf"],["class","motion-text line-numbers-none",3,"innerHTML",4,"ngIf"],[1,"extra-data"],[1,"motion-text-toolbar-wrapper"],[1,"motion-text-controls"],["class","motion-goto-line",4,"ngIf"],["mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-button","",3,"matMenuTriggerFor"],["type","button","mat-button","",3,"matMenuTriggerFor",4,"ngIf"],[1,"motion-goto-line"],["type","number","min","1","matInput","","osAutofocus","",3,"placeholder","ngModel","ngModelOptions","errorStateMatcher","ngModelChange"],["type","submit","mat-button","","matSuffix","","mat-icon-button","","aria-label","Go to line",3,"click",4,"ngIf"],["type","submit","mat-button","","matSuffix","","mat-icon-button","","aria-label","Go to line",3,"click"],["mat-icon-button","",3,"click"],["type","button","mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["type","button","mat-icon-button","",3,"click",4,"ngIf"],["type","button","mat-icon-button","",3,"disabled","click",4,"ngIf"],["type","button","class","red-warning-text","mat-icon-button","",3,"matTooltip","click",4,"ngIf"],["type","button","mat-icon-button","",3,"matTooltip","click"],["type","button","mat-icon-button","",3,"click"],["type","button","mat-icon-button","",3,"disabled","click"],["type","button","mat-icon-button","",1,"red-warning-text",3,"matTooltip","click"],[1,"statute-amendment-selector"],["formControlName","statute_amendment",3,"change"],["formControlName","statute_paragraph_id",3,"placeholder","valueChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"content-field"],["formControlName","submitters_id",3,"multiple","placeholder","inputListValues"],[1,"content-field","form-identifier"],["matInput","","autofocus","","formControlName","identifier",3,"placeholder"],[1,"content-field","form-title"],["matInput","","formControlName","title","required","",3,"placeholder"],[1,"text-prefix-label"],["class","motion-text",3,"line-numbers-none","line-numbers-inline","line-numbers-outside",4,"ngIf"],[3,"motion","changes","scrollToChange","highlightedLine","showAllAmendments","lineNumberingMode","createChangeRecommendation",4,"ngIf"],[1,"motion-text"],[3,"html","changeRecommendations","createChangeRecommendation","gotoChangeRecommendation",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[3,"html","changeRecommendations","createChangeRecommendation","gotoChangeRecommendation"],[3,"innerHTML"],[3,"motion","changes","scrollToChange","highlightedLine","showAllAmendments","lineNumberingMode","createChangeRecommendation"],["formControlName","modified_final_version","required","",3,"hidden","init","onChange"],["class","red-warning-text",4,"ngIf"],[1,"red-warning-text"],[1,"motion-text","line-numbers-none",3,"innerHTML"],["formControlName","text","required","",3,"init","ngModelChange"],["class","line-number",4,"ngIf"],[3,"formControlName","init"],[1,"line-number"],["class","motion-text",3,"innerHtml",4,"ngIf"],["formControlName","reason",3,"init","required",4,"ngIf"],[1,"motion-text",3,"innerHtml"],["formControlName","reason",3,"init","required"],["formControlName","category_id",3,"includeNone","placeholder","inputListValues"],[4,"osPerms","osPermsAnd"],["dense",""],[3,"routerLink","click"],["formControlName","attachments_id",3,"errorHandler"],[3,"form"],["formControlName","supporters_id",3,"multiple","placeholder","inputListValues"],["formControlName","workflow_id",3,"placeholder","inputListValues"],["matInput","","formControlName","origin",3,"placeholder"],[1,"text-holder"],["class","alert alert-info",4,"ngIf"],[1,"alert","alert-info"],["class","motion-text motion-text-diff amendment-view",3,"line-numbers-none","line-numbers-inline","line-numbers-outside","amendment-context",4,"ngFor","ngForOf"],[1,"motion-text","motion-text-diff","amendment-view"],["class","amendment-line-header",4,"ngIf"],[3,"outerHTML",4,"ngIf"],[1,"amendment-line-header"],[3,"outerHTML"],["class","show-entire-text-check",3,"change",4,"ngIf"],[1,"show-entire-text-check",3,"change"]],template:function(t,e){if(1&t&&(h.Zb(0,"os-head-bar",0),h.hc("mainEvent",(function(){return e.createAmendment()}))("cancelEditEvent",(function(){return e.setEditMode(!1)}))("saveEvent",(function(){return e.saveMotion()})),h.Zb(1,"div",1),h.Qc(2,Xn,8,5,"h2",2),h.Qc(3,Kn,3,3,"h2",2),h.Qc(4,Jn,3,3,"h2",2),h.Yb(),h.Qc(5,ni,3,2,"div",3),h.Zb(6,"div",4),h.Zb(7,"button",5),h.Zb(8,"mat-icon"),h.Sc(9,"more_vert"),h.Yb(),h.Yb(),h.Yb(),h.Zb(10,"mat-menu",null,6),h.Qc(12,Mi,16,14,"div",2),h.Yb(),h.Yb(),h.Zb(13,"div",7),h.hc("touchstart",(function(t){return e.swipe(t,"start")}))("touchend",(function(t){return e.swipe(t,"end")})),h.Qc(14,wi,13,9,"div",8),h.Qc(15,Zi,1,0,"ng-container",9),h.Yb(),h.Qc(16,Fi,1,1,"ng-template",null,10,h.Rc),h.Qc(18,Ai,1,1,"ng-template",null,11,h.Rc),h.Qc(20,Wo,12,11,"ng-template",null,12,h.Rc),h.Qc(22,ta,21,19,"ng-template",null,13,h.Rc),h.Qc(24,da,4,3,"ng-template",null,14,h.Rc),h.Zb(26,"mat-menu",null,15),h.Qc(28,ua,12,19,"div",2),h.Yb(),h.Zb(29,"mat-menu",null,16),h.Zb(31,"button",17),h.hc("click",(function(){return e.setChangeRecoMode(e.ChangeRecoMode.Original)})),h.Sc(32),h.mc(33,"translate"),h.Yb(),h.Qc(34,pa,3,6,"button",18),h.Qc(35,fa,3,6,"button",18),h.Qc(36,va,3,6,"button",18),h.Qc(37,Ma,3,6,"button",18),h.Yb()),2&t){const t=h.Ec(11),n=h.Ec(17),i=h.Ec(19);h.tc("hasMainButton",e.perms.isAllowed("can_create_amendments",e.motion))("nav",!1)("editMode",e.editMotion)("isSaveButtonEnabled",e.contentForm.valid),h.Gb(2),h.tc("ngIf",e.motion&&!e.newMotion),h.Gb(1),h.tc("ngIf",e.newMotion&&!e.amendmentEdit),h.Gb(1),h.tc("ngIf",e.amendmentEdit),h.Gb(1),h.tc("ngIf",!e.editMotion&&!e.vp.isMobile),h.Gb(2),h.tc("matMenuTriggerFor",t),h.Gb(5),h.tc("ngIf",e.motion),h.Gb(2),h.tc("ngIf",e.motion&&!e.editMotion),h.Gb(1),h.tc("ngIf",e.vp.isMobile)("ngIfThen",n)("ngIfElse",i),h.Gb(13),h.tc("ngIf",e.motion),h.Gb(3),h.tc("ngClass",h.zc(23,ga,e.crMode===e.ChangeRecoMode.Original)),h.Gb(1),h.Uc(" ",h.nc(33,21,"Original version")," "),h.Gb(2),h.tc("ngIf",e.allChangingObjects&&e.allChangingObjects.length),h.Gb(1),h.tc("ngIf",e.allChangingObjects&&e.allChangingObjects.length),h.Gb(1),h.tc("ngIf",e.motion&&!e.motion.isParagraphBasedAmendment()&&e.allChangingObjects&&e.allChangingObjects.length),h.Gb(1),h.tc("ngIf",e.motion&&e.motion.modified_final_version&&!e.motion.isParagraphBasedAmendment())}},directives:[f.a,i.t,I.b,Mt.e,It.a,Mt.f,Mt.c,i.q,St.a,Ct.a,Tt.a,Gt.a,_t.a,c.g,Yt.c,c.i,i.A,wt.a,Ut,Xt,be,i.s,de.a,ee.a,ee.d,S.a,s.s,s.v,en,s.I,s.t,s.k,pt.c,s.y,ft.b,s.c,nn.a,pt.b,pt.j,s.i,on.a,cn.n,ie.a,s.D,rn,Bn,M.a,$n.a,$n.d,qn.a,zn.a],pipes:[u.j,T.a],styles:['.motion-text .insert,.motion-text ins{color:green;text-decoration:underline}.motion-text .delete,.motion-text del{color:red;text-decoration:line-through}.motion-text li{padding-bottom:10px}.motion-text ol,.motion-text ul{margin-left:15px;margin-bottom:0}.motion-text .highlight{background-color:#ff0}.motion-text.line-numbers-outside{padding-left:40px;position:relative}.motion-text.line-numbers-outside .os-line-number{display:inline-block;font-size:0;line-height:0;width:22px;height:22px;position:absolute;left:0;padding-right:55px}.motion-text.line-numbers-outside .os-line-number:after{content:attr(data-line-number);position:absolute;top:13px;vertical-align:top;color:grey;font-size:12px;font-weight:400}.motion-text.line-numbers-outside .os-line-number.selectable:hover:before,.motion-text.line-numbers-outside .os-line-number.selected:before{position:absolute;top:4px;left:20px;display:inline-block;cursor:pointer;content:"";width:16px;height:16px;background:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" fill="%23337ab7"/><path d="M0 0h24v24H0z" fill="none"/></svg>\');background-size:16px 16px}.motion-text.line-numbers-inline .os-line-break{display:none}.motion-text.line-numbers-inline .os-line-number{display:inline-block}.motion-text.line-numbers-inline .os-line-number:after{display:inline-block;content:attr(data-line-number);vertical-align:top;font-size:10px;font-weight:400;color:grey;margin-top:-3px;margin-left:0;margin-right:0}.motion-text.line-numbers-none .os-line-break,.motion-text.line-numbers-none .os-line-number{display:none}.motion-text .os-split-before{margin-top:0;padding-top:0}.motion-text .os-split-after{margin-bottom:0;padding-bottom:0}.motion-text li.os-split-before{list-style:none}.amendment-view .os-split-after{margin-bottom:0}.amendment-view .os-split-before{margin-top:0}.amendment-view .paragraphcontext{opacity:.5}.amendment-view.amendment-context .paragraphcontext{opacity:1}span{margin:0}.create-poll-button{margin-bottom:1em}.prev-next-motion-controls div{display:inherit}.motion-content{display:flow-root}.motion-text-toolbar-wrapper{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;margin-bottom:16px}.motion-text-toolbar-wrapper button{font-weight:400}.motion-text-toolbar-wrapper>button{margin-top:7px}.motion-text-toolbar-wrapper .motion-text-controls .motion-goto-line{width:150px}.motion-text-toolbar-wrapper .motion-text-controls input[type=number]::-webkit-inner-spin-button,.motion-text-toolbar-wrapper .motion-text-controls input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.motion-text-toolbar-wrapper .motion-text-controls input[type=number]{-moz-appearance:textfield}.meta-info-panel{padding-top:25px}.meta-info-panel a:hover{cursor:pointer}.mat-accordion{display:block;margin-top:0}.mat-expansion-panel{padding-top:0}.mat-expansion-panel .expansion-panel-custom-body{padding-left:55px}.statute-amendment-selector mat-form-field{margin-left:20px;width:calc(100% - 20px)}.amendment-line-header{font-style:italic}.motion-content h4{margin:10px 10px 15px 0;display:block;font-weight:500;font-size:110%}.motion-content h5{margin:15px 10px 10px 0;display:block;font-weight:500;font-size:100%}.motion-content .motion-text{clear:both;margin-left:0}.motion-content .text-prefix-label{display:block;margin:0 10px 20px 0}.motion-content .extra-data{margin-top:1em}.motion-content .content-field{display:inline-block;width:100%}.motion-content .form-id-title{display:-ms-flexbox;display:flex}.motion-content .form-id-title .form-identifier{-ms-flex:0 0 95px;flex:0 0 95px;max-width:95px;margin-right:1em}.motion-content .form-id-title .form-title{-ms-flex:1 1 auto;flex:1 1 auto}.desktop-view .desktop-left{width:30%;float:left;padding-right:25px}.desktop-view .desktop-right .os-form-card{margin-bottom:20px}.desktop-view .desktop-right .os-card{display:grid;max-width:900px;min-width:400px;margin-left:0!important;margin-top:0!important}.mobile-view .os-card{padding:27px;max-width:calc(100% - 54px)}.title-line{display:-ms-flexbox;display:flex}.title-line .motion-title{position:relative;z-index:1;margin-left:-20px;padding-left:20px}.title-line .motion-title .change-title{position:relative;width:0;height:0}.title-line .motion-title .change-title:before{position:absolute;top:18px;left:-17px;display:none;cursor:pointer;content:"";width:16px;height:16px;background:url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z" fill="%23337ab7"/><path d="M0 0h24v24H0z" fill="none"/></svg>\');background-size:16px 16px}.title-line .motion-title:hover .change-title:before{display:block}.title-line .motion-title .title-change-indicator{background-color:#0333ff;position:absolute;width:4px;height:32px;left:10px;top:5px;cursor:pointer}.mat-chip-list-stacked .mat-chip{margin:4px}.supporters{font-size:12px;margin-top:4px}.show-entire-text-check{font-size:70%;float:right}'],encapsulation:2,changeDetection:0}),t})(),pathMatch:"full",runGuardsAndResolvers:"paramsChange"},{path:"create-amendment",component:N}];let Sa=(()=>{class t{}return t.\u0275mod=h.Rb({type:t}),t.\u0275inj=h.Qb({factory:function(e){return new(e||t)},imports:[[c.j.forChild(Ia)],c.j]}),t})();var Ca=n("tSYa");let Ta=(()=>{class t{}return t.\u0275mod=h.Rb({type:t}),t.\u0275inj=h.Qb({factory:function(e){return new(e||t)},imports:[[i.c,Sa,o.a,Ca.MotionPollModule]]}),t})()},T9hM:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),o=n("4u49"),c=n("D/ll"),a=n("AqIO"),s=n("g96W"),r=n("A6Ob"),l=n("+KbT"),m=n("fXoL"),b=n("sYmb");let d=(()=>{class t extends r.a{constructor(t,e,n,i){super(t,e,n),this.storageKey="MotionList",this.defaultSortingLoaded=new s.a,this.motionSortOptions=[{property:"weight",label:"Call list"},{property:"identifier"},{property:"title"},{property:"submitters"},{property:"category",sortFn:this.categorySortFn},{property:"motion_block_id",label:"Motion block"},{property:"state"},{property:"creationDate",label:Object(o.a)("Creation date")},{property:"lastChangeDate",label:Object(o.a)("Last modified")}],i.get("motions_motions_sorting").subscribe(t=>{t&&(this.defaultMotionSorting=t,this.defaultSortingLoaded.resolve())})}getSortOptions(){return this.motionSortOptions}getDefaultDefinition(){return Object(i.a)(this,void 0,void 0,(function*(){return yield this.defaultSortingLoaded,{sortProperty:this.defaultMotionSorting,sortAscending:!0}}))}categorySortFn(t,e,n){return t.category_id===e.category_id?t.category_weight<e.category_weight===n?-1:1:t.category.weight<e.category.weight===n?-1:1}}return t.\u0275fac=function(e){return new(e||t)(m.dc(b.k),m.dc(a.a),m.dc(c.a),m.dc(l.a))},t.\u0275prov=m.Pb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);